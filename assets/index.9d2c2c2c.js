import{Q as Le}from"./QPage.205fb9c2.js";import{u as ve}from"./use-quasar.b8d84810.js";import{u as T,q as O,c as Me}from"./app.3beb99b9.js";import{s as Ce,k as _,l as oe,r as Y,_ as Z,B as f,as as N,ax as ye,bt as c,d as r,bY as v,E as l,ae as $,I as qe,b7 as E,cV as J,cW as R,cX as se,C as U,at as F,cY as ee,bQ as me,bS as je,c as I,w as le,bW as Pe,bV as Ie,bX as ge,F as be,b6 as we,H as Se,bU as Be,z as Qe}from"./index.cf7d0d08.js";import{localforage as A}from"./localForage.b61520e5.js";import{dayjs as h}from"./dayjs.c84cb7a6.js";import{Q as fe}from"./QForm.8349aee9.js";import{a as Ue,Q as re}from"./QStep.6a1cf27d.js";import{a as ie,b as Ye}from"./useQuerySaver.d29ff9ee.js";import{u as ze}from"./dataStore.7ebfc18b.js";import{a as pe,u as P}from"./vee-validate.esm.10226477.js";import{a as B,b as He,c as ne,f as $e}from"./array.164cfe36.js";import{Q as de}from"./QTooltip.f86f61e7.js";import{a as ce}from"./QSelect.82477e9e.js";import{P as Xe,f as We,n as Je}from"./pay-rate-v2.0e1d8757.js";import{Q as De}from"./QTd.c654371a.js";import{Q as Ne}from"./QTable.71a5f950.js";import{p as Ge}from"./VueTelInput.5de42b1a.js";import{_ as Ze}from"./projectSelector.112c53be.js";import{_ as Ke}from"./officeSelector.c02fab15.js";import"./_commonjsHelpers.a26ce4be.js";import"./index.04bc0a32.js";import"./i18n.36b2cf04.js";import"./use-panel.c38b3b23.js";import"./touch.3df10340.js";import"./selection.91083131.js";import"./QSlideTransition.56627dd5.js";import"./position-engine.e46721cf.js";import"./QChip.9b6ccfb5.js";import"./QMenu.fa307e11.js";import"./rtl.b51694b1.js";import"./QList.0865afef.js";import"./QMarkupTable.2ea503b6.js";import"./use-fullscreen.59f721ab.js";const te=Ce("newRequestDataStore",{state:()=>({selectedProject:null,humanizedData:{},humanizedClassificationData:[],dbData:{},dbClassificationData:[],jobNumbers:{},siteContacts:{},meetingLocations:{},perDiemSpecs:{},projectCrafts:{},projectCraftClassifications:{},requestedTimeStamps:{},v3EditData:{request:null,classifications:[],names:[]},v3Data:{request:null,project:null,general:null,classifications:[],names:[],matches:null,edit:!1},v3Options:{projects:[],jobNumbers:[],contacts:[],locations:[],perDiem:[],crafts:[],jobs:[],restrictions:[{value:"Name Request Only",description:"The hiring center will only hire the names you provide.",warning:"If you DO NOT provide enough names or if the people you request do not show up, the hiring center WILL NOT assist with filling this request."},{value:"Open",description:"The hiring center will fill positions by recruiting and selecting the most qualified candidates available.",warning:"You will NOT be able to add names to this type of request."},{value:"Mixed",description:"The hiring center will hire all of the names that you provide and fill remaining positions by recruiting and selecting the most qualified candidates available."}],reasons:[{value:"Backfill",label:"Backfill - (An employee was terminated)",description:"This request is to fill positions that are open because of an employee leaving the job site."},{value:"Increase in Manpower",label:"Increase in Manpower - (We need more employees on site)",description:"This request is to fill positions that are new because of an increased need in manpower. This may be due to a change in the scope of an existing contract, an additional contract awarded, etc."}]}}),getters:{getStoredData:e=>({type:t,key:s})=>!t||!s?[]:!e.requestedTimeStamps[s]||!e.requestedTimeStamps[s][t]||e.requestedTimeStamps[s][t].isBefore(h().subtract(10,"minute"))?[]:e[t][s],getHumanizedData:e=>e.humanizedData,getDbData:e=>e.dbData,getHumanizedClassificationData:e=>e.humanizedClassificationData,getDbClassificationData:e=>e.dbClassificationData,getRequestedTimeStamps(e){return e.requestedTimeStamps},getV3Data:e=>e.v3Data,getV3Options:e=>e.v3Options,getV3EditData:e=>e.v3EditData},actions:{setselectedProject(e){this.selectedProject=e},setTimeStamp({name:e,timeStamp:t,Id:s},o){if(this.requestedTimeStamps[s]?this.requestedTimeStamps[s][e]=t:this.requestedTimeStamps[s]={[e]:t},o){const a=JSON.parse(JSON.stringify(this.requestedTimeStamps));A.setItem(`${_.storageProcessTimeStamps}`,a)}},setNewRequestData({humanized:e,database:t}){for(const[s,o]of Object.entries(e))Object.assign(this.humanizedData,{[s]:o});for(const[s,o]of Object.entries(t))Object.assign(this.dbData,{[s]:o})},setNewRequestClassificationData({humanized:e,database:t}){this.humanizedClassificationData=e,this.dbClassificationData=t},setStorageData({type:e,key:t,data:s,timestamp:o}){this.setTimeStamp({name:e,Id:t,timeStamp:o}),this[e][t]=s},setTimeStampState(e){this.requestedTimeStamps=e},async removeData({type:e,key:t,item:s,storageKey:o}){const a=this[e][t].findIndex(m=>m[3]===s[3]);a>-1&&this[e][t].splice(a,1);const n=this[e][t];A.removeItem(`${_[o]}_${t}`),A.getItem(`${_[o]}_${t}`)||A.setItem(`${_[o]}_${t}`,n)},setV3Data({prop:e,data:t,push:s}){s?this.v3Data[e].push(t):this.v3Data[e]=t},setV3EditData({prop:e,data:t,push:s}){s?this.v3EditData[e].push(t):this.v3EditData[e]=t},setV3Options({prop:e,data:t}){this.v3Options[e]=t},resetV3Data(){this.v3Data={project:null,general:null,classifications:[],names:[],matches:null},this.v3Options={projects:[],jobNumbers:[],contacts:[],locations:[],perDiem:[],crafts:[],jobs:[],restrictions:[{value:"Name Request Only",description:"The hiring center will only hire the names you provide.",warning:"If you DO NOT provide enough names or if the people you request do not show up, the hiring center WILL NOT assist with filling this request."},{value:"Open",description:"The hiring center will fill positions by recruiting and selecting the most qualified candidates available.",warning:"You will NOT be able to add names to this type of request."},{value:"Mixed",description:"The hiring center will hire all of the names that you provide and fill remaining positions by recruiting and selecting the most qualified candidates available."}],reasons:[{value:"Backfill",label:"Backfill - (An employee was terminated)",description:"This request is to fill positions that are open because of an employee leaving the job site."},{value:"Increase in Manpower",label:"Increase in Manpower - (We need more employees on site)",description:"This request is to fill positions that are new because of an increased need in manpower. This may be due to a change in the scope of an existing contract, an additional contract awarded, etc."}]}}}}),ke=Ce("dataStore2",{state:()=>({selectedOffice:null,selfCheckIns:{},profiles:{},scheduledInterviews:{},inProcessInterviews:{},inProcess:{},pending:{},deployments:{},projects:{},openRequest:{},pendingRequest:{},closedRequest:{},openClassifications:{},pendingClassifications:{},closedClassifications:{},nameRequest:{},pendingProjects:{},requestedTimeStamps:{}}),getters:{getSelfCheckIns:e=>t=>{if(t)return e.selfCheckIns[t]?e.selfCheckIns[t]:[];{let s=[];return Object.keys(e.selfCheckIns).forEach(o=>{s=s.concat(e.selfCheckIns[o])}),s}},getProfiles:e=>t=>{if(t)return e.profiles[t]?e.profiles[t]:[];{let s=[];return Object.keys(e.profiles).forEach(o=>{s=s.concat(e.profiles[o])}),s}},getScheduledInterviews:e=>t=>{if(t)return e.scheduledInterviews[t]?e.scheduledInterviews[t]:[];{let s=[];return Object.keys(e.scheduledInterviews).forEach(o=>{s=s.concat(e.scheduledInterviews[o])}),s}},getInProcessInterviews:e=>t=>{if(t)return e.inProcessInterviews[t]?e.inProcessInterviews[t]:[];{let s=[];return Object.keys(e.inProcessInterviews).forEach(o=>{s=s.concat(e.inProcessInterviews[o])}),s}},getInProcess:e=>t=>{if(t)return e.inProcess[t]?e.inProcess[t]:[];{let s=[];return Object.keys(e.inProcess).forEach(o=>{s=s.concat(e.inProcess[o])}),s}},getPending:e=>t=>{if(t)return e.pending[t]?e.pending[t]:[];{let s=[];return Object.keys(e.pending).forEach(o=>{s=s.concat(e.pending[o])}),s}},getDeployments:e=>t=>{if(t)return e.deployments[t]?e.deployments[t]:[];{let s=[];return Object.keys(e.deployments).forEach(o=>{s=s.concat(e.deployments[o])}),s}},getProjects:e=>(t,s)=>{if(!s&&!t){let o=[];return Object.keys(e.projects).forEach(a=>{o=o.concat(e.projects[a])}),o}else if(!s&&t){const{userOffices:o}=T();let a=[];return o(t).forEach(n=>{a=a.concat(e.projects[n[8]])}),a}else if(s&&t){const{getOffice:o}=T(),a=o(s);return t==="read"&&a&&a[39]!==!0?[]:(t==="create"||t==="update")&&a&&a[40]!==!0?[]:t==="manage"&&a&&a[41]!==!0?[]:e.projects[s]?e.projects[s]:[]}else return e.projects[s]?e.projects[s]:[]},getPendingProjects:e=>t=>{if(t)return e.pendingProjects[t]?e.pendingProjects[t]:[];{let s=[];return Object.keys(e.pendingProjects).forEach(o=>{s=s.concat(e.pendingProjects[o])}),s}},getRequestedTimeStamps(e){return e.requestedTimeStamps},getSelectedOffice(e){return e.selectedOffice}},actions:{setSelectedOffice(e,t){this.selectedOffice=e},setTimeStamp({name:e,timeStamp:t,officeId:s},o){if(this.requestedTimeStamps[s]?this.requestedTimeStamps[s][e]=t:this.requestedTimeStamps[s]={[e]:t},o){const a=JSON.parse(JSON.stringify(this.requestedTimeStamps));A.setItem(`${_.storageProcessTimeStamps}`,a)}},setTimeStampState(e){this.requestedTimeStamps=e},async fetchSelfCheckIns(e){const t=this.getRequestedTimeStamps[e.officeId]||{};let s=!0;const o=[{9:{value:e.officeId},7:{value:"Self Check-Ins"}}];if(t.selfCheckIns&&(t.selfCheckIns.isBefore(h().subtract(1,"minute"))?s=!0:s=e.refresh?e.refresh:!1),s){this.setTimeStamp({officeId:e.officeId,name:"selfCheckIns",timeStamp:h()},!0);const{data:a}=await O.fetchFromRecruitingApp({fields:o});return this.setSelfCheckIns({officeId:e.officeId,data:a},!0),{data:a}}else return{data:[]}},async fetchAllSelfCheckIns(e){const{userOffices:t}=T(),s=[];return t(e?e.access:null).forEach(a=>{let n=this.fetchSelfCheckIns({...e,officeId:a[8]});s.push(n)}),await Promise.allSettled(s)},setSelfCheckIns({officeId:e,data:t},s){this.selfCheckIns[e]=t,s&&A.setItem(`${_.storageSelfCheckIns}_${e}`,t)},async fetchProfiles(e){const t=this.getRequestedTimeStamps[e.officeId]||{};let s=!0;const o=[{9:{value:e.officeId},7:{value:"Profiles"}}];if(t.profiles&&(t.profiles.isBefore(h().subtract(1,"minute"))?s=!0:s=e.refresh?e.refresh:!1),s){this.setTimeStamp({officeId:e.officeId,name:"profiles",timeStamp:h()},!0);const{data:a}=await O.fetchFromHiringApp({fields:o});return this.setProfiles({officeId:e.officeId,data:a},!0),{data:a}}else return{data:[]}},async fetchAllProfiles(e){const{userOffices:t}=T(),s=[];return t(e?e.access:null).forEach(a=>{let n=this.fetchProfiles({...e,officeId:a[8]});s.push(n)}),await Promise.allSettled(s)},setProfiles({officeId:e,data:t},s){this.profiles[e]=t,s&&A.setItem(`${_.storageProfiles}_${e}`,t)},async fetchScheduledInterviews(e){const t=this.getRequestedTimeStamps[e.officeId]||{};let s=!0;const o=[{9:{value:e.officeId},7:{value:"Scheduled Interviews"}}];if(t.scheduledInterviews&&(t.scheduledInterviews.isBefore(h().subtract(1,"minute"))?s=!0:s=e.refresh?e.refresh:!1),s){this.setTimeStamp({officeId:e.officeId,name:"scheduledInterviews",timeStamp:h()},!0);const{data:a}=await O.fetchFromHiringApp({fields:o});return this.setScheduledInterviews({officeId:e.officeId,data:a},!0),{data:a}}else return{data:[]}},async fetchAllScheduledInterviews(e){const{userOffices:t}=T(),s=[];return t(e?e.access:null).forEach(a=>{let n=this.fetchScheduledInterviews({...e,officeId:a[8]});s.push(n)}),await Promise.allSettled(s)},setScheduledInterviews({officeId:e,data:t},s){this.scheduledInterviews[e]=t,s&&A.setItem(`${_.storageScheduledInterviews}_${e}`,t)},async fetchInProcessInterviews(e){const t=this.getRequestedTimeStamps[e.officeId]||{};let s=!0;const o=[{9:{value:e.officeId},7:{value:"In Process Interviews"}}];if(t.inProcessInterviews&&(t.inProcessInterviews.isBefore(h().subtract(1,"minute"))?s=!0:s=e.refresh?e.refresh:!1),s){this.setTimeStamp({officeId:e.officeId,name:"inProcessInterviews",timeStamp:h()},!0);const{data:a}=await O.fetchFromHiringApp({fields:o});return this.setInProcessInterviews({officeId:e.officeId,data:a},!0),{data:a}}else return{data:[]}},async fetchAllInProcessInterviews(e){const{userOffices:t}=T(),s=[];return t(e?e.access:null).forEach(a=>{let n=this.fetchInProcessInterviews({...e,officeId:a[8]});s.push(n)}),await Promise.allSettled(s)},setInProcessInterviews({officeId:e,data:t},s){this.inProcessInterviews[e]=t,s&&A.setItem(`${_.storageInProcessInterviews}_${e}`,t)},async fetchInProcess(e){const t=this.getRequestedTimeStamps[e.officeId]||{};let s=!0;const o=[{9:{value:e.officeId},7:{value:"In Processes"}}];if(t.inProcess&&(t.inProcess.isBefore(h().subtract(1,"minute"))?s=!0:s=e.refresh?e.refresh:!1),s){this.setTimeStamp({officeId:e.officeId,name:"inProcess",timeStamp:h()},!0);const{data:a}=await O.fetchFromHiringApp({fields:o});return this.setInProcess({officeId:e.officeId,data:a},!0),{data:a}}else return{data:[]}},async fetchAllInProcess(e){const{userOffices:t}=T(),s=[];return t(e?e.access:null).forEach(a=>{let n=this.fetchInProcess({...e,officeId:a[8]});s.push(n)}),await Promise.allSettled(s)},setInProcess({officeId:e,data:t},s){this.inProcess[e]=t,s&&A.setItem(`${_.storageInProcess}_${e}`,t)},async fetchPending(e){const t=this.getRequestedTimeStamps[e.officeId]||{};let s=!0;const o=[{9:{value:e.officeId},7:{value:"Dispatches"}}];if(t.pending&&(t.pending.isBefore(h().subtract(1,"minute"))?s=!0:s=e.refresh?e.refresh:!1),s){this.setTimeStamp({officeId:e.officeId,name:"pending",timeStamp:h()},!0);const{data:a}=await O.fetchFromHiringApp({fields:o});return this.setPending({officeId:e.officeId,data:a},!0),{data:a}}else return{data:[]}},async fetchAllPending(e){const{userOffices:t}=T(),s=[];return t(e?e.access:null).forEach(a=>{let n=this.fetchPending({...e,officeId:a[8]});s.push(n)}),await Promise.allSettled(s)},setPending({officeId:e,data:t},s){this.pending[e]=t,s&&A.setItem(`${_.storagePending}_${e}`,t)},async fetchOpenRequest(e){const t=this.getRequestedTimeStamps[e.officeId]||{};let s=!0;const o=[{9:{value:e.officeId},7:{value:"Open Request"}}];if(t.openRequest&&(t.openRequest.isBefore(h().subtract(1,"minute"))?s=!0:s=e.refresh?e.refresh:!1),s){this.setTimeStamp({officeId:e.officeId,name:"openRequest",timeStamp:h()},!0);const{data:a}=await O.fetchFromProjectsApp({fields:o});return this.setOpenRequest({officeId:e.officeId,data:a},!0),{data:a}}else return{data:[]}},async fetchAllOpenRequest(e){const{userOffices:t}=T(),s=[];return t(e?e.access:null).forEach(a=>{let n=this.fetchOpenRequest({...e,officeId:a[8]});s.push(n)}),await Promise.allSettled(s)},setOpenRequest({officeId:e,data:t},s){this.openRequest[e]=t,s&&A.setItem(`${_.storageOpenRequest}_${e}`,t)},async fetchPendingRequest(e){const t=this.getRequestedTimeStamps[e.officeId]||{};let s=!0;const o=[{9:{value:e.officeId},7:{value:"Pending Request"}}];if(t.pendingRequest&&(t.pendingRequest.isBefore(h().subtract(1,"minute"))?s=!0:s=e.refresh?e.refresh:!1),s){this.setTimeStamp({officeId:e.officeId,name:"pendingRequest",timeStamp:h()},!0);const{data:a}=await O.fetchFromProjectsApp({fields:o});return this.setPendingRequest({officeId:e.officeId,data:a},!0),{data:a}}else return{data:[]}},async fetchAllPendingRequest(e){const{userOffices:t}=T(),s=[];return t(e?e.access:null).forEach(a=>{let n=this.fetchPendingRequest({...e,officeId:a[8]});s.push(n)}),await Promise.allSettled(s)},setPendingRequest({officeId:e,data:t},s){this.pendingRequest[e]=t,s&&A.setItem(`${_.storagePendingRequest}_${e}`,t)},async fetchProjects(e){const{getOffice:t}=T(),s=this.getRequestedTimeStamps[e.officeId]||{};let o=!0;if(e&&e.access){const n=t(e.officeId);if(e.access==="read"&&n&&n[39]!==!0)return{data:[]};if((e.access==="create"||e.access==="update")&&n&&n[40]!==!0)return{data:[]};if(e.access==="manage"&&n&&n[41]!==!0)return{data:[]}}const a=[{9:{value:e.officeId},7:{value:"Projects"}}];if(s.projects&&(s.projects.isBefore(h().subtract(1,"minute"))?o=!0:o=e.refresh?e.refresh:!1),o){this.setTimeStamp({officeId:e.officeId,name:"projects",timeStamp:h()},!0);const{data:n}=await O.fetchFromProjectsApp({fields:a});return this.setProjects({officeId:e.officeId,data:n},!0),{data:n}}else return{data:[]}},async fetchAllProjects(e){const{userOffices:t}=T(),s=[];return t(e?e.access:null).forEach(a=>{let n=this.fetchProjects({...e,officeId:a[8]});s.push(n)}),await Promise.allSettled(s)},setProjects({officeId:e,data:t},s){e&&t&&(this.projects[e]=t),s&&e&&A.setItem(`${_.storageProjects}_${e}`,t)},async fetchPendingProjects(e){const t=this.getRequestedTimeStamps[e.officeId]||{};let s=!0;const o=[{9:{value:e.officeId},7:{value:"Pending Projects"}}];if(t.pendingProjects&&(t.pendingProjects.isBefore(h().subtract(1,"minute"))?s=!0:s=e.refresh?e.refresh:!1),s){this.setTimeStamp({officeId:e.officeId,name:"pendingProjects",timeStamp:h()},!0);const{data:a}=await O.fetchFromProjectsApp({fields:o});return this.setPendingProjects({officeId:e.officeId,data:a},!0),{data:a}}else return{data:[]}},async fetchAllPendingProjects(e){const{userOffices:t}=T(),s=[];return t(e?e.access:null).forEach(a=>{let n=this.fetchPendingProjects({...e,officeId:a[8]});s.push(n)}),await Promise.allSettled(s)},setPendingProjects({officeId:e,data:t},s){this.pendingProjects[e]=t,s&&A.setItem(`${_.storagePendingProjects}_${e}`,t)}}}),xe=oe({props:{fetcher:{type:Function,required:!0},getter:{type:Function,required:!0},setter:{type:Function,required:!0},filter:{type:Function,required:!0}},setup(e){const t=Y([]),s=async()=>{const{fetcher:a,getter:n,setter:m}=e;if(!n()||n().length===0){const i=await a();m(i),t.value=n()}else t.value=n()},o=(a,n)=>{const{getter:m,filter:i}=e,u=m();if(a===""||!a){n(()=>{t.value=u});return}t.value=i(u,a)};return s(),{options:t,filterOptions:o}}}),et={class:"text-caption"},tt={class:"text-caption"};function st(e,t,s,o,a,n){return f(),N(ce,qe(e.$attrs,{"transition-show":"flip-up","transition-hide":"flip-down",options:e.options,"bottom-slots":"","use-input":"","input-debounce":"0",onFilter:e.filterOptions,loading:!e.options||e.options.length===0}),ye({error:c(()=>[l("div",et,$(e.$attrs.errorMessage),1)]),_:2},[e.$attrs.showTooltip?{name:"after",fn:c(()=>[r(v,{size:"xs",color:"accent",round:"",icon:"question_mark"},{default:c(()=>[r(de,{anchor:"top middle",self:"center middle",class:"bg-primary text-white"},{default:c(()=>[l("div",null,[l("div",tt,$(e.$attrs.tooltipMessage),1)])]),_:1})]),_:1})]),key:"0"}:void 0]),1040,["options","onFilter","loading"])}var Ve=Z(xe,[["render",st]]);const ot=oe({emits:["changeStep"],components:{aSelect:Ve},setup(e,{emit:t}){const s=Y(0),o=Y(h().format("YYYY-MM-DD")),a=Y(h().add("60","day").format("YYYY-MM-DD")),{getV3Data:n,setV3Data:m,getV3Options:i,setV3Options:u}=te(),d=n.general?n.general:{},p=B({dateNeeded:He().required().nullable().label("Date Needed").min(o.value).max(a.value),restriction:B().required().label("Request Type"),reason:B().required().label("Request Reason"),jobNumber:B().required().nullable().label("Job Number"),meetingLocation:B().required().nullable().label("Meeting Location"),siteContact:B().required().nullable().label("Site Contact"),perDiem:B().nullable().label("Per Diem"),notes:ne().nullable().label("Notes")}),{meta:b,errors:q,handleSubmit:g}=pe({validationSchema:p,initialValues:{restriction:d.restriction?d.restriction:i.restrictions[1],reason:d.reason?d.reason:i.reasons[0],dateNeeded:d.dateNeeded?d.dateNeeded:null,jobNumber:d.jobNumber?d.jobNumber:null,meetingLocation:d.meetingLocation?d.meetingLocation:null,siteContact:d.siteContact?d.siteContact:null,perDiem:d.perDiem?d.perDiem:null,notes:d.notes?d.notes:null}}),{value:D}=P("dateNeeded"),{value:L}=P("restriction"),{value:Q}=P("reason"),{value:z}=P("jobNumber"),{value:K}=P("meetingLocation"),{value:x}=P("siteContact"),{value:k}=P("perDiem"),{value:w}=P("notes"),S=g(C=>{console.log(C),C.notes=C.notes?C.notes.replace(/(\r\n|\n|\r)/gm," "):null,m({prop:"general",data:C}),t("changeStep",2)});return{step:s,changeStep:C=>{},submit:S,meta:b,errors:q,dateNeeded:D,jobNumber:z,restriction:L,reason:Q,siteContact:x,meetingLocation:K,perDiem:k,notes:w,getV3Options:i,setV3Options:u,getV3Data:n,jobNumberFetcher:async()=>{const{data:C}=await O.fetchFromProjectsApp({fields:[ie({type:"jobNumbers",query:`{'6'.EX.'${n.project[3]}'}AND{'29'.EX.'Active'}`})]});return C.sort((H,G)=>H[11]>G[11]?-1:1)},meetingLocationsFetcher:async()=>{const{data:C}=await O.fetchFromStructureApp({fields:[Ye({type:"meetingLocations",query:`{'15'.EX.'${n.project[8]}'}AND{'14'.EX.'Active'}`})]});return C.sort((H,G)=>H[6]>G[6]?-1:1)},siteContactsFetcher:async()=>{const{data:C}=await O.fetchFromProjectsApp({fields:[ie({type:"siteContacts",query:`{'7'.EX.'${n.project[3]}'}AND{'6'.EX.'Active'}`})]});return C.sort((H,G)=>H[17]>G[17]?-1:1)},perDiemFetcher:async()=>{const{data:C}=await O.fetchFromProjectsApp({fields:[ie({type:"perDiemSpecs",query:`{'12'.EX.'${n.project[3]}'}AND{'38'.EX.'Active'}`})]});return C.sort((H,G)=>H[20]>G[20]?-1:1)},today:o,maxDay:a}}}),at=l("div",{class:"text-body2 text-italic text-weight-bold text-dark"},"Please provide the following general information about this request.",-1),rt={class:"row"},nt={class:"col-12 col-md-4 q-pr-md"},it={class:"text-caption"},lt=l("div",null,[l("div",{class:"text-caption"}," This is the day that these employees should arrive to begin work. "),l("div",{class:"text-caption"}," Expect a minimum of 3-5 days for processing of any drug screens or background checks. ")],-1),ct={class:"text-caption"},ut={class:"text-caption"},dt={class:"text-caption"},mt={class:"text-caption"},ft={key:0,class:"text-caption text-dark text-italic text-weight-bold"},pt={class:"col-12 col-md-4 q-pr-sm"},ht={class:"col-12 col-md-4 q-pr-sm"};function bt(e,t,s,o,a,n){const m=E("a-select");return f(),N(fe,{onSubmit:me(e.submit,["prevent"])},{default:c(()=>[r(J,{flat:""},{default:c(()=>[r(R,{class:"q-pt-none q-px-none"},{default:c(()=>[at]),_:1}),r(R,{class:"q-px-none q-pb-none"},{default:c(()=>[l("div",rt,[l("div",nt,[r(se,{class:"q-mb-md",autofocus:"",outlined:"",clearable:"",type:"date",dense:"",label:"Date Needed",min:e.today,max:e.maxDay,modelValue:e.dateNeeded,"onUpdate:modelValue":t[0]||(t[0]=i=>e.dateNeeded=i),error:!!e.errors.dateNeeded,"bottom-slots":"","stack-label":""},{error:c(()=>[l("div",it,$(e.errors.dateNeeded),1)]),before:c(()=>[r(v,{size:"xs",color:"accent",round:"",icon:"question_mark"},{default:c(()=>[r(de,{anchor:"top middle",self:"center middle",class:"bg-primary text-white"},{default:c(()=>[lt]),_:1})]),_:1})]),_:1},8,["min","max","modelValue","error"]),r(ce,{class:"q-mb-md",dense:"",clearable:"",outlined:"","transition-show":"flip-up","transition-hide":"flip-down",label:"Request Reason",modelValue:e.reason,"onUpdate:modelValue":t[1]||(t[1]=i=>e.reason=i),options:e.getV3Options.reasons,"option-label":"label",error:!!e.errors.reason,"bottom-slots":""},{error:c(()=>[l("div",ct,$(e.errors.reason),1)]),before:c(()=>[r(v,{size:"xs",color:"accent",round:"",icon:"question_mark"},{default:c(()=>[r(de,{anchor:"top middle",self:"center middle",class:"bg-primary text-white"},{default:c(()=>[l("div",null,[l("div",ut,$(e.reason?e.reason.description:""),1)])]),_:1})]),_:1})]),_:1},8,["modelValue","options","error"]),r(ce,{class:"q-mb-md",dense:"",clearable:"",outlined:"","transition-show":"flip-up","transition-hide":"flip-down",label:"Request Type",modelValue:e.restriction,"onUpdate:modelValue":t[2]||(t[2]=i=>e.restriction=i),options:e.getV3Options.restrictions,"option-label":"value",error:!!e.errors.restriction,"bottom-slots":""},{error:c(()=>[l("div",dt,$(e.errors.restriction),1)]),before:c(()=>[r(v,{size:"xs",color:"accent",round:"",icon:"question_mark"},{default:c(()=>[r(de,{anchor:"top middle",self:"center middle",class:"bg-primary text-white"},{default:c(()=>[l("div",null,[l("div",mt,$(e.restriction?e.restriction.description:""),1)])]),_:1})]),_:1})]),hint:c(()=>[e.restriction?(f(),U("div",ft,$(e.restriction.warning||""),1)):F("",!0)]),_:1},8,["modelValue","options","error"])]),l("div",pt,[r(m,{dense:"",class:"q-mb-md",clearable:"",outlined:"",label:"Job Number",modelValue:e.jobNumber,"onUpdate:modelValue":t[3]||(t[3]=i=>e.jobNumber=i),"option-label":i=>i[11],"display-value":e.jobNumber?`${e.jobNumber[11]}`:"",error:!!e.errors.jobNumber,"error-message":e.errors.jobNumber,fetcher:e.jobNumberFetcher,getter:()=>e.getV3Options.jobNumbers,setter:i=>{e.setV3Options({prop:"jobNumbers",data:i})},filter:(i,u)=>i.filter(d=>d[17].toLowerCase().indexOf(u.toLowerCase())>-1),"bottom-slots":"",showTooltip:!0,tooltipMessage:"This is the job number that hiring costs should be charged to."},null,8,["modelValue","option-label","display-value","error","error-message","fetcher","getter","setter","filter"]),r(m,{dense:"",class:"q-mb-md",clearable:"",outlined:"",label:"Site Contact",modelValue:e.siteContact,"onUpdate:modelValue":t[4]||(t[4]=i=>e.siteContact=i),"option-label":i=>i[17],"display-value":e.siteContact?`${e.siteContact[17]}`:"",error:!!e.errors.siteContact,"error-message":e.errors.siteContact,fetcher:e.siteContactsFetcher,getter:()=>e.getV3Options.siteContacts,setter:i=>{e.setV3Options({prop:"siteContacts",data:i})},filter:(i,u)=>i.filter(d=>d[17].toLowerCase().indexOf(u.toLowerCase())>-1),"bottom-slots":"",showTooltip:!0,tooltipMessage:"This is the person that a new hire should contact when the arrive at the job site."},null,8,["modelValue","option-label","display-value","error","error-message","fetcher","getter","setter","filter"]),r(m,{dense:"",class:"q-mb-md",clearable:"",outlined:"",label:"Meeting Location",modelValue:e.meetingLocation,"onUpdate:modelValue":t[5]||(t[5]=i=>e.meetingLocation=i),"option-label":i=>i[6],"display-value":e.meetingLocation?`${e.meetingLocation[6]}`:"",error:!!e.errors.meetingLocation,"error-message":e.errors.meetingLocation,fetcher:e.meetingLocationsFetcher,getter:()=>e.getV3Options.meetingLocations,setter:i=>{e.setV3Options({prop:"meetingLocations",data:i})},filter:(i,u)=>i.filter(d=>d[6].toLowerCase().indexOf(u.toLowerCase())>-1),"bottom-slots":"",showTooltip:!0,tooltipMessage:"This is the location that the new hire should report to."},null,8,["modelValue","option-label","display-value","error","error-message","fetcher","getter","setter","filter"]),e.getV3Data.project[351]?(f(),N(m,{key:0,dense:"",class:"q-mb-md",clearable:"",outlined:"",label:"Per Diem (optional)",modelValue:e.perDiem,"onUpdate:modelValue":t[6]||(t[6]=i=>e.perDiem=i),"option-label":i=>i[20],"display-value":e.perDiem?`${e.perDiem[20]}`:"",error:!!e.errors.perDiem,"error-message":e.errors.perDiem,fetcher:e.perDiemFetcher,getter:()=>e.getV3Options.perDiem,setter:i=>{e.setV3Options({prop:"perDiem",data:i})},filter:(i,u)=>i.filter(d=>d[20].toLowerCase().indexOf(u.toLowerCase())>-1),"bottom-slots":"",showTooltip:!0,tooltipMessage:"If per diem is available, this is the specification for per diem for all classifications on this request. Add a separate request for any classifications that do not qualify for per diem."},null,8,["modelValue","option-label","display-value","error","error-message","fetcher","getter","setter","filter"])):F("",!0)]),l("div",ht,[r(se,{outlined:"","input-style":"resize: none",maxlength:"2500",type:"textarea",modelValue:e.notes,"onUpdate:modelValue":t[7]||(t[7]=i=>e.notes=i),label:"Notes"},null,8,["modelValue"])])])]),_:1}),r(ee,{align:"right"},{default:c(()=>[r(v,{color:"secondary",label:"Back",onClick:t[8]||(t[8]=i=>e.$emit("changeStep",0))}),r(v,{color:"info",label:"Continue",type:"submit",onClick:e.submit},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["onSubmit"])}var gt=Z(ot,[["render",bt]]);const vt={emits:["removeClassification"],props:{data:Array,matchTable:Boolean},setup(e,{emit:t}){return{columns:[{name:0,label:"Craft",align:"left",field:o=>o.craft[10],format:o=>`${o}`,sortable:!0},{name:1,label:"Classification",align:"left",field:o=>o.classification[18],format:o=>`${o}`,sortable:!0,required:!0},{name:2,label:"Pay Rate",align:"right",field:o=>o.rate,format:o=>`$ ${parseFloat(o).toFixed(2)}`},{name:3,label:"Quantity",align:"right",field:o=>o.qty,format:o=>`${parseFloat(o)}`},{name:4,label:"",align:"center",field:""}]}}},yt={class:"full-width row flex-center text-primary q-gutter-sm q-py-xs"};function qt(e,t,s,o,a,n){return f(),U("div",null,[r(Ne,qe(e.$attrs,{dense:"",title:e.$attrs.title?e.$attrs.title:"Saved Classifications","title-class":e.$attrs.titleClass?e.$attrs.titleClass:(e.$q.screen.gt.sm,"text-primary text-body1"),columns:o.columns,"row-key":m=>m.id,pagination:{rowsPerPage:10},"table-header-class":"bg-dark text-white","no-data-label":"You are required to add at least one classification!","hide-pagination":!0}),ye({"no-data":c(({message:m})=>[l("div",yt,[r(je,{size:"2em",name:"fa-solid fa-person-circle-exclamation"}),l("span",null,$(m),1)])]),_:2},[e.$attrs.hideRemove?void 0:{name:"body-cell-4",fn:c(m=>[r(De,{class:"text-center","auto-width":""},{default:c(()=>[r(v,{flat:"",color:"accent",round:"",dense:"",onClick:i=>e.$emit("removeClassification",m.row),icon:"delete"},null,8,["onClick"])]),_:2},1024)]),key:"0"}]),1040,["title","title-class","columns","row-key"])])}var Te=Z(vt,[["render",qt]]);const wt=oe({emits:["changeStep"],props:{},components:{aSelect:Ve,PayRateField:Xe,ClassificationsTable:Te},setup(e,{emit:t}){const{getV3Data:s,setV3Data:o,getV3Options:a,setV3Options:n}=te(),m=I(()=>s.general?s.general:{}),i=I(()=>s.matches?s.matches:null),u=I(()=>s.request?s.request:null),d=B({craft:B().required().nullable().label("Craft"),classification:B().required().nullable().label("Classification"),rate:$e().required().nullable().label("Rate"),qty:$e().required().nullable().label("Quantity")}),{errors:p,handleSubmit:b,resetForm:q,isSubmitting:g,setFieldError:D}=pe({validationSchema:d}),{value:L}=P("craft"),{value:Q}=P("classification"),{value:z}=P("rate"),{value:K}=P("qty"),x=b(async y=>{console.log(y),console.log(i.value);const X=s.classifications.length+1;if(y.id=X,i.value||u.value){const V=await We({job:y,matches:i.value?i.value:u.value});console.log(V),o({prop:"classifications",data:V,push:!0})}else o({prop:"classifications",data:y,push:!0});q()}),k=async()=>{if(s.project?s.project[3]:s.request?s.request[6]:null){const{data:X}=await O.fetchFromProjectsApp({fields:[ie({type:"projectCrafts",query:`{'7'.EX.'${s.project[3]}'}AND{'6'.EX.'Active'}`})]});return X.sort((ue,C)=>ue[20]>C[20]?1:-1)}else return[]},w=I(()=>{const y=L.value&&L.value.classifications?L.value.classifications:[];return y.length>0?y.sort((X,V)=>X[32]>V[32]?-1:1):[]}),S=y=>{const X=s.classifications.filter(V=>V.id!==y.id);o({prop:"classifications",data:X,push:!1})};return le(Q,(y,X)=>{y&&y.hasFixedRate?z.value=y.fixedRate:z.value&&(z.value=null)}),{submit:x,resetForm:q,errors:p,craft:L,classification:Q,rate:z,qty:K,getV3Data:s,getV3Options:a,setV3Options:n,craftsFetcher:k,classificationOptions:w,removeClassification:S,nextStep:()=>{m.value.restriction&&m.value.restriction.value!=="Open"?t("changeStep",3):u.value?u.value[282]!=="Open"?t("changeStep",1):t("changeStep",2):t("changeStep",4)},request:u}}}),St={class:"row justify-between"},$t={class:"col-12 col-md-6 q-pr-md"},Ct=l("div",{class:"text-body2 text-italic text-weight-bold text-dark"}," Enter the following information about the classification and click Save. Repeat until all classifications you are requesting have been saved. Then click Continue. ",-1),jt={class:"row q-mb-md"},Pt={class:"col-6 q-pr-sm"},It={class:"col-6 q-pl-sm"},Dt={class:"text-caption"},Nt={class:"row"},kt={class:"col-6 q-pr-sm"},Vt={class:"text-caption"},Tt={class:"col-6 q-pl-sm"},Ot={class:"col-12 col-md-6 q-pl-md"};function Rt(e,t,s,o,a,n){const m=E("a-select"),i=E("pay-rate-field"),u=E("classifications-table");return f(),U("div",null,[r(J,{flat:""},{default:c(()=>[r(R,{class:"q-px-none q-pt-none"},{default:c(()=>[l("div",St,[l("div",$t,[r(fe,{onSubmit:me(e.submit,["prevent"])},{default:c(()=>[r(J,null,{default:c(()=>[r(R,null,{default:c(()=>[Ct,l("div",jt,[l("div",Pt,[r(m,{dense:"",class:"q-mt-md",clearable:"",label:"Select Craft",modelValue:e.craft,"onUpdate:modelValue":t[0]||(t[0]=d=>e.craft=d),"option-label":d=>d[10],"display-value":e.craft?`${e.craft[10]}`:"",error:!!e.errors.craft,"error-message":e.errors.craft,fetcher:e.craftsFetcher,getter:()=>e.getV3Options.crafts,setter:d=>{e.setV3Options({prop:"crafts",data:d})},filter:(d,p)=>d.filter(b=>b[10].toLowerCase().indexOf(p.toLowerCase())>-1),"bottom-slots":""},null,8,["modelValue","option-label","display-value","error","error-message","fetcher","getter","setter","filter"])]),l("div",It,[r(ce,{class:"q-mt-md",dense:"",clearable:"","transition-show":"flip-up","transition-hide":"flip-down",label:"Classification",modelValue:e.classification,"onUpdate:modelValue":t[1]||(t[1]=d=>e.classification=d),options:e.classificationOptions,"option-label":d=>d[18],"display-value":e.classification?`${e.classification[18]}`:"",error:!!e.errors.classification,"bottom-slots":"",disable:!e.craft},{error:c(()=>[l("div",Dt,$(e.errors.classification),1)]),_:1},8,["modelValue","options","option-label","display-value","error","disable"])])]),l("div",Nt,[l("div",kt,[r(se,{dense:"",type:"number",label:"Quantity",modelValue:e.qty,"onUpdate:modelValue":t[2]||(t[2]=d=>e.qty=d),modelModifiers:{number:!0},error:!!e.errors.qty,disable:!e.classification,"bottom-slots":""},{error:c(()=>[l("div",Vt,$(e.errors.qty),1)]),_:1},8,["modelValue","error","disable"])]),l("div",Tt,[r(i,{class:"q-mb-md",type:"number",step:"any",dense:"",label:"Hourly Rate",modelValue:e.rate,"onUpdate:modelValue":t[3]||(t[3]=d=>e.rate=d),modelModifiers:{number:!0},prefix:"$",disable:!e.classification||e.classification.hasFixedRate&&!e.$can("manage","rates"),error:!!e.errors.rate,"error-message":e.errors.rate,"bottom-slots":""},null,8,["modelValue","disable","error","error-message"])])])]),_:1}),r(ee,{align:"right"},{default:c(()=>[r(v,{dense:"",color:"accent",label:"Reset",onClick:e.resetForm},null,8,["onClick"]),r(v,{dense:"",color:"primary",label:"Save",type:"submit",onClick:e.submit},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),l("div",Ot,[r(u,{rows:e.getV3Data.classifications,onRemoveClassification:e.removeClassification},null,8,["rows","onRemoveClassification"])])])]),_:1}),r(ee,{class:"q-pb-none",align:"right"},{default:c(()=>[e.request?F("",!0):(f(),N(v,{key:0,color:"secondary",label:"Back",onClick:t[4]||(t[4]=d=>e.$emit("changeStep",1))})),r(v,{color:"info",label:"Continue",disable:e.getV3Data.classifications.length===0,onClick:e.nextStep},null,8,["disable","onClick"])]),_:1})]),_:1})])}var _t=Z(wt,[["render",Rt]]);const At={emits:["removeName","viewEmployee"],props:{data:Array},components:{},setup(e,{emit:t}){const s=[{name:1,label:"Name",align:"left",field:n=>n.firstName,format:(n,m)=>`${n} ${m.lastName}`,sortable:!0},{name:2,label:"Phone",align:"left",field:n=>n.phoneNumber,format:n=>`${a(n)}`,sortable:!0,required:!0},{name:3,label:"Last 4",align:"left",field:n=>n.ssn,format:n=>`${n||"N/A"}`,sortable:!0},{name:4,label:"Classification",align:"left",field:n=>n.job.classification,format:n=>`${n[21]} ${n[18]}`,sortable:!0,required:!0},{name:6,label:"",align:"center",field:""}],o=n=>{t("viewEmployee",n)},a=n=>{const i=(""+n).replace(/\D/g,"").match(/^(\d{3})(\d{3})(\d{4})$/);return i?`(${i[1]}) ${i[2]}-${i[3]}`:null};return{props:e,columns:s,viewEmployee:o,formatPhone:a}}},Ft={class:"full-width row flex-center text-primary q-gutter-sm q-py-xs"};function Et(e,t,s,o,a,n){return f(),U("div",null,[r(Ne,qe(e.$attrs,{dense:"",title:e.$attrs.title?e.$attrs.title:"People","title-class":e.$attrs.titleClass?e.$attrs.titleClass:(e.$q.screen.gt.sm,"text-primary text-body1"),columns:o.columns,rows:o.props.data,"row-key":m=>m.ssn,pagination:{rowsPerPage:10},"table-header-class":"bg-dark text-white","no-data-label":"No People Added","hide-pagination":!0}),ye({"no-data":c(({message:m})=>[l("div",Ft,[r(je,{size:"2em",name:"fa-solid fa-person-circle-exclamation"}),l("span",null,$(m),1)])]),_:2},[e.$attrs.hideRemove?void 0:{name:"body-cell-6",fn:c(m=>[r(De,{class:"text-center","auto-width":""},{default:c(()=>[r(v,{flat:"",color:"accent",round:"",dense:"",onClick:i=>e.$emit("removeName",m.row),icon:"delete_forever"},null,8,["onClick"])]),_:2},1024)]),key:"0"}]),1040,["title","title-class","columns","rows","row-key"])])}var Oe=Z(At,[["render",Et]]);const Lt=oe({emits:["changeStep"],props:{},components:{ClassificationsTable:Te,NamesTable:Oe},setup(e,{emit:t}){const s=ve(),o=Pe(),a=Ie(),{capitalize:n}=Qe,{getUserType:m}=T(),i=te(),{getV3Data:u}=ge(i),d=u.value.project?u.value.project:null,p=u.value.general?u.value.general:null,b=I(()=>u.value.matches?u.value.matches:null),q=I(()=>u.request?u.request:null),g=I(()=>u.value.classifications.filter(w=>w.match)),D=I(()=>u.value.classifications.filter(w=>!w.match)),L=k=>{const w=k.split(" ");let S="";return w.forEach((W,y)=>{S+=y>0?` ${n(W.toLowerCase())}`:n(W.toLowerCase())}),S},Q=I(()=>b.value?q.value?[{label:"Request Number",value:q.value[3]},{label:"Date Submitted",value:h(q.value[1].$d).format("MM/DD/YYYY")},{label:"Hiring Center",value:q.value[103]},{label:"Current Status",value:q.value[14]}]:null:[{label:"Request Number",value:b.value[3]},{label:"Date Submitted",value:h(b.value[1].$d).format("MM/DD/YYYY")},{label:"Hiring Center",value:b.value[103]},{label:"Current Status",value:b.value[14]}]),z=I(()=>{let k;return p?k=[{label:"Project",value:d?d[43]:"N/A"},{label:"Date Needed",value:h(p.dateNeeded).format("MM/DD/YYYY")},{label:"Request Reason",value:p.reason.label},{label:"Request Type",value:p.restriction.value},{label:"Job Number",value:p.jobNumber[11]},{label:"Meeting Location",value:L(p.meetingLocation[6])},{label:"Meeting Location Address",value:p.meetingLocation[7]},{label:"Site Contact",value:L(p.siteContact[17])},{label:"Per Diem",value:p.perDiem?p.perDiem[20]:"N/A"},{label:"Notes",value:p.notes}]:k=[],k});return{project:d,getV3Data:u,details:z,matchDetails:Q,changeStep:()=>{q.value?q.value[282]!=="Open"?t("changeStep",1):t("changeStep",0):p.restriction.value!=="Open"?t("changeStep",3):t("changeStep",2)},submitRequest:async()=>{const k=o.params.project?{name:"project-requests",params:{id:o.params.project}}:m==="Project User"?{name:"requests"}:null;s.loading.show({message:"Submitting Request Now"});try{const{data:w}=await Je({data:u.value});if(s.loading.hide(),s.notify({type:"positive",message:b.value?"Hire Request successfully updated":"Hire Request successfully added"}),k)a.replace({name:"hire-request",params:{id:w[3]}});else try{window.close()}catch{a.replace({name:"hire-request",params:{id:w[3]}})}i.$reset()}catch{s.loading.hide(),s.notify({type:"negative",message:"There was a problem add request"})}},match:b,classWithMatch:g,classNoMatch:D}}}),Mt=l("div",{class:"text-body2 text-italic text-weight-bold text-dark"}," Review the information below. If changes are needed, click Back. If all information is correct, click Submit to complete this request. ",-1),Bt={class:"row"},Qt={class:"col-12 col-md-6 q-pr-md"},Ut=l("div",{class:"text-body1 text-primary text-weight-bold"},"General Information",-1),Yt={class:"row"},zt={class:"col-12 col-md-4"},Ht={class:"text-weight-bold text-caption"},Xt={class:"col-12 col-md-8"},Wt={class:"text-dark text-caption"},Jt={class:"col-12 col-md-6 q-pl-md"},Gt={key:1,class:"row justify-center"},Zt={class:"col-12 col-md-10"},Kt=l("div",{class:"text-primary text-h6 text-weight-bold"},"Matching Request Found",-1),xt=l("div",{class:"text-body2 text-italic"}," The information that you entered on this request matches another request that you submitted recently. ",-1),es=l("div",{style:{"text-decoration":"underline"},class:"text-body2 text-accent text-italic"},"This request will be updated with the below classification and name changes, where applicable.",-1),ts={class:"row q-mb-md"},ss={key:0,class:"col-12 col-md-3 q-pr-sm"},os={class:"row q-mt-md"},as={class:"col-12 col-md-6 q-pr-md"},rs={class:"col-12 col-md-6 q-pl-md"};function ns(e,t,s,o,a,n){const m=E("classifications-table"),i=E("names-table");return f(),U("div",null,[e.match?(f(),U("div",Gt,[l("div",Zt,[r(J,null,{default:c(()=>[r(R,null,{default:c(()=>[Kt,xt,es]),_:1}),r(R,{class:"q-py-none"},{default:c(()=>[l("div",ts,[(f(!0),U(be,null,we(e.matchDetails,(u,d)=>(f(),U(be,{key:d},[u.hide?F("",!0):(f(),U("div",ss,[l("div",{class:Se(["text-weight-bold",e.$q.screen.gt.lg?"text-body2":"text-caption"])},$(u.label),3),l("div",{class:Se(["q-pl-sm text-weight-light",e.$q.screen.gt.lg?"text-body2":"text-caption"])},$(u.value),3)]))],64))),128))]),r(Be),l("div",os,[l("div",as,[e.classWithMatch.length>0?(f(),N(m,{key:0,class:"q-mb-md",matchTable:!0,titleClass:"text-body1 text-accent",title:"Classifications to Update",hideRemove:!0,rows:e.classWithMatch},null,8,["rows"])):F("",!0),e.classNoMatch.length>0?(f(),N(m,{key:1,titleClass:"text-body1 text-dark",title:e.match?"Classifications to Add":"Classifications",hideRemove:!0,rows:e.classNoMatch},null,8,["title","rows"])):F("",!0)]),l("div",rs,[e.getV3Data.names.length>0?(f(),N(i,{key:0,titleClass:"text-body1 text-primary",title:"People to Add",hideRemove:!0,data:e.getV3Data.names},null,8,["data"])):F("",!0)])])]),_:1}),r(ee,{align:"right"},{default:c(()=>[r(v,{color:"secondary",label:"Back",onClick:e.changeStep},null,8,["onClick"]),r(v,{color:"info",label:"Submit",onClick:e.submitRequest},null,8,["onClick"])]),_:1})]),_:1})])])):(f(),N(J,{key:0,flat:""},{default:c(()=>[r(R,{class:"q-pt-none q-px-none"},{default:c(()=>[Mt]),_:1}),r(R,{class:"q-px-none q-pt-none"},{default:c(()=>[l("div",Bt,[l("div",Qt,[r(J,null,{default:c(()=>[r(R,{class:"q-pa-sm"},{default:c(()=>[Ut]),_:1}),(f(!0),U(be,null,we(e.details,(u,d)=>(f(),N(R,{key:d,class:"q-pa-sm"},{default:c(()=>[l("div",Yt,[l("div",zt,[l("div",null,[l("span",Ht,$(u.label),1)])]),l("div",Xt,[l("div",null,[l("span",Wt,$(u.value===""?"N/A":u.value),1)])])])]),_:2},1024))),128))]),_:1})]),l("div",Jt,[e.classNoMatch.length>0?(f(),N(m,{key:0,class:"q-mb-md",titleClass:"text-body1 text-primary text-weight-bold",title:e.match?"Classifications to Add":"Classifications",hideRemove:!0,rows:e.classNoMatch},null,8,["title","rows"])):F("",!0),e.match&&e.classWithMatch.length>0?(f(),N(m,{key:1,matchTable:!0,class:"q-mb-md",titleClass:"text-body1 text-primary text-weight-bold",title:"Classifications to Update",hideRemove:!0,rows:e.classWithMatch},null,8,["rows"])):F("",!0),e.getV3Data.names.length>0?(f(),N(i,{key:2,class:"q-mb-md",titleClass:"text-body1 text-primary text-weight-bold",title:"People",hideRemove:!0,data:e.getV3Data.names},null,8,["data"])):F("",!0),r(ee,{class:"q-pb-none q-pt-lg q-px-none",align:"right"},{default:c(()=>[e.getV3Data.project?(f(),N(v,{key:0,color:"secondary",label:"Back",onClick:e.changeStep},null,8,["onClick"])):F("",!0),e.getV3Data.project?(f(),N(v,{key:1,color:"info",label:"Submit",onClick:e.submitRequest},null,8,["onClick"])):F("",!0)]),_:1})])])]),_:1})]),_:1}))])}var is=Z(Lt,[["render",ns]]);const ls=oe({emits:["changeStep"],props:{},components:{NamesTable:Oe,phoneNumberInput:Ge},setup(e,{emit:t}){const s=Y(10),{getV3Data:o,setV3Data:a,getV3Options:n,setV3Options:m}=te();o.general&&o.general;const i=Y(null),u=I(()=>{const S=new RegExp("^(?!0+$)\\d{"+s.value+"}","g");return B({job:B().required("Classification is required"),firstName:ne().required().label("First Name"),lastName:ne().required().label("Last Name"),phoneNumber:ne().matches(S,{excludeEmptyString:!0,message:"Valid Phone Number Required!"}).required().label("Phone Number"),ssn:ne().matches(/^\d+$/,{excludeEmptyString:!0,message:"Numbers Only!"}).label("Last 4 of SSN")})}),{errors:d,handleSubmit:p,resetForm:b,isSubmitting:q}=pe({validationSchema:u,initialValues:{job:o.classifications.length===1?o.classifications[0]:null}}),{value:g}=P("job"),{value:D}=P("firstName"),{value:L}=P("lastName"),{value:Q}=P("phoneNumber"),{value:z}=P("ssn"),K=p(S=>{console.log(o);const W=o.names.length+1;S.id=W,a({prop:"names",data:S,push:!0}),b()}),x=S=>{const W=o.names.filter(y=>y.id!==S.id);a({prop:"names",data:W,push:!1})},k=S=>{i.value=S},w=S=>{s.value=S};return le(o.names,S=>{console.log(o.names)}),{submit:K,resetForm:b,errors:d,getV3Data:o,job:g,firstName:D,lastName:L,phoneNumber:Q,ssn:z,removeName:x,updateCountry:k,updatePhoneMaxLength:w}}}),cs={class:"row justify-between"},us={class:"col-12 col-md-6 q-pr-md"},ds=l("div",{class:"text-body2 text-italic text-weight-bold text-dark"}," Enter the following information about the people and click Save. Repeat until all people you are requesting have been saved. Then click Continue. You may also skip adding names if you do not have them yet. ",-1),ms={class:"row q-mb-md"},fs={class:"col-6"},ps={class:"text-caption"},hs={class:"row"},bs={class:"col-6 q-pr-sm"},gs={class:"text-caption"},vs={class:"col-6 q-pl-sm"},ys={class:"text-caption"},qs={class:"row"},ws={class:"col-6 q-pr-sm"},Ss={class:"col-6 q-pl-sm"},$s={class:"text-caption"},Cs={class:"col-12 col-md-6 q-pl-md"};function js(e,t,s,o,a,n){const m=E("phone-number-input"),i=E("names-table");return f(),U("div",null,[r(J,{flat:""},{default:c(()=>[r(R,{class:"q-px-none q-pt-none"},{default:c(()=>[l("div",cs,[l("div",us,[r(fe,{onSubmit:me(e.submit,["prevent"])},{default:c(()=>[r(J,null,{default:c(()=>[r(R,null,{default:c(()=>[ds,l("div",ms,[l("div",fs,[r(ce,{class:"q-mt-md",dense:"",clearable:"","transition-show":"flip-up","transition-hide":"flip-down",label:"Classification",modelValue:e.job,"onUpdate:modelValue":t[0]||(t[0]=u=>e.job=u),options:e.getV3Data.classifications,"option-label":u=>`${u.classification[21]} ${u.classification[18]}`,"display-value":e.job?`${e.job.classification[21]} ${e.job.classification[18]}`:"",error:!!e.errors.job,"bottom-slots":""},{error:c(()=>[l("div",ps,$(e.errors.job),1)]),_:1},8,["modelValue","options","option-label","display-value","error"])])]),l("div",hs,[l("div",bs,[r(se,{dense:"",type:"text",label:"First Name",modelValue:e.firstName,"onUpdate:modelValue":t[1]||(t[1]=u=>e.firstName=u),error:!!e.errors.firstName,"bottom-slots":""},{error:c(()=>[l("div",gs,$(e.errors.firstName),1)]),_:1},8,["modelValue","error"])]),l("div",vs,[r(se,{dense:"",type:"text",label:"Last Name",modelValue:e.lastName,"onUpdate:modelValue":t[2]||(t[2]=u=>e.lastName=u),error:!!e.errors.lastName,"bottom-slots":""},{error:c(()=>[l("div",ys,$(e.errors.lastName),1)]),_:1},8,["modelValue","error"])])]),l("div",qs,[l("div",ws,[r(m,{name:"phoneNumber",class:"col-xs-12 col-sm-12",dense:"",modelValue:e.phoneNumber,"onUpdate:modelValue":t[3]||(t[3]=u=>e.phoneNumber=u),label:"Phone Number",tabindex:"3",onMaxLengthChanged:e.updatePhoneMaxLength,error:!!e.errors.phoneNumber,"error-message":e.errors.phoneNumber,onCountryChanged:e.updateCountry},null,8,["modelValue","onMaxLengthChanged","error","error-message","onCountryChanged"])]),l("div",Ss,[r(se,{dense:"",maxlength:"4",label:"SSN Last 4 (Optional)",modelValue:e.ssn,"onUpdate:modelValue":t[4]||(t[4]=u=>e.ssn=u),error:!!e.errors.ssn,"bottom-slots":""},{error:c(()=>[l("div",$s,$(e.errors.ssn),1)]),_:1},8,["modelValue","error"])])])]),_:1}),r(ee,{align:"right"},{default:c(()=>[r(v,{dense:"",color:"accent",label:"Reset",onClick:e.resetForm},null,8,["onClick"]),r(v,{dense:"",color:"primary",label:"Save",type:"submit",onClick:e.submit},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),l("div",Cs,[r(i,{data:e.getV3Data.names,onRemoveName:e.removeName},null,8,["data","onRemoveName"])])])]),_:1}),r(ee,{class:"q-pb-none",align:"right"},{default:c(()=>[r(v,{color:"secondary",label:"Back",onClick:t[5]||(t[5]=u=>e.$emit("changeStep",2))}),r(v,{color:"info",label:e.getV3Data.names.length===0?"Skip Names":"Continue",onClick:t[6]||(t[6]=u=>e.$emit("changeStep",4))},null,8,["label"])]),_:1})]),_:1})])}var Ps=Z(ls,[["render",js]]);const Is=oe({components:{GeneralStep:gt,ClassificationsStep:_t,ReviewStep:is,NamesStep:Ps,projectSelector:Ze,officeSelector:Ke},setup(){const e=ve(),t=Pe(),s=Ie(),o=Y(0),a=Y(null),n=Y(null),m=Y(null),i=Y(null),u=Me(),{setV3Data:d,setV3Options:p,getV3Options:b,resetV3Data:q}=te(),{getSelectedProject:g}=ge(u),{getV3Data:D}=ge(te()),{userData:L,getUserType:Q,userOffices:z,userProjects:K}=T(),{getProjects:x,fetchAllProjects:k}=ke(),{getViewedProjects:w,setViewedProjects:S}=ze(),W=B({projectSelection:B().required().nullable().label("Project")}),{errors:y,handleSubmit:X}=pe({validationSchema:W}),{value:V}=P("projectSelection");g.value&&(V.value=g.value),le(g,()=>{g.value?V.value=g.value:V.value=null});const ue=X(j=>{d({prop:"project",data:j.projectSelection}),H(1)}),C=()=>{e.dialog({title:"Confirm",message:"Are you sure you want to cancel this new request?",persistent:!0,cancel:!0}).onOk(()=>{q(),t.params.project?s.replace({name:"project-general",params:{id:t.params.project}}):s.replace({name:"requests"})})},ae=I(()=>D.value),H=j=>{j===0?(q(),g.value&&(V.value=g.value)):j===2&&G(),o.value=j},G=async()=>{const j=[],M=j.length>0?j.sort((Fe,Ee)=>Fe[1].$d>Ee[1].$d?-1:1):null;M&&d({prop:"matches",data:M[0]})};I(()=>z());const he=I(()=>K()),Re=I(()=>{const j=[];return he.value.forEach(M=>{j.push(M.project)}),x().forEach(M=>{j.push(M)}),[...new Map(j.map(M=>[M[3],M])).values()]}),_e=async()=>{Q==="Project User"&&he.value.length>0&&p({prop:"projects",data:he.value})},Ae=async j=>{if(w(j))d({prop:"project",data:w(j)}),p({prop:"projects",data:[w(j)]}),V.value=w(j),H(1);else{e.loading.show();const{data:M}=await O.fetchFromProjectsApp({fields:[ie({type:"projects",id:j})]});d({prop:"project",data:M}),p({prop:"projects",data:[M]}),S({id:t.params.project,data:M}),V.value=M,H(1),e.loading.hide()}};return t.params.project?Ae(t.params.project):_e(),{step:o,changeStep:H,general:a,classifications:n,names:m,match:i,data:ae,allProjects:Re,formErrors:y,projectSelection:V,submit:ue,cancelNew:C,getV3Data:D,getUserType:Q}}}),Ds=l("div",{class:"text-h6 text-info"},"Add a New Hire Request",-1),Ns=l("div",{class:"text-body2 text-dark text-italic"},"Complete the steps below to submit a new hire request.",-1),ks=l("div",{class:"text-body2 text-italic text-weight-bold text-dark"},"Please select the project that this request is for.",-1),Vs={key:1},Ts=l("br",null,null,-1),Os=[Ts];function Rs(e,t,s,o,a,n){const m=E("officeSelector"),i=E("projectSelector"),u=E("general-step"),d=E("classifications-step"),p=E("names-step"),b=E("review-step");return f(),U("div",null,[r(J,{flat:""},{default:c(()=>[r(R,{class:"q-py-sm"},{default:c(()=>[Ds,Ns]),_:1}),r(R,{class:"q-pa-none"},{default:c(()=>[r(Ue,{flat:"",modelValue:e.step,"onUpdate:modelValue":t[0]||(t[0]=q=>e.step=q),color:"info","active-icon":"build","done-icon":"task_alt","active-color":"accent","done-color":"info",animated:""},{default:c(()=>[r(re,{name:0,title:e.getV3Data.project?e.getV3Data.project[20]:"Select Project",prefix:"1",done:e.step>0},{default:c(()=>[r(fe,{onSubmit:me(e.submit,["prevent"])},{default:c(()=>[r(J,{flat:""},{default:c(()=>[r(R,{class:"q-pt-none q-px-none"},{default:c(()=>[ks]),_:1}),r(R,{class:"q-pa-none"},{default:c(()=>[e.getUserType==="QuickBase User"?(f(),N(m,{key:0,styleSelection:!0,can:"read",style:{"max-width":"500px"}})):F("",!0),e.getUserType==="QuickBase User"?(f(),U("span",Vs,Os)):F("",!0),r(i,{can:"read",styleSelection:!0,error:!!e.formErrors.projectSelection,style:{"max-width":"500px"}},null,8,["error"])]),_:1}),r(ee,{align:"right"},{default:c(()=>[r(v,{color:"secondary",label:"Cancel",onClick:e.cancelNew},null,8,["onClick"]),r(v,{color:"info",label:"Continue",type:"submit",onClick:e.submit},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1},8,["title","done"]),r(re,{name:1,title:"General Information",prefix:"2",done:e.step>1},{default:c(()=>[r(u,{onChangeStep:e.changeStep},null,8,["onChangeStep"])]),_:1},8,["done"]),r(re,{name:2,title:e.step===2?"Add Classifications":e.step>2?"Classifications Added":"Classifications",prefix:"3",done:e.step>2},{default:c(()=>[r(d,{onChangeStep:e.changeStep},null,8,["onChangeStep"])]),_:1},8,["title","done"]),e.data.general&&e.data.general.restriction.value!=="Open"?(f(),N(re,{key:0,name:3,title:e.step===3?"Add Names":"Names",prefix:e.data.general&&e.data.general.restriction.value!=="Open"?"4":"",done:e.step>3},{default:c(()=>[r(p,{onChangeStep:e.changeStep},null,8,["onChangeStep"])]),_:1},8,["title","prefix","done"])):F("",!0),r(re,{name:4,title:"Review",prefix:e.data.general&&e.data.general.restriction.value!=="Open"?"5":"4",done:e.step>4},{default:c(()=>[r(b,{onChangeStep:e.changeStep},null,8,["onChangeStep"])]),_:1},8,["prefix","done"])]),_:1},8,["modelValue"])]),_:1})]),_:1})])}var _s=Z(Is,[["render",Rs]]);const As={name:"New Request",components:{RequestFormStepper:_s},setup(){ve();const{userOffices:e,userProjects:t}=T(),{getProjects:s,fetchAllProjects:o}=ke(),{setNewRequestData:a,getDbData:n,getHumanizedData:m,getHumanizedClassificationData:i}=te(),u=Y(0),d=Y(!1);I(()=>e());const p=I(()=>t()),b=I(()=>{const g=[];return p.value.forEach(D=>{g.push(D.project)}),s().forEach(D=>{g.push(D)}),[...new Map(g.map(D=>[D[3],D])).values()]});function q(){(u.value>1||b.value.length>1)&&(u.value=u.value-1)}return le(b,(g,D)=>{if(g.length===1){u.value=1;const L={6:{value:g[0][3]},92:{value:g[0][12]}},Q={project:g[0]};a({humanized:Q,database:L})}}),le(u,()=>{console.log(m),console.log(i)}),{allProjects:b,step:u,goBack:q,getDbData:n,showCart:d}}},Fs={class:"q-pa-sm"};function Es(e,t,s,o,a,n){const m=E("request-form-stepper");return f(),N(Le,{style:{"max-width":"100vw"}},{default:c(()=>[l("div",Fs,[r(m)])]),_:1})}var qo=Z(As,[["render",Es]]);export{qo as default};
