import{Q as G}from"./QPage.b5c31638.js";import{l as C,r as Q,c as v,_ as S,b5 as I,A as l,aq as p,br as d,B as m,D as o,G as q,ac as _,bW as H,ar as k,H as K,cT as D,bU as N,d as b,F as Y,b4 as V,cS as j,cV as X,bt as Z,bR as ee,bP as R,ax as te,bQ as T,da as le,ab as F,aH as L,bT as ae}from"./index.9dd15430.js";import{q as O}from"./app.727217bc.js";import{u as E}from"./dataStore.c18945c8.js";import{Q as se}from"./QInnerLoading.f0f0848c.js";import{dayjs as y}from"./dayjs.2f8688b0.js";import{u as x}from"./useQuerySaver.d29ff9ee.js";import{E as oe}from"./form-edit-card-section.83a79d32.js";import{Q as ie}from"./QRating.be982d58.js";import{Q as ne}from"./QList.b7324a87.js";import{d as re,f as ue}from"./helpers.14674921.js";import{u as ce}from"./index.cd710c46.js";import{d as de}from"./decode.3998c82c.js";import"./_commonjsHelpers.a26ce4be.js";import"./localForage.eb119360.js";import"./api.4f913c74.js";import"./index.04bc0a32.js";import"./i18n.0b66fc90.js";import"./QSelect.b771c9d2.js";import"./QChip.96daacbb.js";import"./QMenu.c2bc0e92.js";import"./position-engine.c6215dd3.js";import"./selection.a10d025f.js";import"./rtl.b51694b1.js";import"./QForm.685a561c.js";import"./vee-validate.esm.73d552b4.js";import"./array.f318e1cc.js";const me=C({emits:[],props:{item:Object},components:{EditDetailsForm:oe},setup(e,{emit:c}){const r=Q(!1),f=v(()=>{const{permission:s}=e.item.editable&&e.item.config?e.item.config:{action:null,subject:null};return s});return{edit:r,permission:f}}}),pe={key:0,class:"row"},ve={class:"col-12 col-md-4"},fe={class:"col-12 col-md-8"};function ye(e,c,r,f,s,u){const a=I("edit-details-form");return l(),p(D,K(e.$attrs,{class:e.$attrs.class||"q-pa-sm"}),{default:d(()=>[e.edit?(l(),p(a,{key:1,type:e.item.label,config:e.item.config,onCancelEdit:c[1]||(c[1]=t=>e.edit=!1)},null,8,["type","config"])):(l(),m("div",pe,[o("div",ve,[o("div",null,[o("span",{class:q(["text-info",e.$q.screen.gt.lg?"text-body2":"text-caption"])},_(e.item.label),3)])]),o("div",fe,[o("div",null,[o("span",{class:q(["text-weight-light",e.$q.screen.gt.lg?"text-body2":"text-caption"])},_(e.item.value===""?"N/A":e.item.value),3),e.item.editable&&e.$can(e.permission.action,e.permission.subject)?(l(),p(H,{key:0,color:"accent",flat:"",dense:"",round:"",icon:"edit",size:"sm",onClick:c[0]||(c[0]=t=>e.edit=!0)})):k("",!0)])])]))]),_:1},16,["class"])}var z=S(me,[["render",ye]]);const be=C({components:{CardSectionEditable:z},props:{employee:Object},setup(e){const c=N(),r=Q(!0),{getWorkdayData:f,updateViewedEmployees:s,getEmployee:u,getAssignmentsByEmployee:a,setAssignmentsByEmployee:t}=E(),i=v(()=>c.params.id||e.employee[3]),$=v(()=>u(i.value)),n=v(()=>$.value?$.value.currentAssignment?$.value.currentAssignment:a(i.value)?a(i.value):null:null),g=v(()=>{const h=f(i.value);if(h){const{employmentData:W}=h,{positionData:M,workerStatus:P}=W,{jobProfile:B}=M;return[{label:"Position",value:`${M.positionId} ${M.positionTitle}`},{label:"Job Profile",value:`${B.jobProfileId} - ${B.jobProfileName}`},{label:"Hire Date",value:y(P.hireDate).format("MM/DD/YYYY")},{label:"Original Hire Date",value:y(P.originalHireDate).format("MM/DD/YYYY")},{label:"Years Since Last Hire",value:y().diff(P.hireDate,"year",!0).toFixed(2)}]}else return[]}),w=h=>h[145].$d?y(h[145].$d).format("MM/DD/YYYY"):y(h[1].$d).format("MM/DD/YYYY"),A=h=>h[145].$d?y().diff(h[145].$d,"day"):y().diff(h[1].$d,"day"),J=v(()=>n.value&&$.value[79]===7?[{label:"Project",value:n.value[146]},{label:"Current Location",value:n.value[141]},{label:"Job Title",value:n.value[20]},{label:"Current Supervisor",value:n.value[140]===""?"N/A":n.value[140]},{label:"Arrival Date",value:w(n.value)},{label:"Days on Site",value:`${A(n.value)}`}]:[]),U=v(()=>J.value.concat(g.value));return(async()=>{if(!n.value&&$.value&&$.value[577]){const{data:h}=await O.fetchFromHiringApp({fields:[x({type:"rawAssignments",query:"",id:$.value[577]})]});s({id:$.value[3],dataset:"currentAssignment",data:h}),t({id:$.value[3],data:h}),r.value=!1}else r.value=!1})(),{loading:r,details:U}}}),$e=o("div",{class:"text-h6 text-weight-bold"},"Job Details",-1),ge=o("div",{class:"text-body1 text-primary text-italic"},"Employee has a pending release.",-1);function _e(e,c,r,f,s,u){const a=I("card-section-editable");return l(),m("div",null,[b(j,null,{default:d(()=>[b(D,{class:"q-pb-sm"},{default:d(()=>[$e]),_:1}),e.employee[581]?(l(),p(D,{key:0,class:"q-py-sm"},{default:d(()=>[ge]),_:1})):k("",!0),(l(!0),m(Y,null,V(e.details,t=>(l(),m(Y,{key:t},[e.loading?k("",!0):(l(),p(a,{key:0,item:t},null,8,["item"]))],64))),128)),e.loading?(l(),p(D,{key:1,style:{height:"200px"}},{default:d(()=>[b(se,{showing:"",color:"primary",label:"Loading Details"})]),_:1})):k("",!0)]),_:1})])}var he=S(be,[["render",_e]]);const De=C({props:{employee:Object},components:{},setup(e){const{getReleases:c,setReleases:r}=E(),f=t=>t[86].$d?y(t[86].$d).format("MM/DD/YYYY"):y(t[62].$d).format("MM/DD/YYYY"),s=v(()=>c(e.employee[581])),u=v(()=>{let t;return s.value&&s.value[3]?t=[{label:"Project",value:s.value[83]},{label:"Location",value:s.value[84]},{label:"Job Title",value:s.value[82]},{label:"Reason",value:s.value[32]},{label:"Arrival Date",value:f(s.value)},{label:"Last Hire Date",value:y(e.employee[397].$d).format("MM/DD/YYYY")},{label:"Last Day On Site",value:y(s.value[36].$d).format("MM/DD/YYYY")},{label:"Returned Equipment",value:s.value[72]?"Yes":"No"},{label:"Pay Deduct Needed",value:!s.value[72]&&y.duration(y(s.value[36].$d).diff(y(e.employee[397].$d))).asDays()<30?"Yes":"No"},{label:"CAAP Rating",value:s.value[59]&&s.value[59].length>0?s.value[59][0][37]:0,type:"rating"},{label:"Submitted By",value:`${s.value[38][35]} ${s.value[38][37]}`},{label:"Submitted On",value:y(s.value[1].$d).tz(y.tz.guess()).format("MM/DD/YYYY hh:mm a")},{label:"Comments",value:s.value[60],type:"comments"}]:t=[],t});return(async()=>{if(!s.value&&e.employee[581]){const{data:t}=await O.fetchFromHiringApp({fields:[x({type:"releases",query:"",id:e.employee[581]})]},{action:"read",type:"release"});r({id:t[3],data:t})}})(),{releaseDetails:u,release:s,downloadFile:re}}}),ke={class:"row items-center"},we=o("div",{class:"col-12 col-md-7"},[o("div",{class:"text-h6 text-weight-bold"},"Pending Release Details")],-1),Ye={key:0,class:"col-12 col-md-5"},Ie={class:"row"},qe={class:"col-12 col-md-5"},Ae={class:"text-body2"},Ce={class:"col-12 col-md-7"},Se={key:0},Ve={key:1,class:"text-body2 text-weight-light"},Ee={key:1,class:"text-body2 text-weight-light"},Ne={class:"text-body1 text-weight-bold q-mb-xs"},je={class:"text-body2 text-italic text-primary q-pl-md"},Me=o("div",{class:"text-body1 text-weight-bold q-mb-xs"},"Supporting Docs",-1);function Pe(e,c,r,f,s,u){return l(),m("div",null,[b(j,{class:"text-dark"},{default:d(()=>[b(D,{class:"q-pb-sm"},{default:d(()=>[o("div",ke,[we,e.release?(l(),m("div",Ye,[b(X,{align:"right"},{default:d(()=>[b(H,{size:"md",flat:"",dense:"",label:"View Release",color:"info",to:{name:"view-ee-release",params:{id:e.release[25],release:e.release[3]}}},null,8,["to"])]),_:1})])):k("",!0)])]),_:1}),(l(!0),m(Y,null,V(e.releaseDetails,a=>(l(),m(Y,{key:a},[a.type!=="comments"?(l(),p(D,{key:0,class:"q-py-sm"},{default:d(()=>[o("div",Ie,[o("div",qe,[o("div",Ae,_(a.label),1)]),o("div",Ce,[a.type==="rating"?(l(),m("div",Se,[a.value>0?(l(),p(ie,{key:0,modelValue:a.value,"onUpdate:modelValue":t=>a.value=t,max:"5",size:"sm",color:"accent",icon:"star_border","icon-selected":"star","icon-half":"star_half","no-dimming":"",readonly:""},null,8,["modelValue","onUpdate:modelValue"])):(l(),m("div",Ve,"Not Available"))])):(l(),m("div",Ee,_(a.value),1))])])]),_:2},1024)):a.value!==""?(l(),p(D,{key:1},{default:d(()=>[o("div",Ne,_(a.label),1),o("div",je,_(a.value),1)]),_:2},1024)):k("",!0)],64))),128)),e.release&&e.release[70].length>0?(l(),p(D,{key:0},{default:d(()=>[Me,b(ne,null,{default:d(()=>[(l(!0),m(Y,null,V(e.release[70],(a,t)=>Z((l(),p(ee,{key:t,clickable:"",class:"text-body2",onClick:i=>e.downloadFile({tableId:"bsstsai5d",recordId:a[3],fieldId:6,versionNumber:1,name:a[7]})},{default:d(()=>[b(R,null,{default:d(()=>[te(_(t+1)+". "+_(a[7]),1)]),_:2},1024),b(R,{avatar:""},{default:d(()=>[b(T,{color:"info",name:"file_download"})]),_:1})]),_:2},1032,["onClick"])),[[le]])),128))]),_:1})]),_:1})):k("",!0)]),_:1})])}var Qe=S(De,[["render",Pe]]);const Be=C({emits:[],props:{item:Object},components:{},setup(e,{emit:c}){const r=Q(!1),{can:f}=ce(),s=v(()=>{if(e.item.config){const{permission:a}=e.item.config;return a?f(a.action,a.subject):!0}else return!0});return{visible:r,hasPermission:s,toggleVisibility:()=>{r.value?r.value=!1:(r.value=!0,setTimeout(()=>{r.value=!1},5e3))}}}}),Re={key:0},He={key:1};function Te(e,c,r,f,s,u){return l(),m("div",null,[e.item.protected?(l(),m("div",Re,[e.visible?(l(),m("span",{key:0,class:q(["text-weight-light",e.$q.screen.gt.lg?"text-body2":"text-caption"])},_(e.item.value===""?"N/A":e.item.value),3)):(l(),m("span",{key:1,class:q(["text-weight-light",e.$q.screen.gt.lg?"text-body2":"text-caption"])},_(e.item.hiddenValue===""?"N/A":e.item.hiddenValue),3)),e.hasPermission?(l(),p(T,{key:2,class:"cursor-pointer q-ml-sm",color:"accent",name:e.visible?"visibility_off":"visibility",size:"sm",onClick:e.toggleVisibility},null,8,["name","onClick"])):k("",!0)])):(l(),m("div",He,[o("span",{class:q(["text-weight-light",e.$q.screen.gt.lg?"text-body2":"text-caption"])},_(e.item.value===""?"N/A":e.item.value),3)]))])}var Fe=S(Be,[["render",Te]]);const Le=C({props:{employee:Object},components:{CardSectionValue:Fe},setup(e){const c=N(),{getWorkdayData:r,getEmployee:f}=E(),s=({id:n,idType:g})=>g.includes("J&amp;E")?`${n.slice(1,4)} / ${n.slice(-5)}`:n,u=n=>{const g=n.slice(0,3),w=n.slice(3,5),A=n.slice(-4);return`${g}-${w}-${A}`},a=v(()=>c.params.id||e.employee[3]),t=v(()=>f(a.value));v(()=>{const n=r(a.value);if(n){const{personalData:g}=n,{nationalIDData:w}=g.identificationData?g.identificationData:{nationalIDData:null};if(w){const A=w;return{label:A.idType,value:u(A.id),protected:!0,allowView:!0,hiddenValue:`***-**-${A.id.slice(-4)}`,hideIfBlank:!0,config:{permission:{action:"read",subject:"protectedInformation"}}}}else return null}else return null});const i=v(()=>{let n;return t.value?n=[{label:"Workday ID",value:t.value[378],hideIfBlank:!0},{label:"USA-SSN",value:t.value[109].length===9?u(t.value[109]):"",protected:!0,allowView:!0,hiddenValue:"***-**-****",hideIfBlank:!0,config:{permission:{action:"read",subject:"protectedInformation"}}},{label:"CAN-SIN",value:t.value[567]&&t.value[567].length===9?u(t.value[567]):"",protected:!0,allowView:!0,hiddenValue:`***-**-${t.value[567].slice(-4)}`,hideIfBlank:!0,config:{permission:{action:"read",subject:"protectedInformation"}}}]:n=[],n}),$=v(()=>{const n=r(a.value);if(n){const{personalData:g}=n;if(g){const{customIds:w}=g.identificationData?g.identificationData:{customIds:[]};return w}else return[]}else return[]});return{standardIds:i,customIds:$,decodeHTML:de,processCustomID:s}}}),Oe=o("div",{class:"text-h6 text-weight-bold"},"IDs",-1),xe={class:"row"},ze={class:"col-12 col-md-4"},Je={class:"col-12 col-md-8"},Ue={class:"row"},We={class:"col-12 col-md-4"},Ge={class:"col-12 col-md-8"};function Ke(e,c,r,f,s,u){const a=I("card-section-value");return l(),p(j,F(L(e.$attrs)),{default:d(()=>[b(D,{class:"q-pb-sm"},{default:d(()=>[Oe]),_:1}),(l(!0),m(Y,null,V(e.standardIds,(t,i)=>(l(),m(Y,{key:i},[!t.hideIfBlank||t.value!==""?(l(),p(D,{key:0,class:"q-py-sm"},{default:d(()=>[o("div",xe,[o("div",ze,[o("div",{class:q(["text-info",e.$q.screen.gt.lg?"text-body2":"text-caption"])},_(t.label),3)]),o("div",Je,[b(a,{item:t},null,8,["item"])])])]),_:2},1024)):k("",!0)],64))),128)),(l(!0),m(Y,null,V(e.customIds,(t,i)=>(l(),p(D,{key:i,class:"q-py-sm"},{default:d(()=>[o("div",Ue,[o("div",We,[o("div",{class:q(["text-info",e.$q.screen.gt.lg?"text-body2":"text-caption"])},_(e.decodeHTML(t.idType)),3)]),o("div",Ge,[o("div",{class:q(["text-weight-light",e.$q.screen.gt.lg?"text-body2":"text-caption"])},_(e.processCustomID(t)),3)])])]),_:2},1024))),128))]),_:1},16)}var Xe=S(Le,[["render",Ke]]);const Ze=C({components:{CardSectionEditable:z},props:{employee:Object},setup(e){ae();const c=N(),{updateViewedEmployees:r,getEmployee:f}=E(),s=v(()=>c.params.id||e.employee[3]),u=v(()=>f(s.value)),a=i=>{const $=i[20]||"",n=i[21]&&i[21]!==""?` ${i[21]}`:"",g=i[22]&&i[22]!==""?` ${i[22]}`:"",w=i[23]&&i[23]!==""?` ${i[23]}`:"";return`${$}${n}${g}${w}`};return{details:v(()=>{let i;return u.value?i=[{label:"Full Name",value:ue(a(u.value))},{label:"Phone",value:u.value[25]},{label:"Email",value:u.value[26]},{label:"Primary Craft",value:u.value[52]},{label:"Hiring Status",value:u.value[80]},{label:"Employment Status",value:u.value[408]}]:i=[],i})}}}),et=o("div",{class:"text-h6 text-weight-bold"},"Employee Information",-1);function tt(e,c,r,f,s,u){const a=I("card-section-editable");return l(),p(j,F(L(e.$attrs)),{default:d(()=>[b(D,{class:"q-pa-sm"},{default:d(()=>[et]),_:1}),(l(!0),m(Y,null,V(e.details,(t,i)=>(l(),p(a,{key:i,item:t},null,8,["item"]))),128))]),_:1},16)}var lt=S(Ze,[["render",tt]]);const at=C({components:{EmployeeJobDetails:he,PendingReleaseDetails:Qe,EmployeeIdentificationCard:Xe,FullEmployeeCard:lt},setup(){const e=N(),{getEmployee:c}=E();return{employee:v(()=>c(e.params.id))}}}),st={class:"q-pa-sm"},ot={key:0,class:"row"},it={class:"col-12 col-md-6 q-px-sm"},nt={class:"col-12 col-md-6 q-px-sm"};function rt(e,c,r,f,s,u){const a=I("full-employee-card"),t=I("employee-identification-card"),i=I("employee-job-details"),$=I("pending-release-details");return l(),p(G,{style:{"max-width":"100vw"}},{default:d(()=>[o("div",st,[e.employee?(l(),m("div",ot,[o("div",it,[b(a,{employee:e.employee},null,8,["employee"]),b(t,{class:"q-mt-md",employee:e.employee},null,8,["employee"])]),o("div",nt,[e.employee[408]==="Active"&&!e.employee[581]?(l(),p(i,{key:0,employee:e.employee},null,8,["employee"])):k("",!0),e.employee[408]==="Active"&&e.employee[581]?(l(),p($,{key:1,employee:e.employee},null,8,["employee"])):k("",!0)])])):k("",!0)])]),_:1})}var Qt=S(at,[["render",rt]]);export{Qt as default};
