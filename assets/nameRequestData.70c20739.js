import{Q as w}from"./QTd.9de883f6.js";import{l as _,r as k,w as D,_ as C,B as d,C as u,d as r,bt as n,az as v,bY as y,at as p,c as Q,z as T,b7 as A,as as R,E as q,bS as z,ae as I}from"./index.52451644.js";import{Q as B}from"./QTable.55c57da0.js";import{u as N}from"./use-quasar.6cc770ef.js";import{dayjs as b}from"./dayjs.3886e7b6.js";import{Q as V}from"./QSpinnerGears.b7886639.js";import{Q as g}from"./QTooltip.1a821f35.js";import{i as L,q as $}from"./app.4a1e4074.js";import{u as E}from"./useQuerySaver.d29ff9ee.js";import{u as Y}from"./dataStore.328b6498.js";const G=_({emits:["viewEmployee"],props:{data:Object,type:String,query:String},setup(t){const s=N(),{getEmployee:c,setEmployees:m}=Y(),l=k(null),f=k(!0);async function i(){if(t.data[39]&&t.data[39]!==""){if(c(t.data[39]))l.value=c([t.data[39]]);else{const{data:a}=await $.fetchFromHiringApp({fields:[E({type:t.type,query:`{'3'.EX.'${t.data[39]}'}`})]});l.value=a[0],m({id:l.value[3],data:l.value})}f.value=!1}else{const{data:a}=await $.fetchFromHiringApp({fields:[E({type:t.type,query:t.query})]});f.value=!1,a.length>0&&(a.length===1?l.value=a[0]:l.value=a.find(e=>e[24].toLowerCase().includes(t.data.firstName)||e[24].toLowerCase().includes(t.data.lastName)?e:null)),l.value&&($.upsertRecordsXML({to:"bsg4yb4wa",data:[{3:{value:t.data[3]},39:{value:l.value[3]}}],fieldsToReturn:[3]}),m({id:l.value[3],data:l.value}))}}D(l,async a=>{if(a&&a[408]==="Active"&&a[378]&&a[378]!==""&&!a[207]){let e;if(!b(a[573]).isValid()||!b(a[573].$d).isSameOrAfter(b().subtract(2,"day"))){const S={employeeRID:a[3],nationalId:a[566],idType:a[565]},h=await L.updateQuickbaseWorkerInterface(S);h[0].Status!=="N/A"?(e=h[0],l.value[378]=e.workerId,l.value[438]=e.Status):e=null}}});const o=()=>{s.notify({type:"negative",message:"This feature is not ready yet."})};return i(),{record:l,loading:f,viewEmployee:o}}}),P={key:0},X={key:1},F={key:0},H={key:1},M={key:2},j={key:3};function J(t,s,c,m,l,f){return d(),u("div",null,[t.loading?(d(),u("div",P,[r(V,{size:"2em",color:"info"})])):(d(),u("div",X,[t.record&&(t.record[408]===""||t.record[408]==="Terminated")&&t.record[421]?(d(),u("div",F,[r(y,{class:"table-button",size:"xs",color:"positive",label:"Available",onClick:s[0]||(s[0]=i=>t.$emit("viewEmployee",t.record))},{default:n(()=>[r(g,{anchor:"center left",self:"center end",class:"bg-positive"},{default:n(()=>[v("Click to view this employee.")]),_:1})]),_:1})])):p("",!0),t.record&&t.record[408]==="Terminated"&&!t.record[421]?(d(),u("div",H,[r(y,{class:"table-button",size:"xs",color:"negative",label:"Not Eligible",onClick:s[1]||(s[1]=i=>t.$emit("viewEmployee",t.record))},{default:n(()=>[r(g,{anchor:"center left",self:"center end",class:"bg-negative"},{default:n(()=>[v("Click to view this employee.")]),_:1})]),_:1})])):p("",!0),t.record&&t.record[408]==="Active"?(d(),u("div",M,[r(y,{class:"table-button",size:"xs",color:"accent",label:"Active Employee",onClick:s[2]||(s[2]=i=>t.$emit("viewEmployee",t.record))},{default:n(()=>[r(g,{anchor:"center left",self:"center end",class:"bg-accent"},{default:n(()=>[v("Click to view this employee.")]),_:1})]),_:1})])):p("",!0),t.record?p("",!0):(d(),u("div",j,[r(y,{class:"table-button",disable:"",size:"xs",color:"info",label:"Nothing Found"},{default:n(()=>[r(g,{anchor:"center left",self:"center end",class:"bg-info"},{default:n(()=>[v("No employee to view.")]),_:1})]),_:1})]))]))])}var O=C(G,[["render",J],["__scopeId","data-v-201b428a"]]);const W=_({emits:["refreshData","viewEmployee"],props:{requests:Array,status:String,loading:Boolean},components:{GetEmployee:O},setup(t,{emit:s}){const c=N(),{capitalize:m}=T,l=Q(()=>c.screen.gt.sm?[{name:0,label:"",align:"left",field:""},{name:1,label:"Request ID",align:"left",field:e=>e[18],format:e=>`${e}`,sortable:!1,required:!0},{name:2,label:"Created",align:"left",field:e=>e[1],format:e=>`${o(e)}`,sortable:!0},{name:3,label:"Name",align:"left",field:e=>f(e),format:e=>`${e}`,sortable:!0},{name:4,label:"Phone",align:"left",field:e=>e[8],format:e=>`${e}`,sortable:!1,required:!0},{name:7,label:"Job",align:"left",field:e=>e[24],format:e=>`${e}`},{name:5,label:"Status",align:"left",field:e=>i(e),format:e=>`${e}`},{name:6,label:"",align:"center",field:""}]:[{name:0,label:"",align:"left",field:""},{name:1,label:"Request ID",align:"left",field:e=>e[18],format:e=>`${e}`,sortable:!1,required:!0},{name:2,label:"Created",align:"left",field:e=>e[1],format:e=>`${o(e)}`,sortable:!0},{name:3,label:"Name",align:"left",field:e=>f(e),format:e=>`${e}`,sortable:!0},{name:4,label:"Phone",align:"left",field:e=>e[8],format:e=>`${e}`,sortable:!1,required:!0},{name:7,label:"Job",align:"left",field:e=>e[24],format:e=>`${e}`},{name:5,label:"Status",align:"left",field:e=>i(e),format:e=>`${e}`},{name:6,label:"",align:"center",field:""}]);function f(e){return`${m(e[6].toLowerCase())} ${m(e[7].toLowerCase())}`}function i(e){return e.employee[0]===void 0?e[10]:e.employee[0][408]==="Terminated"&&!e.employee[0][421]?"Not Eligible":e.employee[0][552]===""?e[10]:e.employee[0][552]}function o(e){if(e.$d)return b(e.$d).fromNow();if(e.date)return b(e.date,"MM-DD-YYYY").fromNow()}return{columns:l,props:t,viewEmployee:e=>{s("viewEmployee",e)}}}}),K={class:"full-width row flex-center text-primary q-gutter-sm q-py-md"};function U(t,s,c,m,l,f){const i=A("get-employee");return d(),u("div",null,[r(B,{columns:t.columns,rows:t.requests,"row-key":o=>o[3],class:"q-pa-sm",pagination:{rowsPerPage:10},"table-header-class":"bg-dark text-white","no-data-label":"There are no named requests",dense:"",loading:t.loading},{"header-cell-0":n(()=>[r(w,{"auto-width":""})]),"body-cell-0":n(o=>[r(w,{class:"text-center","auto-width":""},{default:n(()=>[r(i,{data:o.row,onViewEmployee:t.viewEmployee,type:"employee",query:`{'27'.EX.'${o.row[29]}'}AND{'551'.EX.'${o.row[16]}'}`},null,8,["data","onViewEmployee","query"])]),_:2},1024)]),"body-cell-6":n(o=>[r(w,{class:"text-center","auto-width":""},{default:n(()=>[!(o.row[31]==="Closed"||o.row[31]==="Cancelled")&&t.$can("create","nameRequests")?(d(),R(y,{key:0,class:"q-pa-none q-ma-none",flat:"",color:"primary",round:"",dense:"",onClick:a=>t.$emit("removeName",o.row),icon:"delete_forever"},null,8,["onClick"])):p("",!0)]),_:2},1024)]),"no-data":n(({message:o})=>[q("div",K,[r(z,{size:"2em",name:"fa-solid fa-person-circle-exclamation"}),q("span",null,I(o),1)])]),"top-right":n(()=>[r(y,{color:"secondary",flat:"","icon-right":"refresh",label:"Refresh",onClick:s[0]||(s[0]=o=>t.$emit("refreshData"))})]),_:1},8,["columns","rows","row-key","loading"])])}var ie=C(W,[["render",U]]);export{ie as N};
