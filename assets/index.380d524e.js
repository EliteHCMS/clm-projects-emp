import{Q as k,b as Q,a as Z}from"./QTabPanels.e8aeaad0.js";import{Q as G}from"./QTabs.ea633e00.js";import{Q as H}from"./QSpace.4e041953.js";import{k as j,bL as E,c as f,_ as R,A as p,B as $,d as r,bi as n,F as S,aY as U,an as h,au as z,ab as T,bI as L,D as w,bO as K,r as _,aZ as g,cw as V,ao as v,cz as D,bM as W,w as x,y as ee}from"./index.d156221a.js";import{Q as te}from"./QToolbar.d810fa94.js";import{Q as oe}from"./QPage.cce46bf2.js";import{Q as N}from"./QSelect.3b2aebcc.js";import{u as F}from"./use-quasar.17bfadd8.js";import{u as C}from"./dataStore.dd90100b.js";import{u as P,q as ae}from"./quickbase.000914fc.js";import{Q as I,a as re}from"./QTable.6601b475.js";import{Q as J}from"./QTr.fbebb94e.js";import{Q as M}from"./QTd.802f2fdb.js";import{dayjs as B}from"./dayjs.42389116.js";import{N as se}from"./nameRequestData.5e7a4909.js";import"./use-panel.167f6dc2.js";import"./touch.60582172.js";import"./selection.03c1209a.js";import"./QResizeObserver.1a77a9e4.js";import"./rtl.cf9bbe47.js";import"./QChip.53326447.js";import"./QItemLabel.71527ca8.js";import"./QMenu.27cad430.js";import"./position-engine.b27ef5cb.js";import"./localForage.5c9cf61e.js";import"./_commonjsHelpers.a26ce4be.js";import"./index.7dbe61ef.js";import"./i18n.6b65d4f8.js";import"./api.8f52ca6d.js";import"./QList.31fef766.js";import"./QMarkupTable.ffd300b6.js";import"./use-fullscreen.c582caf6.js";import"./NameRequestGetEmployee.8c91f169.js";import"./QTooltip.06317ccb.js";import"./dataStore.1eb23ba8.js";import"./workday.f184c164.js";import"./syncEmployeeWithWorkday.a351fad6.js";import"./workdayAPI.a2c3a289.js";const ne=j({emits:["refreshData"],props:{requests:Array,status:String},setup(t,o){const l=F(),u=E(),m=f(()=>l.screen.gt.sm?[{name:1,label:"Created",align:"left",field:e=>e[1].$d,format:e=>`${B(e).fromNow()}`,sortable:!0},{name:2,label:"ID",align:"left",field:e=>e[3],format:e=>`${e}`,sortable:!0,required:!0},{name:3,label:"Type",align:"left",field:e=>e[282],format:e=>`${e===""?"Open":e}`,sortable:!0,required:!0},{name:4,label:"Office",align:"left",field:e=>e[103],format:e=>`${e}`,sortable:!0},{name:5,label:"Job #",align:"left",field:e=>e[27],format:e=>`${e}`,sortable:!0,required:!0},{name:6,label:"# Requested",align:"right",field:e=>d(e),format:e=>`${e}`},{name:7,label:"Offers",align:"right",field:e=>a(e),format:e=>`${e}`,sortable:!0,required:!0},{name:8,label:"Deployed",align:"right",field:e=>e[254],format:e=>`${e}`,sortable:!0,required:!0},{name:9,label:"Balance",align:"right",field:e=>s(e),format:e=>`${e}`,sortable:!0,required:!0}]:[{name:1,label:"Created",align:"left",field:e=>e[1].$d,format:e=>`${B(e).fromNow()}`,sortable:!0},{name:2,label:"ID",align:"left",field:e=>e[3],format:e=>`${e}`,sortable:!0,required:!0},{name:3,label:"Type",align:"left",field:e=>e[282],format:e=>`${e===""?"Open":e}`,sortable:!0,required:!0},{name:4,label:"Office",align:"left",field:e=>e[103],format:e=>`${e}`,sortable:!0},{name:5,label:"Job #",align:"left",field:e=>e[27],format:e=>`${e}`,sortable:!0,required:!0},{name:6,label:"# Requested",align:"right",field:e=>d(e),format:e=>`${e}`},{name:7,label:"Offers",align:"right",field:e=>a(e),format:e=>`${e}`,sortable:!0,required:!0},{name:8,label:"Deployed",align:"right",field:e=>e[254],format:e=>`${e}`,sortable:!0,required:!0},{name:9,label:"Balance",align:"right",field:e=>s(e),format:e=>`${e}`,sortable:!0,required:!0}]);function d(e){return e.classes.reduce((i,c)=>i+c[18],0)}function a(e){return e.offers.filter(i=>i[21]==="Accepted").length}function s(e){const i=d(e),c=a(e);return i-c}function b(e){console.log(e),u.push({name:"hire-request",params:{id:e[3]}})}return{columns:m,props:t,viewRequest:b}}}),le={class:"full-width row flex-center text-primary q-gutter-sm q-py-md"};function ie(t,o,l,u,m,d){return p(),$("div",null,[r(re,{columns:t.columns,rows:t.props.requests,"row-key":a=>a[3],class:"q-pa-sm",pagination:{rowsPerPage:10},"table-header-class":"bg-dark text-white","no-data-label":`There are no ${t.props.status} requests`,dense:""},{header:n(a=>[r(J,{class:"bg-dark text-white",props:a},{default:n(()=>[r(I,{"auto-width":""}),(p(!0),$(S,null,U(a.cols,s=>(p(),h(I,{key:s.name,props:a},{default:n(()=>[z(T(s.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),body:n(a=>[r(J,{props:a},{default:n(()=>[r(M,{"auto-width":""},{default:n(()=>[r(L,{class:"cursor-pointer",size:t.$q.screen.gt.sm?"sm":"xs",color:"info",round:"",dense:"",onClick:s=>t.viewRequest(a.row),name:a.expand?"visibility_off":"visibility"},null,8,["size","onClick","name"])]),_:2},1024),(p(!0),$(S,null,U(a.cols,s=>(p(),h(M,{key:s.name,props:a},{default:n(()=>[z(T(s.value),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),"no-data":n(({message:a})=>[w("div",le,[r(L,{size:"2em",name:"fa-solid fa-person-circle-exclamation"}),w("span",null,T(a),1)])]),"top-right":n(()=>[r(K,{color:"secondary",flat:"","icon-right":"refresh",label:"Refresh",onClick:o[0]||(o[0]=a=>t.$emit("refreshData"))})]),_:1},8,["columns","rows","row-key","no-data-label"])])}var A=R(ne,[["render",ie]]);const ue=j({props:{},components:{RequestDataTable:A},setup(t){const o=F(),l=_(null),{userProjects:u}=P(),{getOpenRequest:m,fetchAllOpenRequest:d}=C(),a=f(()=>l.value?l.value[9]:null),s=f(()=>u()),b=f(()=>m(a.value).sort((i,c)=>i[1].$d<c[1].$d?1:-1));async function e(i){o.loading.show(),await d({refresh:i}),o.loading.hide()}return e(!1),{openRequests:b,projectOptions:s,projectFilter:l,loadData:e}}}),de={class:"row items-center"},pe={key:0,class:"col-12 col-md-4"};function me(t,o,l,u,m,d){const a=g("request-data-table");return p(),$("div",null,[r(D,{flat:""},{default:n(()=>[r(V,null,{default:n(()=>[w("div",de,[t.projectOptions.length>1?(p(),$("div",pe,[r(N,{dense:"",label:"Filter By Project","transition-show":"flip-up","transition-hide":"flip-down",modelValue:t.projectFilter,"onUpdate:modelValue":o[0]||(o[0]=s=>t.projectFilter=s),options:t.projectOptions,"option-value":"9","option-label":"12","display-value":t.projectFilter?t.projectFilter[12]:"","use-chips":""},null,8,["modelValue","options","display-value"])])):v("",!0)])]),_:1})]),_:1}),r(a,{requests:t.openRequests,status:"Open",onRefreshData:o[1]||(o[1]=s=>t.loadData(!0))},null,8,["requests"])])}var ce=R(ue,[["render",me]]);const fe=j({props:{},components:{RequestDataTable:A},setup(t){const o=F(),l=W(),u=_(null),{userProjects:m}=P(),{getPendingRequest:d,fetchAllPendingRequest:a}=C(),s=f(()=>u.value?u.value[9]:null),b=f(()=>m()),e=f(()=>d(s.value).sort((c,O)=>c[1].$d<O[1].$d?1:-1));async function i(c){o.loading.show(),await a({refresh:c}),o.loading.hide()}return x(()=>l.from,c=>{c.name==="new-request"&&(console.log("reloading"),a({refresh:!0}))}),i(!1),{pendingRequests:e,projectOptions:b,projectFilter:u,loadData:i}}}),be={class:"row items-center"},$e={key:0,class:"col-12 col-md-4"};function qe(t,o,l,u,m,d){const a=g("request-data-table");return p(),$("div",null,[r(D,{flat:""},{default:n(()=>[r(V,null,{default:n(()=>[w("div",be,[t.projectOptions.length>1?(p(),$("div",$e,[r(N,{dense:"",label:"Filter By Project","transition-show":"flip-up","transition-hide":"flip-down",modelValue:t.projectFilter,"onUpdate:modelValue":o[0]||(o[0]=s=>t.projectFilter=s),options:t.projectOptions,"option-value":"9","option-label":"12","display-value":t.projectFilter?t.projectFilter[12]:"","use-chips":""},null,8,["modelValue","options","display-value"])])):v("",!0)])]),_:1})]),_:1}),r(a,{requests:t.pendingRequests,status:"Pending",onRefreshData:o[1]||(o[1]=s=>t.loadData(!0))},null,8,["requests"])])}var ge=R(fe,[["render",qe]]);const ve=j({props:{},components:{RequestDataTable:A},setup(t){const o=F(),l=_(null),{userProjects:u}=P(),{getClosedRequest:m,fetchAllClosedRequest:d}=C(),a=f(()=>l.value?l.value[9]:null),s=f(()=>u()),b=f(()=>m(a.value).sort((i,c)=>i[1].$d<c[1].$d?1:-1));async function e(i){o.loading.show(),await d({refresh:i}),o.loading.hide()}return e(),{closedRequests:b,projectOptions:s,projectFilter:l,loadData:e}}}),he={class:"row items-center"},we={key:0,class:"col-12 col-md-4"};function ye(t,o,l,u,m,d){const a=g("request-data-table");return p(),$("div",null,[r(D,{flat:""},{default:n(()=>[r(V,null,{default:n(()=>[w("div",he,[t.projectOptions.length>1?(p(),$("div",we,[r(N,{dense:"",label:"Filter By Project","transition-show":"flip-up","transition-hide":"flip-down",modelValue:t.projectFilter,"onUpdate:modelValue":o[0]||(o[0]=s=>t.projectFilter=s),options:t.projectOptions,"option-value":"9","option-label":"12","display-value":t.projectFilter?t.projectFilter[12]:"","use-chips":""},null,8,["modelValue","options","display-value"])])):v("",!0)])]),_:1})]),_:1}),r(a,{requests:t.closedRequests,status:"Completed",onRefreshData:o[1]||(o[1]=s=>t.loadData(!0))},null,8,["requests"])])}var je=R(ve,[["render",ye]]);const Re=j({props:{},components:{NameRequestDataTable:se},setup(t){const o=F(),{capitalize:l}=ee,u=_(null),{userProjects:m,userData:d}=P(),{getNameRequest:a,fetchAllNameRequest:s,removeData:b}=C(),e=f(()=>u.value?u.value[9]:null),i=f(()=>m()),c=f(()=>a(e.value).sort((q,y)=>q[1].$d<y[1].$d?1:-1));async function O(q){o.loading.show(),await s({refresh:q}),o.loading.hide()}function X(q){return`${l(q[6].toLowerCase())} ${l(q[7].toLowerCase())}`}async function Y(q){o.dialog({title:"Confirm",message:`Are you sure you want to remove ${X(q)} from request# ${q[18]}?`,cancel:!0,persistent:!0}).onOk(async()=>{try{const{data:y}=await ae.upsertRecordsXML({to:"bsg4yb4wa",data:[{3:{value:q[3]},11:{value:!0},12:{value:B().tz("America/Chicago")},13:{value:`${d[35]} ${d[37]}`}}],fieldsToReturn:[15],formatObject:15});b({type:"nameRequest",key:y[0][15][38],item:y[0][15],storageKey:"storageNameRequest"})}catch(y){o.notify({type:"negative",message:"Cannot remove name request"}),console.log(y)}})}return O(),{nameRequests:c,projectOptions:i,projectFilter:u,removeName:Y,loadData:O}}}),_e={class:"row items-center"},Fe={key:0,class:"col-12 col-md-4"};function Oe(t,o,l,u,m,d){const a=g("name-request-data-table");return p(),$("div",null,[r(D,{flat:""},{default:n(()=>[r(V,null,{default:n(()=>[w("div",_e,[t.projectOptions.length>1?(p(),$("div",Fe,[r(N,{dense:"",label:"Filter By Project","transition-show":"flip-up","transition-hide":"flip-down",modelValue:t.projectFilter,"onUpdate:modelValue":o[0]||(o[0]=s=>t.projectFilter=s),options:t.projectOptions,"option-value":"9","option-label":"12","display-value":t.projectFilter?t.projectFilter[12]:"","use-chips":""},null,8,["modelValue","options","display-value"])])):v("",!0)])]),_:1})]),_:1}),r(a,{requests:t.nameRequests,status:"Named",onRemoveName:t.removeName,onRefreshData:o[1]||(o[1]=s=>t.loadData(!0))},null,8,["requests","onRemoveName"])])}var ke=R(Re,[["render",Oe]]);const Qe=j({name:"Requests",components:{OpenTab:ce,PendingTab:ge,CompleteTab:je,NamesTab:ke},setup(){const t=E(),o=_(0);function l(){t.push({name:"new-request"})}return{tab:o,addNewRequest:l}}}),Ve={class:"q-pa-md"};function De(t,o,l,u,m,d){const a=g("open-tab"),s=g("pending-tab"),b=g("names-tab"),e=g("complete-tab");return p(),h(oe,{style:{"max-width":"100vw"}},{default:n(()=>[w("div",Ve,[r(te,{class:"bg-info text-white shadow-2 rounded-borders"},{default:n(()=>[r(G,{modelValue:t.tab,"onUpdate:modelValue":o[0]||(o[0]=i=>t.tab=i),"bg-color":"none","indicator-color":"accent",dense:t.$q.screen.lt.md},{default:n(()=>[r(k,{name:0,label:t.$q.screen.gt.xs?"Open Requests":"Open"},null,8,["label"]),t.$q.screen.gt.sm?(p(),h(k,{key:0,name:1,label:t.$q.screen.gt.xs?"Pending Requests":"Pending"},null,8,["label"])):v("",!0),t.$can("read","nameRequests")?(p(),h(k,{key:1,name:2,label:t.$q.screen.gt.xs?"Named Requests":"Named"},null,8,["label"])):v("",!0),t.$q.screen.gt.sm?(p(),h(k,{key:2,name:3,label:t.$q.screen.gt.xs?"Completed Requests":"Completed"},null,8,["label"])):v("",!0)]),_:1},8,["modelValue","dense"]),r(H),t.$q.screen.gt.sm?(p(),h(K,{key:0,dense:"",color:"accent",icon:"add",label:t.$q.screen.lt.md?"Add New":"Add New Request",onClick:t.addNewRequest},null,8,["label","onClick"])):v("",!0)]),_:1}),r(Z,{modelValue:t.tab,"onUpdate:modelValue":o[1]||(o[1]=i=>t.tab=i),animated:""},{default:n(()=>[r(Q,{name:0},{default:n(()=>[r(a)]),_:1}),r(Q,{name:1},{default:n(()=>[r(s)]),_:1}),r(Q,{name:2},{default:n(()=>[r(b)]),_:1}),r(Q,{name:3},{default:n(()=>[r(e)]),_:1})]),_:1},8,["modelValue"])])]),_:1})}var $t=R(Qe,[["render",De]]);export{$t as default};
