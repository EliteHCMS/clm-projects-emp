import{a4 as H,bU as U,y as B,ap as O,au as K,b3 as X,bq as t,A as Y,aa as Z,aG as ee,a7 as e,B as o,D as oe,ab as w,E as te,r as $,w as C,d as a,cT as se,bN as ae,cU as D,aq as le,b as J,cW as ie,bV as R}from"./index.a03c16e1.js";import{a as g}from"./QSelect.b38e663e.js";import{Q as re}from"./QSpinnerGears.5e74fac3.js";import{Q as ne}from"./QForm.04328203.js";import{Q as de}from"./QPage.521316ed.js";import{a as ce,u as Q}from"./vee-validate.esm.53bf4a95.js";import{a as h}from"./array.164cfe36.js";import{u as ue,c as T,b as pe}from"./app.8e730c48.js";import{u as fe}from"./use-quasar.581262ce.js";import"./QChip.2bf5e9f7.js";import"./QMenu.85d00748.js";import"./position-engine.869e6998.js";import"./selection.a756df5b.js";import"./rtl.b51694b1.js";import"./_commonjsHelpers.a26ce4be.js";import"./dayjs.8e614a0b.js";import"./localForage.8d2e0f2e.js";import"./index.04bc0a32.js";import"./i18n.8ef2ea34.js";const me={__name:"officeSelectorAlt",props:{can:{type:String,default:"read"},twilio:{type:Boolean,default:!1},styleSelection:{type:Boolean,default:!1}},setup(j){const x=j,{can:p,twilio:S,styleSelection:A}=H(x),F=ue(),y=T(),{userOffices:f}=U(F),{setSelectedOffice:v}=y,{getSelectedOffice:m}=U(y);m.value||(f.value(p.value).length>1&&f.value(p.value).forEach(l=>{l[15]===!0&&v(l,!0)}),m.value||v(f.value(p.value)[0],!0));const i=l=>{v(l,!0)};return(l,k)=>(B(),O(g,te({"model-value":e(m),options:e(f)(e(p),e(S))},l.$attrs,{"onUpdate:modelValue":i,label:e(m)?"Office":"Select Office","option-label":"11","option-value":"8",clearable:!1,dense:""}),K({_:2},[X(l.$slots,(q,V)=>({name:V,fn:t(r=>[Y(l.$slots,V,Z(ee(r)))])})),e(A)?{name:"selected-item",fn:t(q=>[o("span",{class:oe(["text-primary",l.$q.screen.gt.sm?"text-h6":""])},w(q.opt[11]),3)]),key:"0"}:void 0]),1040,["model-value","options","label"]))}},be={class:"row justify-center q-pt-sm"},ve={class:"col-12 col-md-8"},_e=o("div",{class:"text-h5 text-dark"},"Post a New Job",-1),he=o("div",{class:"text-primary text-h6 q-mb-sm"},"Job Details",-1),we={class:"row"},ge={class:"col-12 q-pr-md"},Se={class:"row"},ye={class:"col-12 q-pr-md"},qe={class:"text-caption"},Ve={class:"row"},Ce={class:"col-12 q-pr-md"},Je={class:"text-caption"},Qe={class:"row"},xe={class:"col-12 q-pr-md"},Ae={class:"text-caption"},Fe={class:"row"},Pe={class:"col-12 q-pr-md"},Ue={class:"text-caption"},Ye={__name:"newJobPost",setup(j){const x=fe(),{userType:p}=pe(),S=T(),{fetchCrafts:A,fetchLocations:F,fetchAllLocations:y,fetchJobs:f,fetchJobAliases:v}=S,{getCrafts:m,getSelectedOffice:i,getLocations:l,getJobs:k,getJobAliases:q}=U(S);$([]),$([]);const V=h({location:h().nullable().required().label("Location"),craft:h().nullable().required().label("Craft"),job:h().nullable().label("Job"),alias:h().nullable().required().label("Alias")}),{errors:r,handleSubmit:E,handleReset:I,isSubmitting:b}=ce({validationSchema:V}),{value:_}=Q("location"),{value:n,resetField:z}=Q("craft"),{value:d,resetField:G}=Q("job"),{value:P,resetField:M}=Q("alias"),L=c=>{i.value?F({selectedId:i.value[8],refresh:c}):y({can:"read",refresh:c})};i.value&&L(!0),A({refresh:!1}),C(i,()=>{L(!0),I()}),C(_,()=>{z()}),C(n,()=>{G(),n.value&&f({selectedId:n.value.value})}),C(d,()=>{M(),d.value&&v({selectedId:d.value.value})});const W=E(async c=>{try{const s=[{12:{value:i.value[8]},14:{value:c.job[3]},16:{value:c.craft[3]},18:{value:c.alias[3]},33:{value:c.location[3]},47:{value:"now"}}];console.log(s),N()}catch(s){console.log(s),x.notify({position:"top-right",type:"negative",message:"There was a problem submitting Job Post!"})}}),N=()=>{console.log(window.parent,window.opener),window.parent&&window.parent.postMessage("refreshData")};return(c,s)=>(B(),O(de,{style:{"max-width":"100vw","max-height":"100vh"}},{default:t(()=>[o("div",be,[o("div",ve,[a(se,{flat:""},{default:t(()=>[a(ne,{onSubmit:ae(e(W),["prevent"])},{default:t(()=>[a(D,{class:"q-pb-lg"},{default:t(()=>[_e]),_:1}),a(D,{class:"q-pl-lg q-pt-none"},{default:t(()=>[he,o("div",we,[o("div",ge,[e(p)==="QuickBase User"?(B(),O(me,{key:0,can:"read",styleSelection:!1,outlined:"",dense:"",class:"q-mb-md"})):le("",!0)])]),o("div",Se,[o("div",ye,[a(g,{dense:"",outlined:"",label:"Location","transition-show":"flip-up","transition-hide":"flip-down",modelValue:e(_),"onUpdate:modelValue":s[0]||(s[0]=u=>J(_)?_.value=u:null),options:e(l)(e(i)?e(i)[8]:null),"bottom-slots":"",error:!!e(r).location,disable:e(b)||!e(i)},{error:t(()=>[o("div",qe,w(e(r).location),1)]),_:1},8,["modelValue","options","error","disable"])])]),o("div",Ve,[o("div",Ce,[a(g,{dense:"",outlined:"",label:"Craft","transition-show":"flip-up","transition-hide":"flip-down",modelValue:e(n),"onUpdate:modelValue":s[1]||(s[1]=u=>J(n)?n.value=u:null),options:e(m),"bottom-slots":"",error:!!e(r).craft,disable:e(b)||!e(_)},{error:t(()=>[o("div",Je,w(e(r).craft),1)]),_:1},8,["modelValue","options","error","disable"])])]),o("div",Qe,[o("div",xe,[a(g,{dense:"",outlined:"",label:"Job","transition-show":"flip-up","transition-hide":"flip-down",modelValue:e(d),"onUpdate:modelValue":s[2]||(s[2]=u=>J(d)?d.value=u:null),options:e(k)(e(n)?e(n).value:null),"bottom-slots":"",error:!!e(r).job,disable:e(b)||!e(n)},{error:t(()=>[o("div",Ae,w(e(r).job),1)]),_:1},8,["modelValue","options","error","disable"])])]),o("div",Fe,[o("div",Pe,[a(g,{dense:"",outlined:"",label:"Alias","transition-show":"flip-up","transition-hide":"flip-down",modelValue:e(P),"onUpdate:modelValue":s[3]||(s[3]=u=>J(P)?P.value=u:null),options:e(q)(e(d)?e(d).value:null),"bottom-slots":"",error:!!e(r).alias,disable:e(b)||!e(d)},{error:t(()=>[o("div",Ue,w(e(r).alias),1)]),_:1},8,["modelValue","options","error","disable"])])])]),_:1}),a(ie,{class:"q-pl-lg q-py-lg",align:"right"},{default:t(()=>[a(R,{loading:e(b),disable:e(b),color:"primary",label:"Save & Close",type:"submit"},{loading:t(()=>[a(re)]),_:1},8,["loading","disable"]),a(R,{class:"q-mr-lg",color:"secondary",label:"Cancel",onClick:N})]),_:1})]),_:1},8,["onSubmit"])]),_:1})])])]),_:1}))}};export{Ye as default};
