var te=Object.defineProperty,se=Object.defineProperties;var le=Object.getOwnPropertyDescriptors;var K=Object.getOwnPropertySymbols;var re=Object.prototype.hasOwnProperty,oe=Object.prototype.propertyIsEnumerable;var H=(n,r,o)=>r in n?te(n,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[r]=o,E=(n,r)=>{for(var o in r||(r={}))re.call(r,o)&&H(n,o,r[o]);if(K)for(var o of K(r))oe.call(r,o)&&H(n,o,r[o]);return n},W=(n,r)=>se(n,le(r));import{Q as ne}from"./QImg.09c5bdfb.js";import{_ as ue,c4 as ie,r as h,c as R,w as C,aY as me,z as d,am as V,bh as l,a6 as s,A as x,d as a,an as p,C as Q,c2 as _,aa as b,bE as de,bD as pe,cx as U,b as M,bX as j,ar as ce,c6 as X,D as ve,cy as fe,at as B,c3 as ge}from"./index.b1be7a27.js";import{Q as be}from"./QForm.e5141ef7.js";import{Q as ye}from"./QPage.5ae674b9.js";import{u as he}from"./use-quasar.32f188d9.js";import{c as P,u as I}from"./array.e7d3a061.js";import{u as xe}from"./i18n.5effcec9.js";import{c as _e,q as Ne}from"./quickbase.5dabc90e.js";import{p as we}from"./VueTelInput.f43dc7b5.js";import{_ as $e}from"./languageSelector.5f512a9b.js";import{c as ke}from"./carousel.15438e22.js";import"./_commonjsHelpers.dfee5925.js";import"./dayjs.a4eb83b7.js";import"./localForage.44bfdce0.js";import"./index.7dbe61ef.js";import"./api.37dc23fd.js";import"./QSelect.3b1ae8e4.js";import"./QChip.083f5fc2.js";import"./QMenu.afcc94a5.js";import"./position-engine.3b2ab28c.js";import"./selection.ae194bbe.js";import"./rtl.a367ced8.js";import"./use-panel.f292a912.js";import"./touch.52aa58ff.js";import"./use-fullscreen.9f1d00e4.js";const qe={key:0,class:"col-md-7 col-lg-8 col-lx-8"},Ce={class:"col-xs-12 col-sm-12 col-md-5 col-lg-4 col-lx-4 row justify-center items-center"},Ve={key:0,class:"text-dark"},Qe={key:1,class:"text-dark"},Me={key:0,class:"row q-col-gutter-xs"},Pe={class:"text-grey-6",tabindex:"4"},Ie={class:"text-grey-6",tabindex:"5"},Se={class:"row justify-center"},Ee={__name:"forgotPassword",setup(n){const r=he(),o=ie(),{t:N}=xe(),{currentUserType:A}=_e(),c=h(!1),v=h(!1),D=h(10),u=h("username"),i=h("phoneNumber"),y=h(null),Y=R(()=>c.value||i.value==="phoneNumber"?P().email(`${N("validEmailIsRequired")}`).nullable():P().email(`${N("validEmailIsRequired")}`).required()),G=R(()=>{if(v.value||i.value==="email")return P().nullable();{const e=new RegExp("^[0-9]{"+D.value+"}","g");return P().matches(e,{excludeEmptyString:!0,message:`${N("validPhoneIsRequired")}`}).required()}}),{value:w,errorMessage:T,meta:J}=I("firstName"),{value:$,errorMessage:L,meta:O}=I("lastName"),{errorMessage:S,value:f}=I("email",Y),{errorMessage:k,value:g}=I("phone",G);A==="QuickBase User"&&o.push("/"),C(S,e=>{e||f.value===""?v.value=!1:v.value=!0}),C(f,e=>{(!e||e==="")&&(v.value=!1)}),C(k,e=>{e||g.value===""?c.value=!1:c.value=!0}),C(g,e=>{(!e||e==="")&&(c.value=!1)});const Z=e=>{y.value=e},ee=e=>{D.value=e},z=R(()=>!(c.value||v.value)),F=async()=>{const e={userType:A,firstName:w.value,lastName:$.value,email:v.value?f.value:null,phoneNumber:c.value?`+${y.value?y.value.dialCode:"1"}${g.value}`:null},{data:t}=await Ne.resetPassword(e);if(t.length===0)r.notify({position:"top-right",type:"negative",message:`${N("noUserFoundWithInformation")}`});else{const q=t[0][76];o.push({name:"code-confirmation",query:W(E(E({},y.value&&c.value&&{p:`${y.value?y.value.dialCode:"1"}${g.value}`}),v.value&&{e:`${f.value}`}),{rid:q[3],ac:!0,send:!0})})}},ae=e=>{u.value==="username"&&!z.value?F():e.preventDefault()};return(e,t)=>{const q=me("router-link");return d(),V(ye,{class:"window-height window-width row"},{default:l(()=>[s(r).screen.lt.md?p("",!0):(d(),x("div",qe,[a(ke)])),Q("div",Ce,[a(ge,{class:"auth-card",flat:""},{default:l(()=>[a(_,{style:{"padding-left":"30px","padding-right":"30px"}},{default:l(()=>[a(ne,{src:"https://cdn.jsdelivr.net/gh/EliteHCMS/assets@latest/public/logo.svg",fit:"scale-down",class:"auth-logo full-width"})]),_:1}),a(_,{class:"text-center auth-description"},{default:l(()=>[i.value==="email"&&u.value==="username"?(d(),x("p",Ve,b(e.$t("enterEmailSendCode")),1)):p("",!0),i.value==="phoneNumber"&&u.value==="username"?(d(),x("p",Qe,b(e.$t("enterPhoneSendCode")),1)):p("",!0)]),_:1}),a(_,null,{default:l(()=>[a(be,{class:"q-px-sm q-pt-sm",onSubmit:t[7]||(t[7]=de(()=>{},["prevent"])),onKeyup:pe(ae,["enter"])},{default:l(()=>[u.value==="username"?(d(),x("div",Me,[a(U,{class:"col-xs-12 col-sm-6 q-pb-lg",clearable:"",outlined:"",modelValue:s(w),"onUpdate:modelValue":t[0]||(t[0]=m=>M(w)?w.value=m:null),type:"text",autocomplete:"given-name",label:e.$t("firstName"),tabindex:"1",name:"firstName",error:!!(s(T)&&s(J).validated),"error-message":s(T)},{prepend:l(()=>[a(j,{name:"person"})]),_:1},8,["modelValue","label","error","error-message"]),a(U,{class:"col-xs-12 col-sm-6",clearable:"",outlined:"",modelValue:s($),"onUpdate:modelValue":t[1]||(t[1]=m=>M($)?$.value=m:null),type:"text",autocomplete:"family-name",label:e.$t("lastName"),tabindex:"2",name:"lastName",error:!!(s(L)&&s(O).validated),"error-message":s(L)},{prepend:l(()=>[a(j,{name:"person_outline"})]),_:1},8,["modelValue","label","error","error-message"])])):p("",!0),i.value==="email"&&u.value==="username"?(d(),V(U,{key:1,style:{"padding-bottom":"0px"},clearable:"",outlined:"",modelValue:s(f),"onUpdate:modelValue":t[3]||(t[3]=m=>M(f)?f.value=m:null),type:"email",label:e.$t("email"),tabindex:"3",error:!!s(S),"error-message":s(S),readonly:u.value!=="username"},ce({prepend:l(()=>[a(j,{name:"email"})]),_:2},[u.value!=="username"?{name:"append",fn:l(()=>[a(X,{round:"",dense:"",flat:"",icon:"edit",onClick:t[2]||(t[2]=m=>{u.value="username"})})])}:void 0]),1032,["modelValue","label","error","error-message","readonly"])):p("",!0),i.value==="phoneNumber"&&u.value==="username"?(d(),V(we,{key:2,outlined:"",modelValue:s(g),"onUpdate:modelValue":t[4]||(t[4]=m=>M(g)?g.value=m:null),label:e.$t("phoneNumber"),tabindex:"3",onMaxLengthChanged:ee,style:ve(s(k)?"padding-bottom: 20px;":"padding-bottom: 0px;"),error:!!s(k),"error-message":s(k),onCountryChanged:Z},null,8,["modelValue","label","style","error","error-message"])):p("",!0),a(_,{class:"text-right q-pa-none"},{default:l(()=>[i.value==="email"?(d(),x("a",{key:0,onClick:t[5]||(t[5]=m=>i.value="phoneNumber"),class:"text-grey-6",href:"javascript:void(0);",tabindex:"4"},b(e.$t("usePhoneNumber")),1)):p("",!0),i.value==="phoneNumber"?(d(),x("a",{key:1,onClick:t[6]||(t[6]=m=>i.value="email"),class:"text-grey-6",href:"javascript:void(0);",tabindex:"4"},b(e.$t("useEmail")),1)):p("",!0)]),_:1})]),_:1},8,["onKeyup"])]),_:1}),a(fe,{class:"q-px-lg"},{default:l(()=>[u.value==="username"?(d(),V(X,{key:0,unelevated:"",size:"lg",color:"primary",class:"full-width text-white",label:e.$t("resetPassword"),tabindex:"3",disabled:s(z),onClick:F},null,8,["label","disabled"])):p("",!0)]),_:1}),a(_,{class:"text-center q-pa-sm"},{default:l(()=>[Q("p",Pe,[a(q,{to:"/login",class:"text-grey-6"},{default:l(()=>[B(b(e.$t("returnToLogin")),1)]),_:1})]),Q("p",Ie,[B(b(e.$t("needAnAccountQuestion"))+" ",1),a(q,{to:"/register",class:"text-grey-6"},{default:l(()=>[B(b(e.$t("register")),1)]),_:1})])]),_:1}),a(_,{class:"q-pl-lg q-pa-sm"},{default:l(()=>[Q("div",Se,[a($e,{dense:"",borderless:""})])]),_:1})]),_:1})])]),_:1})}}};var na=ue(Ee,[["__scopeId","data-v-a4a59948"]]);export{na as default};
