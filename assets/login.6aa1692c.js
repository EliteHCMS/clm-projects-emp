import{Q as ne}from"./QImg.377710c3.js";import{_ as ie,bU as ue,bT as de,r as u,c as S,w as y,b5 as U,A as d,aq as p,br as o,aQ as L,B as j,d as s,ar as m,D as q,cF as b,ac as P,bO as ce,bN as me,cG as W,av as pe,bW as I,bQ as z,E as ve,cH as fe,ax as K,cE as ge}from"./index.e8fb2253.js";import{Q as he}from"./QForm.bc1b5926.js";import{Q as ye}from"./QPage.d147e8f9.js";import{u as be}from"./use-quasar.0aa2fc3d.js";import{u as D}from"./vee-validate.esm.f9a9192e.js";import{p as we}from"./VueTelInput.e2906d76.js";import{_ as _e}from"./languageSelector.ac25040f.js";import{c as T}from"./array.6a8b7cfb.js";import{c as ke}from"./carousel.1dc054b5.js";import{b as xe,q as Y}from"./app.00bf1e10.js";import{u as Ce}from"./i18n.2814a62c.js";import"./QSelect.c4b0a406.js";import"./QChip.178232ad.js";import"./QMenu.b4300bfa.js";import"./position-engine.d748a9db.js";import"./selection.1f477e95.js";import"./rtl.b51694b1.js";import"./use-panel.0e4ac6ef.js";import"./touch.70a9dd44.js";import"./use-fullscreen.b1caa6d3.js";import"./_commonjsHelpers.a26ce4be.js";import"./dayjs.d1250a8a.js";import"./localForage.8666a90b.js";import"./api.e92e8aaa.js";import"./index.04bc0a32.js";const qe={name:"Login",components:{phoneNumberInput:we,carousel:ke,languageSelector:_e},setup(){const l=be(),n=ue(),w=de(),{locale:e,t:_}=Ce(),{currentUserType:k,currentPageType:V}=xe(),r=u(!1),t=u(!1),x=u(10),i=u(!1),C=u(null),Q=u(!1),J=u("first"),f=u("username"),F=u(null),A=u(null),E=u(!1),M=u(!1);n.query.redirect&&(A.value=n.query.redirect,w.replace({query:{}}));const X=S(()=>r.value?T().email(`${_("validEmailIsRequired")}`).nullable():T().email(`${_("validEmailIsRequired")}`).nullable()),$=S(()=>{if(t.value)return T().nullable();{const a=new RegExp("^[0-9]{"+x.value+"}","g");return T().matches(a,{excludeEmptyString:!0,message:`${_("validPhoneIsRequired")}`}).nullable()}}),ee=S(()=>T().required().matches(/^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d@$!%*#?&]{8,}$/,{excludeEmptyString:!0,message:`${_("passwordRules")}`}).nullable()),{errorMessage:B,value:g}=D("email",X),{errorMessage:R,value:v}=D("phone",$),{errorMessage:O,value:h,validate:ae}=D("password",ee),le=u(!0);y(B,a=>{a||g.value===""?t.value=!1:t.value=!0}),y(g,a=>{!a||a===""?t.value=!1:/^\w+([.-]?\w+)*@\w+([.-]?\w+)*(\.\w{2,3})+$/.test(a)&&!B.value&&(t.value=!0)}),y(R,a=>{a||v.value===""?r.value=!1:r.value=!0}),y(v,a=>{!a||a===""?r.value=!1:a.length===x.value&&!R.value&&(r.value=!0)}),y(O,a=>{a||h.value===""?i.value=!1:i.value=!0}),y(h,a=>{Q.value=!1,!a||a===""?i.value=!1:ae().then(c=>{i.value=c.valid})});const se=a=>{x.value=a},H=S(()=>!(r.value||t.value)),oe=a=>{C.value=a},re=()=>{f.value="username",h.value=null,L(()=>{document.querySelector("#email").focus()})},te=()=>{f.value="username",h.value=null,L(()=>{document.querySelector("#phoneNumber").focus()})},Z=async()=>{M.value=!0;const a={userType:k};r.value?a.phoneNumber=`+${C.value?C.value.dialCode:"1"}${v.value}`:t.value&&(a.email=g.value);try{const c=await Y.checkIfUserExist(a);M.value=!1,c?(f.value="password",L(()=>{document.querySelector("#password").focus()})):k==="Candidate"?w.push({name:"register",params:{...r.value&&{phoneTemp:v.value},...t.value&&{emailTemp:a.email}}}):l.dialog({title:"Alert",message:r.value?"That phone number does not exist. Try again.":"That email does not exist. Try again."}).onOk(()=>{v.value="",r.value=!1,g.value="",t.value=!1})}catch(c){M.value=!1,console.log(c)}},G=async()=>{E.value=!0,clearTimeout(F.value);const a={password:h.value,userType:k};r.value?a.phoneNumber=`+${C.value?C.value.dialCode:"1"}${v.value}`:t.value&&(a.email=g.value);try{const c=await Y.login(a);E.value=!1,c&&(A.value?w.push(A.value):w.push({path:"/"}))}catch(c){E.value=!1,F.value=setTimeout(function(){Q.value=!1},7e3);const{response:N}=c;N&&N.data.errtext&&N.data.errdetail?l.notify({type:"negative",message:N.data.errdetail,timeout:7e3,position:l.screen.lt.md?"top":"top-right"}):(console.log(c),l.notify({type:"negative",message:"An error occurred, please try again later",timeout:7e3,position:l.screen.lt.md?"top":"top-right"}))}};return{email:g,phone:v,password:h,isPwd:le,validPhone:r,validEmail:t,step:f,validPassword:i,invalidLogin:Q,continueProgress:M,loginProgress:E,passwordMessage:O,phoneMessage:R,emailMessage:B,userNameInvalid:H,updatePhoneMaxLength:se,continueAction:Z,editUserNameEmail:re,editUserNamePhoneNumber:te,slide:J,login:G,updateCountry:oe,onSubmit:a=>{f.value==="username"&&!H.value?Z():f.value==="password"&&!(!i.value||Q.value)?G():a.preventDefault()},locale:e,currentUserType:k,currentPageType:V}}},Pe={key:0,class:"col-md-7 col-lg-8 col-lx-8"},Te={class:"col-xs-12 col-sm-12 col-md-5 col-lg-4 col-lx-4 row justify-center items-center"},Qe={class:"text-dark"},Ee={key:1,class:"divider"},Me={class:"divider-text"},Ne={key:0,class:"text-grey-6",tabindex:"4"},Se={class:"row justify-center"},Ue={class:"row justify-center"};function Ie(l,n,w,e,_,k){const V=U("carousel"),r=U("phone-number-input"),t=U("router-link"),x=U("languageSelector");return d(),p(ye,{class:"window-height window-width row"},{default:o(()=>[l.$q.screen.lt.md?m("",!0):(d(),j("div",Pe,[s(V)])),q("div",Te,[s(ge,{class:"auth-card",flat:""},{default:o(()=>[s(b,{style:{"padding-left":"30px","padding-right":"30px"}},{default:o(()=>[s(ne,{src:"https://cdn.jsdelivr.net/gh/EliteHCMS/assets@latest/public/logo.svg",fit:"scale-down",class:"auth-logo full-width"})]),_:1}),s(b,{class:"text-center auth-description"},{default:o(()=>[q("p",Qe,P(l.$t("pleaseSignInToYourAccount")),1)]),_:1}),s(b,null,{default:o(()=>[s(he,{class:"q-px-sm q-pt-sm",onSubmit:n[4]||(n[4]=ce(()=>{},["prevent"])),onKeyup:me(e.onSubmit,["enter"])},{default:o(()=>[!e.validEmail&&!e.validPhone||e.validEmail?(d(),p(W,{key:0,for:"email",style:{"padding-bottom":"0px"},autocomplete:"username",clearable:"",outlined:"",modelValue:e.email,"onUpdate:modelValue":n[0]||(n[0]=i=>e.email=i),type:"email",label:l.$t("email"),tabindex:"1",error:!!e.emailMessage,"error-message":e.emailMessage,readonly:e.step!=="username"},pe({prepend:o(()=>[s(z,{name:"email"})]),_:2},[e.step!=="username"?{name:"append",fn:o(()=>[s(I,{round:"",dense:"",flat:"",icon:"edit",onClick:e.editUserNameEmail},null,8,["onClick"])]),key:"0"}:void 0]),1032,["modelValue","label","error","error-message","readonly"])):m("",!0),!e.validEmail&&!e.validPhone&&e.currentUserType!=="QuickBase User"?(d(),j("div",Ee,[q("div",Me,P(l.$t("or")),1)])):m("",!0),(!e.validEmail&&!e.validPhone||e.validPhone)&&e.currentUserType!=="QuickBase User"?(d(),p(r,{key:2,outlined:"",for:"phoneNumber",modelValue:e.phone,"onUpdate:modelValue":n[1]||(n[1]=i=>e.phone=i),label:l.$t("phoneNumber"),tabindex:"1",autocomplete:"username",onMaxLengthChanged:e.updatePhoneMaxLength,style:ve(e.phoneMessage?"padding-bottom: 20px;":"padding-bottom: 0px;"),error:!!e.phoneMessage,"error-message":e.phoneMessage,readonly:e.step!=="username",editIcon:e.step!=="username",onEditClicked:e.editUserNamePhoneNumber,onCountryChanged:e.updateCountry},null,8,["modelValue","label","onMaxLengthChanged","style","error","error-message","readonly","editIcon","onEditClicked","onCountryChanged"])):m("",!0),e.step==="password"?(d(),p(W,{key:3,for:"password",class:"q-mt-lg",outlined:"",modelValue:e.password,"onUpdate:modelValue":n[3]||(n[3]=i=>e.password=i),type:e.isPwd?"password":"text",label:l.$t("password"),autocomplete:"current-password",tabindex:"2",error:!!e.passwordMessage,"error-message":e.passwordMessage},{append:o(()=>[s(z,{name:e.isPwd?"visibility_off":"visibility",class:"cursor-pointer",onClick:n[2]||(n[2]=i=>e.isPwd=!e.isPwd)},null,8,["name"])]),prepend:o(()=>[s(z,{name:"lock"})]),_:1},8,["modelValue","type","label","error","error-message"])):m("",!0)]),_:1},8,["onKeyup"])]),_:1}),s(fe,{class:"q-px-lg"},{default:o(()=>[e.step==="username"?(d(),p(I,{key:0,loading:e.continueProgress,unelevated:"",size:"lg",color:"primary",class:"full-width text-white",label:l.$t("continue"),tabindex:"3",disabled:e.userNameInvalid,onClick:e.continueAction},null,8,["loading","label","disabled","onClick"])):m("",!0),e.step==="password"?(d(),p(I,{key:1,loading:e.loginProgress,unelevated:"",size:"lg",color:"primary",class:"full-width text-white",label:l.$t("login"),tabindex:"3",disabled:!e.validPassword||e.invalidLogin,onClick:e.login},null,8,["loading","label","disabled","onClick"])):m("",!0)]),_:1}),s(b,{class:"text-center q-pa-sm"},{default:o(()=>[e.currentUserType==="Candidate"?(d(),j("p",Ne,[K(P(l.$t("needAnAccountQuestion"))+" ",1),s(t,{to:"/register",class:"text-grey-6"},{default:o(()=>[K(P(l.$t("register")),1)]),_:1})])):m("",!0),e.currentUserType!=="QuickBase User"?(d(),p(t,{key:1,to:"/forgot-password",class:"text-grey-6"},{default:o(()=>[K(P(l.$t("forgotPasswordQuestion")),1)]),_:1})):m("",!0)]),_:1}),s(b,{class:"q-pl-lg q-pa-sm"},{default:o(()=>[q("div",Se,[s(x,{dense:"",borderless:""})])]),_:1}),e.currentPageType==="Candidate Kiosk"?(d(),p(b,{key:0,class:"q-pl-lg q-pa-sm"},{default:o(()=>[q("div",Ue,[s(I,{label:"Bookmarks",color:"primary",size:"md",class:"text-white q-mt-xl",to:{name:"bookmarks"}})])]),_:1})):m("",!0)]),_:1})])]),_:1})}var ia=ie(qe,[["render",Ie],["__scopeId","data-v-6f3ba52c"]]);export{ia as default};
