import{u as p,q as n}from"./app.0d6b5a44.js";import{dayjs as f}from"./dayjs.3e9de836.js";import{u as T}from"./dataStore.c4565561.js";import{u as L}from"./dataStore.7f5d81df.js";import{k as M}from"./index.a8594182.js";const P=async({employee:t,assignment:e,effectiveNow:c,values:a,attachments:l,ratings:o,supervisor:s})=>{const{userData:i,getUserType:y}=p(),u=i;u.access&&delete u.access,u.permissions&&delete u.permissions;const R=[{12:{value:a.recommendation},25:{value:t[3]},28:{value:e[3]},30:{value:a.selection[10]},35:{value:e[142]},36:{value:a.effective},123:{value:a.lastDay},124:{value:u[3]},38:{value:JSON.stringify(u)},39:{value:y!=="QuickBase User"},60:{value:o.comments?o.comments:""},72:{value:a.equipment.value}}];if(c){const{ee:m,assign:r}=await S({assignment:e,supervisor:s}),{data:v}=await n.upsertRecordsXML({to:"bp3ga39ut",data:R,fieldsToReturn:[37],formatObject:37},{action:"create",type:"release"}),{release:d}=await O({release:v[0][37][3],employee:v[0][37][25],ratings:o,user:u,supervisor:s});if(l.length>0){const{docs:g}=await j({release:d,attachments:l,user:u});return d[70]=g.map(w=>w[12]),{release:d,employee:m,assignment:r,attachments:g}}else return{release:d,employee:m,assignment:r,attachments:[]}}else{const{data:m}=await n.upsertRecordsXML({to:"bp3ga39ut",data:R,fieldsToReturn:[37],formatObject:37},{action:"create",type:"release"});s&&X({assignment:e,supervisor:s});const{release:r}=await O({release:m[0][37][3],employee:m[0][37][25],ratings:o,user:u,supervisor:s});if(l.length>0){const{docs:v}=await j({release:r,attachments:l,user:u});return r[70]=v.map(d=>d[12]),{release:r,employee:t,assignment:e,attachments:v}}else return{release:r,employee:t,assignment:e,attachments:[]}}},O=async({release:t,employee:e,ratings:c,user:a,supervisor:l})=>{const o={6:{value:c.attendance},8:{value:c.attitude},10:{value:c.capability},12:{value:c.promotable},14:{value:c.comments?c.comments:""},16:{value:e},34:{value:t},36:{value:JSON.stringify(a)}};l&&Object.assign(o,{42:{value:l[18]}});const{data:s}=await n.upsertRecordsXML({to:"bqzkbcxup",data:[o],fieldsToReturn:[35],formatObject:35});return{release:s[0][35]}},j=async({release:t,attachments:e,user:c})=>{const a=[];e.forEach(o=>{Object.assign(o,{8:{value:JSON.stringify(c)},9:{value:t[3]},10:{value:t[25]}}),a.push(o)});const{data:l}=await n.upsertRecordsXML({to:"bsstsai5d",data:a,fieldsToReturn:[12],formatObject:12});return{docs:l}},S=async({assignment:t,supervisor:e,id:c})=>{const{removeData:a}=T(),{removeFromRoster:l}=L(),o={3:{value:c||t[3]},21:{value:"Complete"},22:{value:f()},165:{value:"Inactive"}};e&&e[3]&&Object.assign(o,{133:{value:e[3]?e[3]:""}});const{data:s}=await n.upsertRecordsXML({to:"bp3gazpqj",data:[o],fieldsToReturn:[110],formatObject:110});return l({id:s[0][110][74],data:s[0]}),a({type:"assignments",key:s[0][110][74],item:s[0][110],storageKey:M.storageAssignments}),{ee:await b({3:{value:s[0][110][18]},79:{value:19}}),assign:s[0][110]}},b=async t=>{const{data:e}=await n.upsertRecordsXML({to:"bp3gb7ng2",data:[t],fieldsToReturn:[549],formatObject:549});return e[0][549]},X=async({assignment:t,supervisor:e})=>{n.upsertRecordsXML({to:"bp3gazpqj",data:[{3:{value:t[3]},133:{value:e[3]?e[3]:""}}],fieldsToReturn:[110],formatObject:110})},z=async({release:t,disp:e})=>{const{userData:c}=p(),a=c;a.access&&delete a.access,a.permissions&&delete a.permissions;const l={3:{value:t[3]},42:{value:e.value==="Terminate"?"Reviewed":"Complete"},43:{value:e.value},73:{value:e.value==="Terminate"?"Pending":"Cancelled"},75:{value:JSON.stringify(a)},125:{value:a[3]},77:{value:f()}},o=e.value==="Terminate"?19:15,s=await b({3:{value:t[25]},79:{value:o},16:{value:t[35]}}),{data:i}=await n.upsertRecordsXML({to:"bp3ga39ut",data:[l],fieldsToReturn:[37],formatObject:37},{action:"update",type:"release"});return{release:i[0][37],employee:s}},C=async({release:t,fid:e,entryMoment:c,workdayData:a})=>{const{userData:l}=p(),o=e||37,s=l;s.access&&delete s.access,s.permissions&&delete s.permissions;const i=[{3:{value:t[3]},42:{value:"Complete"},73:{value:"Processed"},76:{value:JSON.stringify(s)},127:{value:s[3]},78:{value:f(c)||f()},106:{value:a?JSON.stringify(a):""}}];b({3:{value:t[25]},79:{value:""},122:{value:""}});const{data:y}=await n.upsertRecordsXML({to:"bp3ga39ut",data:i,fieldsToReturn:[o],formatObject:o},{action:"update",type:"release"});return{data:y[0][o]}},k=async({release:t,disp:e})=>{const{userData:c}=p(),a=c;a.access&&delete a.access,a.permissions&&delete a.permissions;const l={3:{value:t[3]},42:{value:"Rescinded"},43:{value:"Rescinded"},73:{value:"Not Processed"},75:{value:JSON.stringify(a)},77:{value:f()}},o={3:{value:t.assignment[3]},21:{value:"In Process"},22:{value:""},165:{value:"Active"},112:{value:!1}};await n.upsertRecordsXML({to:"bp3gazpqj",data:[o],fieldsToReturn:[110],formatObject:110});const s=await b({3:{value:t[25]},79:{value:7},16:{value:t[35]}}),{data:i}=await n.upsertRecordsXML({to:"bp3ga39ut",data:[l],fieldsToReturn:[37],formatObject:37},{action:"update",type:"release"});return{release:i[0][37],employee:s}};export{S as a,P as b,z as f,k as r,j as s,C as t};
