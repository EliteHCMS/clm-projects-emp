import{l as z,c as _,_ as j,A as f,an as h,bi as n,d as o,cw as Q,D as r,au as q,ab as u,bK as U,cz as V,r as L,y as J,aZ as E,B as P,bI as w,bO as I,ao as T,F as A,aY as N,G as F}from"./index.8856b4a9.js";import{Q as G}from"./QInnerLoading.68b35a5a.js";import{Q as S,a as K}from"./QTable.9f12789c.js";import{Q as B}from"./QTr.70fb5497.js";import{Q as M}from"./QTd.1bcc7d93.js";import{u as R}from"./use-quasar.5082239b.js";import{e as W}from"./export-file.751205c9.js";import{dayjs as $}from"./dayjs.da6fbf87.js";import{b as Z,u as H}from"./quickbase.ce7d8f68.js";const X=z({name:"Pipeline Summary",components:{},props:{pipeline:Array},setup(t,y){const m=_(()=>t.pipeline.filter(l=>l.type==="In Process"||l.type==="Dispatch")),i=_(()=>t.pipeline.filter(l=>l.type==="Deployed"&&l[20]==="In Process")),b=_(()=>m.value.length+i.value.length);return{props:t,inProcess:m,deployed:i,total:b}}}),ee=r("div",{class:"text-body1 text-primary"},"Summary",-1),te={class:"text-body2"},se=r("span",{class:"q-mr-md"},"In Process:",-1),ae=r("span",null,null,-1),re={class:"text-body2"},ne=r("span",{class:"q-mr-md"},"Deployed:",-1),oe={class:"text-body2"},le=r("span",{class:"q-mr-md"},"Total:",-1);function ie(t,y,m,i,b,g){return f(),h(V,null,{default:n(()=>[o(Q,{class:"q-pb-xs"},{default:n(()=>[ee]),_:1}),o(Q,{class:"text-right q-pt-xs"},{default:n(()=>[r("div",te,[se,q(u(t.inProcess.length),1),ae]),r("div",re,[ne,r("span",null,u(t.deployed.length),1)]),o(U,{color:"primary",class:"q-my-sm"}),r("div",oe,[le,r("span",null,u(t.total),1)])]),_:1})]),_:1})}var de=j(X,[["render",ie]]);const{openWindow:pe}=Z(),fe=z({name:"Pipeline Table",components:{PipelineSummary:de},props:{rows:Array,selected:Array},setup(t,y){const m=R(),{capitalize:i}=J,b=L(!1),{getUserType:g}=H(),l=_(()=>m.screen.gt.sm?[{name:1,label:"Name",align:"left",field:e=>s(e.employee),format:e=>`${e}`,sortable:!0},{name:8,label:"Phone #",align:"left",field:e=>e.employee[25],format:e=>`${e}`,sortable:!1},{name:7,label:"Status",align:"left",field:e=>d(e),format:e=>`${e}`,sortable:!0,sortOrder:"ad"},{name:2,label:"Offer Date",align:"left",field:e=>Y(e),format:e=>`${$(e).format("MM/DD/YYYY")}`,sortable:!0},{name:4,label:"Classification",align:"left",field:e=>k(e),format:e=>`${!e||e===""?"Not Assigned":e}`,sortable:!0},{name:5,label:"Job #",align:"left",field:e=>v(e),format:e=>`${e===""||!e?"Not Assigned":e}`,sortable:!0},{name:6,label:"Arrival Date",align:"left",field:e=>x(e),format:e=>`${e?$(e).format("MM/DD/YYYY"):"TBD"}`,sortable:!0}]:[{name:1,label:"Name",align:"left",field:e=>s(e.employee),format:e=>`${e}`,sortable:!0},{name:8,label:"Phone #",align:"left",field:e=>e.employee[25],format:e=>`${e}`,sortable:!1},{name:7,label:"Status",align:"left",field:e=>d(e),format:e=>`${e}`,sortable:!0,sortOrder:"ad"},{name:2,label:"Offer Date",align:"left",field:e=>Y(e),format:e=>`${$(e).format("MM/DD/YYYY")}`,sortable:!0},{name:4,label:"Classification",align:"left",field:e=>k(e),format:e=>`${!e||e===""?"Not Assigned":e}`,sortable:!0},{name:5,label:"Job #",align:"left",field:e=>v(e),format:e=>`${e===""||!e?"Not Assigned":e}`,sortable:!0},{name:6,label:"Arrival Date",align:"left",field:e=>x(e),format:e=>`${e?$(e).format("MM/DD/YYYY"):"TBD"}`,sortable:!0}]),s=e=>{const c=e[20]!==""?i(e[20].toLowerCase().trim()):"",D=e[22]!==""?i(e[22].toLowerCase().trim()):"",a=e[21]!==""?` ${i(e[21].toLowerCase().trim())}`:"",p=e[23]!==""?` ${i(e[23])}`:"";return`${D}${p}, ${c}${a}`};function d(e){if(e.type==="In Process")return"In Process";if(e.type==="Dispatch")return"In Process";if(e.type==="Deployed")return"Deployed"}function Y(e){if(e.type==="In Process")return e[197].$d;if(e.type==="Dispatch")return e[165].$d;if(e.type==="Deployed")return e[144].$d}function k(e){if(e.type==="In Process")return e[106];if(e.type==="Dispatch")return e[45];if(e.type==="Deployed")return e[45]}function v(e){if(e.type==="In Process")return e[44];if(e.type==="Dispatch")return e[63];if(e.type==="Deployed")return e[85]}function x(e){if(e.type==="In Process")return null;if(e.type==="Dispatch")return null;if(e.type==="Deployed")return e[33].$d}const C=(e,c,D)=>{let a=c!==void 0?c(e,D):e;return a=a==null?"":String(a),a=a.split('"').join('""'),`"${a}"`};function O(){const e=t.rows&&t.rows.value?t.rows.value:t.rows,c=[l.value.map(a=>C(a.label))].concat(e.map(a=>l.value.map(p=>C(typeof p.field=="function"?p.field(a):a[p.field===void 0?p.name:p.field],p.format,a)).join(","))).join(`\r
`);W(`${$().format("MM.DD.YYYY")} Project-Pipeline-Export.csv`,c,"text/csv")!==!0&&m.notify({message:"Browser denied file download...",color:"negative",icon:"warning"})}return{columns:l,props:t,loading:b,exportPipeline:O,viewProfile:e=>{pe(null,{url:`https://elitehcms.quickbase.com/db/bpzpy6n3x?a=dbpage&pageID=2&ee=${e[16]}`,name:"View Profile"})},getUserType:g}}}),me={class:"q-px-sm"},ce={class:"row"},ue={class:"col-12 col-md-10 q-px-xs"},ye={class:"full-width row flex-center text-primary q-gutter-sm q-py-md"};function be(t,y,m,i,b,g){const l=E("pipeline-summary");return f(),P("div",me,[r("div",ce,[r("div",ue,[o(K,{dense:"",columns:t.columns,rows:t.props.rows,"row-key":s=>s[3],class:"q-pa-sm",pagination:{rowsPerPage:t.$q.screen.gt.sm?25:100},separator:"vertical","table-header-class":"bg-dark text-white","no-data-label":"There is no one in the pipeline",loading:t.loading,grid:t.$q.screen.lt.md},{"no-data":n(({message:s})=>[r("div",ye,[o(w,{size:"2em",name:"fa-solid fa-person-circle-exclamation"}),r("span",null,u(s),1)])]),"top-right":n(()=>[o(I,{color:"secondary",flat:"","icon-right":"refresh",label:"Refresh",onClick:y[0]||(y[0]=s=>t.$emit("refresh"))}),o(I,{dense:t.$q.screen.lt.md,color:"primary",label:"Download",onClick:t.exportPipeline,disable:t.props.rows.length<1},null,8,["dense","onClick","disable"])]),loading:n(()=>[o(G,{showing:"",color:"primary"})]),header:n(s=>[o(B,{class:"bg-dark text-white",props:s},{default:n(()=>[t.getUserType==="QuickBase User"?(f(),h(S,{key:0,"auto-width":""})):T("",!0),(f(!0),P(A,null,N(s.cols,d=>(f(),h(S,{key:d.name,props:s},{default:n(()=>[q(u(d.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),body:n(s=>[o(B,{props:s},{default:n(()=>[t.getUserType==="QuickBase User"?(f(),h(M,{key:0,"auto-width":""},{default:n(()=>[o(w,{class:"cursor-pointer",size:t.$q.screen.gt.sm?"sm":"xs",color:"info",round:"",dense:"",onClick:d=>t.viewProfile(s.row),name:s.expand?"visibility_off":"visibility"},null,8,["size","onClick","name"])]),_:2},1024)):T("",!0),(f(!0),P(A,null,N(s.cols,d=>(f(),h(M,{key:d.name,props:s},{default:n(()=>[q(u(d.value),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),_:1},8,["columns","rows","row-key","pagination","loading","grid"])]),r("div",{class:F(t.$q.screen.lt.md?"col-12 q-px-xs q-mt-sm order-first":"col-2 q-px-xs")},[o(l,{pipeline:t.props.rows},null,8,["pipeline"])],2)])])}var xe=j(fe,[["render",be]]);export{xe as P};
