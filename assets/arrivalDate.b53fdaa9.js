import{l as A,r as u,c as Y,_ as C,B as i,as as w,bt as s,C as m,E as b,ae as D,bY as p,at as g,d as l,bQ as q,cX as T,az as $,G as z}from"./index.52451644.js";import{Q as B}from"./QInnerLoading.6fcc845d.js";import{Q as h}from"./QTooltip.1a821f35.js";import{Q as _}from"./QForm.6648b3a5.js";import{Q as j}from"./QTd.9de883f6.js";import{u as N}from"./use-quasar.6cc770ef.js";import{a as R,u as H}from"./vee-validate.esm.9fbe7cdf.js";import{a as I,b as L}from"./array.164cfe36.js";import{dayjs as o}from"./dayjs.3886e7b6.js";import{q as k}from"./app.4a1e4074.js";import{u as O}from"./useQuerySaver.d29ff9ee.js";const X=A({emits:["disableEdit"],props:{row:Object,rowType:String,edit:Boolean},setup(e,{emit:r}){const v=N(),n=u(e.edit),d=u(null),f=u(null),t=u(!0),F=u(o().format("YYYY-MM-DD")),M=Y(()=>{const a=e.row[219];return a?o(a.$d).format("MM/DD/YYYY"):null}),Q=Y(()=>I({entry:L().required("Arrival date is required").max(o().toDate(),"Arrival date cannot be in the future!").nullable().label("Arrival Date")})),{errors:V,handleSubmit:E,handleReset:ee}=R({validationSchema:Q}),{value:c}=H("entry"),S=E(async a=>{t.value=!0,n.value=!1;try{const{data:y}=await k.upsertRecordsXML({to:"bp3gazpqj",data:[{3:{value:f.value},145:{value:o(a.entry)}}],fieldsToReturn:[144],formatObject:144});d.value=o(y[0][144][145].$d).toDate(),c.value=o(y[0][144][145].$d).format("YYYY-MM-DD"),t.value=!1,v.notify({type:"positive",message:"Arrival date was updated!"})}catch{v.notify({type:"negative",message:"There was a problem"}),t.value=!1,n.value=!1}});return(async()=>{if(e.rowType==="assignment"){const a=e.row[145].$d?e.row[145].$d:e.row[1].$d;f.value=e.row[3],d.value=o(a).toDate(),c.value=o(a).format("YYYY-MM-DD"),t.value=!1}else if(e.rowType==="deployment"&&e.row[207]){const{data:a}=await k.fetchFromHiringApp({fields:[O({type:"rawAssignments",id:e.row[207]})]});d.value=o(a[145].$d).toDate(),c.value=o(a[145].$d).format("YYYY-MM-DD"),f.value=a[3],t.value=!1}})(),{editField:n,entry:c,formErrors:V,submit:S,val:M,fieldValue:d,loading:t,today:F,disableEditFunction:()=>{n.value=!1,r("disableEdit",e.row)}}}}),G={key:0},U={key:0},J={key:0},K={key:1},P={key:1},W={class:"q-pt-sm"},Z={class:"text-caption"};function x(e,r,v,n,d,f){return i(),w(j,{"auto-width":!e.editField,style:z(e.editField?"min-width: 250px;":"")},{default:s(()=>[e.fieldValue?(i(),m("div",G,[e.editField?(i(),m("div",P,[l(_,{onSubmit:q(e.submit,["prevent"])},{default:s(()=>[l(T,{modelValue:e.entry,"onUpdate:modelValue":r[2]||(r[2]=t=>e.entry=t),type:"date",label:"Arrival Date",max:e.today,error:!!e.formErrors.entry,"bottom-slots":"","stack-label":"",dense:""},{after:s(()=>[b("div",W,[l(p,{class:"q-mr-xs",onClick:r[1]||(r[1]=t=>e.disableEditFunction()),icon:"close",color:"secondary",dense:"",size:"sm"},{default:s(()=>[l(h,{class:"bg-secondary"},{default:s(()=>[$("Cancel")]),_:1})]),_:1}),l(p,{disable:!!e.formErrors.entry,type:"submit",onClick:e.submit,icon:"done",color:"info",dense:"",size:"sm"},{default:s(()=>[l(h,{class:"bg-info"},{default:s(()=>[$("Submit")]),_:1})]),_:1},8,["disable","onClick"])])]),error:s(()=>[b("div",Z,D(e.formErrors.entry),1)]),_:1},8,["modelValue","max","error"])]),_:1},8,["onSubmit"])])):(i(),m("div",U,[e.loading?(i(),m("div",K,[l(B,{size:"sm",showing:"",color:"primary"})])):(i(),m("div",J,[b("span",null,D(e.$dayjs(e.fieldValue).format("MM/DD/YYYY")),1),e.$can("manage","employees")?(i(),w(p,{key:0,icon:"edit",color:"accent",flat:"",size:"sm",onClick:r[0]||(r[0]=t=>e.editField=!0)})):g("",!0)]))]))])):g("",!0)]),_:1},8,["auto-width","style"])}var ve=C(X,[["render",x]]);export{ve as A};
