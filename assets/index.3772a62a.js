import{Q as Ue}from"./QPage.1c164a0a.js";import{u as be}from"./use-quasar.e6ca1583.js";import{u as k,q as P}from"./app.d59c0f43.js";import{q as je,k as O,l as oe,r as z,_ as J,A as h,aq as E,av as ge,br as c,d as i,bW as q,D as l,ac as v,H as ve,b5 as U,cS as H,cT as V,cU as ee,B,ar as X,cV as G,bO as ce,bQ as Ce,c as C,w as he,bU as Pe,bT as Ne,bV as Qe,F as me,b4 as we,G as Se,bS as Xe,y as ze}from"./index.429672c4.js";import{localforage as T}from"./localForage.7b97ba34.js";import{dayjs as g}from"./dayjs.cdbadc74.js";import{a as se}from"./QSelect.4d6ed681.js";import{Q as ue}from"./QForm.644d5019.js";import{a as He,Q as ie}from"./QStep.a78a2065.js";import{a as te,b as Ye}from"./useQuerySaver.d29ff9ee.js";import{u as We}from"./dataStore.59ac3960.js";import{a as de,u as j}from"./vee-validate.esm.217e8859.js";import{a as F,b as Je,c as ne,e as $e}from"./array.59f93f43.js";import{Q as le}from"./QTooltip.a483311b.js";import{P as Ge,f as Ze,n as Ke}from"./pay-rate-v2.c86bfef4.js";import{Q as Ie}from"./QTd.b4d99b53.js";import{a as De}from"./QTable.5b5241aa.js";import"./_commonjsHelpers.a26ce4be.js";import"./api.682a7e8f.js";import"./index.04bc0a32.js";import"./i18n.0152b37a.js";import"./QChip.6eeb9910.js";import"./QMenu.c6a626a1.js";import"./position-engine.daa72afe.js";import"./selection.fa3bc4cc.js";import"./rtl.b51694b1.js";import"./use-panel.6bbf83ae.js";import"./touch.70a9dd44.js";import"./QSlideTransition.4fafdf29.js";import"./QList.a027e3e6.js";import"./QMarkupTable.5054ba66.js";import"./use-fullscreen.9de0f9ba.js";const ae=je("newRequestDataStore",{state:()=>({selectedProject:null,humanizedData:{},humanizedClassificationData:[],dbData:{},dbClassificationData:[],jobNumbers:{},siteContacts:{},meetingLocations:{},perDiemSpecs:{},projectCrafts:{},projectCraftClassifications:{},requestedTimeStamps:{},v3EditData:{request:null,classifications:[],names:[]},v3Data:{request:null,project:null,general:null,classifications:[],names:[],matches:null,edit:!1},v3Options:{projects:[],jobNumbers:[],contacts:[],locations:[],perDiem:[],crafts:[],jobs:[],restrictions:[{value:"Name Request Only",description:"The hiring center will only hire the names you provide.",warning:"If you DO NOT provide enough names or if the people you request do not show up, the hiring center WILL NOT assist with filling this request."},{value:"Open",description:"The hiring center will fill positions by recruiting and selecting the most qualified candidates available.",warning:"You will NOT be able to add names to this type of request."},{value:"Mixed",description:"The hiring center will hire all of the names that you provide and fill remaining positions by recruiting and selecting the most qualified candidates available."}],reasons:[{value:"Backfill",label:"Backfill - (An employee was terminated)",description:"This request is to fill positions that are open because of an employee leaving the job site."},{value:"Increase in Manpower",label:"Increase in Manpower - (We need more employees on site)",description:"This request is to fill positions that are new because of an increased need in manpower. This may be due to a change in the scope of an existing contract, an additional contract awarded, etc."}]}}),getters:{getStoredData:e=>({type:t,key:s})=>!t||!s?[]:!e.requestedTimeStamps[s]||!e.requestedTimeStamps[s][t]||e.requestedTimeStamps[s][t].isBefore(g().subtract(10,"minute"))?[]:e[t][s],getHumanizedData:e=>e.humanizedData,getDbData:e=>e.dbData,getHumanizedClassificationData:e=>e.humanizedClassificationData,getDbClassificationData:e=>e.dbClassificationData,getRequestedTimeStamps(e){return e.requestedTimeStamps},getV3Data:e=>e.v3Data,getV3Options:e=>e.v3Options,getV3EditData:e=>e.v3EditData},actions:{setselectedProject(e){this.selectedProject=e},setTimeStamp({name:e,timeStamp:t,Id:s},o){if(this.requestedTimeStamps[s]?this.requestedTimeStamps[s][e]=t:this.requestedTimeStamps[s]={[e]:t},o){const r=JSON.parse(JSON.stringify(this.requestedTimeStamps));T.setItem(`${O.storageProcessTimeStamps}`,r)}},setNewRequestData({humanized:e,database:t}){for(const[s,o]of Object.entries(e))Object.assign(this.humanizedData,{[s]:o});for(const[s,o]of Object.entries(t))Object.assign(this.dbData,{[s]:o})},setNewRequestClassificationData({humanized:e,database:t}){this.humanizedClassificationData=e,this.dbClassificationData=t},setStorageData({type:e,key:t,data:s,timestamp:o}){this.setTimeStamp({name:e,Id:t,timeStamp:o}),this[e][t]=s},setTimeStampState(e){this.requestedTimeStamps=e},async removeData({type:e,key:t,item:s,storageKey:o}){const r=this[e][t].findIndex(p=>p[3]===s[3]);r>-1&&this[e][t].splice(r,1);const n=this[e][t];T.removeItem(`${O[o]}_${t}`),T.getItem(`${O[o]}_${t}`)||T.setItem(`${O[o]}_${t}`,n)},setV3Data({prop:e,data:t,push:s}){s?this.v3Data[e].push(t):this.v3Data[e]=t},setV3EditData({prop:e,data:t,push:s}){s?this.v3EditData[e].push(t):this.v3EditData[e]=t},setV3Options({prop:e,data:t}){this.v3Options[e]=t},resetV3Data(){this.v3Data={project:null,general:null,classifications:[],names:[],matches:null},this.v3Options={projects:[],jobNumbers:[],contacts:[],locations:[],perDiem:[],crafts:[],jobs:[],restrictions:[{value:"Name Request Only",description:"The hiring center will only hire the names you provide.",warning:"If you DO NOT provide enough names or if the people you request do not show up, the hiring center WILL NOT assist with filling this request."},{value:"Open",description:"The hiring center will fill positions by recruiting and selecting the most qualified candidates available.",warning:"You will NOT be able to add names to this type of request."},{value:"Mixed",description:"The hiring center will hire all of the names that you provide and fill remaining positions by recruiting and selecting the most qualified candidates available."}],reasons:[{value:"Backfill",label:"Backfill - (An employee was terminated)",description:"This request is to fill positions that are open because of an employee leaving the job site."},{value:"Increase in Manpower",label:"Increase in Manpower - (We need more employees on site)",description:"This request is to fill positions that are new because of an increased need in manpower. This may be due to a change in the scope of an existing contract, an additional contract awarded, etc."}]}}}}),ke=je("dataStore2",{state:()=>({selectedOffice:null,selfCheckIns:{},profiles:{},scheduledInterviews:{},inProcessInterviews:{},inProcess:{},pending:{},deployments:{},projects:{},openRequest:{},pendingRequest:{},closedRequest:{},openClassifications:{},pendingClassifications:{},closedClassifications:{},nameRequest:{},pendingProjects:{},requestedTimeStamps:{}}),getters:{getSelfCheckIns:e=>t=>{if(t)return e.selfCheckIns[t]?e.selfCheckIns[t]:[];{let s=[];return Object.keys(e.selfCheckIns).forEach(o=>{s=s.concat(e.selfCheckIns[o])}),s}},getProfiles:e=>t=>{if(t)return e.profiles[t]?e.profiles[t]:[];{let s=[];return Object.keys(e.profiles).forEach(o=>{s=s.concat(e.profiles[o])}),s}},getScheduledInterviews:e=>t=>{if(t)return e.scheduledInterviews[t]?e.scheduledInterviews[t]:[];{let s=[];return Object.keys(e.scheduledInterviews).forEach(o=>{s=s.concat(e.scheduledInterviews[o])}),s}},getInProcessInterviews:e=>t=>{if(t)return e.inProcessInterviews[t]?e.inProcessInterviews[t]:[];{let s=[];return Object.keys(e.inProcessInterviews).forEach(o=>{s=s.concat(e.inProcessInterviews[o])}),s}},getInProcess:e=>t=>{if(t)return e.inProcess[t]?e.inProcess[t]:[];{let s=[];return Object.keys(e.inProcess).forEach(o=>{s=s.concat(e.inProcess[o])}),s}},getPending:e=>t=>{if(t)return e.pending[t]?e.pending[t]:[];{let s=[];return Object.keys(e.pending).forEach(o=>{s=s.concat(e.pending[o])}),s}},getDeployments:e=>t=>{if(t)return e.deployments[t]?e.deployments[t]:[];{let s=[];return Object.keys(e.deployments).forEach(o=>{s=s.concat(e.deployments[o])}),s}},getProjects:e=>(t,s)=>{if(!s&&!t){let o=[];return Object.keys(e.projects).forEach(r=>{o=o.concat(e.projects[r])}),o}else if(!s&&t){const{userOffices:o}=k();let r=[];return o(t).forEach(n=>{r=r.concat(e.projects[n[8]])}),r}else if(s&&t){const{getOffice:o}=k(),r=o(s);return t==="read"&&r&&r[39]!==!0?[]:(t==="create"||t==="update")&&r&&r[40]!==!0?[]:t==="manage"&&r&&r[41]!==!0?[]:e.projects[s]?e.projects[s]:[]}else return e.projects[s]?e.projects[s]:[]},getPendingProjects:e=>t=>{if(t)return e.pendingProjects[t]?e.pendingProjects[t]:[];{let s=[];return Object.keys(e.pendingProjects).forEach(o=>{s=s.concat(e.pendingProjects[o])}),s}},getRequestedTimeStamps(e){return e.requestedTimeStamps},getSelectedOffice(e){return e.selectedOffice}},actions:{setSelectedOffice(e,t){this.selectedOffice=e},setTimeStamp({name:e,timeStamp:t,officeId:s},o){if(this.requestedTimeStamps[s]?this.requestedTimeStamps[s][e]=t:this.requestedTimeStamps[s]={[e]:t},o){const r=JSON.parse(JSON.stringify(this.requestedTimeStamps));T.setItem(`${O.storageProcessTimeStamps}`,r)}},setTimeStampState(e){this.requestedTimeStamps=e},async fetchSelfCheckIns(e){const t=this.getRequestedTimeStamps[e.officeId]||{};let s=!0;const o=[{9:{value:e.officeId},7:{value:"Self Check-Ins"}}];if(t.selfCheckIns&&(t.selfCheckIns.isBefore(g().subtract(1,"minute"))?s=!0:s=e.refresh?e.refresh:!1),s){this.setTimeStamp({officeId:e.officeId,name:"selfCheckIns",timeStamp:g()},!0);const{data:r}=await P.fetchFromRecruitingApp({fields:o});return this.setSelfCheckIns({officeId:e.officeId,data:r},!0),{data:r}}else return{data:[]}},async fetchAllSelfCheckIns(e){const{userOffices:t}=k(),s=[];return t(e?e.access:null).forEach(r=>{let n=this.fetchSelfCheckIns({...e,officeId:r[8]});s.push(n)}),await Promise.allSettled(s)},setSelfCheckIns({officeId:e,data:t},s){this.selfCheckIns[e]=t,s&&T.setItem(`${O.storageSelfCheckIns}_${e}`,t)},async fetchProfiles(e){const t=this.getRequestedTimeStamps[e.officeId]||{};let s=!0;const o=[{9:{value:e.officeId},7:{value:"Profiles"}}];if(t.profiles&&(t.profiles.isBefore(g().subtract(1,"minute"))?s=!0:s=e.refresh?e.refresh:!1),s){this.setTimeStamp({officeId:e.officeId,name:"profiles",timeStamp:g()},!0);const{data:r}=await P.fetchFromHiringApp({fields:o});return this.setProfiles({officeId:e.officeId,data:r},!0),{data:r}}else return{data:[]}},async fetchAllProfiles(e){const{userOffices:t}=k(),s=[];return t(e?e.access:null).forEach(r=>{let n=this.fetchProfiles({...e,officeId:r[8]});s.push(n)}),await Promise.allSettled(s)},setProfiles({officeId:e,data:t},s){this.profiles[e]=t,s&&T.setItem(`${O.storageProfiles}_${e}`,t)},async fetchScheduledInterviews(e){const t=this.getRequestedTimeStamps[e.officeId]||{};let s=!0;const o=[{9:{value:e.officeId},7:{value:"Scheduled Interviews"}}];if(t.scheduledInterviews&&(t.scheduledInterviews.isBefore(g().subtract(1,"minute"))?s=!0:s=e.refresh?e.refresh:!1),s){this.setTimeStamp({officeId:e.officeId,name:"scheduledInterviews",timeStamp:g()},!0);const{data:r}=await P.fetchFromHiringApp({fields:o});return this.setScheduledInterviews({officeId:e.officeId,data:r},!0),{data:r}}else return{data:[]}},async fetchAllScheduledInterviews(e){const{userOffices:t}=k(),s=[];return t(e?e.access:null).forEach(r=>{let n=this.fetchScheduledInterviews({...e,officeId:r[8]});s.push(n)}),await Promise.allSettled(s)},setScheduledInterviews({officeId:e,data:t},s){this.scheduledInterviews[e]=t,s&&T.setItem(`${O.storageScheduledInterviews}_${e}`,t)},async fetchInProcessInterviews(e){const t=this.getRequestedTimeStamps[e.officeId]||{};let s=!0;const o=[{9:{value:e.officeId},7:{value:"In Process Interviews"}}];if(t.inProcessInterviews&&(t.inProcessInterviews.isBefore(g().subtract(1,"minute"))?s=!0:s=e.refresh?e.refresh:!1),s){this.setTimeStamp({officeId:e.officeId,name:"inProcessInterviews",timeStamp:g()},!0);const{data:r}=await P.fetchFromHiringApp({fields:o});return this.setInProcessInterviews({officeId:e.officeId,data:r},!0),{data:r}}else return{data:[]}},async fetchAllInProcessInterviews(e){const{userOffices:t}=k(),s=[];return t(e?e.access:null).forEach(r=>{let n=this.fetchInProcessInterviews({...e,officeId:r[8]});s.push(n)}),await Promise.allSettled(s)},setInProcessInterviews({officeId:e,data:t},s){this.inProcessInterviews[e]=t,s&&T.setItem(`${O.storageInProcessInterviews}_${e}`,t)},async fetchInProcess(e){const t=this.getRequestedTimeStamps[e.officeId]||{};let s=!0;const o=[{9:{value:e.officeId},7:{value:"In Processes"}}];if(t.inProcess&&(t.inProcess.isBefore(g().subtract(1,"minute"))?s=!0:s=e.refresh?e.refresh:!1),s){this.setTimeStamp({officeId:e.officeId,name:"inProcess",timeStamp:g()},!0);const{data:r}=await P.fetchFromHiringApp({fields:o});return this.setInProcess({officeId:e.officeId,data:r},!0),{data:r}}else return{data:[]}},async fetchAllInProcess(e){const{userOffices:t}=k(),s=[];return t(e?e.access:null).forEach(r=>{let n=this.fetchInProcess({...e,officeId:r[8]});s.push(n)}),await Promise.allSettled(s)},setInProcess({officeId:e,data:t},s){this.inProcess[e]=t,s&&T.setItem(`${O.storageInProcess}_${e}`,t)},async fetchPending(e){const t=this.getRequestedTimeStamps[e.officeId]||{};let s=!0;const o=[{9:{value:e.officeId},7:{value:"Dispatches"}}];if(t.pending&&(t.pending.isBefore(g().subtract(1,"minute"))?s=!0:s=e.refresh?e.refresh:!1),s){this.setTimeStamp({officeId:e.officeId,name:"pending",timeStamp:g()},!0);const{data:r}=await P.fetchFromHiringApp({fields:o});return this.setPending({officeId:e.officeId,data:r},!0),{data:r}}else return{data:[]}},async fetchAllPending(e){const{userOffices:t}=k(),s=[];return t(e?e.access:null).forEach(r=>{let n=this.fetchPending({...e,officeId:r[8]});s.push(n)}),await Promise.allSettled(s)},setPending({officeId:e,data:t},s){this.pending[e]=t,s&&T.setItem(`${O.storagePending}_${e}`,t)},async fetchOpenRequest(e){const t=this.getRequestedTimeStamps[e.officeId]||{};let s=!0;const o=[{9:{value:e.officeId},7:{value:"Open Request"}}];if(t.openRequest&&(t.openRequest.isBefore(g().subtract(1,"minute"))?s=!0:s=e.refresh?e.refresh:!1),s){this.setTimeStamp({officeId:e.officeId,name:"openRequest",timeStamp:g()},!0);const{data:r}=await P.fetchFromProjectsApp({fields:o});return this.setOpenRequest({officeId:e.officeId,data:r},!0),{data:r}}else return{data:[]}},async fetchAllOpenRequest(e){const{userOffices:t}=k(),s=[];return t(e?e.access:null).forEach(r=>{let n=this.fetchOpenRequest({...e,officeId:r[8]});s.push(n)}),await Promise.allSettled(s)},setOpenRequest({officeId:e,data:t},s){this.openRequest[e]=t,s&&T.setItem(`${O.storageOpenRequest}_${e}`,t)},async fetchPendingRequest(e){const t=this.getRequestedTimeStamps[e.officeId]||{};let s=!0;const o=[{9:{value:e.officeId},7:{value:"Pending Request"}}];if(t.pendingRequest&&(t.pendingRequest.isBefore(g().subtract(1,"minute"))?s=!0:s=e.refresh?e.refresh:!1),s){this.setTimeStamp({officeId:e.officeId,name:"pendingRequest",timeStamp:g()},!0);const{data:r}=await P.fetchFromProjectsApp({fields:o});return this.setPendingRequest({officeId:e.officeId,data:r},!0),{data:r}}else return{data:[]}},async fetchAllPendingRequest(e){const{userOffices:t}=k(),s=[];return t(e?e.access:null).forEach(r=>{let n=this.fetchPendingRequest({...e,officeId:r[8]});s.push(n)}),await Promise.allSettled(s)},setPendingRequest({officeId:e,data:t},s){this.pendingRequest[e]=t,s&&T.setItem(`${O.storagePendingRequest}_${e}`,t)},async fetchProjects(e){const{getOffice:t}=k(),s=this.getRequestedTimeStamps[e.officeId]||{};let o=!0;if(e&&e.access){const n=t(e.officeId);if(e.access==="read"&&n&&n[39]!==!0)return{data:[]};if((e.access==="create"||e.access==="update")&&n&&n[40]!==!0)return{data:[]};if(e.access==="manage"&&n&&n[41]!==!0)return{data:[]}}const r=[{9:{value:e.officeId},7:{value:"Projects"}}];if(s.projects&&(s.projects.isBefore(g().subtract(1,"minute"))?o=!0:o=e.refresh?e.refresh:!1),o){this.setTimeStamp({officeId:e.officeId,name:"projects",timeStamp:g()},!0);const{data:n}=await P.fetchFromProjectsApp({fields:r});return this.setProjects({officeId:e.officeId,data:n},!0),{data:n}}else return{data:[]}},async fetchAllProjects(e){const{userOffices:t}=k(),s=[];return t(e?e.access:null).forEach(r=>{let n=this.fetchProjects({...e,officeId:r[8]});s.push(n)}),await Promise.allSettled(s)},setProjects({officeId:e,data:t},s){e&&t&&(this.projects[e]=t),s&&e&&T.setItem(`${O.storageProjects}_${e}`,t)},async fetchPendingProjects(e){const t=this.getRequestedTimeStamps[e.officeId]||{};let s=!0;const o=[{9:{value:e.officeId},7:{value:"Pending Projects"}}];if(t.pendingProjects&&(t.pendingProjects.isBefore(g().subtract(1,"minute"))?s=!0:s=e.refresh?e.refresh:!1),s){this.setTimeStamp({officeId:e.officeId,name:"pendingProjects",timeStamp:g()},!0);const{data:r}=await P.fetchFromProjectsApp({fields:o});return this.setPendingProjects({officeId:e.officeId,data:r},!0),{data:r}}else return{data:[]}},async fetchAllPendingProjects(e){const{userOffices:t}=k(),s=[];return t(e?e.access:null).forEach(r=>{let n=this.fetchPendingProjects({...e,officeId:r[8]});s.push(n)}),await Promise.allSettled(s)},setPendingProjects({officeId:e,data:t},s){this.pendingProjects[e]=t,s&&T.setItem(`${O.storagePendingProjects}_${e}`,t)}}}),xe=oe({props:{fetcher:{type:Function,required:!0},getter:{type:Function,required:!0},setter:{type:Function,required:!0},filter:{type:Function,required:!0}},setup(e){const t=z([]),s=async()=>{const{fetcher:r,getter:n,setter:p}=e;if(!n()||n().length===0){const a=await r();p(a),t.value=n()}else t.value=n()},o=(r,n)=>{const{getter:p,filter:a}=e,u=p();if(r===""||!r){n(()=>{t.value=u});return}t.value=a(u,r)};return s(),{options:t,filterOptions:o}}}),et={class:"text-caption"},tt={class:"text-caption"};function st(e,t,s,o,r,n){return h(),E(se,ve(e.$attrs,{"transition-show":"flip-up","transition-hide":"flip-down",options:e.options,"bottom-slots":"","use-input":"","input-debounce":"0",onFilter:e.filterOptions,loading:!e.options||e.options.length===0}),ge({error:c(()=>[l("div",et,v(e.$attrs.errorMessage),1)]),_:2},[e.$attrs.showTooltip?{name:"after",fn:c(()=>[i(q,{size:"xs",color:"accent",round:"",icon:"question_mark"},{default:c(()=>[i(le,{anchor:"top middle",self:"center middle",class:"bg-primary text-white"},{default:c(()=>[l("div",null,[l("div",tt,v(e.$attrs.tooltipMessage),1)])]),_:1})]),_:1})]),key:"0"}:void 0]),1040,["options","onFilter","loading"])}var Ve=J(xe,[["render",st]]);const ot=oe({emits:["changeStep"],components:{aSelect:Ve},setup(e,{emit:t}){const s=z(0),{getV3Data:o,setV3Data:r,getV3Options:n,setV3Options:p}=ae(),a=o.general?o.general:{},u=F({dateNeeded:Je().required().nullable().label("Date Needed"),restriction:F().required().label("Request Type"),reason:F().required().label("Request Reason"),jobNumber:F().required().nullable().label("Job Number"),meetingLocation:F().required().nullable().label("Meeting Location"),siteContact:F().required().nullable().label("Site Contact"),perDiem:F().nullable().label("Per Diem"),notes:ne().nullable().label("Notes")}),{meta:d,errors:f,handleSubmit:y}=de({validationSchema:u,initialValues:{restriction:a.restriction?a.restriction:n.restrictions[1],reason:a.reason?a.reason:n.reasons[0],dateNeeded:a.dateNeeded?a.dateNeeded:null,jobNumber:a.jobNumber?a.jobNumber:null,meetingLocation:a.meetingLocation?a.meetingLocation:null,siteContact:a.siteContact?a.siteContact:null,perDiem:a.perDiem?a.perDiem:null,notes:a.notes?a.notes:null}}),{value:L}=j("dateNeeded"),{value:N}=j("restriction"),{value:S}=j("reason"),{value:R}=j("jobNumber"),{value:M}=j("meetingLocation"),{value:I}=j("siteContact"),{value:Z}=j("perDiem"),{value:m}=j("notes"),$=y(b=>{console.log(b),b.notes=b.notes?b.notes.replace(/(\r\n|\n|\r)/gm," "):null,r({prop:"general",data:b}),t("changeStep",2)});return{step:s,changeStep:b=>{},submit:$,meta:d,errors:f,dateNeeded:L,jobNumber:R,restriction:N,reason:S,siteContact:I,meetingLocation:M,perDiem:Z,notes:m,getV3Options:n,setV3Options:p,getV3Data:o,jobNumberFetcher:async()=>{const{data:b}=await P.fetchFromProjectsApp({fields:[te({type:"jobNumbers",query:`{'6'.EX.'${o.project[3]}'}AND{'29'.EX.'Active'}`})]});return b.sort((A,W)=>A[11]>W[11]?-1:1)},meetingLocationsFetcher:async()=>{const{data:b}=await P.fetchFromStructureApp({fields:[Ye({type:"meetingLocations",query:`{'15'.EX.'${o.project[8]}'}AND{'14'.EX.'Active'}`})]});return b.sort((A,W)=>A[6]>W[6]?-1:1)},siteContactsFetcher:async()=>{const{data:b}=await P.fetchFromProjectsApp({fields:[te({type:"siteContacts",query:`{'7'.EX.'${o.project[3]}'}AND{'6'.EX.'Active'}`})]});return b.sort((A,W)=>A[17]>W[17]?-1:1)},perDiemFetcher:async()=>{const{data:b}=await P.fetchFromProjectsApp({fields:[te({type:"perDiemSpecs",query:`{'12'.EX.'${o.project[3]}'}AND{'38'.EX.'Active'}`})]});return b.sort((A,W)=>A[20]>W[20]?-1:1)}}}}),at=l("div",{class:"text-body2 text-italic text-weight-bold text-dark"},"Please provide the following general information about this request.",-1),rt={class:"row"},it={class:"col-12 col-md-4 q-pr-md"},nt={class:"text-caption"},lt=l("div",null,[l("div",{class:"text-caption"}," This is the day that these employees should arrive to begin work. "),l("div",{class:"text-caption"}," Expect a minimum of 3-5 days for processing of any drug screens or background checks. ")],-1),ct={class:"text-caption"},ut={class:"text-caption"},dt={class:"text-caption"},pt={class:"text-caption"},ft={key:0,class:"text-caption text-dark text-italic text-weight-bold"},mt={class:"col-12 col-md-4 q-pr-sm"},ht={class:"col-12 col-md-4 q-pr-sm"};function bt(e,t,s,o,r,n){const p=U("a-select");return h(),E(ue,{onSubmit:ce(e.submit,["prevent"])},{default:c(()=>[i(H,{flat:""},{default:c(()=>[i(V,{class:"q-pt-none q-px-none"},{default:c(()=>[at]),_:1}),i(V,{class:"q-px-none q-pb-none"},{default:c(()=>[l("div",rt,[l("div",it,[i(ee,{class:"q-mb-md",autofocus:"",outlined:"",clearable:"",type:"date",dense:"",label:"Date Needed",modelValue:e.dateNeeded,"onUpdate:modelValue":t[0]||(t[0]=a=>e.dateNeeded=a),error:!!e.errors.dateNeeded,"bottom-slots":"","stack-label":""},{error:c(()=>[l("div",nt,v(e.errors.dateNeeded),1)]),before:c(()=>[i(q,{size:"xs",color:"accent",round:"",icon:"question_mark"},{default:c(()=>[i(le,{anchor:"top middle",self:"center middle",class:"bg-primary text-white"},{default:c(()=>[lt]),_:1})]),_:1})]),_:1},8,["modelValue","error"]),i(se,{class:"q-mb-md",dense:"",clearable:"",outlined:"","transition-show":"flip-up","transition-hide":"flip-down",label:"Request Reason",modelValue:e.reason,"onUpdate:modelValue":t[1]||(t[1]=a=>e.reason=a),options:e.getV3Options.reasons,"option-label":"label",error:!!e.errors.reason,"bottom-slots":""},{error:c(()=>[l("div",ct,v(e.errors.reason),1)]),before:c(()=>[i(q,{size:"xs",color:"accent",round:"",icon:"question_mark"},{default:c(()=>[i(le,{anchor:"top middle",self:"center middle",class:"bg-primary text-white"},{default:c(()=>[l("div",null,[l("div",ut,v(e.reason?e.reason.description:""),1)])]),_:1})]),_:1})]),_:1},8,["modelValue","options","error"]),i(se,{class:"q-mb-md",dense:"",clearable:"",outlined:"","transition-show":"flip-up","transition-hide":"flip-down",label:"Request Type",modelValue:e.restriction,"onUpdate:modelValue":t[2]||(t[2]=a=>e.restriction=a),options:e.getV3Options.restrictions,"option-label":"value",error:!!e.errors.restriction,"bottom-slots":""},{error:c(()=>[l("div",dt,v(e.errors.restriction),1)]),before:c(()=>[i(q,{size:"xs",color:"accent",round:"",icon:"question_mark"},{default:c(()=>[i(le,{anchor:"top middle",self:"center middle",class:"bg-primary text-white"},{default:c(()=>[l("div",null,[l("div",pt,v(e.restriction?e.restriction.description:""),1)])]),_:1})]),_:1})]),hint:c(()=>[e.restriction?(h(),B("div",ft,v(e.restriction.warning||""),1)):X("",!0)]),_:1},8,["modelValue","options","error"])]),l("div",mt,[i(p,{dense:"",class:"q-mb-md",clearable:"",outlined:"",label:"Job Number",modelValue:e.jobNumber,"onUpdate:modelValue":t[3]||(t[3]=a=>e.jobNumber=a),"option-label":a=>a[11],"display-value":e.jobNumber?`${e.jobNumber[11]}`:"",error:!!e.errors.jobNumber,"error-message":e.errors.jobNumber,fetcher:e.jobNumberFetcher,getter:()=>e.getV3Options.jobNumbers,setter:a=>{e.setV3Options({prop:"jobNumbers",data:a})},filter:(a,u)=>a.filter(d=>d[17].toLowerCase().indexOf(u.toLowerCase())>-1),"bottom-slots":"",showTooltip:!0,tooltipMessage:"This is the job number that hiring costs should be charged to."},null,8,["modelValue","option-label","display-value","error","error-message","fetcher","getter","setter","filter"]),i(p,{dense:"",class:"q-mb-md",clearable:"",outlined:"",label:"Site Contact",modelValue:e.siteContact,"onUpdate:modelValue":t[4]||(t[4]=a=>e.siteContact=a),"option-label":a=>a[17],"display-value":e.siteContact?`${e.siteContact[17]}`:"",error:!!e.errors.siteContact,"error-message":e.errors.siteContact,fetcher:e.siteContactsFetcher,getter:()=>e.getV3Options.siteContacts,setter:a=>{e.setV3Options({prop:"siteContacts",data:a})},filter:(a,u)=>a.filter(d=>d[17].toLowerCase().indexOf(u.toLowerCase())>-1),"bottom-slots":"",showTooltip:!0,tooltipMessage:"This is the person that a new hire should contact when the arrive at the job site."},null,8,["modelValue","option-label","display-value","error","error-message","fetcher","getter","setter","filter"]),i(p,{dense:"",class:"q-mb-md",clearable:"",outlined:"",label:"Meeting Location",modelValue:e.meetingLocation,"onUpdate:modelValue":t[5]||(t[5]=a=>e.meetingLocation=a),"option-label":a=>a[6],"display-value":e.meetingLocation?`${e.meetingLocation[6]}`:"",error:!!e.errors.meetingLocation,"error-message":e.errors.meetingLocation,fetcher:e.meetingLocationsFetcher,getter:()=>e.getV3Options.meetingLocations,setter:a=>{e.setV3Options({prop:"meetingLocations",data:a})},filter:(a,u)=>a.filter(d=>d[6].toLowerCase().indexOf(u.toLowerCase())>-1),"bottom-slots":"",showTooltip:!0,tooltipMessage:"This is the location that the new hire should report to."},null,8,["modelValue","option-label","display-value","error","error-message","fetcher","getter","setter","filter"]),e.getV3Data.project[351]?(h(),E(p,{key:0,dense:"",class:"q-mb-md",clearable:"",outlined:"",label:"Per Diem (optional)",modelValue:e.perDiem,"onUpdate:modelValue":t[6]||(t[6]=a=>e.perDiem=a),"option-label":a=>a[20],"display-value":e.perDiem?`${e.perDiem[20]}`:"",error:!!e.errors.perDiem,"error-message":e.errors.perDiem,fetcher:e.perDiemFetcher,getter:()=>e.getV3Options.perDiem,setter:a=>{e.setV3Options({prop:"perDiem",data:a})},filter:(a,u)=>a.filter(d=>d[20].toLowerCase().indexOf(u.toLowerCase())>-1),"bottom-slots":"",showTooltip:!0,tooltipMessage:"If per diem is available, this is the specification for per diem for all classifications on this request. Add a separate request for any classifications that do not qualify for per diem."},null,8,["modelValue","option-label","display-value","error","error-message","fetcher","getter","setter","filter"])):X("",!0)]),l("div",ht,[i(ee,{outlined:"","input-style":"resize: none",maxlength:"2500",type:"textarea",modelValue:e.notes,"onUpdate:modelValue":t[7]||(t[7]=a=>e.notes=a),label:"Notes"},null,8,["modelValue"])])])]),_:1}),i(G,{align:"right"},{default:c(()=>[i(q,{color:"secondary",label:"Back",onClick:t[8]||(t[8]=a=>e.$emit("changeStep",0))}),i(q,{color:"info",label:"Continue",type:"submit",onClick:e.submit},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["onSubmit"])}var gt=J(ot,[["render",bt]]);const vt={emits:["removeClassification"],props:{data:Array,matchTable:Boolean},setup(e,{emit:t}){return{columns:[{name:0,label:"Craft",align:"left",field:o=>o.craft[10],format:o=>`${o}`,sortable:!0},{name:1,label:"Classification",align:"left",field:o=>o.classification[18],format:o=>`${o}`,sortable:!0,required:!0},{name:2,label:"Pay Rate",align:"right",field:o=>o.rate,format:o=>`$ ${parseFloat(o).toFixed(2)}`},{name:3,label:"Quantity",align:"right",field:o=>o.qty,format:o=>`${parseFloat(o)}`},{name:4,label:"",align:"center",field:""}]}}},qt={class:"full-width row flex-center text-primary q-gutter-sm q-py-xs"};function yt(e,t,s,o,r,n){return h(),B("div",null,[i(De,ve(e.$attrs,{dense:"",title:e.$attrs.title?e.$attrs.title:"Saved Classifications","title-class":e.$attrs.titleClass?e.$attrs.titleClass:(e.$q.screen.gt.sm,"text-primary text-body1"),columns:o.columns,"row-key":p=>p.id,pagination:{rowsPerPage:10},"table-header-class":"bg-dark text-white","no-data-label":"You are required to add at least one classification!","hide-pagination":!0}),ge({"no-data":c(({message:p})=>[l("div",qt,[i(Ce,{size:"2em",name:"fa-solid fa-person-circle-exclamation"}),l("span",null,v(p),1)])]),_:2},[e.$attrs.hideRemove?void 0:{name:"body-cell-4",fn:c(p=>[i(Ie,{class:"text-center","auto-width":""},{default:c(()=>[i(q,{flat:"",color:"accent",round:"",dense:"",onClick:a=>e.$emit("removeClassification",p.row),icon:"delete"},null,8,["onClick"])]),_:2},1024)]),key:"0"}]),1040,["title","title-class","columns","row-key"])])}var Oe=J(vt,[["render",yt]]);const wt=oe({emits:["changeStep"],props:{},components:{aSelect:Ve,PayRateField:Ge,ClassificationsTable:Oe},setup(e,{emit:t}){const{getV3Data:s,setV3Data:o,getV3Options:r,setV3Options:n}=ae(),p=C(()=>s.general?s.general:{}),a=C(()=>s.matches?s.matches:null),u=C(()=>s.request?s.request:null),d=F({craft:F().required().nullable().label("Craft"),classification:F().required().nullable().label("Classification"),rate:$e().required().nullable().label("Rate"),qty:$e().required().nullable().label("Quantity")}),{errors:f,handleSubmit:y,resetForm:L,isSubmitting:N,setFieldError:S}=de({validationSchema:d}),{value:R}=j("craft"),{value:M}=j("classification"),{value:I}=j("rate"),{value:Z}=j("qty"),m=y(async w=>{console.log(w),console.log(a.value);const Q=s.classifications.length+1;if(w.id=Q,a.value||u.value){const b=await Ze({job:w,matches:a.value?a.value:u.value});console.log(b),o({prop:"classifications",data:b,push:!0})}else o({prop:"classifications",data:w,push:!0});L()}),$=async()=>{if(s.project?s.project[3]:s.request?s.request[6]:null){const{data:Q}=await P.fetchFromProjectsApp({fields:[te({type:"projectCrafts",query:`{'7'.EX.'${s.project[3]}'}AND{'6'.EX.'Active'}`})]});return Q.sort((x,A)=>x[20]>A[20]?1:-1)}else return[]},Y=C(()=>{const w=R.value&&R.value.classifications?R.value.classifications:[];return w.length>0?w.sort((Q,b)=>Q[32]>b[32]?-1:1):[]}),K=w=>{const Q=s.classifications.filter(b=>b.id!==w.id);o({prop:"classifications",data:Q,push:!1})};return he(M,(w,Q)=>{w&&w.hasFixedRate?I.value=w.fixedRate:I.value&&(I.value=null)}),{submit:m,resetForm:L,errors:f,craft:R,classification:M,rate:I,qty:Z,getV3Data:s,getV3Options:r,setV3Options:n,craftsFetcher:$,classificationOptions:Y,removeClassification:K,nextStep:()=>{p.value.restriction&&p.value.restriction.value!=="Open"?t("changeStep",3):u.value?u.value[282]!=="Open"?t("changeStep",1):t("changeStep",2):t("changeStep",4)},request:u}}}),St={class:"row justify-between"},$t={class:"col-12 col-md-6 q-pr-md"},jt=l("div",{class:"text-body2 text-italic text-weight-bold text-dark"}," Enter the following information about the classification and click Save. Repeat until all classifications you are requesting have been saved. Then click Continue. ",-1),Ct={class:"row q-mb-md"},Pt={class:"col-6 q-pr-sm"},Nt={class:"col-6 q-pl-sm"},It={class:"text-caption"},Dt={class:"row"},kt={class:"col-6 q-pr-sm"},Vt={class:"text-caption"},Ot={class:"col-6 q-pl-sm"},Tt={class:"col-12 col-md-6 q-pl-md"};function Rt(e,t,s,o,r,n){const p=U("a-select"),a=U("pay-rate-field"),u=U("classifications-table");return h(),B("div",null,[i(H,{flat:""},{default:c(()=>[i(V,{class:"q-px-none q-pt-none"},{default:c(()=>[l("div",St,[l("div",$t,[i(ue,{onSubmit:ce(e.submit,["prevent"])},{default:c(()=>[i(H,null,{default:c(()=>[i(V,null,{default:c(()=>[jt,l("div",Ct,[l("div",Pt,[i(p,{dense:"",class:"q-mt-md",clearable:"",label:"Select Craft",modelValue:e.craft,"onUpdate:modelValue":t[0]||(t[0]=d=>e.craft=d),"option-label":d=>d[10],"display-value":e.craft?`${e.craft[10]}`:"",error:!!e.errors.craft,"error-message":e.errors.craft,fetcher:e.craftsFetcher,getter:()=>e.getV3Options.crafts,setter:d=>{e.setV3Options({prop:"crafts",data:d})},filter:(d,f)=>d.filter(y=>y[10].toLowerCase().indexOf(f.toLowerCase())>-1),"bottom-slots":""},null,8,["modelValue","option-label","display-value","error","error-message","fetcher","getter","setter","filter"])]),l("div",Nt,[i(se,{class:"q-mt-md",dense:"",clearable:"","transition-show":"flip-up","transition-hide":"flip-down",label:"Classification",modelValue:e.classification,"onUpdate:modelValue":t[1]||(t[1]=d=>e.classification=d),options:e.classificationOptions,"option-label":d=>d[18],"display-value":e.classification?`${e.classification[18]}`:"",error:!!e.errors.classification,"bottom-slots":"",disable:!e.craft},{error:c(()=>[l("div",It,v(e.errors.classification),1)]),_:1},8,["modelValue","options","option-label","display-value","error","disable"])])]),l("div",Dt,[l("div",kt,[i(ee,{dense:"",type:"number",label:"Quantity",modelValue:e.qty,"onUpdate:modelValue":t[2]||(t[2]=d=>e.qty=d),modelModifiers:{number:!0},error:!!e.errors.qty,disable:!e.classification,"bottom-slots":""},{error:c(()=>[l("div",Vt,v(e.errors.qty),1)]),_:1},8,["modelValue","error","disable"])]),l("div",Ot,[i(a,{class:"q-mb-md",type:"number",step:"any",dense:"",label:"Hourly Rate",modelValue:e.rate,"onUpdate:modelValue":t[3]||(t[3]=d=>e.rate=d),modelModifiers:{number:!0},prefix:"$",disable:!e.classification||e.classification.hasFixedRate&&!e.$can("manage","rates"),error:!!e.errors.rate,"error-message":e.errors.rate,"bottom-slots":""},null,8,["modelValue","disable","error","error-message"])])])]),_:1}),i(G,{align:"right"},{default:c(()=>[i(q,{dense:"",color:"accent",label:"Reset",onClick:e.resetForm},null,8,["onClick"]),i(q,{dense:"",color:"primary",label:"Save",type:"submit",onClick:e.submit},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),l("div",Tt,[i(u,{rows:e.getV3Data.classifications,onRemoveClassification:e.removeClassification},null,8,["rows","onRemoveClassification"])])])]),_:1}),i(G,{class:"q-pb-none",align:"right"},{default:c(()=>[e.request?X("",!0):(h(),E(q,{key:0,color:"secondary",label:"Back",onClick:t[4]||(t[4]=d=>e.$emit("changeStep",1))})),i(q,{color:"info",label:"Continue",disable:e.getV3Data.classifications.length===0,onClick:e.nextStep},null,8,["disable","onClick"])]),_:1})]),_:1})])}var At=J(wt,[["render",Rt]]);const _t={emits:["removeName","viewEmployee"],props:{data:Array},components:{},setup(e,{emit:t}){const s=[{name:1,label:"Name",align:"left",field:n=>n.firstName,format:(n,p)=>`${n} ${p.lastName}`,sortable:!0},{name:2,label:"Phone",align:"left",field:n=>n.phoneNumber,format:n=>`${r(n)}`,sortable:!0,required:!0},{name:3,label:"Last 4",align:"left",field:n=>n.ssn,format:n=>`${n}`,sortable:!0},{name:4,label:"Classification",align:"left",field:n=>n.job.classification[18],format:n=>`${n}`,sortable:!0,required:!0},{name:6,label:"",align:"center",field:""}],o=n=>{t("viewEmployee",n)},r=n=>{const a=(""+n).replace(/\D/g,"").match(/^(\d{3})(\d{3})(\d{4})$/);return a?`(${a[1]}) ${a[2]}-${a[3]}`:null};return{props:e,columns:s,viewEmployee:o,formatPhone:r}}},Et={class:"full-width row flex-center text-primary q-gutter-sm q-py-xs"};function Ft(e,t,s,o,r,n){return h(),B("div",null,[i(De,ve(e.$attrs,{dense:"",title:e.$attrs.title?e.$attrs.title:"People","title-class":e.$attrs.titleClass?e.$attrs.titleClass:(e.$q.screen.gt.sm,"text-primary text-body1"),columns:o.columns,rows:o.props.data,"row-key":p=>p.ssn,pagination:{rowsPerPage:10},"table-header-class":"bg-dark text-white","no-data-label":"No People Added","hide-pagination":!0}),ge({"no-data":c(({message:p})=>[l("div",Et,[i(Ce,{size:"2em",name:"fa-solid fa-person-circle-exclamation"}),l("span",null,v(p),1)])]),_:2},[e.$attrs.hideRemove?void 0:{name:"body-cell-6",fn:c(p=>[i(Ie,{class:"text-center","auto-width":""},{default:c(()=>[i(q,{flat:"",color:"accent",round:"",dense:"",onClick:a=>e.$emit("removeName",p.row),icon:"delete_forever"},null,8,["onClick"])]),_:2},1024)]),key:"0"}]),1040,["title","title-class","columns","rows","row-key"])])}var Te=J(_t,[["render",Ft]]);const Lt=oe({emits:["changeStep"],props:{},components:{ClassificationsTable:Oe,NamesTable:Te},setup(e,{emit:t}){const s=be(),o=Pe(),r=Ne(),{capitalize:n}=ze,{getUserType:p}=k(),a=ae(),{getV3Data:u}=Qe(a),d=u.value.general?u.value.general:null,f=C(()=>u.value.matches?u.value.matches:null),y=C(()=>u.request?u.request:null),L=C(()=>u.value.classifications.filter($=>$.match)),N=C(()=>u.value.classifications.filter($=>!$.match)),S=m=>{const $=m.split(" ");let Y="";return $.forEach((K,re)=>{Y+=re>0?` ${n(K.toLowerCase())}`:n(K.toLowerCase())}),Y},R=C(()=>f.value?y.value?[{label:"Request Number",value:y.value[3]},{label:"Date Submitted",value:g(y.value[1].$d).format("MM/DD/YYYY")},{label:"Hiring Center",value:y.value[103]},{label:"Current Status",value:y.value[14]}]:null:[{label:"Request Number",value:f.value[3]},{label:"Date Submitted",value:g(f.value[1].$d).format("MM/DD/YYYY")},{label:"Hiring Center",value:f.value[103]},{label:"Current Status",value:f.value[14]}]),M=C(()=>{let m;return d?m=[{label:"Project",value:u.value.project?u.value.project[43]:"N/A"},{label:"Date Needed",value:g(d.dateNeeded).format("MM/DD/YYYY")},{label:"Request Reason",value:d.reason.label},{label:"Request Type",value:d.restriction.value},{label:"Job Number",value:d.jobNumber[11]},{label:"Meeting Location",value:S(d.meetingLocation[6])},{label:"Meeting Location Address",value:d.meetingLocation[7]},{label:"Site Contact",value:S(d.siteContact[17])},{label:"Per Diem",value:d.perDiem?d.perDiem[20]:"N/A"},{label:"Notes",value:d.notes}]:m=[],m});return{getV3Data:u,details:M,matchDetails:R,changeStep:()=>{y.value?y.value[282]!=="Open"?t("changeStep",1):t("changeStep",0):d.restriction.value!=="Open"?t("changeStep",3):t("changeStep",2)},submitRequest:async()=>{const m=o.params.project?{name:"project-requests",params:{id:o.params.project}}:p==="Project User"?{name:"requests"}:null;s.loading.show({message:"Submitting Request Now"});try{const{data:$}=await Ke({data:u.value});s.loading.hide(),s.notify({type:"positive",message:f.value?"Hire Request successfully updated":"Hire Request successfully added"}),m?r.replace({name:"hire-request",params:{id:$[3]}}):window.close(),a.$reset()}catch{s.loading.hide(),s.notify({type:"negative",message:"There was a problem add request"})}},match:f,classWithMatch:L,classNoMatch:N}}}),Mt=l("div",{class:"text-body2 text-italic text-weight-bold text-dark"}," Review the information below. If changes are needed, click Back. If all information is correct, click Submit to complete this request. ",-1),Bt={class:"row"},Ut={class:"col-12 col-md-6 q-pr-md"},Qt=l("div",{class:"text-body1 text-primary text-weight-bold"},"General Information",-1),Xt={class:"row"},zt={class:"col-12 col-md-4"},Ht={class:"text-weight-bold text-caption"},Yt={class:"col-12 col-md-8"},Wt={class:"text-dark text-caption"},Jt={class:"col-12 col-md-6 q-pl-md"},Gt={key:1,class:"row justify-center"},Zt={class:"col-12 col-md-10"},Kt=l("div",{class:"text-primary text-h6 text-weight-bold"},"Matching Request Found",-1),xt=l("div",{class:"text-body2 text-italic"}," The information that you entered on this request matches another request that you submitted recently. ",-1),es=l("div",{style:{"text-decoration":"underline"},class:"text-body2 text-accent text-italic"},"This request will be updated with the below classification and name changes, where applicable.",-1),ts={class:"row q-mb-md"},ss={key:0,class:"col-12 col-md-3 q-pr-sm"},os={class:"row q-mt-md"},as={class:"col-12 col-md-6 q-pr-md"},rs={class:"col-12 col-md-6 q-pl-md"};function is(e,t,s,o,r,n){const p=U("classifications-table"),a=U("names-table");return h(),B("div",null,[e.match?(h(),B("div",Gt,[l("div",Zt,[i(H,null,{default:c(()=>[i(V,null,{default:c(()=>[Kt,xt,es]),_:1}),i(V,{class:"q-py-none"},{default:c(()=>[l("div",ts,[(h(!0),B(me,null,we(e.matchDetails,(u,d)=>(h(),B(me,{key:d},[u.hide?X("",!0):(h(),B("div",ss,[l("div",{class:Se(["text-weight-bold",e.$q.screen.gt.lg?"text-body2":"text-caption"])},v(u.label),3),l("div",{class:Se(["q-pl-sm text-weight-light",e.$q.screen.gt.lg?"text-body2":"text-caption"])},v(u.value),3)]))],64))),128))]),i(Xe),l("div",os,[l("div",as,[e.classWithMatch.length>0?(h(),E(p,{key:0,class:"q-mb-md",matchTable:!0,titleClass:"text-body1 text-accent",title:"Classifications to Update",hideRemove:!0,rows:e.classWithMatch},null,8,["rows"])):X("",!0),e.classNoMatch.length>0?(h(),E(p,{key:1,titleClass:"text-body1 text-dark",title:e.match?"Classifications to Add":"Classifications",hideRemove:!0,rows:e.classNoMatch},null,8,["title","rows"])):X("",!0)]),l("div",rs,[e.getV3Data.names.length>0?(h(),E(a,{key:0,titleClass:"text-body1 text-primary",title:"People to Add",hideRemove:!0,data:e.getV3Data.names},null,8,["data"])):X("",!0)])])]),_:1}),i(G,{align:"right"},{default:c(()=>[i(q,{color:"secondary",label:"Back",onClick:e.changeStep},null,8,["onClick"]),i(q,{color:"info",label:"Submit",onClick:e.submitRequest},null,8,["onClick"])]),_:1})]),_:1})])])):(h(),E(H,{key:0,flat:""},{default:c(()=>[i(V,{class:"q-pt-none q-px-none"},{default:c(()=>[Mt]),_:1}),i(V,{class:"q-px-none q-pt-none"},{default:c(()=>[l("div",Bt,[l("div",Ut,[i(H,null,{default:c(()=>[i(V,{class:"q-pa-sm"},{default:c(()=>[Qt]),_:1}),(h(!0),B(me,null,we(e.details,(u,d)=>(h(),E(V,{key:d,class:"q-pa-sm"},{default:c(()=>[l("div",Xt,[l("div",zt,[l("div",null,[l("span",Ht,v(u.label),1)])]),l("div",Yt,[l("div",null,[l("span",Wt,v(u.value===""?"N/A":u.value),1)])])])]),_:2},1024))),128))]),_:1})]),l("div",Jt,[e.classNoMatch.length>0?(h(),E(p,{key:0,class:"q-mb-md",titleClass:"text-body1 text-primary text-weight-bold",title:e.match?"Classifications to Add":"Classifications",hideRemove:!0,rows:e.classNoMatch},null,8,["title","rows"])):X("",!0),e.match&&e.classWithMatch.length>0?(h(),E(p,{key:1,matchTable:!0,class:"q-mb-md",titleClass:"text-body1 text-primary text-weight-bold",title:"Classifications to Update",hideRemove:!0,rows:e.classWithMatch},null,8,["rows"])):X("",!0),e.getV3Data.names.length>0?(h(),E(a,{key:2,class:"q-mb-md",titleClass:"text-body1 text-primary text-weight-bold",title:"People",hideRemove:!0,data:e.getV3Data.names},null,8,["data"])):X("",!0),i(G,{class:"q-pb-none q-pt-lg q-px-none",align:"right"},{default:c(()=>[i(q,{color:"secondary",label:"Back",onClick:e.changeStep},null,8,["onClick"]),i(q,{color:"info",label:"Submit",onClick:e.submitRequest},null,8,["onClick"])]),_:1})])])]),_:1})]),_:1}))])}var ns=J(Lt,[["render",is]]);const ls=oe({emits:["changeStep"],props:{},components:{NamesTable:Te},setup(e,{emit:t}){const s=z(10),{getV3Data:o,setV3Data:r,getV3Options:n,setV3Options:p}=ae();o.general&&o.general;const a=C(()=>{const m=new RegExp("^[0-9]{"+s.value+"}","g");return F({job:F().required("Classification is required"),firstName:ne().required().label("First Name"),lastName:ne().required().label("Last Name"),phoneNumber:ne().matches(m,{excludeEmptyString:!0,message:"Number Only!"}).required().label("Phone Number"),ssn:ne().matches(/^\d+$/,{excludeEmptyString:!0,message:"Numbers Only!"}).label("Last 4 of SSN")})}),{errors:u,handleSubmit:d,resetForm:f,isSubmitting:y}=de({validationSchema:a,initialValues:{job:o.classifications.length===1?o.classifications[0]:null}}),{value:L}=j("job"),{value:N}=j("firstName"),{value:S}=j("lastName"),{value:R}=j("phoneNumber"),{value:M}=j("ssn");return{submit:d(m=>{console.log(m);const $=o.names.length+1;m.id=$,r({prop:"names",data:m,push:!0}),f()}),resetForm:f,errors:u,getV3Data:o,job:L,firstName:N,lastName:S,phoneNumber:R,ssn:M,removeName:m=>{const $=o.names.filter(Y=>Y.id!==m.id);r({prop:"names",data:$,push:!1})}}}}),cs={class:"row justify-between"},us={class:"col-12 col-md-6 q-pr-md"},ds=l("div",{class:"text-body2 text-italic text-weight-bold text-dark"}," Enter the following information about the people and click Save. Repeat until all people you are requesting have been saved. Then click Continue. You may also skip adding names if you do not have them yet. ",-1),ps={class:"row q-mb-md"},fs={class:"col-6"},ms={class:"text-caption"},hs={class:"row"},bs={class:"col-6 q-pr-sm"},gs={class:"text-caption"},vs={class:"col-6 q-pl-sm"},qs={class:"text-caption"},ys={class:"row"},ws={class:"col-6 q-pr-sm"},Ss={class:"text-caption"},$s={class:"col-6 q-pl-sm"},js={class:"text-caption"},Cs={class:"col-12 col-md-6 q-pl-md"};function Ps(e,t,s,o,r,n){const p=U("names-table");return h(),B("div",null,[i(H,{flat:""},{default:c(()=>[i(V,{class:"q-px-none q-pt-none"},{default:c(()=>[l("div",cs,[l("div",us,[i(ue,{onSubmit:ce(e.submit,["prevent"])},{default:c(()=>[i(H,null,{default:c(()=>[i(V,null,{default:c(()=>[ds,l("div",ps,[l("div",fs,[i(se,{class:"q-mt-md",dense:"",clearable:"","transition-show":"flip-up","transition-hide":"flip-down",label:"Classification",modelValue:e.job,"onUpdate:modelValue":t[0]||(t[0]=a=>e.job=a),options:e.getV3Data.classifications,"option-label":a=>a.classification[18],"display-value":e.job?`${e.job.classification[18]}`:"",error:!!e.errors.job,"bottom-slots":""},{error:c(()=>[l("div",ms,v(e.errors.job),1)]),_:1},8,["modelValue","options","option-label","display-value","error"])])]),l("div",hs,[l("div",bs,[i(ee,{dense:"",type:"text",label:"First Name",modelValue:e.firstName,"onUpdate:modelValue":t[1]||(t[1]=a=>e.firstName=a),error:!!e.errors.firstName,"bottom-slots":""},{error:c(()=>[l("div",gs,v(e.errors.firstName),1)]),_:1},8,["modelValue","error"])]),l("div",vs,[i(ee,{dense:"",type:"text",label:"Last Name",modelValue:e.lastName,"onUpdate:modelValue":t[2]||(t[2]=a=>e.lastName=a),error:!!e.errors.lastName,"bottom-slots":""},{error:c(()=>[l("div",qs,v(e.errors.lastName),1)]),_:1},8,["modelValue","error"])])]),l("div",ys,[l("div",ws,[i(ee,{dense:"",type:"tel",label:"Phone Number",modelValue:e.phoneNumber,"onUpdate:modelValue":t[3]||(t[3]=a=>e.phoneNumber=a),error:!!e.errors.phoneNumber,"bottom-slots":""},{error:c(()=>[l("div",Ss,v(e.errors.phoneNumber),1)]),_:1},8,["modelValue","error"])]),l("div",$s,[i(ee,{dense:"",maxlength:"4",label:"SSN Last 4 (Optional)",modelValue:e.ssn,"onUpdate:modelValue":t[4]||(t[4]=a=>e.ssn=a),error:!!e.errors.ssn,"bottom-slots":""},{error:c(()=>[l("div",js,v(e.errors.ssn),1)]),_:1},8,["modelValue","error"])])])]),_:1}),i(G,{align:"right"},{default:c(()=>[i(q,{dense:"",color:"accent",label:"Reset",onClick:e.resetForm},null,8,["onClick"]),i(q,{dense:"",color:"primary",label:"Save",type:"submit",onClick:e.submit},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),l("div",Cs,[i(p,{data:e.getV3Data.names,onRemoveName:e.removeName},null,8,["data","onRemoveName"])])])]),_:1}),i(G,{class:"q-pb-none",align:"right"},{default:c(()=>[i(q,{color:"secondary",label:"Back",onClick:t[5]||(t[5]=a=>e.$emit("changeStep",2))}),i(q,{color:"info",label:e.getV3Data.names.length===0?"Skip Names":"Continue",onClick:t[6]||(t[6]=a=>e.$emit("changeStep",4))},null,8,["label"])]),_:1})]),_:1})])}var Ns=J(ls,[["render",Ps]]);const Is=oe({components:{GeneralStep:gt,ClassificationsStep:At,ReviewStep:ns,NamesStep:Ns},setup(){const e=be(),t=Pe(),s=Ne(),o=z(0),r=z(null),n=z(null),p=z(null),a=z(null),{getV3Data:u,setV3Data:d,setV3Options:f,getV3Options:y,resetV3Data:L}=ae(),{userData:N,getUserType:S,userOffices:R,userProjects:M}=k(),{getProjects:I,fetchAllProjects:Z}=ke(),{getViewedProjects:m,setViewedProjects:$}=We(),Y=F({projectSelection:F().required().nullable().label("Project")}),{errors:K,handleSubmit:re}=de({validationSchema:Y}),{value:w}=j("projectSelection"),Q=re(D=>{d({prop:"project",data:D.projectSelection}),A(1)}),b=()=>{e.dialog({title:"Confirm",message:"Are you sure you want to cancel this new request?",persistent:!0,cancel:!0}).onOk(()=>{L(),t.params.project?s.replace({name:"project-general",params:{id:t.params.project}}):s.replace({name:"requests"})})},x=C(()=>u),A=D=>{D===2&&W(),o.value=D},W=async()=>{const{project:D}=u,{jobNumber:_,siteContact:Ee,perDiem:qe,meetingLocation:Fe,restriction:Le}=u.general,{data:ye}=await P.fetchFromProjectsApp({fields:[te({type:"requests",query:`({'1'.IR.'today'}OR{'1'.IR.'last 3 d'})AND{'282'.EX.'${Le.value}'}AND{'180'.XEX.'Shared'}AND{'14'.XEX.'Closed'}AND{'14'.XEX.'Cancelled'}AND{'6'.EX.'${D[3]}'}AND{'31'.EX.'${Fe[3]}'}AND{'9'.EX.'${_[3]}'}AND{'60'.EX.'${Ee[3]}'}${qe?`AND{'65'.EX.'${qe[3]}'}`:""}`})]}),fe=ye.length>0?ye.sort((Me,Be)=>Me[1].$d>Be[1].$d?-1:1):null;fe&&(console.log(fe[0]),d({prop:"matches",data:fe[0]}))};C(()=>R());const pe=C(()=>M()),Re=C(()=>{const D=[];return pe.value.forEach(_=>{D.push(_.project)}),I().forEach(_=>{D.push(_)}),[...new Map(D.map(_=>[_[3],_])).values()]}),Ae=async()=>{S==="Project User"?pe.value.length>0&&f({prop:"projects",data:pe.value}):S==="QuickBase User"&&(I().length>0?y.projects.length!==I().length&&f({prop:"projects",data:I()}):(await Z(),I().length>0&&y.projects.length!==I().length&&f({prop:"projects",data:I()})))},_e=async D=>{if(m(D))d({prop:"project",data:m(D)}),f({prop:"projects",data:[m(D)]}),w.value=m(D),A(1);else{e.loading.show();const{data:_}=await P.fetchFromProjectsApp({fields:[te({type:"projects",id:D})]});console.log(_),d({prop:"project",data:_}),f({prop:"projects",data:[_]}),$({id:t.params.project,data:_}),w.value=_,A(1),e.loading.hide()}};return t.params.project?_e(t.params.project):Ae(),{step:o,changeStep:A,general:r,classifications:n,names:p,match:a,data:x,allProjects:Re,formErrors:K,projectSelection:w,submit:Q,cancelNew:b,getV3Data:u}}}),Ds=l("div",{class:"text-h6 text-info"},"Add a New Hire Request",-1),ks=l("div",{class:"text-body2 text-dark text-italic"},"Complete the steps below to submit a new hire request.",-1),Vs=l("div",{class:"text-body2 text-italic text-weight-bold text-dark"},"Please select the project that this request is for.",-1),Os={class:"text-caption"};function Ts(e,t,s,o,r,n){const p=U("general-step"),a=U("classifications-step"),u=U("names-step"),d=U("review-step");return h(),B("div",null,[i(H,{flat:""},{default:c(()=>[i(V,{class:"q-py-sm"},{default:c(()=>[Ds,ks]),_:1}),i(V,{class:"q-pa-none"},{default:c(()=>[i(He,{flat:"",modelValue:e.step,"onUpdate:modelValue":t[1]||(t[1]=f=>e.step=f),color:"info","active-icon":"build","done-icon":"task_alt","active-color":"accent","done-color":"info",animated:""},{default:c(()=>[i(ie,{name:0,title:e.getV3Data.project?e.getV3Data.project[20]:"Select Project",prefix:"1",done:e.step>0},{default:c(()=>[i(ue,{onSubmit:ce(e.submit,["prevent"])},{default:c(()=>[i(H,{flat:""},{default:c(()=>[i(V,{class:"q-pt-none q-px-none"},{default:c(()=>[Vs]),_:1}),i(V,{class:"q-pa-none"},{default:c(()=>[i(se,{dense:"",label:"Select Project","transition-show":"flip-up","transition-hide":"flip-down",modelValue:e.projectSelection,"onUpdate:modelValue":t[0]||(t[0]=f=>e.projectSelection=f),options:e.allProjects,"option-value":"3","option-label":"20","display-value":e.projectSelection?e.projectSelection[20]:"",error:!!e.formErrors.projectSelection,"bottom-slots":"",style:{width:"500px"}},{error:c(()=>[l("div",Os,v(e.formErrors.projectSelection),1)]),_:1},8,["modelValue","options","display-value","error"])]),_:1}),i(G,{align:"right"},{default:c(()=>[i(q,{color:"secondary",label:"Cancel",onClick:e.cancelNew},null,8,["onClick"]),i(q,{color:"info",label:"Continue",type:"submit",onClick:e.submit},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1},8,["title","done"]),i(ie,{name:1,title:"General Information",prefix:"2",done:e.step>1},{default:c(()=>[i(p,{onChangeStep:e.changeStep},null,8,["onChangeStep"])]),_:1},8,["done"]),i(ie,{name:2,title:e.step===2?"Add Classifications":e.step>2?"Classifications Added":"Classifications",prefix:"3",done:e.step>2},{default:c(()=>[i(a,{onChangeStep:e.changeStep},null,8,["onChangeStep"])]),_:1},8,["title","done"]),e.data.general&&e.data.general.restriction.value!=="Open"?(h(),E(ie,{key:0,name:3,title:e.step===3?"Add Names":"Names",prefix:e.data.general&&e.data.general.restriction.value!=="Open"?"4":"",done:e.step>3},{default:c(()=>[i(u,{onChangeStep:e.changeStep},null,8,["onChangeStep"])]),_:1},8,["title","prefix","done"])):X("",!0),i(ie,{name:4,title:"Review",prefix:e.data.general&&e.data.general.restriction.value!=="Open"?"5":"4",done:e.step>4},{default:c(()=>[i(d,{onChangeStep:e.changeStep},null,8,["onChangeStep"])]),_:1},8,["prefix","done"])]),_:1},8,["modelValue"])]),_:1})]),_:1})])}var Rs=J(Is,[["render",Ts]]);const As={name:"New Request",components:{RequestFormStepper:Rs},setup(){be();const{userOffices:e,userProjects:t}=k(),{getProjects:s,fetchAllProjects:o}=ke(),{setNewRequestData:r,getDbData:n,getHumanizedData:p,getHumanizedClassificationData:a}=ae(),u=z(0),d=z(!1);C(()=>e());const f=C(()=>t()),y=C(()=>{const N=[];return f.value.forEach(S=>{N.push(S.project)}),s().forEach(S=>{N.push(S)}),[...new Map(N.map(S=>[S[3],S])).values()]});function L(){(u.value>1||y.value.length>1)&&(u.value=u.value-1)}return he(y,(N,S)=>{if(N.length===1){u.value=1;const R={6:{value:N[0][3]},92:{value:N[0][12]}},M={project:N[0]};r({humanized:M,database:R})}}),he(u,()=>{console.log(p),console.log(a)}),{allProjects:y,step:u,goBack:L,getDbData:n,showCart:d}}},_s={class:"q-pa-sm"};function Es(e,t,s,o,r,n){const p=U("request-form-stepper");return h(),E(Ue,{style:{"max-width":"100vw"}},{default:c(()=>[l("div",_s,[i(p)])]),_:1})}var go=J(As,[["render",Es]]);export{go as default};
