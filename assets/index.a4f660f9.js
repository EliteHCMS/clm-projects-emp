import{Q as C,a as z,b as h}from"./QTabPanels.7f2b2f83.js";import{Q as I}from"./QTabs.3a560d12.js";import{Q as L}from"./QSpace.b3c62d84.js";import{l as w,r as j,bX as y,c as v,_ as N,b7 as f,B as _,C as D,d as o,bt as l,cW as Q,E as $,cV as V,z as U,bV as E,as as g,at as S,bY as X}from"./index.960d5b34.js";import{Q as K}from"./QToolbar.6b905ef4.js";import{Q as M}from"./QPage.8d15663e.js";import{u as T}from"./use-quasar.09536e80.js";import{u as k}from"./dataStore.1da58b7a.js";import{c as O,u as W,q as Y}from"./app.bda2cd70.js";import{R as G,a as H}from"./requestDataAlt.e2ee6bff.js";import{_ as A}from"./projectSelector.32d51d56.js";import{dayjs as J}from"./dayjs.501e8a8e.js";import{N as Z}from"./nameRequestData.c1c525cd.js";import"./use-panel.98705a6b.js";import"./touch.3df10340.js";import"./selection.4cab378b.js";import"./QResizeObserver.b1215cec.js";import"./rtl.b51694b1.js";import"./localForage.84a30b23.js";import"./_commonjsHelpers.a26ce4be.js";import"./index.04bc0a32.js";import"./i18n.2abc02f2.js";import"./QTd.e3f90e32.js";import"./QTable.2cc075de.js";import"./QList.c2993b6b.js";import"./QMarkupTable.17a90ccc.js";import"./QSelect.ce23f885.js";import"./QChip.e4d2f168.js";import"./QMenu.dd57348b.js";import"./position-engine.40859e34.js";import"./use-fullscreen.7e074d8e.js";import"./QSpinnerGears.4fd5f8fe.js";import"./QTooltip.7454b396.js";import"./useQuerySaver.d29ff9ee.js";import"./dataStore.d3a4115a.js";const x=w({props:{},components:{RequestDataTable:G,projectSelector:A},setup(e){const t=T(),u=O(),m=j(null),{getSelectedProject:c}=y(u),{getOpenRequest:p,fetchOpenRequest:a,fetchAllOpenRequest:n}=k(),s=v(()=>c.value?c.value[3]:null),i=v(()=>p(s.value).sort((r,R)=>r[1].$d<R[1].$d?1:-1));async function q(r){t.loading.show(),s.value?await a({projectId:s.value,refresh:r}):await n({refresh:r}),t.loading.hide()}return q(!1),{openRequests:i,projectFilter:m,loadData:q}}}),ee={class:"row items-center"},te={class:"col-12 col-md-4"};function oe(e,t,u,m,c,p){const a=f("projectSelector"),n=f("request-data-table");return _(),D("div",null,[o(V,{flat:""},{default:l(()=>[o(Q,null,{default:l(()=>[$("div",ee,[$("div",te,[o(a,{dense:""})])])]),_:1})]),_:1}),o(n,{requests:e.openRequests,status:"Open",onRefreshData:t[0]||(t[0]=s=>e.loadData(!0))},null,8,["requests"])])}var ae=N(x,[["render",oe]]);const se=w({props:{},components:{RequestDataTableAlt:H,projectSelector:A},setup(e){const t=T(),u=O(),m=j(null),{getSelectedProject:c}=y(u),{getClosedRequest:p,fetchClosedRequest:a,fetchAllClosedRequest:n}=k(),s=v(()=>c.value?c.value[3]:null),i=v(()=>p(s.value).sort((r,R)=>r[1].$d<R[1].$d?1:-1));async function q(r){t.loading.show(),s.value?await a({projectId:s.value,refresh:r}):await n({refresh:r}),t.loading.hide()}return q(),{closedRequests:i,projectFilter:m,loadData:q}}}),ne={class:"row items-center"},re={class:"col-12 col-md-4"};function le(e,t,u,m,c,p){const a=f("projectSelector"),n=f("request-data-table-alt");return _(),D("div",null,[o(V,{flat:""},{default:l(()=>[o(Q,null,{default:l(()=>[$("div",ne,[$("div",re,[o(a,{dense:""})])])]),_:1})]),_:1}),o(n,{requests:e.closedRequests,status:"Completed",onRefreshData:t[0]||(t[0]=s=>e.loadData(!0))},null,8,["requests"])])}var ue=N(se,[["render",le]]);const ce=w({props:{},components:{NameRequestDataTable:Z,projectSelector:A},setup(e){const t=T(),u=O(),{capitalize:m}=U,c=j(null),{userData:p}=W(),{getSelectedProject:a}=y(u),{getNameRequest:n,fetchAllNameRequest:s,removeData:i,fetchNameRequest:q}=k(),r=v(()=>a.value?a.value[3]:null),R=v(()=>n(r.value).sort((d,b)=>d[1].$d<b[1].$d?1:-1));async function P(d){t.loading.show(),r.value?await q({projectId:r.value,refresh:d}):await s({refresh:d}),t.loading.hide()}function B(d){return`${m(d[6].toLowerCase())} ${m(d[7].toLowerCase())}`}async function F(d){t.dialog({title:"Confirm",message:`Are you sure you want to remove ${B(d)} from request# ${d[18]}?`,cancel:!0,persistent:!0}).onOk(async()=>{try{const{data:b}=await Y.upsertRecordsXML({to:"bsg4yb4wa",data:[{3:{value:d[3]},11:{value:!0},12:{value:J().tz("America/Chicago")},13:{value:`${p[35]} ${p[37]}`}}],fieldsToReturn:[15],formatObject:15});i({type:"nameRequest",key:b[0][15][38],item:b[0][15],storageKey:"storageNameRequest"})}catch(b){t.notify({type:"negative",message:"Cannot remove name request"}),console.log(b)}})}return P(),{nameRequests:R,projectFilter:c,removeName:F,loadData:P}}}),de={class:"row items-center"},me={class:"col-12 col-md-4"};function pe(e,t,u,m,c,p){const a=f("projectSelector"),n=f("name-request-data-table");return _(),D("div",null,[o(V,{flat:""},{default:l(()=>[o(Q,null,{default:l(()=>[$("div",de,[$("div",me,[o(a,{dense:""})])])]),_:1})]),_:1}),o(n,{requests:e.nameRequests,status:"Named",onRemoveName:e.removeName,onRefreshData:t[0]||(t[0]=s=>e.loadData(!0))},null,8,["requests","onRemoveName"])])}var ie=N(ce,[["render",pe]]);const fe=w({name:"Requests",components:{OpenTab:ae,CompleteTab:ue,NamesTab:ie},setup(){const e=E(),t=j(0);function u(){e.push({name:"new-request"})}return{tab:t,addNewRequest:u}}}),qe={class:"q-pa-md"};function _e(e,t,u,m,c,p){const a=f("open-tab"),n=f("names-tab"),s=f("complete-tab");return _(),g(M,{style:{"max-width":"100vw"}},{default:l(()=>[$("div",qe,[o(K,{class:"bg-info text-white shadow-2 rounded-borders"},{default:l(()=>[o(I,{modelValue:e.tab,"onUpdate:modelValue":t[0]||(t[0]=i=>e.tab=i),"bg-color":"none","indicator-color":"accent",dense:e.$q.screen.lt.md},{default:l(()=>[o(C,{name:0,label:e.$q.screen.gt.xs?"Open Requests":"Open"},null,8,["label"]),e.$can("read","nameRequests")?(_(),g(C,{key:0,name:2,label:e.$q.screen.gt.xs?"Named Requests":"Named"},null,8,["label"])):S("",!0),e.$q.screen.gt.sm?(_(),g(C,{key:1,name:3,label:e.$q.screen.gt.xs?"Completed Requests":"Completed"},null,8,["label"])):S("",!0)]),_:1},8,["modelValue","dense"]),o(L),e.$can("create","projectRequests")?(_(),g(X,{key:0,dense:"",color:"accent",icon:"add",label:e.$q.screen.lt.md?"Add New":"Add New Request",onClick:e.addNewRequest},null,8,["label","onClick"])):S("",!0)]),_:1}),o(z,{modelValue:e.tab,"onUpdate:modelValue":t[1]||(t[1]=i=>e.tab=i),animated:""},{default:l(()=>[o(h,{name:0},{default:l(()=>[o(a)]),_:1}),o(h,{name:2},{default:l(()=>[o(n)]),_:1}),o(h,{name:3},{default:l(()=>[o(s)]),_:1})]),_:1},8,["modelValue"])])]),_:1})}var Ze=N(fe,[["render",_e]]);export{Ze as default};
