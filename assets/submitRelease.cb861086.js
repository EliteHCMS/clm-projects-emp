import{u as p,q as l}from"./app.58c96d85.js";import{dayjs as f}from"./dayjs.d6c6127f.js";import{u as T}from"./dataStore.fa4960b2.js";import{u as L}from"./dataStore.112f1173.js";import{k as M}from"./index.ed1cd1a8.js";const P=async({employee:a,assignment:e,effectiveNow:c,values:t,attachments:n,ratings:o,supervisor:s})=>{const{userData:i,getUserType:y}=p(),u=i;u.access&&delete u.access,u.permissions&&delete u.permissions;const R=[{12:{value:t.recommendation},25:{value:a[3]},28:{value:e[3]},30:{value:t.selection[10]},35:{value:e[142]},36:{value:t.effective},38:{value:JSON.stringify(u)},39:{value:y!=="QuickBase User"},60:{value:o.comments?o.comments:""},72:{value:t.equipment.value}}];if(c){const{ee:m,assign:r}=await S({assignment:e,supervisor:s}),{data:v}=await l.upsertRecordsXML({to:"bp3ga39ut",data:R,fieldsToReturn:[37],formatObject:37},{action:"create",type:"release"}),{release:d}=await O({release:v[0][37][3],employee:v[0][37][25],ratings:o,user:u,supervisor:s});if(n.length>0){const{docs:g}=await j({release:d,attachments:n,user:u});return d[70]=g.map(w=>w[12]),{release:d,employee:m,assignment:r,attachments:g}}else return{release:d,employee:m,assignment:r,attachments:[]}}else{const{data:m}=await l.upsertRecordsXML({to:"bp3ga39ut",data:R,fieldsToReturn:[37],formatObject:37},{action:"create",type:"release"});s&&X({assignment:e,supervisor:s});const{release:r}=await O({release:m[0][37][3],employee:m[0][37][25],ratings:o,user:u,supervisor:s});if(n.length>0){const{docs:v}=await j({release:r,attachments:n,user:u});return r[70]=v.map(d=>d[12]),{release:r,employee:a,assignment:e,attachments:v}}else return{release:r,employee:a,assignment:e,attachments:[]}}},O=async({release:a,employee:e,ratings:c,user:t,supervisor:n})=>{const o={6:{value:c.attendance},8:{value:c.attitude},10:{value:c.capability},12:{value:c.promotable},14:{value:c.comments?c.comments:""},16:{value:e},34:{value:a},36:{value:JSON.stringify(t)}};n&&Object.assign(o,{42:{value:n[18]}});const{data:s}=await l.upsertRecordsXML({to:"bqzkbcxup",data:[o],fieldsToReturn:[35],formatObject:35});return{release:s[0][35]}},j=async({release:a,attachments:e,user:c})=>{const t=[];e.forEach(o=>{Object.assign(o,{8:{value:JSON.stringify(c)},9:{value:a[3]},10:{value:a[25]}}),t.push(o)});const{data:n}=await l.upsertRecordsXML({to:"bsstsai5d",data:t,fieldsToReturn:[12],formatObject:12});return{docs:n}},S=async({assignment:a,supervisor:e,id:c})=>{const{removeData:t}=T(),{removeFromRoster:n}=L(),o={3:{value:c||a[3]},21:{value:"Complete"},22:{value:f()},165:{value:"Inactive"}};e&&e[3]&&Object.assign(o,{133:{value:e[3]?e[3]:""}});const{data:s}=await l.upsertRecordsXML({to:"bp3gazpqj",data:[o],fieldsToReturn:[110],formatObject:110});return n({id:s[0][110][74],data:s[0]}),t({type:"assignments",key:s[0][110][74],item:s[0][110],storageKey:M.storageAssignments}),{ee:await b({3:{value:s[0][110][18]},79:{value:19}}),assign:s[0][110]}},b=async a=>{const{data:e}=await l.upsertRecordsXML({to:"bp3gb7ng2",data:[a],fieldsToReturn:[549],formatObject:549});return e[0][549]},X=async({assignment:a,supervisor:e})=>{l.upsertRecordsXML({to:"bp3gazpqj",data:[{3:{value:a[3]},133:{value:e[3]?e[3]:""}}],fieldsToReturn:[110],formatObject:110})},z=async({release:a,disp:e})=>{const{userData:c}=p(),t=c;t.access&&delete t.access,t.permissions&&delete t.permissions;const n={3:{value:a[3]},42:{value:e.value==="Terminate"?"Reviewed":"Complete"},43:{value:e.value},73:{value:e.value==="Terminate"?"Pending":"Cancelled"},75:{value:JSON.stringify(t)},77:{value:f()}},o=e.value==="Terminate"?19:15,s=await b({3:{value:a[25]},79:{value:o},16:{value:a[35]}}),{data:i}=await l.upsertRecordsXML({to:"bp3ga39ut",data:[n],fieldsToReturn:[37],formatObject:37},{action:"update",type:"release"});return{release:i[0][37],employee:s}},C=async({release:a,fid:e,entryMoment:c,workdayData:t})=>{const{userData:n}=p(),o=e||37,s=n;s.access&&delete s.access,s.permissions&&delete s.permissions;const i=[{3:{value:a[3]},42:{value:"Complete"},73:{value:"Processed"},76:{value:JSON.stringify(s)},78:{value:f(c)||f()},106:{value:t?JSON.stringify(t):""}}];b({3:{value:a[25]},79:{value:""},122:{value:""}});const{data:y}=await l.upsertRecordsXML({to:"bp3ga39ut",data:i,fieldsToReturn:[o],formatObject:o},{action:"update",type:"release"});return{data:y[0][o]}},k=async({release:a,disp:e})=>{const{userData:c}=p(),t=c;t.access&&delete t.access,t.permissions&&delete t.permissions;const n={3:{value:a[3]},42:{value:"Rescinded"},43:{value:"Rescinded"},73:{value:"Not Processed"},75:{value:JSON.stringify(t)},77:{value:f()}},o={3:{value:a.assignment[3]},21:{value:"In Process"},22:{value:""},165:{value:"Active"},112:{value:!1}};await l.upsertRecordsXML({to:"bp3gazpqj",data:[o],fieldsToReturn:[110],formatObject:110});const s=await b({3:{value:a[25]},79:{value:7},16:{value:a[35]}}),{data:i}=await l.upsertRecordsXML({to:"bp3ga39ut",data:[n],fieldsToReturn:[37],formatObject:37},{action:"update",type:"release"});return{release:i[0][37],employee:s}};export{S as a,P as b,z as f,k as r,j as s,C as t};
