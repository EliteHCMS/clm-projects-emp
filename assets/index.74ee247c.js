import{Q as A}from"./QPage.4f87a96a.js";import{u as M,k as j,c1 as w,c4 as B,r as y,w as O,_ as S,z as r,A as _,C as n,aa as m,am as f,bh as o,d as s,c2 as u,d4 as U,cx as E,an as g,b$ as N,c6 as z,cy as F,c3 as $,c5 as H,aY as I}from"./index.d1324d55.js";import{q as Y,c as K,e as L,u as C,g as q}from"./quickbase.10256e61.js";import{u as P}from"./use-quasar.562e76c4.js";import"./_commonjsHelpers.dfee5925.js";import"./dayjs.2e060f83.js";import"./localForage.ef6397b3.js";import"./index.7dbe61ef.js";import"./i18n.424c44f0.js";import"./api.c49f1d19.js";const R=M("QRStore",{state:()=>({qr:{}}),getters:{getQR:e=>e.qr},actions:{async fetchQRData(e){const a=[{6:{value:"bskbpgnwb"},7:{value:"Table Record"},9:{value:e},14:{value:7}}],{data:t}=await Y.fetchFromStructureApp({fields:a});t&&(this.qr=t)}}}),W=j({setup(){const e=P(),{setEvent:a}=K(),{getQR:t}=w(R()),{employeeData:l,addMatrixToEmployee:d}=L(),{getUser:p}=C(),i=C(),V=B(),h=y(!1),Q=y(!1),v=y(""),k=y(""),D=async()=>{a(null),i.logout().then(()=>{V.replace({name:"login"})})};async function x(){const c={12:{value:l[3]},6:{value:t.value[17]},13:{value:t.value[16]},17:{value:t.value[14]},23:{value:t.value[3]},10:{value:`${p[35]} ${p[37]}`}};t.value[17]==="date"?Object.assign(c,{8:{value:v.value}}):t.value[17]==="checkbox"||t.value[20]?Object.assign(c,{9:{value:h.value}}):Object.assign(c,{7:{value:k.value}});try{const{data:b}=await Y.upsertRecordsXML({to:"bsi3t4bcz",data:[c],fieldsToReturn:[11],formatObject:11});b&&(d({data:{key:t.value[16],value:b[0][11]}}),Q.value=!0,setTimeout(function(){D()},5e3))}catch{e.notify({type:"negative",message:"There was a problem submitting"})}}O(h,(c,b)=>{c?v.value=q.formatDate(Date.now(),"YYYY-MM-DD"):v.value=""});function T(){l[t.value[16]]&&(Q.value=!0,setTimeout(function(){D()},5e3))}return T(),{getQR:t,confirmation:h,submitted:Q,submitAttendanceRecord:x,employeeData:l,completionDate:v,entryString:k,date:q}}}),X={class:"row justify-center q-mt-md"},G={class:"col-12 col-md-4 q-px-sm"},J={class:"text-primary text-h6 q-mb-md"},Z={class:"text-white text-body1"},ee={class:"text-dark text-body2"},te={key:0,class:"q-pt-md"},ae=n("div",{class:"text-white text-body1"},"Congratulations",-1),oe={class:"text-dark text-body2"},se=n("div",{class:"text-dark text-body2"},"You are done. You may close this screen.",-1),ne=n("div",{class:"text-primary text-body1"},"THANK YOU!",-1);function le(e,a,t,l,d,p){return r(),_("div",null,[n("div",X,[n("div",G,[n("div",J,"Welcome, "+m(e.employeeData[20])+"!",1),e.submitted?(r(),f($,{key:1,class:"text-center"},{default:o(()=>[s(u,{class:"bg-info"},{default:o(()=>[ae]),_:1}),s(u,null,{default:o(()=>[n("div",oe,"You have successfully submitted your attendance record for "+m(e.getQR[19])+" on "+m(e.date.formatDate(e.employeeData[e.getQR[16]][1].$d,"MM/DD/YYYY"))+".",1),se]),_:1}),s(u,null,{default:o(()=>[ne]),_:1})]),_:1})):(r(),f($,{key:0,class:"text-center"},{default:o(()=>[s(u,{class:"bg-info"},{default:o(()=>[n("div",Z,m(e.getQR[19]),1)]),_:1}),s(u,null,{default:o(()=>[n("div",ee,m(e.getQR[11]),1)]),_:1}),e.getQR[20]?(r(),f(u,{key:0},{default:o(()=>[n("div",null,[s(U,{modelValue:e.confirmation,"onUpdate:modelValue":a[0]||(a[0]=i=>e.confirmation=i),label:e.getQR[21]},null,8,["modelValue","label"])]),e.confirmation?(r(),_("div",te,[s(E,{type:"date",modelValue:e.completionDate,"onUpdate:modelValue":a[1]||(a[1]=i=>e.completionDate=i),label:"Date Completed","stack-label":""},null,8,["modelValue"])])):g("",!0)]),_:1})):g("",!0),s(N),s(F,{align:"right"},{default:o(()=>[e.getQR[20]?(r(),f(z,{key:0,color:"primary",label:"Submit",disable:e.getQR[20]&&(!e.confirmation||e.completionDate===""),onClick:e.submitAttendanceRecord},null,8,["disable","onClick"])):g("",!0)]),_:1})]),_:1}))])])])}var re=S(W,[["render",le]]);const ie={components:{QrDataCard:re},setup(){const e=H(),{fetchQRData:a}=R(),{getQR:t}=w(R());async function l(){const d=e.query.qr;await a(d)}return l(),{fetchQRData:a,getQR:t}}},ce={key:0};function ue(e,a,t,l,d,p){const i=I("qr-data-card");return r(),f(A,{style:{"max-width":"100vw"}},{default:o(()=>[l.getQR[3]?(r(),_("div",ce,[s(i)])):g("",!0)]),_:1})}var _e=S(ie,[["render",ue]]);export{_e as default};
