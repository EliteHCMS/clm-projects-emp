import{c as h,bX as je,i as Xe,n as He,dx as Le,h as J,bW as D,bQ as oe,cA as Oe,g as Ee,c0 as Ye,c3 as We,r as A,d8 as Ge,c8 as Ke,b0 as Ze,bY as xe,l as z,_ as U,b5 as L,A as u,B as N,d as o,br as n,D as m,ac as _,ar as C,cU as H,bO as qe,aq as y,cy as ge,G as Se,cT as O,F as te,b4 as le,cS as X,bT as me,ax as ye,y as Te,bV as Ue,bS as et,cV as ee,w as tt,H as at,bU as st}from"./index.90b022bc.js";import{Q as be,a as ot,b as pe}from"./QTabPanels.aca38a70.js";import{Q as lt}from"./QTabs.ded26a22.js";import{Q as Qe}from"./QPage.e74b7426.js";import{u as Y}from"./use-quasar.0a055ece.js";import{q as T,u as re,b as nt}from"./app.65ef9746.js";import{dayjs as G}from"./dayjs.a1ba429d.js";import{a as B,c as x,e as Pe}from"./array.59f93f43.js";import{a as ve,b as rt}from"./useQuerySaver.d29ff9ee.js";import{u as ae}from"./dataStore.03c8fc46.js";import{a as ne}from"./QSelect.09ac914d.js";import{Q as we}from"./QForm.72c95e2a.js";import{a as $e,u as M}from"./vee-validate.esm.56090d73.js";import{A as it,a as dt}from"./addNewCustomer.e3b971cc.js";import{Q as he,a as _e}from"./QTable.26950873.js";import{Q as ue}from"./QTr.3549f18b.js";import{Q as ce}from"./QTd.52255160.js";import{N as ut}from"./nameRequestData.4c22867d.js";import{P as ct}from"./projectPipeline.1a2ae5fb.js";import{u as Fe,P as mt,c as ft}from"./pay-rate-v2.ade70a59.js";import"./use-panel.84d3ce1b.js";import"./touch.70a9dd44.js";import"./selection.f9ac9cf5.js";import"./QResizeObserver.7163e2f6.js";import"./rtl.b51694b1.js";import"./_commonjsHelpers.a26ce4be.js";import"./localForage.be7a4e81.js";import"./api.893bf48a.js";import"./index.04bc0a32.js";import"./i18n.a8d34bee.js";import"./QChip.8f9b531e.js";import"./QMenu.9301279f.js";import"./position-engine.6cc4165f.js";import"./states.03e3d448.js";import"./QList.4306b48e.js";import"./QMarkupTable.8d6bc1cb.js";import"./use-fullscreen.edfc2da7.js";import"./QSpinnerGears.045d818b.js";import"./QTooltip.2c2cf2f4.js";import"./workday.987da2b4.js";import"./syncEmployeeWithWorkday.d8effdda.js";import"./workdayAPI.7485ed7b.js";import"./QInnerLoading.2696bd0e.js";import"./export-file.dc78ba05.js";const bt=["top","right","bottom","left"],Ie={type:{type:String,default:"a"},outline:Boolean,push:Boolean,flat:Boolean,unelevated:Boolean,color:String,textColor:String,glossy:Boolean,square:Boolean,padding:String,label:{type:[String,Number],default:""},labelPosition:{type:String,default:"right",validator:e=>bt.includes(e)},externalLabel:Boolean,hideLabel:{type:Boolean},labelClass:[Array,String,Object],labelStyle:[Array,String,Object],disable:Boolean,tabindex:[Number,String]};function Me(e,a){return{formClass:h(()=>`q-fab--form-${e.square===!0?"square":"rounded"}`),stacked:h(()=>e.externalLabel===!1&&["top","bottom"].includes(e.labelPosition)),labelProps:h(()=>{if(e.externalLabel===!0){const c=e.hideLabel===null?a.value===!1:e.hideLabel;return{action:"push",data:{class:[e.labelClass,`q-fab__label q-tooltip--style q-fab__label--external q-fab__label--external-${e.labelPosition}`+(c===!0?" q-fab__label--external-hidden":"")],style:e.labelStyle}}}return{action:["left","top"].includes(e.labelPosition)?"unshift":"push",data:{class:[e.labelClass,`q-fab__label q-fab__label--internal q-fab__label--internal-${e.labelPosition}`+(e.hideLabel===!0?" q-fab__label--internal-hidden":"")],style:e.labelStyle}}})}}const Be={start:"self-end",center:"self-center",end:"self-start"},pt=Object.keys(Be);var se=je({name:"QFabAction",props:{...Ie,icon:{type:String,default:""},anchor:{type:String,validator:e=>pt.includes(e)},to:[String,Object],replace:Boolean},emits:["click"],setup(e,{slots:a,emit:c}){const s=Xe(Le,()=>({showing:{value:!0},onChildClick:He})),{formClass:f,labelProps:p}=Me(e,s.showing),t=h(()=>{const v=Be[e.anchor];return f.value+(v!==void 0?` ${v}`:"")}),r=h(()=>e.disable===!0||s.showing.value!==!0);function l(v){s.onChildClick(v),c("click",v)}function V(){const v=[];return a.icon!==void 0?v.push(a.icon()):e.icon!==""&&v.push(J(oe,{name:e.icon})),(e.label!==""||a.label!==void 0)&&v[p.value.action](J("div",p.value.data,a.label!==void 0?a.label():[e.label])),Oe(a.default,v)}const k=Ee();return Object.assign(k.proxy,{click:l}),()=>J(D,{class:t.value,...e,noWrap:!0,stack:e.stacked,icon:void 0,label:void 0,noCaps:!0,fabMini:!0,disable:r.value,onClick:l},V)}});const vt=["up","right","down","left"],gt=["left","center","right"];var De=je({name:"QFab",props:{...Ie,...Ye,icon:String,activeIcon:String,hideIcon:Boolean,hideLabel:{default:null},direction:{type:String,default:"right",validator:e=>vt.includes(e)},persistent:Boolean,verticalActionsAlign:{type:String,default:"center",validator:e=>gt.includes(e)}},emits:We,setup(e,{slots:a}){const c=A(null),s=A(e.modelValue===!0),f=Ge(),{proxy:{$q:p}}=Ee(),{formClass:t,labelProps:r}=Me(e,s),l=h(()=>e.persistent!==!0),{hide:V,toggle:k}=Ke({showing:s,hideOnRouteChange:l}),v=h(()=>({opened:s.value})),R=h(()=>`q-fab z-fab row inline justify-center q-fab--align-${e.verticalActionsAlign} ${t.value}`+(s.value===!0?" q-fab--opened":" q-fab--closed")),S=h(()=>`q-fab__actions flex no-wrap inline q-fab__actions--${e.direction} q-fab__actions--${s.value===!0?"opened":"closed"}`),b=h(()=>{const w={id:f,role:"menu"};return s.value!==!0&&(w["aria-hidden"]="true"),w}),d=h(()=>`q-fab__icon-holder  q-fab__icon-holder--${s.value===!0?"opened":"closed"}`);function q(w,j){const P=a[w],F=`q-fab__${w} absolute-full`;return P===void 0?J(oe,{class:F,name:e[j]||p.iconSet.fab[j]}):J("div",{class:F},P(v.value))}function Q(){const w=[];return e.hideIcon!==!0&&w.push(J("div",{class:d.value},[q("icon","icon"),q("active-icon","activeIcon")])),(e.label!==""||a.label!==void 0)&&w[r.value.action](J("div",r.value.data,a.label!==void 0?a.label(v.value):[e.label])),Oe(a.tooltip,w)}return Ze(Le,{showing:s,onChildClick(w){V(w),c.value!==null&&c.value.$el.focus()}}),()=>J("div",{class:R.value},[J(D,{ref:c,class:t.value,...e,noWrap:!0,stack:e.stacked,align:void 0,icon:void 0,label:void 0,noCaps:!0,fab:!0,"aria-expanded":s.value===!0?"true":"false","aria-haspopup":"true","aria-controls":f,onClick:k},Q),J("div",{class:S.value,...b.value},xe(a.default))])}});const yt=z({emits:["cancelEdit"],components:{AddProjectLocationForm:it,AddCustomerForm:dt},props:{config:Object},setup(e,{emit:a}){const c=A(null),s=A(null),f=A(!1),p=async()=>{const{type:b,initialValue:d}=e.config;if(b==="options"){const{getter:q}=e.config;s.value=await q(),c.value=s.value,k.value=d(c.value)}else k.value=d},t=h(()=>B({entry:e.config.formRules})),{meta:r,errors:l,handleSubmit:V}=$e({validationSchema:t}),{value:k}=M("entry"),v=(b,d)=>{const{filter:q}=e.config;b===""&&d(()=>{c.value=s.value}),d(()=>{const Q=b.toLowerCase();c.value=q(s.value,Q)})},R=b=>{f.value=!1,s.value.push(b),c.value.push(b),k.value=b},S=V(async b=>{const{setter:d}=e.config;await d(b.entry),a("cancelEdit")});return p(),{rawOptions:s,options:c,entry:k,formErrors:l,formMeta:r,submit:S,filterOptions:v,addNew:f,newOptionAdded:R}}}),ht={key:0,class:"q-pr-xl"},qt={class:"text-caption"},wt={key:0,class:"text-center bg-info"},$t={key:0,class:"text-center bg-info"},Ct={key:1,class:"q-pr-xl"},Rt={class:"text-caption"};function kt(e,a,c,s,f,p){const t=L("add-project-location-form"),r=L("add-customer-form");return u(),N("div",null,[o(we,{onSubmit:qe(e.submit,["prevent"])},{default:n(()=>[e.config.type==="options"?(u(),N("div",ht,[o(ne,{class:"q-mb-sm",dense:"",label:`Select a ${e.config.fieldLabel}`,"transition-show":"flip-up","transition-hide":"flip-down",modelValue:e.entry,"onUpdate:modelValue":a[3]||(a[3]=l=>e.entry=l),options:e.options,"option-label":e.config.optionLabel,"display-value":`${e.entry?e.entry[e.config.displayValue]:""}`,"bottom-slots":"",error:!!e.formErrors.entry,"stack-label":"","use-input":"","input-debounce":"0",onFilter:e.filterOptions,clearable:"",loading:!e.rawOptions,disable:!e.rawOptions},{error:n(()=>[m("div",qt,_(e.formErrors.entry),1)]),after:n(()=>[o(D,{type:"submit",color:"info",icon:"done",dense:"",onClick:e.submit},null,8,["onClick"]),o(D,{color:"dark",icon:"close",dense:"",onClick:a[0]||(a[0]=l=>e.$emit("cancelEdit"))})]),"after-options":n(()=>[e.config.allowNew&&e.options&&e.options.length>0?(u(),N("div",wt,[o(D,{flat:"",color:"white",label:`Add a New ${e.config.fieldLabel}`,onClick:a[1]||(a[1]=l=>e.addNew=!0)},null,8,["label"])])):C("",!0)]),"no-option":n(()=>[e.config.allowNew?(u(),N("div",$t,[o(D,{flat:"",color:"white",label:`Add a New ${e.config.fieldLabel}`,onClick:a[2]||(a[2]=l=>e.addNew=!0)},null,8,["label"])])):C("",!0)]),_:1},8,["label","modelValue","options","option-label","display-value","error","onFilter","loading","disable"])])):C("",!0),e.config.type==="input"?(u(),N("div",Ct,[o(H,{class:"q-mb-sm",dense:"",label:e.config.fieldLabel,modelValue:e.entry,"onUpdate:modelValue":a[5]||(a[5]=l=>e.entry=l),"bottom-slots":"",error:!!e.formErrors.entry,"stack-label":""},{error:n(()=>[m("div",Rt,_(e.formErrors.entry),1)]),after:n(()=>[o(D,{type:"submit",color:"info",icon:"done",dense:"",onClick:e.submit},null,8,["onClick"]),o(D,{color:"dark",icon:"close",dense:"",onClick:a[4]||(a[4]=l=>e.$emit("cancelEdit"))})]),_:1},8,["label","modelValue","error"])])):C("",!0)]),_:1},8,["onSubmit"]),o(ge,{modelValue:e.addNew,"onUpdate:modelValue":a[8]||(a[8]=l=>e.addNew=l)},{default:n(()=>[e.config.newType==="location"?(u(),y(t,{key:0,onCancelAdd:a[6]||(a[6]=l=>e.addNew=!1),onAddComplete:e.newOptionAdded},null,8,["onAddComplete"])):C("",!0),e.config.newType==="customer"?(u(),y(r,{key:1,onCancelAdd:a[7]||(a[7]=l=>e.addNew=!1),onAddComplete:e.newOptionAdded},null,8,["onAddComplete"])):C("",!0)]),_:1},8,["modelValue"])])}var Nt=U(yt,[["render",kt]]);const _t=z({emits:[],props:{item:Object},components:{EditDetailsForm:Nt},setup(e,{emit:a}){const c=A(!1),s=h(()=>{const{permission:f}=e.item.editable&&e.item.config?e.item.config:{action:null,subject:null};return f});return{edit:c,permission:s}}}),Vt={key:0,class:"row"},At={class:"col-12 col-md-4"},St={class:"col-12 col-md-8"};function Pt(e,a,c,s,f,p){const t=L("edit-details-form");return u(),y(O,{class:"q-py-sm"},{default:n(()=>[e.edit?(u(),y(t,{key:1,type:e.item.label,config:e.item.config,onCancelEdit:a[1]||(a[1]=r=>e.edit=!1)},null,8,["type","config"])):(u(),N("div",Vt,[m("div",At,[m("div",null,[m("span",{class:Se(e.$q.screen.gt.lg?"text-body2":"text-caption")},_(e.item.label),3)])]),m("div",St,[m("div",null,[m("span",{class:Se(["text-weight-light",e.$q.screen.gt.lg?"text-body2":"text-caption"])},_(e.item.value),3),e.item.editable&&e.$can(e.permission.action,e.permission.subject)?(u(),y(D,{key:0,color:"accent",flat:"",dense:"",round:"",icon:"edit",size:"sm",onClick:a[0]||(a[0]=r=>e.edit=!0)})):C("",!0)])])]))]),_:1})}var Dt=U(_t,[["render",Pt]]);const jt=z({props:{title:String,details:Array},components:{DetailsSection:Dt}}),Lt={class:"text-body1 text-white"};function Ot(e,a,c,s,f,p){const t=L("details-section");return u(),N("div",null,[o(X,{class:"text-dark q-pb-sm"},{default:n(()=>[e.title&&e.title!==""?(u(),y(O,{key:0,class:"bg-info q-py-sm"},{default:n(()=>[m("div",Lt,_(e.title.toUpperCase()),1)]),_:1})):C("",!0),(u(!0),N(te,null,le(e.details,r=>(u(),N(te,{key:r},[r.hide?C("",!0):(u(),y(t,{key:0,item:r},null,8,["item"]))],64))),128))]),_:1})])}var Et=U(jt,[["render",Ot]]);const Tt=z({props:{rows:Array},setup(e,a){const c=Y();me();const s=h(()=>c.screen.gt.sm?[{name:1,label:"Created",align:"left",field:t=>t[1].$d,format:t=>`${G(t).format("L LT")}`,sortable:!0},{name:2,label:"ID",align:"left",field:t=>t[3],format:t=>`${t}`,sortable:!0,required:!0},{name:3,label:"Classification",align:"left",field:t=>t[21],format:t=>`${t===""?"Open":t}`,sortable:!0,required:!0},{name:4,label:"Status",align:"left",field:t=>t[17],format:t=>`${t}`,sortable:!0},{name:5,label:"Rate",align:"left",field:t=>t[23],format:t=>`$ ${t.toFixed(2)}`,sortable:!0,required:!0},{name:6,label:"# Requested",align:"right",field:t=>t[18],format:t=>`${t}`},{name:7,label:"Offers",align:"right",field:t=>f(t),format:t=>`${t}`,sortable:!0,required:!0},{name:8,label:"# Names",align:"right",field:t=>t.names,format:t=>t?t.length:0,sortable:!0,required:!0},{name:9,label:"Balance",align:"right",field:t=>p(t),format:t=>`${t}`,sortable:!0,required:!0}]:[]);function f(t){return t.offers.filter(r=>r[21]==="Accepted").length}function p(t){const r=f(t);return t[18]-r}return{columns:s,props:e}}}),Ut={class:"full-width row flex-center text-primary q-gutter-sm q-py-md"};function Qt(e,a,c,s,f,p){return u(),N("div",null,[o(_e,{columns:e.columns,rows:e.props.rows,"row-key":t=>t[3],class:"q-pa-sm",pagination:{rowsPerPage:10},"table-header-class":"bg-dark text-white","no-data-label":"There are no classifications",dense:""},{header:n(t=>[o(ue,{class:"bg-dark text-white",props:t},{default:n(()=>[(u(!0),N(te,null,le(t.cols,r=>(u(),y(he,{key:r.name,props:t},{default:n(()=>[ye(_(r.label),1)]),_:2},1032,["props"]))),128)),o(he,{"auto-width":""})]),_:2},1032,["props"])]),body:n(t=>[o(ue,{props:t},{default:n(()=>[(u(!0),N(te,null,le(t.cols,r=>(u(),y(ce,{key:r.name,props:t},{default:n(()=>[ye(_(r.value),1)]),_:2},1032,["props"]))),128)),o(ce,{"auto-width":""},{default:n(()=>[t.row[17]==="Pending"&&e.$can("manage","projectRequests")&&!e.$can("read","hireRequests")?(u(),y(oe,{key:0,class:"cursor-pointer",size:e.$q.screen.gt.sm?"sm":"xs",color:"primary",round:"",dense:"",onClick:r=>e.$emit("removeRow",t.row),name:"delete_forever"},null,8,["size","onClick"])):C("",!0)]),_:2},1024)]),_:2},1032,["props"])]),"no-data":n(({message:t})=>[m("div",Ut,[o(oe,{size:"2em",name:"fa-solid fa-person-circle-exclamation"}),m("span",null,_(t),1)])]),"top-right":n(()=>[o(D,{color:"secondary",flat:"","icon-right":"refresh",label:"Refresh",onClick:a[0]||(a[0]=t=>e.$emit("refresh"))})]),_:1},8,["columns","rows","row-key"])])}var Ft=U(Tt,[["render",Qt]]);const It=z({props:{data:Object},components:{ClassificationsTable:Ft},setup(e,a){const c=Y(),{getClassifications:s,fetchClassifications:f,removeData:p,updateViewedRequests:t,getHireRequest:r}=ae(),l=h(()=>r(e.data[3])&&r(e.data[3]).classes?r(e.data[3]).classes:s(e.data[3]).sort((v,R)=>v[1].$d<R[1].$d?1:-1));async function V(v){c.loading.show();const{data:R}=await f({id:e.data[3]});t({id:e.data[3],dataset:"classes",data:R}),c.loading.hide()}async function k(v){c.dialog({title:"Confirm",message:`Are you sure you want to remove ${v[12]} from request# ${v[6]}?`,cancel:!0,persistent:!0}).onOk(async()=>{try{const{data:R}=await T.upsertRecordsXML({to:"bpzpyqcu4",data:[{3:{value:v[3]},17:{value:"Cancelled"},51:{value:new Date},128:{value:6}}],fieldsToReturn:[220],formatObject:220});p({type:"classifications",key:R[0][220][6],item:R[0][220],storageKey:"storageRequestClassifications"});const S=l.value.filter(b=>b[3]!==R[0][220][3]);t({id:e.data[3],dataset:"classes",data:S})}catch(R){c.notify({type:"negative",message:"Cannot remove classification"}),console.log(R)}})}return V(),{rows:l,removeRow:k,loadData:V}}});function Mt(e,a,c,s,f,p){const t=L("classifications-table");return u(),N("div",null,[o(t,{rows:e.rows,onRemoveRow:e.removeRow,onRefresh:a[0]||(a[0]=r=>e.loadData(!0))},null,8,["rows","onRemoveRow"])])}var Bt=U(It,[["render",Mt]]);const zt=z({props:{data:Object},components:{NameRequestDataTable:ut},setup(e,a){const c=Y(),s=me(),{capitalize:f}=Te,p=A(""),{getNameRequest:t,fetchNameRequest:r,removeData:l}=ae(),{userData:V}=re(),k=h(()=>t(e.data[3]).sort((d,q)=>d[1].$d<q[1].$d?1:-1));async function v(){c.loading.show(),await r({id:e.data[3]}),c.loading.hide()}function R(d){return`${f(d[6].toLowerCase())} ${f(d[7].toLowerCase())}`}async function S(d){c.dialog({title:"Confirm",message:`Are you sure you want to remove ${R(d)} from request# ${d[18]}?`,cancel:!0,persistent:!0}).onOk(async()=>{try{const{data:q}=await T.upsertRecordsXML({to:"bsg4yb4wa",data:[{3:{value:d[3]},11:{value:!0},12:{value:G().tz("America/Chicago")},13:{value:`${V[35]} ${V[37]}`}}],fieldsToReturn:[15],formatObject:15});l({type:"nameRequest",key:q[0][15][18],item:q[0][15],storageKey:"storageNameRequest"})}catch(q){c.notify({type:"negative",message:"Cannot remove name request"}),console.log(q)}})}const b=d=>{s.push({name:"ee-summary",params:{id:d[3]}})};return v(),{nameRequests:k,search:p,removeName:S,viewEmployee:b}}}),Jt={class:"row items-center"},Xt={class:"col-12 col-md-4"};function Ht(e,a,c,s,f,p){const t=L("name-request-data-table");return u(),N("div",null,[o(X,{flat:""},{default:n(()=>[o(O,null,{default:n(()=>[m("div",Jt,[m("div",Xt,[o(H,{dense:"",modelValue:e.search,"onUpdate:modelValue":a[0]||(a[0]=r=>e.search=r),label:"Search"},null,8,["modelValue"])])])]),_:1})]),_:1}),o(t,{requests:e.nameRequests,status:"Named",onRemoveName:e.removeName,onViewEmployee:e.viewEmployee},null,8,["requests","onRemoveName","onViewEmployee"])])}var Yt=U(zt,[["render",Ht]]);const Wt=z({props:{rows:Array},setup(e,a){const c=Y();me();const{openWindow:s}=nt(),f=re(),{getUserType:p}=Ue(f),t=h(()=>c.screen.gt.sm?[{name:"Action",label:"",align:"left"},{name:1,label:"Created",align:"left",field:l=>l[1].$d,format:l=>`${G(l).format("L LT")}`,sortable:!0},{name:2,label:"Offered To",align:"left",field:l=>l.employee[24],format:l=>`${l}`,sortable:!0,required:!0},{name:3,label:"Classification",align:"left",field:l=>l[57],format:l=>`${l===""?"Open":l}`,sortable:!0,required:!0},{name:4,label:"Status",align:"left",field:l=>l[21],format:l=>`${l}`,sortable:!0},{name:5,label:"Rate Offered",align:"left",field:l=>l[22],format:l=>`$ ${l.toFixed(2)}`,sortable:!0,required:!0}]:[{name:"Action",label:"",align:"left"},{name:1,label:"Created",align:"left",field:l=>l[1].$d,format:l=>`${G(l).fromNow()}`,sortable:!0},{name:2,label:"Offered To",align:"left",field:l=>l.employee[24],format:l=>`${l}`,sortable:!0,required:!0},{name:3,label:"Classification",align:"left",field:l=>l[57],format:l=>`${l===""?"Open":l}`,sortable:!0,required:!0},{name:4,label:"Status",align:"left",field:l=>l[21],format:l=>`${l}`,sortable:!0},{name:5,label:"Rate Offered",align:"left",field:l=>l[22],format:l=>`$ ${l.toFixed(2)}`,sortable:!0,required:!0}]);return{getUserType:p,viewProfile:l=>{s(null,{url:`https://elitehcms.quickbase.com/db/bs7qsu6wh?a=dbpage&pageID=6&ee=${l[25]}`,name:"View Profile"})},columns:t,props:e}}}),Gt={key:0},Kt={key:1},Zt={key:2},xt={class:"full-width row flex-center text-primary q-gutter-sm q-py-md"};function ea(e,a,c,s,f,p){return u(),N("div",null,[o(_e,{columns:e.columns,rows:e.props.rows,"row-key":t=>t[3],class:"q-pa-sm",pagination:{rowsPerPage:10},"table-header-class":"bg-dark text-white","no-data-label":"There are no offers",dense:""},{body:n(t=>[o(ue,{props:t},{default:n(()=>[(u(!0),N(te,null,le(t.cols,r=>(u(),y(ce,{key:r.name,props:t,"auto-width":""},{default:n(()=>[r.name==="Action"?(u(),N("span",Gt,[e.getUserType==="QuickBase User"?(u(),y(oe,{key:0,class:"cursor-pointer",size:e.$q.screen.gt.sm?"sm":"xs",color:"info",round:"",dense:"",onClick:l=>e.viewProfile(t.row),name:t.expand?"visibility_off":"visibility"},null,8,["size","onClick","name"])):C("",!0)])):C("",!0),r.name===4?(u(),N("span",Kt,_(t.row[29]==="Review"?"Pending":r.value),1)):(u(),N("span",Zt,_(r.value),1))]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),"no-data":n(({message:t})=>[m("div",xt,[o(oe,{size:"2em",name:"fa-solid fa-person-circle-exclamation"}),m("span",null,_(t),1)])]),_:1},8,["columns","rows","row-key"])])}var ta=U(Wt,[["render",ea]]);const aa=z({props:{data:Array},components:{OffersDataTable:ta},setup(e){const a=A("");return{offers:h(()=>{const s=[];return e.data.forEach(f=>{`${f.employee[24].toLowerCase}`.includes(a.value.toLowerCase())&&s.push(f)}),s}),search:a}}}),sa={class:"row items-center"},oa={class:"col-12 col-md-4"};function la(e,a,c,s,f,p){const t=L("offers-data-table");return u(),N("div",null,[o(X,{flat:""},{default:n(()=>[o(O,null,{default:n(()=>[m("div",sa,[m("div",oa,[o(H,{dense:"",modelValue:e.search,"onUpdate:modelValue":a[0]||(a[0]=r=>e.search=r),label:"Search"},null,8,["modelValue"])])])]),_:1})]),_:1}),o(t,{rows:e.offers},null,8,["rows"])])}var na=U(aa,[["render",la]]);const ra={name:"Pipeline",components:{ProjectPipelineTable:ct},props:{request:Object},setup(e){const a=Y(),c=A(""),{fetchDeployments:s,fetchInProcess:f,fetchPending:p,getDeployments:t,getInProcess:r,getPending:l}=ae(),V=h(()=>t(e.request[3]).filter(d=>d[20]==="Complete")),k=h(()=>{const d=[];return t(e.request[3]).forEach(q=>{q[31].toLowerCase().includes(c.value.toLowerCase())&&d.push(q)}),d}),v=h(()=>{const d=[];return l(e.request[3]).forEach(q=>{q[25].toLowerCase().includes(c.value.toLowerCase())&&d.push(q)}),d}),R=h(()=>{const d=[];return r(e.request[3]).forEach(q=>{q[39].toLowerCase().includes(c.value.toLowerCase())&&d.push(q)}),d}),S=h(()=>R.value.concat(v.value.concat(k.value)));async function b(){a.loading.show(),await s({requestId:e.request[3]}),await f({requestId:e.request[3]}),await p({requestId:e.request[3]}),a.loading.hide()}return b(),{arrived:V,allPipeline:S,search:c}}},ia={class:"q-pt-sm"},da={class:"text-h5 text-dark"},ua={class:"text-body2 text-italic q-ml-sm"},ca=m("div",{class:"text-subtitle2 text-accent"},"The following people are currently in process or deployed for this request.",-1),ma={class:"row items-center"},fa={class:"col-12 col-md-3 q-px-sm"};function ba(e,a,c,s,f,p){const t=L("project-pipeline-table");return u(),y(Qe,{style:{"max-width":"100vw"}},{default:n(()=>[m("div",ia,[o(X,{flat:""},{default:n(()=>[o(O,{class:"q-pb-none"},{default:n(()=>[m("div",da,[ye(" Staffing Pipeline "),m("span",ua,"("+_(s.allPipeline.length)+" total)",1)]),ca]),_:1}),o(O,null,{default:n(()=>[m("div",ma,[m("div",fa,[o(H,{dense:"",modelValue:s.search,"onUpdate:modelValue":a[0]||(a[0]=r=>s.search=r),label:"Search"},null,8,["modelValue"])])])]),_:1})]),_:1}),o(t,{rows:s.allPipeline},null,8,["rows"])])]),_:1})}var pa=U(ra,[["render",ba]]);const va=z({emits:["namesAdded","closeNames"],components:{},props:{request:Object},setup(e,{emit:a}){const c=Y(),{getClassifications:s,addNameRequest:f}=ae(),{userData:p}=re(),{capitalize:t}=Te;A(!1);const r=A(10);A(null);const l=A([]),V=h(()=>s(e.request[3])||[]),k=[{name:0,label:"#",align:"left",field:i=>i.id,format:i=>`${i}`},{name:1,label:"First Name",align:"left",field:i=>i.firstName,format:i=>`${t(i.toLowerCase())}`,sortable:!0},{name:2,label:"Last Name",align:"left",field:i=>i.lastName,format:i=>`${t(i.toLowerCase())}`,sortable:!0},{name:3,label:"Phone",align:"left",field:i=>i.phone,format:i=>`${i}`,sortable:!1,required:!0},{name:4,label:"Last 4",align:"left",field:i=>i.ssn,format:i=>`${i}`}],v=h(()=>{const i=new RegExp("^[0-9]{"+r.value+"}","g");return B({job:B().required("Classification is required"),firstName:x().required().label("First Name"),lastName:x().required().label("Last Name"),phoneNumber:x().matches(i,{excludeEmptyString:!0,message:"Number Only!"}).required().label("Phone Number"),ssn:x().matches(/^\d+$/,{excludeEmptyString:!0,message:"Numbers Only!"}).label("Last 4 of SSN")})}),{errors:R,handleSubmit:S,resetForm:b,isSubmitting:d}=$e({validationSchema:v,initialValues:{job:V.value.length===1?V.value[0]:null}}),{value:q}=M("job"),{value:Q}=M("firstName"),{value:w}=M("lastName"),{value:j}=M("phoneNumber"),{value:P}=M("ssn"),F=S(i=>{const $={id:l.value.length+1,classification:i.job,firstName:i.firstName,lastName:i.lastName,phone:i.phoneNumber,ssn:i.ssn};l.value.push($),b()}),K=i=>{const $=l.value.filter(I=>I.id!==i.id);l.value=$},fe=async i=>{const $=p;$.access&&delete $.access,$.permissions&&delete $.permissions;const{data:I}=await T.upsertRecordsXML({to:"bsg4yb4wa",data:[{6:{value:i.firstName},7:{value:i.lastName},8:{value:i.phone},10:{value:"Has Not Arrived"},19:{value:G()},16:{value:i.ssn},14:{value:`${$[35]} ${$[37]}`},17:{value:i.classification[3]}}],fieldsToReturn:[15],formatObject:15}),E=I[0][15];return E[45]>E[43]&&Fe({id:E[17],qty:E[45]}),E};return{formErrors:R,submit:F,job:q,firstName:Q,lastName:w,phoneNumber:j,ssn:P,resetForm:b,classifications:V,names:l,columns:k,removeRow:K,submitNames:async()=>{c.loading.show();const i=[];l.value.forEach(E=>{const Ce=fe(E);i.push(Ce)});const I=(await Promise.allSettled(i)).map(E=>E.value);console.log(I),f({id:e.request[3],data:I}),c.notify({type:"positive",message:"Names successfully added!"}),a("namesAdded"),c.loading.hide()}}}}),ga={class:"q-mb-sm"},ya={class:"text-caption"},ha={class:"q-mb-sm"},qa={class:"text-caption"},wa={class:"q-mb-sm"},$a={class:"text-caption"},Ca={class:"q-mb-sm"},Ra={class:"text-caption"},ka={class:"text-caption"},Na={class:"text-caption"};function _a(e,a,c,s,f,p){return u(),y(we,{onSubmit:qe(e.submit,["prevent"])},{default:n(()=>[o(X,null,{default:n(()=>[o(O,{class:"q-pb-sm"},{default:n(()=>[m("div",ga,[o(H,{dense:"",label:"First Name",modelValue:e.firstName,"onUpdate:modelValue":a[0]||(a[0]=t=>e.firstName=t),error:!!e.formErrors.firstName,"bottom-slots":""},{error:n(()=>[m("div",ya,_(e.formErrors.firstName),1)]),_:1},8,["modelValue","error"])]),m("div",ha,[o(H,{dense:"",label:"Last Name",modelValue:e.lastName,"onUpdate:modelValue":a[1]||(a[1]=t=>e.lastName=t),error:!!e.formErrors.lastName,"bottom-slots":""},{error:n(()=>[m("div",qa,_(e.formErrors.lastName),1)]),_:1},8,["modelValue","error"])]),m("div",wa,[o(H,{dense:"",label:"Phone Number",modelValue:e.phoneNumber,"onUpdate:modelValue":a[2]||(a[2]=t=>e.phoneNumber=t),error:!!e.formErrors.phoneNumber,"bottom-slots":""},{error:n(()=>[m("div",$a,_(e.formErrors.phoneNumber),1)]),_:1},8,["modelValue","error"])]),m("div",Ca,[o(H,{maxlength:"4",dense:"",label:"SSN Last 4 (Optional)",modelValue:e.ssn,"onUpdate:modelValue":a[3]||(a[3]=t=>e.ssn=t),error:!!e.formErrors.ssn,"bottom-slots":""},{error:n(()=>[m("div",Ra,_(e.formErrors.ssn),1)]),_:1},8,["modelValue","error"])]),m("div",null,[o(ne,{dense:"",label:"Classification","transition-show":"flip-up","transition-hide":"flip-down",modelValue:e.job,"onUpdate:modelValue":a[4]||(a[4]=t=>e.job=t),options:e.classifications,"option-label":t=>t?`${t[21]}`:"","display-value":e.job?`${e.job[21]}`:"","bottom-slots":"",error:!!e.formErrors.job},{error:n(()=>[m("div",ka,_(e.formErrors.job),1)]),_:1},8,["modelValue","options","option-label","display-value","error"])])]),_:1}),o(et),o(ee,{class:"q-pt-sm",align:"right"},{default:n(()=>[e.names.length===0?(u(),y(D,{key:0,dense:"",label:"Cancel",color:"secondary",onClick:a[5]||(a[5]=t=>e.$emit("closeNames"))})):C("",!0),o(D,{dense:"",color:"info",label:"Save Name",type:"submit",onClick:e.submit},null,8,["onClick"])]),_:1}),e.names.length>0?(u(),y(O,{key:0,class:"q-px-none"},{default:n(()=>[o(_e,{flat:"",columns:e.columns,rows:e.names,"row-key":t=>t.name,class:"q-pa-sm",pagination:{rowsPerPage:100},"table-header-class":"bg-dark text-white",dense:"","hide-pagination":""},{header:n(t=>[o(ue,{class:"bg-dark text-white",props:t},{default:n(()=>[(u(!0),N(te,null,le(t.cols,r=>(u(),y(he,{class:"text-left",key:r.name},{default:n(()=>[ye(_(r.label),1)]),_:2},1024))),128)),o(he,{"auto-width":""})]),_:2},1032,["props"])]),body:n(t=>[o(ue,{"no-hover":"",props:t},{default:n(()=>[(u(!0),N(te,null,le(t.cols,r=>(u(),y(ce,{key:r.name,props:t},{default:n(()=>[m("span",Na,_(r.value),1)]),_:2},1032,["props"]))),128)),o(ce,{"auto-width":""},{default:n(()=>[o(D,{round:"",flat:"",icon:"delete",color:"accent",onClick:r=>e.removeRow(t.row)},null,8,["onClick"])]),_:2},1024)]),_:2},1032,["props"])]),_:1},8,["columns","rows","row-key"])]),_:1})):C("",!0),e.names.length>0?(u(),y(ee,{key:1,align:"right"},{default:n(()=>[o(D,{dense:"",label:"Cancel",color:"secondary",onClick:a[6]||(a[6]=t=>e.$emit("closeNames"))}),o(D,{dense:"",color:"primary",label:"Submit These Names",onClick:e.submitNames},null,8,["onClick"])]),_:1})):C("",!0)]),_:1})]),_:1},8,["onSubmit"])}var Va=U(va,[["render",_a]]);const Aa=z({emits:["jobsAdded","closeJobs","jobUpdated"],components:{PayRateField:mt},props:{request:Object},setup(e,{emit:a}){Y();const{getClassifications:c}=ae();re();const s=A([]),f=h(()=>c(e.request[3])||[]),p=B({craft:B().required().nullable().label("Craft"),classification:B().required().nullable().label("Classification"),rate:Pe().required().nullable().label("Rate"),qty:Pe().required().nullable().label("Quantity")}),{errors:t,handleSubmit:r,resetForm:l,isSubmitting:V,setFieldError:k}=$e({validationSchema:p}),{value:v}=M("craft"),{value:R}=M("classification"),{value:S}=M("rate"),{value:b}=M("qty"),d=r(async w=>{const j=f.value.find(P=>P[9]===w.classification[3]&&P[23]===w.rate);if(j){const P=j[18]+w.qty,F=await Fe({id:j[3],qty:P});a("jobUpdated",F)}else{const P=await ft({requestData:e.request,job:w});a("jobsAdded",P)}}),q=async()=>{const{data:w}=await T.fetchFromProjectsApp({fields:[ve({type:"projectCrafts",query:`{'7'.EX.'${e.request[6]}'}AND{'6'.EX.'Active'}`})]}),j=w.sort((P,F)=>P[20]>F[20]?1:-1);s.value=j,console.log(f.value)},Q=h(()=>{const w=v.value&&v.value.classifications?v.value.classifications:[];return w.length>0?w.sort((j,P)=>j[32]>P[32]?-1:1):[]});return tt(R,(w,j)=>{w&&w.hasFixedRate?S.value=w.fixedRate:S.value&&(S.value=null)}),q(),{errors:t,submit:d,classificationOptions:Q,craft:v,classification:R,rate:S,qty:b,crafts:s}}}),Sa={key:0,class:"text-body2 text-italic text-weight-bold text-dark"},Pa={key:1,class:"text-body2 text-italic text-weight-bold text-dark"},Da={class:"row q-mb-md"},ja={class:"col-6 q-pr-sm"},La={class:"text-caption"},Oa={class:"col-6 q-pl-sm"},Ea={class:"text-caption"},Ta={class:"row"},Ua={class:"col-6 q-pr-sm"},Qa={class:"text-caption"},Fa={class:"col-6 q-pl-sm"};function Ia(e,a,c,s,f,p){const t=L("pay-rate-field");return u(),y(we,at(e.$attrs,{onSubmit:qe(e.submit,["prevent"])}),{default:n(()=>[o(X,null,{default:n(()=>[o(O,null,{default:n(()=>[e.$attrs.hideInstructions?(u(),N("div",Pa," Enter the following information about the classification and click Submit. ")):(u(),N("div",Sa," Enter the following information about the classification and click Save. Repeat until all classifications you are requesting have been saved. Then click Continue. ")),m("div",Da,[m("div",ja,[o(ne,{class:"q-mt-md",dense:"",clearable:"","transition-show":"flip-up","transition-hide":"flip-down",label:"Select Craft",modelValue:e.craft,"onUpdate:modelValue":a[0]||(a[0]=r=>e.craft=r),options:e.crafts,"option-label":r=>r[10],"display-value":e.craft?`${e.craft[10]}`:"",error:!!e.errors.craft,"bottom-slots":""},{error:n(()=>[m("div",La,_(e.errors.craft),1)]),_:1},8,["modelValue","options","option-label","display-value","error"])]),m("div",Oa,[o(ne,{class:"q-mt-md",dense:"",clearable:"","transition-show":"flip-up","transition-hide":"flip-down",label:"Classification",modelValue:e.classification,"onUpdate:modelValue":a[1]||(a[1]=r=>e.classification=r),options:e.classificationOptions,"option-label":r=>r[18],"display-value":e.classification?`${e.classification[18]}`:"",error:!!e.errors.classification,"bottom-slots":"",disable:!e.craft},{error:n(()=>[m("div",Ea,_(e.errors.classification),1)]),_:1},8,["modelValue","options","option-label","display-value","error","disable"])])]),m("div",Ta,[m("div",Ua,[o(H,{dense:"",type:"number",label:"Quantity",modelValue:e.qty,"onUpdate:modelValue":a[2]||(a[2]=r=>e.qty=r),modelModifiers:{number:!0},error:!!e.errors.qty,disable:!e.classification,"bottom-slots":""},{error:n(()=>[m("div",Qa,_(e.errors.qty),1)]),_:1},8,["modelValue","error","disable"])]),m("div",Fa,[o(t,{class:"q-mb-md",type:"number",step:"any",dense:"",label:"Hourly Rate",modelValue:e.rate,"onUpdate:modelValue":a[3]||(a[3]=r=>e.rate=r),modelModifiers:{number:!0},prefix:"$",disable:!e.classification||e.classification.hasFixedRate&&!e.$can("manage","rates"),error:!!e.errors.rate,"error-message":e.errors.rate,"bottom-slots":""},null,8,["modelValue","disable","error","error-message"])])])]),_:1}),o(ee,{align:"right"},{default:n(()=>[o(D,{dense:"",color:"secondary",label:"Cancel",onClick:a[4]||(a[4]=r=>e.$emit("closeJobs"))}),o(D,{dense:"",color:"primary",label:"Submit",type:"submit",onClick:e.submit},null,8,["onClick"])]),_:1})]),_:1})]),_:1},16,["onSubmit"])}var Ma=U(Aa,[["render",Ia]]);const Ba=z({props:{request:Object},setup(e){const a=A(null),c=["Continue Processing","Remove from In Process"],s=["Client Headcount Met","Client Changed Work Scope"],f=re(),{userData:p}=Ue(f),t=me(),r=Y(),{getDeployments:l,getInProcess:V,getPending:k,fetchDeployments:v,fetchInProcess:R,fetchPending:S}=ae(),b=p.value&&p.value[35]?p.value[35]:"",d=p.value&&p.value[37]?p.value[37]:"",q=h(()=>l(e.request[3])),Q=h(()=>V(e.request[3])),w=h(()=>k(e.request[3])),j=h(()=>q.value.concat(Q.value)),P=h(()=>w.value.concat(Q.value));async function F(){await v({requestId:e.request[3],refresh:!0}),await R({requestId:e.request[3],refresh:!0}),await S({requestId:e.request[3],refresh:!0})}F();const K=h(()=>{let Z={};return P.value.length>0?Z=B({action:x().required().label("Applicant(s) In Process, Action Needed?"),reason:x().required().label("Reason for Closing")}):Z=B({reason:x().required().label("Reason for Closing")}),Z}),{meta:fe,errors:g,handleSubmit:i,handleReset:$}=$e({validationSchema:K}),{value:I}=M("action"),{value:E}=M("reason"),Ce=i(async Z=>{try{let ie=j.value.length===0?"Cancelled":"Closed",Re=j.value.length===0?6:5;e.request[305]>0&&(ie="Closed",Re=5);const ze={3:{value:e.request[3]},14:{value:ie},84:{value:new Date},86:{value:new Date},147:{value:Re},276:{value:p.value[3]},277:{value:`${b} ${d}`},303:{value:Z.reason},306:{value:Z.action||"N/A"}},Ae=[];e.request.classes&&Array.isArray(e.request.classes)&&e.request.classes.forEach(W=>{const Ne=A(W[18]);Z.action==="Continue Processing"?W.offers&&Array.isArray(W.offers)&&(Ne.value=W.offers.filter(de=>de[21]==="Accepted").length):Ne.value=q.value.filter(de=>de[89]===W[3]&&(de[20]==="Complete"||de[20]==="In Process")).length;const Je={3:{value:W[3]},17:{value:ie},29:{value:new Date},51:{value:new Date},128:{value:Re},255:{value:Ne.value}};Ae.push(Je)});const{data:ke}=await T.upsertRecordsXML({to:"bpzpyjbuy",data:[ze],fieldsToReturn:[3]});if(ke&&ke[0]&&ke[0][3]){const{data:W}=await T.upsertRecordsXML({to:"bpzpyqcu4",data:Ae,fieldsToReturn:[3]});if(W)Ve(),t.go(-1),r.notify({position:"top-right",type:"positive",message:"Request successfully closed"});else throw"Error in canceling request"}else throw"Error in canceling request"}catch(ie){console.log(ie),r.notify({position:"top-right",type:"negative",message:"There was a problem closing request!"})}}),Ve=()=>{$(),a.value.hide()};return{cancelRequestDialog:a,hireRequestPipeline:P,actions:c,reasons:s,action:I,reason:E,formErrors:g,submitCancel:Ce,closeCancelDialog:Ve}}}),za=m("div",{class:"text-h6 text-info"},"Close Request",-1),Ja={key:0,class:"row"},Xa={class:"col-12 q-pr-sm"},Ha={class:"text-caption"},Ya={class:"row q-mb-md"},Wa={class:"col-12 q-pr-sm"},Ga={class:"text-caption"};function Ka(e,a,c,s,f,p){return u(),y(ge,{ref:"cancelRequestDialog"},{default:n(()=>[o(X,{flat:"",style:{width:"400px"}},{default:n(()=>[o(we,{onSubmit:qe(e.submitCancel,["prevent"])},{default:n(()=>[o(O,{class:"q-pb-none"},{default:n(()=>[za]),_:1}),o(O,null,{default:n(()=>[e.hireRequestPipeline.length>0?(u(),N("div",Ja,[m("div",Xa,[o(ne,{class:"q-mt-md",dense:"","transition-show":"flip-up","transition-hide":"flip-down",label:`${e.hireRequestPipeline.length} Applicant(s) In Process, Action Needed?`,modelValue:e.action,"onUpdate:modelValue":a[0]||(a[0]=t=>e.action=t),options:e.actions,error:!!e.formErrors.action,"bottom-slots":""},{error:n(()=>[m("div",Ha,_(e.formErrors.action),1)]),_:1},8,["label","modelValue","options","error"])])])):C("",!0),m("div",Ya,[m("div",Wa,[o(ne,{class:"q-mt-md",dense:"","transition-show":"flip-up","transition-hide":"flip-down",label:"Reason for Closing",modelValue:e.reason,"onUpdate:modelValue":a[1]||(a[1]=t=>e.reason=t),options:e.reasons,error:!!e.formErrors.reason,"bottom-slots":""},{error:n(()=>[m("div",Ga,_(e.formErrors.reason),1)]),_:1},8,["modelValue","options","error"])])])]),_:1}),o(ee,{align:"right"},{default:n(()=>[o(D,{dense:"",color:"secondary",label:"Cancel",onClick:e.closeCancelDialog},null,8,["onClick"]),o(D,{dense:"",color:"primary",label:"Submit",type:"submit",onClick:e.submitCancel},null,8,["onClick"])]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1},512)}var Za=U(Ba,[["render",Ka]]);const xa={name:"View Request",components:{ClassificationsTab:Bt,NamesTab:Yt,PipelineTab:pa,OffersTab:na,NamesForm:Va,DetailsCard:Et,ClassificationForm:Ma,cancelHireRequest:Za},setup(){const e=A(!0),a=A(!1),c=A(!1),s=A(!1),f=Y(),p=st(),t=me(),r=A(0),{getHireRequest:l,fetchHireRequest:V,updateViewedRequests:k,setHireRequests:v}=ae(),{getUserType:R,userData:S}=re(),b=A(!1),d=h(()=>l(p.params.id)),q=async g=>{if(!d.value[3]||g){f.loading.show();const{data:i}=await T.fetchFromProjectsApp({fields:[ve({type:"requests",id:p.params.id})]});v({requestId:p.params.id,data:i}),f.loading.hide()}},Q=()=>{t.go(-1)},w=()=>{t.push({name:"project-general",params:{id:d.value[6]}})};q();const j=()=>{r.value=1,c.value=!1,q(!0)},P=g=>{s.value=!1,q(!0),k({id:d.value[3],dataset:"classes",data:g,push:!0})},F=g=>{s.value=!1,q(!0);const i=l(d.value[3]).classes,$=i.findIndex(I=>I[3]===g[3]);$>-1?(i[$]=g,k({id:d.value[3],dataset:"classes",data:i})):k({id:d.value[3],dataset:"classes",data:g,push:!0})},K=g=>{const i=[];for(const[$,I]of Object.entries(g)){const E={fid:$,value:I};i.push(E)}k({id:d.value[3],props:i})},fe=h(()=>d.value[3]?[{label:"Request ID",value:d.value[3],editable:!1},{label:"Date Created",value:G(d.value[1].$d).format("MM/DD/YYYY hh:mm:ss a"),editable:!1},{label:"Status",value:`${d.value[14]} (${d.value[59]})`,editable:!1},{label:"Opened On",value:d.value[82].$d?G(d.value[82].$d).format("MM/DD/YYYY hh:mm:ss a"):null,editable:!1,hide:d.value[14]!=="Open"&&d.value[14]!=="Closed"},{label:"Closed On",value:d.value[86].$d?G(d.value[86].$d).format("MM/DD/YYYY hh:mm:ss a"):null,editable:!1,hide:d.value[14]!=="Closed"},{label:"Project Name",value:d.value[91],editable:!1},{label:"Job Number",value:d.value[27],editable:d.value[14]!=="Closed",config:{permission:{action:"manage",subject:"projectRequests"},type:"options",allowNew:!1,newType:"customer",initialValue:g=>g.find(i=>i[3]===d.value[9]),formRules:B().required().label("Job Number").nullable(),fieldLabel:"Job Number",optionLabel:"11",displayValue:11,getter:async()=>{const{data:g}=await T.fetchFromProjectsApp({fields:[ve({type:"jobNumbers",query:`{'6'.EX.'${d.value[6]}'}AND{'29'.EX.'Active'}`})]});return g.sort((i,$)=>i[1].$d>$[1].$d?-1:1)},setter:async g=>{try{const{data:i}=await T.upsertRecordsXML({to:"bpzpyjbuy",data:[{3:{value:d.value[3]},9:{value:g[3]}}],fieldsToReturn:[9,27]});K(i[0]),f.notify({type:"positive",message:"Job Number successfully updated"})}catch{f.notify({type:"negative",message:"Error updating Job Number"})}},filter:(g,i)=>g.filter($=>$[11].toLowerCase().indexOf(i)>-1)}},{label:"Site Contact",value:d.value[76],editable:d.value[14]!=="Closed",config:{permission:{action:"manage",subject:"projectRequests"},type:"options",allowNew:!1,newType:"location",initialValue:g=>g.find(i=>i[3]===d.value[60]),formRules:B().required().label("Site Contact").nullable(),fieldLabel:"Site Contact",optionLabel:"17",displayValue:17,getter:async()=>{const{data:g}=await T.fetchFromProjectsApp({fields:[ve({type:"siteContacts",query:`{'7'.EX.'${d.value[6]}'}AND{'6'.EX.'Active'}`})]});return g.sort((i,$)=>i[17]>$[17]?1:-1)},setter:async g=>{try{const{data:i}=await T.upsertRecordsXML({to:"bpzpyjbuy",data:[{3:{value:d.value[3]},60:{value:g[3]}}],fieldsToReturn:[60,76]});K(i[0]),f.notify({type:"positive",message:"Site Contact successfully updated"})}catch{f.notify({type:"negative",message:"Error updating Site Contact"})}},filter:(g,i)=>g.filter($=>$[17].toLowerCase().indexOf(i)>-1)}},{label:"Meeting Location",value:d.value[32],editable:d.value[14]!=="Closed",config:{permission:{action:"manage",subject:"projectRequests"},type:"options",allowNew:!1,newType:"location",initialValue:g=>g.find(i=>i[3]===d.value[31]),formRules:B().required().label("Meeting Location").nullable(),fieldLabel:"Meeting Location",optionLabel:"6",displayValue:6,getter:async()=>{const{data:g}=await T.fetchFromStructureApp({fields:[rt({type:"meetingLocations",query:`{'15'.EX.'${d.value[8]}'}AND{'14'.EX.'Active'}`})]});return g.sort((i,$)=>i[6]>$[6]?1:-1)},setter:async g=>{try{const{data:i}=await T.upsertRecordsXML({to:"bpzpyjbuy",data:[{3:{value:d.value[3]},31:{value:g[3]}}],fieldsToReturn:[31,32,33]});K(i[0]),f.notify({type:"positive",message:"Meeting Location successfully updated"})}catch{f.notify({type:"negative",message:"Error updating Meeting Location"})}},filter:(g,i)=>g.filter($=>$[6].toLowerCase().indexOf(i)>-1)}},{label:"Address",value:d.value[33],editable:!1},{label:"Notes",value:d.value[299],editable:!1}]:[]);return{hireRequestData:d,tab:r,back:Q,showAddNames:c,showAddJobs:s,namesAdded:j,details:fe,viewProject:w,actions:e,navs:a,jobsAdded:P,jobUpdated:F,getUserType:R,cancelRequest:b}}},es={key:0,class:"q-pa-sm"},ts={class:"row"},as={class:"col-12 col-md-6"},ss={class:"col-12 col-md-6"},os={class:"row"},ls={class:"col-12 col-md-4 q-pr-sm"},ns={class:"col-12 col-md-8 q-pl-sm"};function rs(e,a,c,s,f,p){const t=L("details-card"),r=L("classifications-tab"),l=L("names-tab"),V=L("offers-tab"),k=L("pipeline-tab"),v=L("names-form"),R=L("classification-form"),S=L("cancelHireRequest");return u(),y(Qe,{style:{"max-width":"100vw"}},{default:n(()=>[s.hireRequestData[3]?(u(),N("div",es,[o(X,{flat:""},{default:n(()=>[o(O,{class:"q-pa-none"},{default:n(()=>[m("div",ts,[m("div",as,[o(ee,{class:"q-pt-none",align:"left"},{default:n(()=>[o(D,{label:"Go Back",color:"secondary",icon:"keyboard_return",onClick:s.back},null,8,["onClick"])]),_:1})]),m("div",ss,[s.getUserType==="Project User"?(u(),y(ee,{key:0,class:"q-pt-none",align:"right"},{default:n(()=>[e.$can("manage","projectRequests")&&(s.hireRequestData[14]==="Pending"||s.hireRequestData[14]==="Open")||e.$can("manage","nameRequests")&&s.hireRequestData[14]!=="Closed"&&s.hireRequestData[282]!=="Open"||e.$can("manage","projectRequests")&&!e.$can("read","hireRequests")&&s.hireRequestData[14]==="Pending"?(u(),y(De,{key:0,modelValue:s.actions,"onUpdate:modelValue":a[3]||(a[3]=b=>s.actions=b),square:"",color:"accent",icon:"keyboard_arrow_left",direction:"left",label:"Actions",padding:"sm"},{default:n(()=>[e.$can("manage","projectRequests")&&s.hireRequestData[14]==="Pending"?(u(),y(se,{key:0,label:"Add Classifications",color:"primary",icon:"add",onClick:a[0]||(a[0]=b=>s.showAddJobs=!0)})):C("",!0),e.$can("manage","nameRequests")&&(s.hireRequestData[14]==="Pending"||s.hireRequestData[14]==="Open")&&s.hireRequestData[282]!=="Open"?(u(),y(se,{key:1,label:"Add Names to Request",color:"accent",icon:"person_add",onClick:a[1]||(a[1]=b=>s.showAddNames=!0)})):C("",!0),e.$can("manage","projectRequests")&&(s.hireRequestData[14]==="Pending"||s.hireRequestData[14]==="Open")?(u(),y(se,{key:2,label:"Close Hire Request",color:"dark",icon:"cancel",onClick:a[2]||(a[2]=b=>s.cancelRequest=!0)})):C("",!0)]),_:1},8,["modelValue"])):C("",!0)]),_:1})):s.getUserType==="QuickBase User"?(u(),y(ee,{key:1,class:"q-pt-none",align:"right"},{default:n(()=>[o(De,{modelValue:s.actions,"onUpdate:modelValue":a[7]||(a[7]=b=>s.actions=b),square:"",color:"accent",icon:"keyboard_arrow_left",direction:"left",label:"Actions",padding:"sm"},{default:n(()=>[e.$can("manage","projectRequests")&&(s.hireRequestData[14]==="Open"||s.hireRequestData[14]==="Pending")?(u(),y(se,{key:0,label:"Add Classifications",color:"primary",icon:"add",onClick:a[4]||(a[4]=b=>s.showAddJobs=!0)})):C("",!0),e.$can("manage","nameRequests")&&(s.hireRequestData[14]==="Open"||s.hireRequestData[14]==="Pending")?(u(),y(se,{key:1,label:"Add Names to Request",color:"accent",icon:"person_add",onClick:a[5]||(a[5]=b=>s.showAddNames=!0)})):C("",!0),e.$can("manage","projectRequests")&&(s.hireRequestData[14]==="Open"||s.hireRequestData[14]==="Pending")?(u(),y(se,{key:2,label:"Close Hire Request",color:"dark",icon:"cancel",onClick:a[6]||(a[6]=b=>s.cancelRequest=!0)})):C("",!0)]),_:1},8,["modelValue"])]),_:1})):C("",!0)])])]),_:1})]),_:1}),m("div",os,[m("div",ls,[o(t,{details:s.details,title:"Details"},null,8,["details"])]),m("div",ns,[o(lt,{class:"q-py-xs bg-info text-white shadow-2 rounded-borders",align:"left",modelValue:s.tab,"onUpdate:modelValue":a[8]||(a[8]=b=>s.tab=b),dense:"","indicator-color":"accent","outside-arrows":"","mobile-arrows":"","inline-label":""},{default:n(()=>[o(be,{name:0,label:"Classifications"}),o(be,{name:1,label:"Names"}),s.hireRequestData[14]!=="Pending"?(u(),y(be,{key:0,name:2,label:"Offers"})):C("",!0),s.hireRequestData[14]!=="Pending"?(u(),y(be,{key:1,name:3,label:"Pipeline"})):C("",!0)]),_:1},8,["modelValue"]),o(ot,{modelValue:s.tab,"onUpdate:modelValue":a[9]||(a[9]=b=>s.tab=b),animated:"",class:"q-px-none"},{default:n(()=>[o(pe,{class:"q-px-xs",name:0},{default:n(()=>[s.hireRequestData[3]?(u(),y(r,{key:0,data:s.hireRequestData},null,8,["data"])):C("",!0)]),_:1}),o(pe,{class:"q-px-xs",name:1},{default:n(()=>[o(l,{data:s.hireRequestData},null,8,["data"])]),_:1}),o(pe,{class:"q-px-xs",name:2},{default:n(()=>[o(V,{data:s.hireRequestData.offers},null,8,["data"])]),_:1}),o(pe,{class:"q-px-xs",name:3},{default:n(()=>[o(k,{request:s.hireRequestData},null,8,["request"])]),_:1})]),_:1},8,["modelValue"])])]),o(ge,{persistent:"",modelValue:s.showAddNames,"onUpdate:modelValue":a[11]||(a[11]=b=>s.showAddNames=b)},{default:n(()=>[o(X,{flat:"",style:{width:"500px"}},{default:n(()=>[o(O,{class:"q-pa-none"},{default:n(()=>[o(v,{onCloseNames:a[10]||(a[10]=b=>s.showAddNames=!1),onNamesAdded:s.namesAdded,request:s.hireRequestData},null,8,["onNamesAdded","request"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),o(ge,{persistent:"",modelValue:s.showAddJobs,"onUpdate:modelValue":a[13]||(a[13]=b=>s.showAddJobs=b)},{default:n(()=>[o(X,{flat:"",style:{width:"500px"}},{default:n(()=>[o(O,{class:"q-pa-none"},{default:n(()=>[o(R,{hideInstructions:!0,request:s.hireRequestData,onCloseJobs:a[12]||(a[12]=b=>s.showAddJobs=!1),onJobsAdded:s.jobsAdded,onJobUpdated:s.jobUpdated},null,8,["request","onJobsAdded","onJobUpdated"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])):C("",!0),s.hireRequestData[3]?(u(),y(S,{key:1,request:s.hireRequestData,modelValue:s.cancelRequest,"onUpdate:modelValue":a[14]||(a[14]=b=>s.cancelRequest=b)},null,8,["request","modelValue"])):C("",!0)]),_:1})}var Zs=U(xa,[["render",rs]]);export{Zs as default};
