import{Q as W}from"./QImg.e443940a.js";import{_ as G,bV as J,bU as Z,bT as ee,r as x,c as ae,w as te,A as b,aq as I,br as l,B as se,d as r,ar as q,D as m,cS as re,cT as h,ac as V,bO as le,bN as oe,cU as L,a8 as i,b as j,bQ as $,cV as ie,bW as ne}from"./index.4dac2c6e.js";import{Q as ue}from"./QForm.0f6066f1.js";import{Q as ce}from"./QPage.9aeaf4f3.js";import{a as de,u as k}from"./vee-validate.esm.98ae1735.js";import{u as me}from"./i18n.619af201.js";import{u as pe,e as fe,b as ve,q as u}from"./app.dc1ff75d.js";import{_ as ge}from"./languageSelector.c500b248.js";import{a as ye,e as be,c as B,d as he}from"./array.59f93f43.js";import{c as _e}from"./carousel.ae0e3aa7.js";import"./_commonjsHelpers.a26ce4be.js";import"./dayjs.1133dfcf.js";import"./localForage.501be3ae.js";import"./api.1f088558.js";import"./index.04bc0a32.js";import"./QSelect.0217e1b0.js";import"./QChip.14868bc0.js";import"./QMenu.5ef1c14c.js";import"./position-engine.eb3df269.js";import"./selection.4e7f893d.js";import"./rtl.b51694b1.js";import"./use-quasar.5f82aae6.js";import"./use-panel.309da1bf.js";import"./touch.3df10340.js";import"./use-fullscreen.2cf9f582.js";const we={key:0,class:"col-md-7 col-lg-8 col-lx-8"},Ce={class:"col-xs-12 col-sm-12 col-md-5 col-lg-4 col-lx-4 row justify-center items-center"},Ie={class:"text-dark"},qe={class:"row"},Ue={class:"row"},Ne={class:"text-grey-6"},Se={class:"row justify-center"},xe={__name:"verifyIdentity",setup($e){const s=pe(),{employeeData:_,socialRequired:D,updateEmployeeData:O,setEmployee:T}=fe(),R=ve(),{getCountry:n,currentLang:w}=J(R),f=Z(),v=ee(),{t:c}=me(),d=x(!1),U=x("confirm-identity"),X=ae(()=>ye({userRID:be().required(),ssn:B().required().matches(/^[0-9]{9}/g,{excludeEmptyString:!0,message:`${c("nineDigitsRequired")}`}).nullable().label(`${n.value==="CA"?c("socialInsuranceNumber"):c("socialSecurityNumber")}`),ssnConfirmation:B().oneOf([he("ssn"),null],`${n.value==="CA",c("socialInsuranceNumberMustMatch")}`).required().nullable().label(`${n.value==="CA"?c("socialInsuranceNumberConfirmation"):c("socialSecurityNumberConfirmation")}`)})),{errors:ke,meta:M}=de({validationSchema:X,initialValues:{ssn:"",ssnConfirmation:""}}),{value:g}=k("userRID"),{value:o,errorMessage:A,meta:F}=k("ssn"),{value:y,errorMessage:E,meta:Y}=k("ssnConfirmation"),C=x(!0);f.query.rid?(g.value=f.query.rid,o.value="",y.value="",v.replace({query:{}})):v.push("/"),te(()=>f.query,()=>{f.query.rid&&(g.value=f.query.rid,o.value="",y.value="",v.replace({query:{}}))});const K=async()=>{const e=u.getOfficeLocation();let a=1;w.value==="en-US"?a=1:w.value==="es"&&(a=2);const t=[{20:{value:s.getUser[35]},22:{value:s.getUser[37]},...n.value==="CA"?{564:{value:o.value}}:{109:{value:o.value}},25:{value:s.getUser[9]?s.getUser[9].phoneNumber:s.getUser[8].replace(/[^0-9]/g,"")},28:{value:s.getUser[50]?"Yes":"No"},26:{value:s.getUser[6]},34:{value:s.getUser[49]?"Yes":"No"},16:{value:e?e.rid:""},339:{value:a}}],{data:p}=await u.upsertRecordsXML({to:"bp3gb7ng2",fieldsToReturn:[500],data:t,formatObject:500}),S=p[0][500];return s.userLoggedIn&&T(S,!0),S[3]},N=async e=>{const a=u.getOfficeLocation();let t=1;w.value==="en-US"?t=1:w.value==="es"&&(t=2);const p={3:{value:e},20:{value:s.getUser[35]},22:{value:s.getUser[37]},...n.value==="CA"?{564:{value:o.value}}:{109:{value:o.value}},25:{value:s.getUser[9]?s.getUser[9].phoneNumber:s.getUser[8].replace(/[^0-9]/g,"")},28:{value:s.getUser[50]?"Yes":"No"},26:{value:s.getUser[6]},34:{value:s.getUser[49]?"Yes":"No"},...a&&{16:{value:a.rid}},339:{value:t}};return(await O({fields:p}))[3]},H=async e=>{const a=[{3:{value:s.getUser[86]},16:{value:e}}],{data:t}=await u.upsertRecordsXML({to:"br26nivmr",fieldsToReturn:[76],data:a,formatObject:76});return u.setCheckInData(t[0][76]),t[3]},P=async()=>{const a=[{8:{value:`${n.value==="CA"?`{'564'.EX.'${o.value}'}`:`{'188'.EX.'${o.value}'}`}AND{'509'.EX.'false'} `},7:{value:"Employees"},9:{value:12}}],{data:t}=await u.fetchFromHiringApp({fields:a});return t[0]?t[0][3]:null},Q=async()=>{if(d.value=!0,!M.value.valid||!g.value||g.value==="")return d.value=!1,!1;let e=await P();const a=new Date,t={3:{value:Number(g.value)},26:{value:a}};D&&e?(_[3]&&await u.softDeleteEmployee(_[3]),await N(e)):D&&!e&&_[3]?e=await N(_[3]):e?await N(e):e||(e=await K()),R.checkedIn&&H(e),t[80]={value:e},t[85]={value:!1};try{await u.updateUserData({fields:t}),d.value=!1,v.push({path:"/",query:{verify:!0,...e&&{rid:e}}})}catch(p){d.value=!1,console.log(p)}d.value=!1},z=()=>{s.logout().then(()=>{v.replace({name:"login"})})};return(e,a)=>(b(),I(ce,{class:"window-height window-width row"},{default:l(()=>[e.$q.screen.lt.md?q("",!0):(b(),se("div",we,[r(_e)])),m("div",Ce,[r(re,{class:"auth-card",flat:""},{default:l(()=>[r(h,{style:{"padding-left":"30px","padding-right":"30px"}},{default:l(()=>[r(W,{src:"https://cdn.jsdelivr.net/gh/EliteHCMS/assets@latest/public/logo.svg",fit:"scale-down",class:"auth-logo full-width"})]),_:1}),r(h,{class:"text-center auth-description"},{default:l(()=>[m("p",Ie,V(e.$t("pleaseVerifyInfoToCompleteRegistration")),1)]),_:1}),r(h,null,{default:l(()=>[r(ue,{class:"q-px-sm q-pt-sm",onSubmit:a[3]||(a[3]=le(()=>{},["prevent"])),onKeyup:oe(Q,["enter"])},{default:l(()=>[m("div",qe,[U.value==="confirm-identity"?(b(),I(L,{key:0,class:"col-xs-12",outlined:"",mask:"#########",modelValue:i(o),"onUpdate:modelValue":a[0]||(a[0]=t=>j(o)?o.value=t:null),maxlength:"9",minlength:"9",type:"password",label:i(n)==="CA"?e.$t("socialInsuranceNumber"):e.$t("socialSecurityNumber"),tabindex:"1",error:!!(i(A)&&i(F).validated),"error-message":i(A)},{prepend:l(()=>[r($,{name:"lock"})]),_:1},8,["modelValue","label","error","error-message"])):q("",!0)]),m("div",Ue,[U.value==="confirm-identity"?(b(),I(L,{key:0,class:"col-xs-12",outlined:"",mask:"#########",modelValue:i(y),"onUpdate:modelValue":a[2]||(a[2]=t=>j(y)?y.value=t:null),maxlength:"9",minlength:"9",type:C.value?"password":"text",label:i(n)==="CA"?e.$t("confirmSIN"):e.$t("confirmSSN"),tabindex:"2",error:!!(i(E)&&i(Y).validated),"error-message":i(E)},{prepend:l(()=>[r($,{name:"lock"})]),append:l(()=>[r($,{name:C.value?"visibility_off":"visibility",class:"cursor-pointer",onClick:a[1]||(a[1]=t=>C.value=!C.value)},null,8,["name"])]),_:1},8,["modelValue","type","label","error","error-message"])):q("",!0)])]),_:1},8,["onKeyup"])]),_:1}),r(ie,{class:"q-px-lg"},{default:l(()=>[U.value==="confirm-identity"?(b(),I(ne,{key:0,loading:d.value,disable:!i(M).valid,unelevated:"",size:"lg",color:"primary",class:"full-width text-white",label:e.$t("confirm"),tabindex:"3",onClick:Q},null,8,["loading","disable","label"])):q("",!0)]),_:1}),r(h,{class:"text-center q-pa-sm"},{default:l(()=>[m("p",Ne,[m("a",{onClick:z,class:"text-grey-6",href:"javascript:void(0);",tabindex:"4"},V(e.$t("logout")),1)])]),_:1}),r(h,{class:"q-pl-lg q-pa-sm"},{default:l(()=>[m("div",Se,[r(ge,{dense:"",borderless:""})])]),_:1})]),_:1})])]),_:1}))}};var ta=G(xe,[["__scopeId","data-v-83795308"]]);export{ta as default};
