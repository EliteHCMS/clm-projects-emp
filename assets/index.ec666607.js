import{Q as q}from"./QSpace.3a04a4cb.js";import{bW as se,r as c,w as ne,aU as ue,c as y,B as f,C as p,d as e,bs as l,cV as C,E as n,H,a9 as b,ad as i,cU as D,bS as w,ac as de,aI as ie,bQ as r,dr as re,cW as ce,bR as fe,bX as X,ay as u,bT as me,as as m,ar as U}from"./index.2e7fe8e8.js";import{a as I,Q as d}from"./QSelect.63d8c041.js";import{Q as z}from"./QTooltip.b95091fe.js";import{Q as ve}from"./QList.ca4b78d4.js";import{Q as S}from"./QTd.f89fda48.js";import{u as _e}from"./use-quasar.40d4c05b.js";import{e as pe}from"./export-file.dc78ba05.js";import{c as be,q as E}from"./app.1914f476.js";import{_ as we}from"./officeSelector.7726f3ce.js";import{_ as ge}from"./aTable.43d8715e.js";import{dayjs as B}from"./dayjs.d259e186.js";import"./QChip.1e62c9f1.js";import"./QMenu.aa89615f.js";import"./position-engine.fae1bc72.js";import"./selection.87b1e79a.js";import"./rtl.b51694b1.js";import"./_commonjsHelpers.a26ce4be.js";import"./localForage.efbf8f90.js";import"./api.15b844fb.js";import"./index.04bc0a32.js";import"./i18n.2ffb039e.js";import"./QTable.0863689b.js";import"./QMarkupTable.883d653c.js";import"./use-fullscreen.a6d76165.js";const he={class:"q-pa-md"},ke={class:"row items-center"},xe={class:"col-12 col-md-6 q-px-sm"},ye=n("div",{class:"col-12 col-md-4 q-px-sm"},null,-1),Ce={class:"row items-center"},Ie={class:"col-12 col-md-3 q-px-sm"},Se={class:"col-12 col-md-3 q-px-sm"},Te={class:"col-12 col-md-3 q-px-sm"},Qe={class:"col-12 col-md-5 q-px-sm"},Ve={class:"q-pa-xs col-xs-12 col-sm-6 col-md-4"},Ae=n("br",null,null,-1),qe=n("br",null,null,-1),De=n("br",null,null,-1),Ue={key:0},Be={key:0},Ne=n("br",null,null,-1),Re=n("br",null,null,-1),Oe={key:0},Pe={key:0},We={key:1},ml={__name:"index",setup($e){const g=_e(),N=be(),{fetchSelfCheckIns:K,fetchAllSelfCheckIns:F}=N,{getSelfCheckIns:G,getSelectedOffice:h,getLoadingState:R}=se(N),x=c(h.value?h.value[8]:null),T=c("Self Check-Ins"),O=c("selfCheckIns"),Q=c(""),P=c({sortBy:"13",descending:!1,rowsPerPage:150}),V=t=>{x.value?K({selectedId:x.value,refresh:t}):F({can:"read",refresh:t})};V(!0),ne(h,()=>{x.value=h.value?h.value[8]:null,V()});const W=c(new Date),J=setInterval(()=>{W.value=new Date},1e3);ue(()=>{clearInterval(J)});const v=c("Waiting"),Z=c(["Waiting","Called"]),ee=c(["Waiting","Called","All"]),k=c([]),$=c([{label:"Kiosk",value:"Kiosk"},{label:"In Process",value:"In Process"},{label:"Deployment",value:"Deployment"},{label:"No Task Assigned",value:""}]),A=y(()=>[{name:"index",align:"left",label:"#",sortable:!1},{name:"timeCheckIn",align:"left",label:"Time Checked-In",field:"13",sortable:!1},{name:"name",align:"left",label:"Name",field:"17",sortable:!1},{name:"phoneNumber",align:"center",label:"Phone Number",field:"6",sortable:!1},{name:"reason",align:"center",label:"Reason",field:"10",sortable:!1},{name:"status",align:"center",label:"Status",field:"15",sortable:!1},{name:"task",align:"center",label:"Task",field:"27",sortable:!1},...v.value==="Called"||v.value==="All"?[{name:"timeCheckedOut",align:"center",label:"Time Checked Out",field:"14",sortable:!1}]:[]]),_=y(()=>G.value(x.value).filter(t=>{let o=!0,a=!0;return v.value&&(v.value==="All"?o=!0:o=t[15]===v.value,o||(a=!1)),k.value&&k.value.length!==0&&(o=k.value.some(s=>t[27]===s.value),o||(a=!1)),a}).sort((t,o)=>P.value.descending?t[13].isBefore(o[13]):t[13].isAfter(o[13]))),L=y(()=>_.value.map(t=>B(W.value).to(t[13]))),M=y(()=>_.value.map(t=>t[14]?B(t[13]).to(t[14],!0):"N/A")),le=async(t,o)=>{const a=t==="Called"?Date():"";await E.upsertRecordsXML({to:"br26nivmr",data:[{3:{value:o.row[3]},14:{value:a},15:{value:t}}],fieldsToReturn:[3,15]}),o.row[15]=t},ae=async(t,o)=>{await E.upsertRecordsXML({to:"br26nivmr",data:[{3:{value:o.row[3]},27:{value:t.value}}],fieldsToReturn:[3,27]}),o.row[27]=t.value},Y=(t,o,a)=>{let s=o!==void 0?o(t,a):t;return s=s==null?"":String(s),s=s.split('"').join('""'),`"${s}"`},j=()=>{const t=[A.value.map(a=>Y(a.label))].concat(_.value.map(a=>A.value.map(s=>Y(typeof s.field=="function"?s.field(a):a[s.field===void 0?s.name:s.field],s.format,a)).join(","))).join(`\r
`);pe(`${T.value} ${B().format("MM.DD.YYYY")}.csv`,t,"text/csv")!==!0&&g.notify({message:"Browser denied file download...",color:"negative",icon:"warning"})};return(t,o)=>(f(),p("div",he,[e(D,{flat:"",class:"q-pt-none"},{default:l(()=>[e(C,null,{default:l(()=>[n("div",ke,[n("div",xe,[n("div",{class:H(["text-dark",b(g).screen.lt.md?"text-body1":"text-h5"])},i(T.value),3)]),e(q),ye])]),_:1})]),_:1}),e(D,{flat:""},{default:l(()=>[e(C,null,{default:l(()=>[n("div",Ce,[n("div",Ie,[e(I,{label:"Select Status",modelValue:v.value,"onUpdate:modelValue":o[0]||(o[0]=a=>v.value=a),options:ee.value},null,8,["modelValue","options"])]),n("div",Se,[e(I,{label:"Select Task",modelValue:k.value,"onUpdate:modelValue":o[1]||(o[1]=a=>k.value=a),options:$.value,multiple:"","use-chips":"",clearable:""},{option:l(({itemProps:a,opt:s,selected:te,toggleOption:oe})=>[e(w,de(ie(a)),{default:l(()=>[e(r,null,{default:l(()=>[e(d,{innerHTML:s.label},null,8,["innerHTML"])]),_:2},1024),e(r,{side:""},{default:l(()=>[e(re,{"model-value":te,"onUpdate:modelValue":Le=>oe(s)},null,8,["model-value","onUpdate:modelValue"])]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","options"])]),e(q),n("div",Te,[e(we,{can:"read",styleSelection:!0})])])]),_:1})]),_:1}),e(ge,{rows:_.value,columns:A.value,pagination:P.value,filter:Q.value,title:T.value,separator:"vertical","row-key":"3",grid:!b(g).screen.gt.sm,loading:b(R)(O.value),downloadButton:!0,onDownload:j},{top:l(()=>[n("div",Qe,[e(ce,{dense:b(g).screen.lt.md,modelValue:Q.value,"onUpdate:modelValue":o[2]||(o[2]=a=>Q.value=a),label:"Search...",clearable:""},{prepend:l(()=>[e(fe,{name:"search"})]),_:1},8,["dense","modelValue"])]),e(q),n("div",{class:H(["text-dark text-caption text-italic",b(g).screen.lt.md?"offset-xs-5":""])},"(Total: "+i(_.value.length)+")",3),e(X,{flat:"",round:"",color:"primary",icon:"download",disable:_.value.length<1,onClick:j},{default:l(()=>[e(z,{class:"bg-accent text-black shadow-4",offset:[10,10]},{default:l(()=>[u(" Download ")]),_:1})]),_:1},8,["disable"]),e(X,{flat:"",round:"",color:"primary",icon:"refresh",onClick:o[3]||(o[3]=a=>V(!0)),loading:b(R)(O.value)},{default:l(()=>[e(z,{class:"bg-accent text-black shadow-4",offset:[10,10]},{default:l(()=>[u(" Refresh ")]),_:1})]),_:1},8,["loading"])]),item:l(a=>[n("div",Ve,[e(D,null,{default:l(()=>[e(C,{class:"text-center"},{default:l(()=>[n("strong",null,i(a.row[17]),1),Ae,n("span",null,i(a.row[15]),1)]),_:2},1024),e(me),e(C,{class:"flex flex-center"},{default:l(()=>[e(ve,{dense:""},{default:l(()=>[e(w,null,{default:l(()=>[e(r,null,{default:l(()=>[e(d,null,{default:l(()=>[u("Time Checked-In")]),_:1}),qe,e(d,null,{default:l(()=>[u("\xA0")]),_:1})]),_:1}),e(r,{side:""},{default:l(()=>[e(d,{caption:""},{default:l(()=>[u(i(a.row[13].format("h:mm:ss A")),1)]),_:2},1024),De,e(d,{caption:""},{default:l(()=>[u(i(L.value[a.rowIndex]),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),e(w,null,{default:l(()=>[e(r,null,{default:l(()=>[e(d,null,{default:l(()=>[u("Phone Number")]),_:1})]),_:1}),e(r,{side:""},{default:l(()=>[e(d,{caption:""},{default:l(()=>[u(i(a.row[20]),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),e(w,null,{default:l(()=>[e(r,null,{default:l(()=>[e(d,null,{default:l(()=>[u("Reason")]),_:1}),a.row[10]==="Applying"?(f(),p("br",Ue)):m("",!0),a.row[10]==="Applying"?(f(),U(d,{key:1},{default:l(()=>[u("\xA0")]),_:1})):m("",!0)]),_:2},1024),e(r,{side:""},{default:l(()=>[e(d,{caption:""},{default:l(()=>[u(i(a.row[10]),1)]),_:2},1024),a.row[10]==="Applying"?(f(),p("br",Be)):m("",!0),a.row[10]==="Applying"?(f(),U(d,{key:1,caption:""},{default:l(()=>[u(i(a.row[11]),1)]),_:2},1024)):m("",!0)]),_:2},1024)]),_:2},1024),e(w,null,{default:l(()=>[e(r,null,{default:l(()=>[e(d,null,{default:l(()=>[u("Task")]),_:1})]),_:1}),e(r,{side:""},{default:l(()=>[e(d,{caption:""},{default:l(()=>[u(i(a.row[20]),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),a.row[15]==="Called"?(f(),U(w,{key:0},{default:l(()=>[e(r,null,{default:l(()=>[e(d,null,{default:l(()=>[u("Time Checked-Out")]),_:1}),Ne,e(d,null,{default:l(()=>[u("\xA0")]),_:1})]),_:1}),e(r,{side:""},{default:l(()=>[e(d,{caption:""},{default:l(()=>[u(i(a.row[14].format("h:mm:ss A")),1)]),_:2},1024),Re,e(d,{caption:""},{default:l(()=>[u("Wait: "+i(M.value[a.rowIndex]),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)):m("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024)])]),"body-cell-timeCheckIn":l(a=>[e(S,{props:a},{default:l(()=>[n("div",null,i(a.value.format("h:mm:ss A")),1),a.row[15]==="Waiting"?(f(),p("div",Oe,i(L.value[a.rowIndex]),1)):m("",!0)]),_:2},1032,["props"])]),"body-cell-status":l(a=>[e(S,{props:a},{default:l(()=>[e(I,{dense:"",filled:"","model-value":a.value,"onUpdate:modelValue":s=>le(s,a),options:Z.value},null,8,["model-value","onUpdate:modelValue","options"])]),_:2},1032,["props"])]),"body-cell-task":l(a=>[e(S,{props:a},{default:l(()=>[e(I,{dense:"",filled:"","model-value":a.value,"onUpdate:modelValue":s=>ae(s,a),options:$.value},null,8,["model-value","onUpdate:modelValue","options"])]),_:2},1032,["props"])]),"body-cell-timeCheckedOut":l(a=>[e(S,{props:a},{default:l(()=>[a.row[15]==="Called"?(f(),p("div",Pe,i(a.value)+" ",1)):m("",!0),a.row[15]==="Called"?(f(),p("div",We," Wait: "+i(M.value[a.rowIndex]),1)):m("",!0)]),_:2},1032,["props"])]),_:1},8,["rows","columns","pagination","filter","title","grid","loading"])]))}};export{ml as default};
