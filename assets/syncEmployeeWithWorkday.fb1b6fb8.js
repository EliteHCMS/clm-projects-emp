import{q as u}from"./app.58c96d85.js";import{dayjs as r}from"./dayjs.d6c6127f.js";import{u as f}from"./useQuerySaver.d29ff9ee.js";import"./workday.a4eb29f7.js";import{workdayAPI as l}from"./workdayAPI.fc53fdce.js";const S=async({clm:e},a)=>{const s=!e[576]||!e[576].$d||e[576]&&e[576].$d&&!r(e[576].$d).isSameOrAfter(r().subtract(r.duration({days:2})),"day");if(!a&&!s){if(e.workday)return{sync:e.workday,clm:e};{const{data:n}=await u.fetchFromHiringApp({fields:[f({type:"workdaySync",query:"",id:e[578]})]});if(n&&n[22]){const t=o(e);if(t){const{sync:i}=await y({request:t,employee:e});return e[576]=i&&i[1]&&i[1].$d?r(i[1].$d):e[576],{sync:i,clm:e}}else return{sync:null,clm:e}}else return{sync:n,clm:e}}}else{const n=o(e);if(n){const{sync:t}=await y({request:n,employee:e});return e[576]=t&&t[1]&&t[1].$d?r(t[1].$d):e[576],{sync:t,clm:e}}else return{sync:null,clm:e}}},o=e=>{let a={sandbox:e[207],includeTransactionLogs:!0,includeRelatedPersons:!0};return e[378]!==""?a.workerId=e[378]:e[188].length===9?a.ssn=e[188]:e[567].length===9?a.sin=e[567]:(e[509],a=null),a},d=async({id:e,worker:a,values:s})=>{const n=s||[{6:{value:e},8:{value:a.workerName||""},9:{value:a.nationalId||""},10:{value:a.userId||""},11:{value:a.workerId||""},12:{value:a.employmentData?JSON.stringify(a.employmentData):""},14:{value:a.personalData?JSON.stringify(a.personalData):""},16:{value:a.workerReference?JSON.stringify(a.workerReference):""},17:{value:a.managementChainData?JSON.stringify(a.managementChainData):""},18:{value:a.organizations?JSON.stringify(a.organizations):""},19:{value:a.applicantReference?JSON.stringify(a.applicantReference):""},21:{value:a.jobHistory?JSON.stringify(a.jobHistory):""},23:{value:a.relatedPersons?JSON.stringify(a.relatedPersons):""}}],{data:t}=await u.upsertRecordsXML({to:"bspfhy84a",data:n,fieldsToReturn:[7],formatObject:7});return t.length>0?{sync:t[0][7]}:t},b=async({wd:e,clm:a})=>{const{data:s}=await u.upsertRecordsXML({to:"bp3gb7ng2",data:[{3:{value:a[3]},568:{value:r()}}],fieldsToReturn:[549],formatObject:549});return{clm:s[0][549],sync:e}},y=async({request:e,employee:a})=>{const{data:s}=await l.getWorker(e);let n;if(s.length>0?n=s[0]:n=null,n)return await d({id:a[3],worker:n});{const t=[{3:{value:a[3]},22:{value:!0}}];return await d({values:t})}};export{S as a,d as b,b as s};
