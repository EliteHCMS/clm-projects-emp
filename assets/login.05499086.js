var de=Object.defineProperty;var J=Object.getOwnPropertySymbols;var ce=Object.prototype.hasOwnProperty,me=Object.prototype.propertyIsEnumerable;var W=(l,s,t)=>s in l?de(l,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[s]=t,L=(l,s)=>{for(var t in s||(s={}))ce.call(s,t)&&W(l,t,s[t]);if(J)for(var t of J(s))me.call(s,t)&&W(l,t,s[t]);return l};import{Q as pe}from"./QImg.e3932307.js";import{_ as ve,bM as fe,bL as ge,r as d,c as Q,w as b,aZ as I,A as c,an as v,bi as r,B as z,d as o,ao as p,D as q,cw as w,ab as P,bF as ye,bE as he,cx as X,as as be,bO as U,bI as j,E as we,cy as _e,au as K,cz as ke,aI as D}from"./index.b77499f4.js";import{Q as xe}from"./QForm.946b5d49.js";import{Q as Ce}from"./QPage.0d707061.js";import{u as qe}from"./use-quasar.289cfd4a.js";import{u as F}from"./vee-validate.esm.c3d07e58.js";import{p as Pe}from"./VueTelInput.d80e211a.js";import{_ as Me}from"./languageSelector.a4ce0719.js";import{c as M}from"./array.ac98669b.js";import{c as Te}from"./carousel.f65a2211.js";import{b as Ee,q as $}from"./quickbase.a8fc0a6c.js";import{u as Se}from"./i18n.3bb76871.js";import"./QItemLabel.cc149b4e.js";import"./QSelect.884d94d4.js";import"./QChip.6f1a18d8.js";import"./QMenu.25c2ee47.js";import"./position-engine.568da16f.js";import"./selection.e6fd70c2.js";import"./rtl.d0f7624c.js";import"./use-panel.802038da.js";import"./touch.9d375472.js";import"./use-fullscreen.c181eea0.js";import"./_commonjsHelpers.a26ce4be.js";import"./dayjs.7d293816.js";import"./index.7dbe61ef.js";import"./localForage.acd48c99.js";import"./api.3e41bf9d.js";const Ne={name:"Login",components:{phoneNumberInput:Pe,carousel:Te,languageSelector:Me},setup(){const l=qe(),s=fe(),t=ge(),{locale:e,t:_}=Se(),{currentUserType:k,currentPageType:V}=Ee(),n=d(!1),i=d(!1),x=d(10),u=d(!1),C=d(null),T=d(!1),ee=d("first"),g=d("username"),O=d(null),A=d(null),E=d(!1),S=d(!1);s.query.redirect&&(A.value=s.query.redirect,t.replace({query:{}}));const ae=Q(()=>n.value?M().email(`${_("validEmailIsRequired")}`).nullable():M().email(`${_("validEmailIsRequired")}`).nullable()),le=Q(()=>{if(i.value)return M().nullable();{const a=new RegExp("^[0-9]{"+x.value+"}","g");return M().matches(a,{excludeEmptyString:!0,message:`${_("validPhoneIsRequired")}`}).nullable()}}),se=Q(()=>M().required().matches(/^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d@$!%*#?&]{8,}$/,{excludeEmptyString:!0,message:`${_("passwordRules")}`}).nullable()),{errorMessage:B,value:y}=F("email",ae),{errorMessage:R,value:f}=F("phone",le),{errorMessage:Z,value:h,validate:oe}=F("password",se),te=d(!0);b(B,a=>{a||y.value===""?i.value=!1:i.value=!0}),b(y,a=>{!a||a===""?i.value=!1:/^\w+([.-]?\w+)*@\w+([.-]?\w+)*(\.\w{2,3})+$/.test(a)&&!B.value&&(i.value=!0)}),b(R,a=>{a||f.value===""?n.value=!1:n.value=!0}),b(f,a=>{!a||a===""?n.value=!1:a.length===x.value&&!R.value&&(n.value=!0)}),b(Z,a=>{a||h.value===""?u.value=!1:u.value=!0}),b(h,a=>{T.value=!1,!a||a===""?u.value=!1:oe().then(m=>{u.value=m.valid})});const re=a=>{x.value=a},H=Q(()=>!(n.value||i.value)),ne=a=>{C.value=a},ie=()=>{g.value="username",h.value=null,D(()=>{document.querySelector("#email").focus()})},ue=()=>{g.value="username",h.value=null,D(()=>{document.querySelector("#phoneNumber").focus()})},Y=async()=>{S.value=!0;const a={userType:k};n.value?a.phoneNumber=`+${C.value?C.value.dialCode:"1"}${f.value}`:i.value&&(a.email=y.value);try{const m=await $.checkIfUserExist(a);S.value=!1,m?(g.value="password",D(()=>{document.querySelector("#password").focus()})):k==="Candidate"?t.push({name:"register",params:L(L({},n.value&&{phoneTemp:f.value}),i.value&&{emailTemp:a.email})}):l.dialog({title:"Alert",message:n.value?"That phone number does not exist. Try again.":"That email does not exist. Try again."}).onOk(()=>{f.value="",n.value=!1,y.value="",i.value=!1})}catch(m){S.value=!1,console.log(m)}},G=async()=>{E.value=!0,clearTimeout(O.value);const a={password:h.value,userType:k};n.value?a.phoneNumber=`+${C.value?C.value.dialCode:"1"}${f.value}`:i.value&&(a.email=y.value);try{const m=await $.login(a);E.value=!1,m&&(A.value?t.push(A.value):t.push({path:"/"}))}catch(m){E.value=!1,O.value=setTimeout(function(){T.value=!1},7e3);const{response:N}=m;N&&N.data.errtext&&N.data.errdetail?l.notify({type:"negative",message:N.data.errdetail,timeout:7e3,position:l.screen.lt.md?"top":"top-right"}):(console.log(m),l.notify({type:"negative",message:"An error occurred, please try again later",timeout:7e3,position:l.screen.lt.md?"top":"top-right"}))}};return{email:y,phone:f,password:h,isPwd:te,validPhone:n,validEmail:i,step:g,validPassword:u,invalidLogin:T,continueProgress:S,loginProgress:E,passwordMessage:Z,phoneMessage:R,emailMessage:B,userNameInvalid:H,updatePhoneMaxLength:re,continueAction:Y,editUserNameEmail:ie,editUserNamePhoneNumber:ue,slide:ee,login:G,updateCountry:ne,onSubmit:a=>{g.value==="username"&&!H.value?Y():g.value==="password"&&!(!u.value||T.value)?G():a.preventDefault()},locale:e,currentUserType:k,currentPageType:V}}},Qe={key:0,class:"col-md-7 col-lg-8 col-lx-8"},Ie={class:"col-xs-12 col-sm-12 col-md-5 col-lg-4 col-lx-4 row justify-center items-center"},Ue={class:"text-dark"},Ve={key:1,class:"divider"},Ae={class:"divider-text"},Be={key:0,class:"text-grey-6",tabindex:"4"},Re={class:"row justify-center"},Le={class:"row justify-center"};function ze(l,s,t,e,_,k){const V=I("carousel"),n=I("phone-number-input"),i=I("router-link"),x=I("languageSelector");return c(),v(Ce,{class:"window-height window-width row"},{default:r(()=>[l.$q.screen.lt.md?p("",!0):(c(),z("div",Qe,[o(V)])),q("div",Ie,[o(ke,{class:"auth-card",flat:""},{default:r(()=>[o(w,{style:{"padding-left":"30px","padding-right":"30px"}},{default:r(()=>[o(pe,{src:"https://cdn.jsdelivr.net/gh/EliteHCMS/assets@latest/public/logo.svg",fit:"scale-down",class:"auth-logo full-width"})]),_:1}),o(w,{class:"text-center auth-description"},{default:r(()=>[q("p",Ue,P(l.$t("pleaseSignInToYourAccount")),1)]),_:1}),o(w,null,{default:r(()=>[o(xe,{class:"q-px-sm q-pt-sm",onSubmit:s[4]||(s[4]=ye(()=>{},["prevent"])),onKeyup:he(e.onSubmit,["enter"])},{default:r(()=>[!e.validEmail&&!e.validPhone||e.validEmail?(c(),v(X,{key:0,for:"email",style:{"padding-bottom":"0px"},autocomplete:"username",clearable:"",outlined:"",modelValue:e.email,"onUpdate:modelValue":s[0]||(s[0]=u=>e.email=u),type:"email",label:l.$t("email"),tabindex:"1",error:!!e.emailMessage,"error-message":e.emailMessage,readonly:e.step!=="username"},be({prepend:r(()=>[o(j,{name:"email"})]),_:2},[e.step!=="username"?{name:"append",fn:r(()=>[o(U,{round:"",dense:"",flat:"",icon:"edit",onClick:e.editUserNameEmail},null,8,["onClick"])]),key:"0"}:void 0]),1032,["modelValue","label","error","error-message","readonly"])):p("",!0),!e.validEmail&&!e.validPhone&&e.currentUserType!=="QuickBase User"?(c(),z("div",Ve,[q("div",Ae,P(l.$t("or")),1)])):p("",!0),(!e.validEmail&&!e.validPhone||e.validPhone)&&e.currentUserType!=="QuickBase User"?(c(),v(n,{key:2,outlined:"",for:"phoneNumber",modelValue:e.phone,"onUpdate:modelValue":s[1]||(s[1]=u=>e.phone=u),label:l.$t("phoneNumber"),tabindex:"1",autocomplete:"username",onMaxLengthChanged:e.updatePhoneMaxLength,style:we(e.phoneMessage?"padding-bottom: 20px;":"padding-bottom: 0px;"),error:!!e.phoneMessage,"error-message":e.phoneMessage,readonly:e.step!=="username",editIcon:e.step!=="username",onEditClicked:e.editUserNamePhoneNumber,onCountryChanged:e.updateCountry},null,8,["modelValue","label","onMaxLengthChanged","style","error","error-message","readonly","editIcon","onEditClicked","onCountryChanged"])):p("",!0),e.step==="password"?(c(),v(X,{key:3,for:"password",class:"q-mt-lg",outlined:"",modelValue:e.password,"onUpdate:modelValue":s[3]||(s[3]=u=>e.password=u),type:e.isPwd?"password":"text",label:l.$t("password"),autocomplete:"current-password",tabindex:"2",error:!!e.passwordMessage,"error-message":e.passwordMessage},{append:r(()=>[o(j,{name:e.isPwd?"visibility_off":"visibility",class:"cursor-pointer",onClick:s[2]||(s[2]=u=>e.isPwd=!e.isPwd)},null,8,["name"])]),prepend:r(()=>[o(j,{name:"lock"})]),_:1},8,["modelValue","type","label","error","error-message"])):p("",!0)]),_:1},8,["onKeyup"])]),_:1}),o(_e,{class:"q-px-lg"},{default:r(()=>[e.step==="username"?(c(),v(U,{key:0,loading:e.continueProgress,unelevated:"",size:"lg",color:"primary",class:"full-width text-white",label:l.$t("continue"),tabindex:"3",disabled:e.userNameInvalid,onClick:e.continueAction},null,8,["loading","label","disabled","onClick"])):p("",!0),e.step==="password"?(c(),v(U,{key:1,loading:e.loginProgress,unelevated:"",size:"lg",color:"primary",class:"full-width text-white",label:l.$t("login"),tabindex:"3",disabled:!e.validPassword||e.invalidLogin,onClick:e.login},null,8,["loading","label","disabled","onClick"])):p("",!0)]),_:1}),o(w,{class:"text-center q-pa-sm"},{default:r(()=>[e.currentUserType==="Candidate"?(c(),z("p",Be,[K(P(l.$t("needAnAccountQuestion"))+" ",1),o(i,{to:"/register",class:"text-grey-6"},{default:r(()=>[K(P(l.$t("register")),1)]),_:1})])):p("",!0),e.currentUserType!=="QuickBase User"?(c(),v(i,{key:1,to:"/forgot-password",class:"text-grey-6"},{default:r(()=>[K(P(l.$t("forgotPasswordQuestion")),1)]),_:1})):p("",!0)]),_:1}),o(w,{class:"q-pl-lg q-pa-sm"},{default:r(()=>[q("div",Re,[o(x,{dense:"",borderless:""})])]),_:1}),e.currentPageType==="Candidate Kiosk"?(c(),v(w,{key:0,class:"q-pl-lg q-pa-sm"},{default:r(()=>[q("div",Le,[o(U,{label:"Bookmarks",color:"primary",size:"md",class:"text-white q-mt-xl",to:{name:"bookmarks"}})])]),_:1})):p("",!0)]),_:1})])]),_:1})}var ga=ve(Ne,[["render",ze],["__scopeId","data-v-6f3ba52c"]]);export{ga as default};
