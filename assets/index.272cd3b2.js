import{Q as Pt}from"./QSpace.566833e3.js";import{bX as Te,r as w,c as I,w as P,aR as Ct,aV as Et,aT as dt,o as ft,b$ as It,h as D,bY as Tt,cJ as At,dv as re,cK as me,dw as De,aQ as Z,cE as pe,ce as Dt,cp as Nt,g as Ae,i as Lt,bZ as he,b_ as Qt,cM as Vt,cA as Mt,di as kt,a8 as F,N as qt,W as Ht,b as vt,Z as Rt,l as jt,Y as ue,bV as mt,A as E,B,aq as L,br as h,D as ae,d as g,ck as Ft,F as we,b4 as Oe,ax as R,ac as U,dn as Se,G as se,ar as te,cT as ge,cS as Ne,bW as X,E as Le,bN as _e,bt as J,bR as ee,bP as z,dc as Qe,bQ as Ve,cy as Bt,cU as ye,cV as zt}from"./index.90b022bc.js";import{Q as Ut,a as Me}from"./QHeader.a3d8aa36.js";import{Q as be}from"./QList.4306b48e.js";import{Q as Wt}from"./QMenu.9301279f.js";import{Q as Kt}from"./QToolbar.9148a8a7.js";import{Q as ke}from"./QSelect.09ac914d.js";import{Q as Yt,a as Gt}from"./QDrawer.2c69bb9c.js";import{Q as Xt,a as Jt}from"./QLayout.ef2af909.js";import{Q as Zt}from"./QResizeObserver.7163e2f6.js";import{C as le}from"./ClosePopup.96774051.js";import{u as ea}from"./use-quasar.0a055ece.js";import{Q as ta}from"./QImg.c5454b24.js";import{g as pt,r as K}from"./app.65ef9746.js";import{p as aa}from"./VueTelInput.99a4d414.js";import{c as oa}from"./array.59f93f43.js";import{u as na}from"./i18n.a8d34bee.js";import{u as ra}from"./vee-validate.esm.56090d73.js";import{_ as qe}from"./officeSelector.a7a1eac5.js";import"./position-engine.6cc4165f.js";import"./selection.f9ac9cf5.js";import"./QChip.8f9b531e.js";import"./rtl.b51694b1.js";import"./TouchPan.e6dd6253.js";import"./touch.70a9dd44.js";import"./_commonjsHelpers.a26ce4be.js";import"./dayjs.a1ba429d.js";import"./localForage.be7a4e81.js";import"./api.893bf48a.js";import"./index.04bc0a32.js";const{passive:W}=At;var ht=Te({name:"QInfiniteScroll",props:{offset:{type:Number,default:500},debounce:{type:[String,Number],default:100},scrollTarget:{default:void 0},initialIndex:Number,disable:Boolean,reverse:Boolean},emits:["load"],setup(e,{slots:t,emit:a}){const o=w(!1),n=w(!0),r=w(null),l=w(null);let s=e.initialIndex||0,u,d;const c=I(()=>"q-infinite-scroll__loading"+(o.value===!0?"":" invisible"));function f(){if(e.disable===!0||o.value===!0||n.value===!1)return;const m=re(u),N=me(u),q=De(u);e.reverse===!1?Math.round(N+q+e.offset)>=Math.round(m)&&i():Math.round(N)<=e.offset&&i()}function i(){if(e.disable===!0||o.value===!0||n.value===!1)return;s++,o.value=!0;const m=re(u);a("load",s,N=>{n.value===!0&&(o.value=!1,Z(()=>{if(e.reverse===!0){const q=re(u),ce=me(u),de=q-m;pe(u,ce+de)}N===!0?O():r.value&&r.value.closest("body")&&d()}))})}function v(){s=0}function _(){n.value===!1&&(n.value=!0,u.addEventListener("scroll",d,W)),f()}function O(){n.value===!0&&(n.value=!1,o.value=!1,u.removeEventListener("scroll",d,W),d!==void 0&&d.cancel!==void 0&&d.cancel())}function y(){if(u&&n.value===!0&&u.removeEventListener("scroll",d,W),u=Dt(r.value,e.scrollTarget),n.value===!0){if(u.addEventListener("scroll",d,W),e.reverse===!0){const m=re(u),N=De(u);pe(u,m-N)}f()}}function T(m){s=m}function M(m){m=parseInt(m,10);const N=d;d=m<=0?f:Nt(f,isNaN(m)===!0?100:m),u&&n.value===!0&&(N!==void 0&&u.removeEventListener("scroll",N,W),u.addEventListener("scroll",d,W))}function A(m){if(C.value===!0){if(l.value===null){m!==!0&&Z(()=>{A(!0)});return}const N=`${o.value===!0?"un":""}pauseAnimations`;Array.from(l.value.getElementsByTagName("svg")).forEach(q=>{q[N]()})}}const C=I(()=>e.disable!==!0&&n.value===!0);P([o,C],()=>{A()}),P(()=>e.disable,m=>{m===!0?O():_()}),P(()=>e.reverse,()=>{o.value===!1&&n.value===!0&&f()}),P(()=>e.scrollTarget,y),P(()=>e.debounce,M);let p=!1;Ct(()=>{p!==!1&&u&&pe(u,p)}),Et(()=>{p=u?me(u):!1}),dt(()=>{n.value===!0&&u.removeEventListener("scroll",d,W)}),ft(()=>{M(e.debounce),y(),o.value===!1&&A()});const $=Ae();return Object.assign($.proxy,{poll:()=>{d!==void 0&&d()},trigger:i,stop:O,reset:v,resume:_,setIndex:T}),()=>{const m=It(t.default,[]);return C.value===!0&&m[e.reverse===!1?"push":"unshift"](D("div",{ref:l,class:c.value},Tt(t.loading))),D("div",{class:"q-infinite-scroll",ref:r},m)}}}),la=Te({name:"QFooter",props:{modelValue:{type:Boolean,default:!0},reveal:Boolean,bordered:Boolean,elevated:Boolean,heightHint:{type:[String,Number],default:50}},emits:["reveal","focusin"],setup(e,{slots:t,emit:a}){const{proxy:{$q:o}}=Ae(),n=Lt(Qt,he);if(n===he)return console.error("QFooter needs to be child of QLayout"),he;const r=w(parseInt(e.heightHint,10)),l=w(!0),s=w(Vt.value===!0||n.isContainer.value===!0?0:window.innerHeight),u=I(()=>e.reveal===!0||n.view.value.indexOf("F")>-1||o.platform.is.ios&&n.isContainer.value===!0),d=I(()=>n.isContainer.value===!0?n.containerHeight.value:s.value),c=I(()=>{if(e.modelValue!==!0)return 0;if(u.value===!0)return l.value===!0?r.value:0;const p=n.scroll.value.position+d.value+r.value-n.height.value;return p>0?p:0}),f=I(()=>e.modelValue!==!0||u.value===!0&&l.value!==!0),i=I(()=>e.modelValue===!0&&f.value===!0&&e.reveal===!0),v=I(()=>"q-footer q-layout__section--marginal "+(u.value===!0?"fixed":"absolute")+"-bottom"+(e.bordered===!0?" q-footer--bordered":"")+(f.value===!0?" q-footer--hidden":"")+(e.modelValue!==!0?" q-layout--prevent-focus"+(u.value!==!0?" hidden":""):"")),_=I(()=>{const p=n.rows.value.bottom,$={};return p[0]==="l"&&n.left.space===!0&&($[o.lang.rtl===!0?"right":"left"]=`${n.left.size}px`),p[2]==="r"&&n.right.space===!0&&($[o.lang.rtl===!0?"left":"right"]=`${n.right.size}px`),$});function O(p,$){n.update("footer",p,$)}function y(p,$){p.value!==$&&(p.value=$)}function T({height:p}){y(r,p),O("size",p)}function M(){if(e.reveal!==!0)return;const{direction:p,position:$,inflectionPoint:m}=n.scroll.value;y(l,p==="up"||$-m<100||n.height.value-d.value-$-r.value<300)}function A(p){i.value===!0&&y(l,!0),a("focusin",p)}P(()=>e.modelValue,p=>{O("space",p),y(l,!0),n.animate()}),P(c,p=>{O("offset",p)}),P(()=>e.reveal,p=>{p===!1&&y(l,e.modelValue)}),P(l,p=>{n.animate(),a("reveal",p)}),P([r,n.scroll,n.height],M),P(()=>o.screen.height,p=>{n.isContainer.value!==!0&&y(s,p)});const C={};return n.instances.footer=C,e.modelValue===!0&&O("size",r.value),O("space",e.modelValue),O("offset",c.value),dt(()=>{n.instances.footer===C&&(n.instances.footer=void 0,O("size",0),O("offset",0),O("space",!1))}),()=>{const p=Mt(t.default,[D(Zt,{debounce:0,onResize:T})]);return e.elevated===!0&&p.push(D("div",{class:"q-layout__shadow absolute-full overflow-hidden no-pointer-events"})),D("footer",{class:v.value,style:_.value,onFocusin:A},p)}}}),sa=Te({name:"QChatMessage",props:{sent:Boolean,label:String,bgColor:String,textColor:String,name:String,avatar:String,text:Array,stamp:String,size:String,labelHtml:Boolean,nameHtml:Boolean,textHtml:Boolean,stampHtml:Boolean},setup(e,{slots:t}){const a=I(()=>e.sent===!0?"sent":"received"),o=I(()=>`q-message-text-content q-message-text-content--${a.value}`+(e.textColor!==void 0?` text-${e.textColor}`:"")),n=I(()=>`q-message-text q-message-text--${a.value}`+(e.bgColor!==void 0?` text-${e.bgColor}`:"")),r=I(()=>"q-message-container row items-end no-wrap"+(e.sent===!0?" reverse":"")),l=I(()=>e.size!==void 0?`col-${e.size}`:""),s=I(()=>({msg:e.textHtml===!0?"innerHTML":"textContent",stamp:e.stampHtml===!0?"innerHTML":"textContent",name:e.nameHtml===!0?"innerHTML":"textContent",label:e.labelHtml===!0?"innerHTML":"textContent"}));function u(c){return t.stamp!==void 0?[c,D("div",{class:"q-message-stamp"},t.stamp())]:e.stamp?[c,D("div",{class:"q-message-stamp",[s.value.stamp]:e.stamp})]:[c]}function d(c,f){const i=f===!0?c.length>1?v=>v:v=>D("div",[v]):v=>D("div",{[s.value.msg]:v});return c.map((v,_)=>D("div",{key:_,class:n.value},[D("div",{class:o.value},u(i(v)))]))}return()=>{const c=[];t.avatar!==void 0?c.push(t.avatar()):e.avatar!==void 0&&c.push(D("img",{class:`q-message-avatar q-message-avatar--${a.value}`,src:e.avatar,"aria-hidden":"true"}));const f=[];t.name!==void 0?f.push(D("div",{class:`q-message-name q-message-name--${a.value}`},t.name())):e.name!==void 0&&f.push(D("div",{class:`q-message-name q-message-name--${a.value}`,[s.value.name]:e.name})),t.default!==void 0?f.push(d(kt(t.default()),!0)):e.text!==void 0&&f.push(d(e.text)),c.push(D("div",{class:l.value},f));const i=[];return t.label!==void 0?i.push(D("div",{class:"q-message-label"},t.label())):e.label!==void 0&&i.push(D("div",{class:"q-message-label",[s.value.label]:e.label})),i.push(D("div",{class:r.value},c)),D("div",{class:`q-message q-message-${a.value}`},i)}}}),He;const oe=typeof window!="undefined",ua=e=>typeof e=="function",ia=e=>typeof e=="string",H=()=>{},xe=oe&&((He=window==null?void 0:window.navigator)==null?void 0:He.userAgent)&&/iP(ad|hone|od)/.test(window.navigator.userAgent);function Q(e){return typeof e=="function"?e():F(e)}function gt(e,t){function a(...o){return new Promise((n,r)=>{Promise.resolve(e(()=>t.apply(this,o),{fn:t,thisArg:this,args:o})).then(n).catch(r)})}return a}function ca(e,t={}){let a,o,n=H;const r=s=>{clearTimeout(s),n(),n=H};return s=>{const u=Q(e),d=Q(t.maxWait);return a&&r(a),u<=0||d!==void 0&&d<=0?(o&&(r(o),o=null),Promise.resolve(s())):new Promise((c,f)=>{n=t.rejectOnCancel?f:c,d&&!o&&(o=setTimeout(()=>{a&&r(a),o=null,c(s())},d)),a=setTimeout(()=>{o&&r(o),o=null,c(s())},u)})}}function da(e,t=!0,a=!0,o=!1){let n=0,r,l=!0,s=H,u;const d=()=>{r&&(clearTimeout(r),r=void 0,s(),s=H)};return f=>{const i=Q(e),v=Date.now()-n,_=()=>u=f();return d(),i<=0?(n=Date.now(),_()):(v>i&&(a||!l)?(n=Date.now(),_()):t&&(u=new Promise((O,y)=>{s=o?y:O,r=setTimeout(()=>{n=Date.now(),l=!0,O(_()),d()},Math.max(0,i-v))})),!a&&!r&&(r=setTimeout(()=>l=!0,i)),l=!1,u)}}const j={mounted:"mounted",updated:"updated",unmounted:"unmounted"};function fa(e){return e}function Y(e){return qt()?(Ht(e),!0):!1}function va(e,t=200,a={}){return gt(ca(t,a),e)}function ma(e,t=200,a=!1,o=!0,n=!1){return gt(da(t,a,o,n),e)}function pa(e){return typeof e=="function"?I(e):w(e)}function ha(e,t=!0){Ae()?ft(e):t?e():Z(e)}function ga(e,t=1e3,a={}){const{immediate:o=!0,immediateCallback:n=!1}=a;let r=null;const l=w(!1);function s(){r&&(clearInterval(r),r=null)}function u(){l.value=!1,s()}function d(){const c=Q(t);c<=0||(l.value=!0,n&&e(),s(),r=setInterval(e,c))}if(o&&oe&&d(),vt(t)||ua(t)){const c=P(t,()=>{l.value&&oe&&d()});Y(c)}return Y(u),{isActive:l,pause:u,resume:d}}const _a=oe?window:void 0,$e=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},Pe="__vueuse_ssr_handlers__";$e[Pe]=$e[Pe]||{};$e[Pe];function ya(e,t={}){const{immediate:a=!0,window:o=_a}=t,n=w(!1);let r=0,l=null;function s(c){if(!n.value||!o)return;const f=c-r;e({delta:f,timestamp:c}),r=c,l=o.requestAnimationFrame(s)}function u(){!n.value&&o&&(n.value=!0,l=o.requestAnimationFrame(s))}function d(){n.value=!1,l!=null&&o&&(o.cancelAnimationFrame(l),l=null)}return a&&u(),Y(d),{isActive:Rt(n),pause:d,resume:u}}var ba=Object.defineProperty,Re=Object.getOwnPropertySymbols,wa=Object.prototype.hasOwnProperty,Oa=Object.prototype.propertyIsEnumerable,je=(e,t,a)=>t in e?ba(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,Sa=(e,t)=>{for(var a in t||(t={}))wa.call(t,a)&&je(e,a,t[a]);if(Re)for(var a of Re(t))Oa.call(t,a)&&je(e,a,t[a]);return e};function xa(e={}){const{controls:t=!1,interval:a="requestAnimationFrame"}=e,o=w(new Date),n=()=>o.value=new Date,r=a==="requestAnimationFrame"?ya(n,{immediate:!0}):ga(n,a,{immediate:!0});return t?Sa({now:o},r):o}var Fe;(function(e){e.UP="UP",e.RIGHT="RIGHT",e.DOWN="DOWN",e.LEFT="LEFT",e.NONE="NONE"})(Fe||(Fe={}));var $a=Object.defineProperty,ie=Object.getOwnPropertySymbols,_t=Object.prototype.hasOwnProperty,yt=Object.prototype.propertyIsEnumerable,Be=(e,t,a)=>t in e?$a(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,Pa=(e,t)=>{for(var a in t||(t={}))_t.call(t,a)&&Be(e,a,t[a]);if(ie)for(var a of ie(t))yt.call(t,a)&&Be(e,a,t[a]);return e},Ca=(e,t)=>{var a={};for(var o in e)_t.call(e,o)&&t.indexOf(o)<0&&(a[o]=e[o]);if(e!=null&&ie)for(var o of ie(e))t.indexOf(o)<0&&yt.call(e,o)&&(a[o]=e[o]);return a};const Ea=[{max:6e4,value:1e3,name:"second"},{max:276e4,value:6e4,name:"minute"},{max:72e6,value:36e5,name:"hour"},{max:5184e5,value:864e5,name:"day"},{max:24192e5,value:6048e5,name:"week"},{max:28512e6,value:2592e6,name:"month"},{max:1/0,value:31536e6,name:"year"}],Ia={justNow:"just now",past:e=>e.match(/\d/)?`${e} ago`:e,future:e=>e.match(/\d/)?`in ${e}`:e,month:(e,t)=>e===1?t?"last month":"next month":`${e} month${e>1?"s":""}`,year:(e,t)=>e===1?t?"last year":"next year":`${e} year${e>1?"s":""}`,day:(e,t)=>e===1?t?"yesterday":"tomorrow":`${e} day${e>1?"s":""}`,week:(e,t)=>e===1?t?"last week":"next week":`${e} week${e>1?"s":""}`,hour:e=>`${e} hour${e>1?"s":""}`,minute:e=>`${e} minute${e>1?"s":""}`,second:e=>`${e} second${e>1?"s":""}`,invalid:""},Ta=e=>e.toISOString().slice(0,10);function Aa(e,t={}){const{controls:a=!1,updateInterval:o=3e4}=t,n=xa({interval:o,controls:!0}),{now:r}=n,l=Ca(n,["now"]),s=I(()=>Da(new Date(Q(e)),t,F(r.value)));return a?Pa({timeAgo:s},l):s}function Da(e,t={},a=Date.now()){var o;const{max:n,messages:r=Ia,fullDateFormatter:l=Ta,units:s=Ea,showSecond:u=!1,rounding:d="round"}=t,c=typeof d=="number"?y=>+y.toFixed(d):Math[d],f=+a-+e,i=Math.abs(f);function v(y,T){return c(Math.abs(y)/T.value)}function _(y,T){const M=v(y,T),A=y>0,C=O(T.name,M,A);return O(A?"past":"future",C,A)}function O(y,T,M){const A=r[y];return typeof A=="function"?A(T,M):A.replace("{0}",T.toString())}if(i<6e4&&!u)return r.justNow;if(typeof n=="number"&&i>n)return l(new Date(e));if(typeof n=="string"){const y=(o=s.find(T=>T.name===n))==null?void 0:o.max;if(y&&i>y)return l(new Date(e))}for(const[y,T]of s.entries()){if(v(f,T)<=0&&s[y-1])return _(f,s[y-1]);if(i<T.max)return _(f,T)}return r.invalid}var Na=Object.defineProperty,ze=Object.getOwnPropertySymbols,La=Object.prototype.hasOwnProperty,Qa=Object.prototype.propertyIsEnumerable,Ue=(e,t,a)=>t in e?Na(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,Va=(e,t)=>{for(var a in t||(t={}))La.call(t,a)&&Ue(e,a,t[a]);if(ze)for(var a of ze(t))Qa.call(t,a)&&Ue(e,a,t[a]);return e};const Ma={easeInSine:[.12,0,.39,0],easeOutSine:[.61,1,.88,1],easeInOutSine:[.37,0,.63,1],easeInQuad:[.11,0,.5,0],easeOutQuad:[.5,1,.89,1],easeInOutQuad:[.45,0,.55,1],easeInCubic:[.32,0,.67,0],easeOutCubic:[.33,1,.68,1],easeInOutCubic:[.65,0,.35,1],easeInQuart:[.5,0,.75,0],easeOutQuart:[.25,1,.5,1],easeInOutQuart:[.76,0,.24,1],easeInQuint:[.64,0,.78,0],easeOutQuint:[.22,1,.36,1],easeInOutQuint:[.83,0,.17,1],easeInExpo:[.7,0,.84,0],easeOutExpo:[.16,1,.3,1],easeInOutExpo:[.87,0,.13,1],easeInCirc:[.55,0,1,.45],easeOutCirc:[0,.55,.45,1],easeInOutCirc:[.85,0,.15,1],easeInBack:[.36,0,.66,-.56],easeOutBack:[.34,1.56,.64,1],easeInOutBack:[.68,-.6,.32,1.6]};Va({linear:fa},Ma);function V(e){var t;const a=Q(e);return(t=a==null?void 0:a.$el)!=null?t:a}const G=oe?window:void 0;function k(...e){let t,a,o,n;if(ia(e[0])||Array.isArray(e[0])?([a,o,n]=e,t=G):[t,a,o,n]=e,!t)return H;Array.isArray(a)||(a=[a]),Array.isArray(o)||(o=[o]);const r=[],l=()=>{r.forEach(c=>c()),r.length=0},s=(c,f,i,v)=>(c.addEventListener(f,i,v),()=>c.removeEventListener(f,i,v)),u=P(()=>[V(t),Q(n)],([c,f])=>{l(),c&&r.push(...a.flatMap(i=>o.map(v=>s(c,i,v,f))))},{immediate:!0,flush:"post"}),d=()=>{u(),l()};return Y(d),d}let We=!1;function Ke(e,t,a={}){const{window:o=G,ignore:n=[],capture:r=!0,detectIframe:l=!1}=a;if(!o)return;xe&&!We&&(We=!0,Array.from(o.document.body.children).forEach(i=>i.addEventListener("click",H)));let s=!0;const u=i=>n.some(v=>{if(typeof v=="string")return Array.from(o.document.querySelectorAll(v)).some(_=>_===i.target||i.composedPath().includes(_));{const _=V(v);return _&&(i.target===_||i.composedPath().includes(_))}}),c=[k(o,"click",i=>{const v=V(e);if(!(!v||v===i.target||i.composedPath().includes(v))){if(i.detail===0&&(s=!u(i)),!s){s=!0;return}t(i)}},{passive:!0,capture:r}),k(o,"pointerdown",i=>{const v=V(e);v&&(s=!i.composedPath().includes(v)&&!u(i))},{passive:!0}),l&&k(o,"blur",i=>{var v;const _=V(e);((v=o.document.activeElement)==null?void 0:v.tagName)==="IFRAME"&&!(_!=null&&_.contains(o.document.activeElement))&&t(i)})].filter(Boolean);return()=>c.forEach(i=>i())}j.mounted+"",j.unmounted+"";const ka=e=>typeof e=="function"?e:typeof e=="string"?t=>t.key===e:Array.isArray(e)?t=>e.includes(t.key):()=>!0;function Ye(...e){let t,a,o={};e.length===3?(t=e[0],a=e[1],o=e[2]):e.length===2?typeof e[1]=="object"?(t=!0,a=e[0],o=e[1]):(t=e[0],a=e[1]):(t=!0,a=e[0]);const{target:n=G,eventName:r="keydown",passive:l=!1}=o,s=ka(t);return k(n,r,d=>{s(d)&&a(d)},l)}var qa=Object.defineProperty,Ge=Object.getOwnPropertySymbols,Ha=Object.prototype.hasOwnProperty,Ra=Object.prototype.propertyIsEnumerable,Xe=(e,t,a)=>t in e?qa(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,ja=(e,t)=>{for(var a in t||(t={}))Ha.call(t,a)&&Xe(e,a,t[a]);if(Ge)for(var a of Ge(t))Ra.call(t,a)&&Xe(e,a,t[a]);return e};j.mounted+"";const Fa=500;function Je(e,t,a){var o,n;const r=I(()=>V(e));let l;function s(){l&&(clearTimeout(l),l=void 0)}function u(c){var f,i,v,_;((f=a==null?void 0:a.modifiers)==null?void 0:f.self)&&c.target!==r.value||(s(),(i=a==null?void 0:a.modifiers)!=null&&i.prevent&&c.preventDefault(),(v=a==null?void 0:a.modifiers)!=null&&v.stop&&c.stopPropagation(),l=setTimeout(()=>t(c),(_=a==null?void 0:a.delay)!=null?_:Fa))}const d={capture:(o=a==null?void 0:a.modifiers)==null?void 0:o.capture,once:(n=a==null?void 0:a.modifiers)==null?void 0:n.once};k(r,"pointerdown",u,d),k(r,"pointerup",s,d),k(r,"pointerleave",s,d)}j.mounted+"";const Ce=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},Ee="__vueuse_ssr_handlers__";Ce[Ee]=Ce[Ee]||{};Ce[Ee];function bt(e,t=!1){const a=w(),o=()=>a.value=Boolean(e());return o(),ha(o,t),a}function Ba(e,t={}){const a=t?t.delayEnter:0,o=t?t.delayLeave:0,n=w(!1);let r;const l=s=>{const u=s?a:o;r&&(clearTimeout(r),r=void 0),u?r=setTimeout(()=>n.value=s,u):n.value=s};return window&&(k(e,"mouseenter",()=>l(!0),{passive:!0}),k(e,"mouseleave",()=>l(!1),{passive:!0})),n}j.mounted+"";var Ze=Object.getOwnPropertySymbols,za=Object.prototype.hasOwnProperty,Ua=Object.prototype.propertyIsEnumerable,Wa=(e,t)=>{var a={};for(var o in e)za.call(e,o)&&t.indexOf(o)<0&&(a[o]=e[o]);if(e!=null&&Ze)for(var o of Ze(e))t.indexOf(o)<0&&Ua.call(e,o)&&(a[o]=e[o]);return a};function Ka(e,t,a={}){const o=a,{window:n=G}=o,r=Wa(o,["window"]);let l;const s=bt(()=>n&&"ResizeObserver"in n),u=()=>{l&&(l.disconnect(),l=void 0)},d=P(()=>V(e),f=>{u(),s.value&&n&&f&&(l=new ResizeObserver(t),l.observe(f,r))},{immediate:!0,flush:"post"}),c=()=>{u(),d()};return Y(c),{isSupported:s,stop:c}}function Ya(e,t={width:0,height:0},a={}){const{window:o=G,box:n="content-box"}=a,r=I(()=>{var u,d;return(d=(u=V(e))==null?void 0:u.namespaceURI)==null?void 0:d.includes("svg")}),l=w(t.width),s=w(t.height);return Ka(e,([u])=>{const d=n==="border-box"?u.borderBoxSize:n==="content-box"?u.contentBoxSize:u.devicePixelContentBoxSize;if(o&&r.value){const c=V(e);if(c){const f=o.getComputedStyle(c);l.value=parseFloat(f.width),s.value=parseFloat(f.height)}}else if(d){const c=Array.isArray(d)?d:[d];l.value=c.reduce((f,{inlineSize:i})=>f+i,0),s.value=c.reduce((f,{blockSize:i})=>f+i,0)}else l.value=u.contentRect.width,s.value=u.contentRect.height},a),P(()=>V(e),u=>{l.value=u?t.width:0,s.value=u?t.height:0}),{width:l,height:s}}j.mounted+"";function et(e,{window:t=G,scrollTarget:a}={}){const o=w(!1),n=()=>{if(!t)return;const r=t.document,l=V(e);if(!l)o.value=!1;else{const s=l.getBoundingClientRect();o.value=s.top<=(t.innerHeight||r.documentElement.clientHeight)&&s.left<=(t.innerWidth||r.documentElement.clientWidth)&&s.bottom>=0&&s.right>=0}};return P(()=>V(e),()=>n(),{immediate:!0,flush:"post"}),t&&k(a||t,"scroll",n,{capture:!1,passive:!0}),o}j.mounted+"";const tt=1;function Ie(e,t={}){const{throttle:a=0,idle:o=200,onStop:n=H,onScroll:r=H,offset:l={left:0,right:0,top:0,bottom:0},eventListenerOptions:s={capture:!1,passive:!0},behavior:u="auto"}=t,d=w(0),c=w(0),f=I({get(){return d.value},set(C){v(C,void 0)}}),i=I({get(){return c.value},set(C){v(void 0,C)}});function v(C,p){var $,m,N;const q=Q(e);!q||(N=q instanceof Document?document.body:q)==null||N.scrollTo({top:($=Q(p))!=null?$:i.value,left:(m=Q(C))!=null?m:f.value,behavior:Q(u)})}const _=w(!1),O=ue({left:!0,right:!1,top:!0,bottom:!1}),y=ue({left:!1,right:!1,top:!1,bottom:!1}),T=C=>{!_.value||(_.value=!1,y.left=!1,y.right=!1,y.top=!1,y.bottom=!1,n(C))},M=va(T,a+o),A=C=>{const p=C.target===document?C.target.documentElement:C.target,$=p.scrollLeft;y.left=$<d.value,y.right=$>c.value,O.left=$<=0+(l.left||0),O.right=$+p.clientWidth>=p.scrollWidth-(l.right||0)-tt,d.value=$;let m=p.scrollTop;C.target===document&&!m&&(m=document.body.scrollTop),y.top=m<c.value,y.bottom=m>c.value,O.top=m<=0+(l.top||0),O.bottom=m+p.clientHeight>=p.scrollHeight-(l.bottom||0)-tt,c.value=m,_.value=!0,M(C),r(C)};return k(e,"scroll",a?ma(A,a,!0,!1):A,s),k(e,"scrollend",T,s),{x:f,y:i,isScrolling:_,arrivedState:O,directions:y}}var Ga=Object.defineProperty,Xa=Object.defineProperties,Ja=Object.getOwnPropertyDescriptors,at=Object.getOwnPropertySymbols,Za=Object.prototype.hasOwnProperty,eo=Object.prototype.propertyIsEnumerable,ot=(e,t,a)=>t in e?Ga(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,nt=(e,t)=>{for(var a in t||(t={}))Za.call(t,a)&&ot(e,a,t[a]);if(at)for(var a of at(t))eo.call(t,a)&&ot(e,a,t[a]);return e},to=(e,t)=>Xa(e,Ja(t));function rt(e,t,a={}){var o,n;const r=(o=a.direction)!=null?o:"bottom",l=ue(Ie(e,to(nt({},a),{offset:nt({[r]:(n=a.distance)!=null?n:0},a.offset)})));P(()=>l.arrivedState[r],async s=>{var u,d;if(s){const c=Q(e),f={height:(u=c==null?void 0:c.scrollHeight)!=null?u:0,width:(d=c==null?void 0:c.scrollWidth)!=null?d:0};await t(l),a.preserveScrollPosition&&c&&Z(()=>{c.scrollTo({top:c.scrollHeight-f.height,left:c.scrollWidth-f.width})})}})}j.mounted+"";function lt(e,t,a={}){const{root:o,rootMargin:n="0px",threshold:r=.1,window:l=G}=a,s=bt(()=>l&&"IntersectionObserver"in l);let u=H;const d=s.value?P(()=>({el:V(e),root:V(o)}),({el:f,root:i})=>{if(u(),!f)return;const v=new IntersectionObserver(t,{root:i,rootMargin:n,threshold:r});v.observe(f),u=()=>{v.disconnect(),u=H}},{immediate:!0,flush:"post"}):H,c=()=>{u(),d()};return Y(c),{isSupported:s,stop:c}}j.mounted+"";var ao=Object.defineProperty,oo=Object.defineProperties,no=Object.getOwnPropertyDescriptors,st=Object.getOwnPropertySymbols,ro=Object.prototype.hasOwnProperty,lo=Object.prototype.propertyIsEnumerable,ut=(e,t,a)=>t in e?ao(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,so=(e,t)=>{for(var a in t||(t={}))ro.call(t,a)&&ut(e,a,t[a]);if(st)for(var a of st(t))lo.call(t,a)&&ut(e,a,t[a]);return e},uo=(e,t)=>oo(e,no(t));j.mounted+"";function wt(e){const t=window.getComputedStyle(e);if(t.overflowX==="scroll"||t.overflowY==="scroll"||t.overflowX==="auto"&&e.clientHeight<e.scrollHeight||t.overflowY==="auto"&&e.clientWidth<e.scrollWidth)return!0;{const a=e.parentNode;return!a||a.tagName==="BODY"?!1:wt(a)}}function io(e){const t=e||window.event,a=t.target;return wt(a)?!1:t.touches.length>1?!0:(t.preventDefault&&t.preventDefault(),!1)}function co(e,t=!1){const a=w(t);let o=null,n;P(pa(e),s=>{if(s){const u=s;n=u.style.overflow,a.value&&(u.style.overflow="hidden")}},{immediate:!0});const r=()=>{const s=Q(e);!s||a.value||(xe&&(o=k(s,"touchmove",u=>{io(u)},{passive:!1})),s.style.overflow="hidden",a.value=!0)},l=()=>{const s=Q(e);!s||!a.value||(xe&&(o==null||o()),s.style.overflow=n,a.value=!1)};return Y(l),I({get(){return a.value},set(s){s?r():l()}})}const fo=()=>{let e=!1;const t=w(!1);return(a,o)=>{if(t.value=o.value,e)return;e=!0;const n=co(a,o.value);P(t,r=>n.value=r)}};fo();var vo=Object.defineProperty,mo=Object.defineProperties,po=Object.getOwnPropertyDescriptors,it=Object.getOwnPropertySymbols,ho=Object.prototype.hasOwnProperty,go=Object.prototype.propertyIsEnumerable,ct=(e,t,a)=>t in e?vo(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,_o=(e,t)=>{for(var a in t||(t={}))ho.call(t,a)&&ct(e,a,t[a]);if(it)for(var a of it(t))go.call(t,a)&&ct(e,a,t[a]);return e},yo=(e,t)=>mo(e,po(t));const Ot=jt({name:"UseTimeAgo",props:["time","updateInterval","max","fullDateFormatter","messages","showSecond"],setup(e,{slots:t}){const a=ue(Aa(()=>e.time,yo(_o({},e),{controls:!0})));return()=>{if(t.default)return t.default(a)}}}),bo={class:"q-pa-md row justify-center"},wo={class:"row justify-center q-my-md"},Oo={key:0},So={__name:"chatLog",props:{conversation:{type:Object,default:()=>({})}},setup(e){const t=e,a=pt(),{getMessageNotification:o}=mt(a),n=w(null),r=w([]),l=w(20),s=c=>{const f=[...r.value,...c].sort((_,O)=>new Date(_.createdAt)-new Date(O.createdAt)),i=[],v=new Map;for(const _ of f)v.has(_.id)||(v.set(_.id,!0),i.push(_));t.conversation.id==="new"?r.value=[]:r.value=i},u=(c,f)=>K.getMessages({filters:{conversation:{id:c}},populate:{contact:!0,conversation:{filters:{id:c}}},sort:"createdAt:desc",pagination:{page:f,pageSize:l.value}}).then(i=>{const v=i.data.length===0||i.data.length<l.value;return(!v||i.data.length>0)&&s(i.data),v}),d=async(c,f)=>{t.conversation.id==="new"?f(!0):u(t.conversation.id,c).then(i=>{f(i)})};return P(()=>t.conversation,async()=>{r.value=[]}),P(o,()=>{o.value.conversation&&o.value.conversation.id===t.conversation.id?(s([o.value]),o.value.direction==="inbound"&&K.readConversation(t.conversation.id),Z(()=>{const c=document.querySelector("#conversation-layout div.scroll");c.scrollTop=c.scrollHeight})):console.log(o.value)}),(c,f)=>(E(),B("div",bo,[(E(),L(ht,{style:{width:"100%"},reverse:"",onLoad:d,ref_key:"messageScroll",ref:n,key:e.conversation.id},{loading:h(()=>[ae("div",wo,[g(Ft,{color:"primary",name:"dots",size:"40px"})])]),default:h(()=>[(E(!0),B(we,null,Oe(r.value,(i,v)=>(E(),B("div",{key:v},[g(sa,{sent:i.direction==="outbound-api",name:i.direction==="inbound"?e.conversation.name:`${i.contact.firstName} ${i.contact.lastName}`,"text-color":i.direction==="outbound-api"?"white":"","bg-color":i.direction==="outbound-api"?"primary":"amber"},{stamp:h(()=>[g(F(Ot),{time:i.createdAt},{default:h(({timeAgo:_})=>[R(U(_),1)]),_:2},1032,["time"])]),avatar:h(()=>[g(Se,{class:se(["q-message-avatar",{"q-message-avatar--sent":i.direction==="outbound-api","q-message-avatar--received":i.direction==="inbound"}]),color:i.direction==="outbound-api"?"primary":"amber"},{default:h(()=>[R("J")]),_:2},1032,["class","color"])]),default:h(()=>[ae("div",null,[R(U(i.body)+" ",1),i.numMedia>0?(E(),B("div",Oo,[(E(!0),B(we,null,Oe(i.mediaUrl,(_,O)=>(E(),L(ta,{src:_,fit:"contain","spinner-color":"white",style:{height:"150px","max-width":"300px",width:"100%"},key:O},null,8,["src"]))),128))])):te("",!0)])]),_:2},1032,["sent","name","text-color","bg-color"])]))),128))]),_:1}))]))}},xo={class:"q-pa-md",style:{height:"92vh"}},$o={class:"row items-center"},Po={class:"col-12 col-md-3 q-px-sm"},Co={key:0},Eo={key:1,class:"q-pa-md row justify-center text-h5"},Io={class:"text-h6"},ln={__name:"index",setup(e){const t=ea(),a=pt(),{fetchConversations:o,setConversation:n}=a,{getConversations:r}=mt(a),{t:l}=na(),s=w(50),u=w(null),d=w(!1),c=w(""),f=w(""),i=w(""),v=w(10),_=I(()=>{const S=new RegExp("^[0-9]{"+v.value+"}","g");return oa().matches(S,{excludeEmptyString:!0,message:`${l("validPhoneIsRequired")}`}).nullable()}),{errorMessage:O,value:y}=ra("phone",_),T=w([]),M={background:"#D3D3D3"},A=w(!1),C=async(S,x)=>{A.value||(A.value=!0,o(S,s.value).then(b=>{A.value=!1,x(b)}))},p=w(!0),$=w(""),m=w(null),N=S=>{m.value=S,c.value=S.name,f.value=S.contacts[0].firstName,i.value=S.contacts[0].lastName,y.value="",S.unread&&(K.readConversation(S.id),S.unread=!1)},q=async()=>{const S={data:{phoneNumber:y.value,type:"phoneNumber"}},x=await K.createContact(S);x.data.valid===!0&&x.data.conversations[0]&&(console.log(x.data.conversations[0]),N(x.data.conversations[0])),console.log(x)},ce=()=>{const S=new Date;m.value={id:"new",createdAt:S,lastMessage:{},lastMessageDateTime:S,name:"",readBy:[],twilioEnabled:!0,twilio_messaging_service:{},type:"Direct",unread:!1,updatedAt:S},Z(()=>{document.querySelector("#phoneNumber").focus()})},de=S=>{S.contacts[0].valid===!0&&S.twilio_messaging_service?K.sendMessage({data:{body:$.value,to:S.contacts[0].phoneNumber,messagingServiceSid:S.twilio_messaging_service.sid,direction:"outbound-api",twilioMessage:!0}}).then(()=>{$.value=""}):console.log("not valid phone number")},fe=async()=>{const S={data:{name:`${f.value} ${i.value}`}},x={data:{firstName:f.value,lastName:i.value}};if(m.value){const b=K.updateContact(m.value.contacts[0].id,x),ne=K.updateConversation(m.value.id,S),$t=await b,ve=await ne;return ve.data.contacts=[$t.data],n({data:ve.data}),ve}},St=async()=>{const S=await t.dialog({type:"file",accept:"image/*, audio/*, video/*"});S&&T.value.push(S)},xt=S=>{v.value=S};return(S,x)=>(E(),B("div",xo,[g(Ne,{flat:""},{default:h(()=>[g(ge,null,{default:h(()=>[ae("div",$o,[g(Pt),ae("div",Po,[g(qe,{can:"read",styleSelection:!0})])])]),_:1})]),_:1}),g(Jt,{view:"lHh Lpr lFf",container:"",style:{height:"100%"},class:"shadow-2 rounded-borders bg-grey-3",id:"conversation-layout"},{default:h(()=>[m.value?(E(),L(Ut,{key:0,bordered:"",class:"bg-white text-black",style:{height:"57px"}},{default:h(()=>[g(Kt,null,{default:h(()=>[g(X,{dense:"",flat:"",round:"",icon:"menu",onClick:x[0]||(x[0]=b=>p.value=!p.value)}),!m.value||m.value.id==="new"?(E(),L(Me,{key:0},{default:h(()=>[g(aa,{for:"phoneNumber",modelValue:F(y),"onUpdate:modelValue":x[1]||(x[1]=b=>vt(y)?y.value=b:null),label:S.$t("phoneNumber"),tabindex:"0",onMaxLengthChanged:xt,style:Le(F(O)?"padding-bottom: 20px; max-width: 250px;":"padding-bottom: 0px; max-width: 250px;"),error:!!F(O),"error-message":F(O),readonly:!1,editIcon:!1,onAddClicked:q,onKeyup:_e(q,["enter"])},null,8,["modelValue","label","style","error","error-message","onKeyup"])]),_:1})):(E(),L(Me,{key:1},{default:h(()=>[R(U(m.value.name),1)]),_:1})),g(X,{dense:"",flat:"",round:"",icon:"more_vert"},{default:h(()=>[g(Wt,null,{default:h(()=>[g(be,{style:{"min-width":"100px"}},{default:h(()=>[J((E(),L(ee,{clickable:""},{default:h(()=>[g(z,{onClick:x[2]||(x[2]=b=>d.value=!0)},{default:h(()=>[R("Edit")]),_:1})]),_:1})),[[le]]),J((E(),L(ee,{clickable:""},{default:h(()=>[g(z,null,{default:h(()=>[R("Archive")]),_:1})]),_:1})),[[le]])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):te("",!0),g(Yt,{"show-if-above":"",modelValue:p.value,"onUpdate:modelValue":x[4]||(x[4]=b=>p.value=b),side:"left",width:350,bordered:""},{default:h(()=>[g(Gt,{class:"fit",id:"scroll-id"},{default:h(()=>[g(be,{separator:""},{default:h(()=>[J((E(),L(ee,{clickable:"",onClick:x[3]||(x[3]=b=>ce())},{default:h(()=>[g(z,{avatar:"",top:""},{default:h(()=>[g(Se,{icon:"add",color:"grey","text-color":"white"})]),_:1}),g(z,null,{default:h(()=>[R("New Message")]),_:1})]),_:1})),[[Qe]]),g(ee,null,{default:h(()=>[g(z,null,{default:h(()=>[g(qe,{styleSelection:!0})]),_:1})]),_:1})]),_:1}),g(be,{bordered:""},{default:h(()=>[g(ht,{style:{width:"100%"},onLoad:C,ref_key:"conversationScroll",ref:u},{default:h(()=>[(E(!0),B(we,null,Oe(F(r),b=>J((E(),L(ee,{key:b.id,clickable:"",onClick:ne=>N(b),style:Le(m.value&&m.value.id===b.id?M:null)},{default:h(()=>[g(z,{avatar:""},{default:h(()=>[g(Se,{color:"primary","text-color":"white"},{default:h(()=>[b.letter?(E(),B("span",Co,U(b.letter),1)):(E(),L(Ve,{key:1,name:"person"}))]),_:2},1024)]),_:2},1024),g(z,null,{default:h(()=>[g(ke,{lines:"1",class:se({"text-bold":b.unread})},{default:h(()=>[R(U(b.name),1)]),_:2},1032,["class"]),g(ke,{caption:"",lines:"2",class:se({"text-bold":b.unread,"text-black":b.unread})},{default:h(()=>[b.lastMessage&&b.lastMessage.body?(E(),L(Ve,{key:0,size:"xs",name:b.lastMessage.direction==="inbound"?"call_received":"call_made",color:b.lastMessage.direction==="inbound"?"green":"red"},null,8,["name","color"])):te("",!0),R(" "+U(b.lastMessage&&b.lastMessage.body),1)]),_:2},1032,["class"])]),_:2},1024),g(z,{side:"",top:"",class:se({"text-bold":b.unread,"text-black":b.unread})},{default:h(()=>[b.lastMessageDateTime?(E(),L(F(Ot),{key:0,time:new Date(b.lastMessageDateTime)},{default:h(({timeAgo:ne})=>[R(U(ne),1)]),_:2},1032,["time"])):te("",!0)]),_:2},1032,["class"])]),_:2},1032,["onClick","style"])),[[Qe]])),128))]),_:1},512)]),_:1})]),_:1})]),_:1},8,["modelValue"]),g(Xt,null,{default:h(()=>[m.value?(E(),L(So,{key:0,conversation:m.value},null,8,["conversation"])):(E(),B("div",Eo,"Select a conversation"))]),_:1}),g(Bt,{modelValue:d.value,"onUpdate:modelValue":x[7]||(x[7]=b=>d.value=b),persistent:""},{default:h(()=>[g(Ne,{style:{"min-width":"350px"}},{default:h(()=>[g(ge,null,{default:h(()=>[ae("div",Io,U(c.value),1)]),_:1}),g(ge,{class:"q-pt-none"},{default:h(()=>[g(ye,{modelValue:f.value,"onUpdate:modelValue":x[5]||(x[5]=b=>f.value=b),label:"First Name",autofocus:"",onKeyup:_e(fe,["enter"])},null,8,["modelValue","onKeyup"]),g(ye,{modelValue:i.value,"onUpdate:modelValue":x[6]||(x[6]=b=>i.value=b),label:"Last Name",autofocus:"",onKeyup:_e(fe,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),g(zt,{align:"right",class:"text-primary"},{default:h(()=>[J(g(X,{flat:"",label:"Cancel"},null,512),[[le]]),J(g(X,{flat:"",label:"Update",onClick:fe},null,512),[[le]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),m.value?(E(),L(la,{key:1,class:"bg-white"},{default:h(()=>[g(ye,{autogrow:"",modelValue:$.value,"onUpdate:modelValue":x[9]||(x[9]=b=>$.value=b),placeholder:"Type a message",rounded:"",dense:"",standout:"",class:"q-py-sm"},{before:h(()=>[g(X,{round:"",dense:"",flat:"",icon:"attach_file",onClick:St})]),after:h(()=>[g(X,{round:"",dense:"",flat:"",icon:"send",onClick:x[8]||(x[8]=b=>de(m.value)),disabled:!m.value||m.value.id==="new"},null,8,["disabled"])]),_:1},8,["modelValue"])]),_:1})):te("",!0)]),_:1})]))}};export{ln as default};
