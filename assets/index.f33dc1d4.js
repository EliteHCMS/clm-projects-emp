import{Q as C}from"./QSpace.0aefa4da.js";import{c1 as z,r as c,w as N,aK as Y,c as g,z as A,A as O,d as a,bh as d,c2 as T,C as m,E as b,a6 as o,aa as P,c3 as E,cx as L,bX as M,c6 as S}from"./index.52c71ca6.js";import{Q as R}from"./QTd.be89a153.js";import{u as U}from"./use-quasar.8076b8cd.js";import{e as W}from"./export-file.6b95af49.js";import{R as K,c as X}from"./quickbase.0d6b62e6.js";import{dayjs as F}from"./dayjs.7e2f14dc.js";import{_ as G,a as H}from"./aTable.0ed71fc6.js";import{_ as J}from"./projectsTab.caf12251.js";import"./_commonjsHelpers.dfee5925.js";import"./localForage.83b50c47.js";import"./index.7dbe61ef.js";import"./i18n.3d69f992.js";import"./api.14a19609.js";import"./QSelect.02464590.js";import"./QChip.bee081d7.js";import"./QMenu.b5435217.js";import"./position-engine.901fa583.js";import"./selection.445971ab.js";import"./rtl.a367ced8.js";import"./QTable.34b4b377.js";import"./QList.dade0d45.js";import"./QMarkupTable.6709601e.js";import"./use-fullscreen.57b102bc.js";import"./QBadge.58e5f8ba.js";import"./QRouteTab.81b0e7cb.js";import"./QTabs.b09ba654.js";import"./QResizeObserver.cd0d3c43.js";const Z={class:"q-pa-md"},ee={class:"row items-center"},te={class:"col-12 col-md-6 q-px-sm"},ae={class:"col-12 col-md-4 q-px-sm"},oe={class:"col-12 col-md-5 q-px-sm"},qe={__name:"index",setup(le){const n=U(),_=K(),{openWindow:y}=X(),{fetchPendingProjects:w,fetchAllPendingProjects:h}=_,{getPendingProjects:B,getSelectedOffice:r,getLoadingState:D}=z(_),i=c(r.value?r.value[8]:null),p=c("Pending Projects"),Q=c("pendingProjects"),f=c(""),k=c({sortBy:"13",descending:!1,rowsPerPage:150});i.value?w({selectedId:i.value}):h({can:"read"}),N(r,()=>{i.value=r.value?r.value[8]:null,i.value?w({selectedId:i.value}):h({can:"read"})});const I=c(new Date),$=setInterval(()=>{I.value=new Date},1e3);Y(()=>{clearInterval($)});const q=g(()=>["id","name","location","customer","action",...r.value?[]:["office"]]),v=g(()=>[{name:"id",align:"left",label:"ID",field:"3",sortable:!1},{name:"name",align:"left",label:"Name",field:"298",sortable:!0},{name:"location",align:"center",label:"Location",field:"24",sortable:!0},{name:"customer",align:"center",label:"Customer",field:"25",sortable:!0},{name:"office",align:"center",label:"Office",field:"76",sortable:!1},{name:"action",align:"center",label:"",sortable:!1}]),u=g(()=>B.value(i.value).filter(l=>!0).sort((l,s)=>l[298].localeCompare(s[298]))),V=l=>{y(null,{url:`https://elitehcms.quickbase.com/db/bpz457c9d?a=dbpage&pageID=204&proj_id=${l[3]}&ut=hc`,name:"Project Build"})},x=(l,s,t)=>{let e=s!==void 0?s(l,t):l;return e=e==null?"":String(e),e=e.split('"').join('""'),`"${e}"`},j=()=>{const l=[v.value.map(t=>x(t.label))].concat(u.value.map(t=>v.value.map(e=>x(typeof e.field=="function"?e.field(t):t[e.field===void 0?e.name:e.field],e.format,t)).join(","))).join(`\r
`);W(`${p.value} ${F().format("MM.DD.YYYY")}.csv`,l,"text/csv")!==!0&&n.notify({message:"Browser denied file download...",color:"negative",icon:"warning"})};return(l,s)=>(A(),O("div",Z,[a(J),a(E,{flat:"",class:"q-pt-none"},{default:d(()=>[a(T,null,{default:d(()=>[m("div",ee,[m("div",te,[m("div",{class:b(["text-dark",o(n).screen.lt.md?"text-body1":"text-h5"])},P(p.value),3)]),a(C),m("div",ae,[a(G,{can:"read",styleSelection:!0})])])]),_:1})]),_:1}),a(H,{rows:o(u),columns:o(v),pagination:k.value,filter:f.value,title:p.value,separator:"vertical","row-key":"3",loading:o(D)(Q.value),"visible-columns":o(q),downloadButton:!0,onDownload:j},{top:d(()=>[m("div",oe,[a(L,{dense:o(n).screen.lt.md,modelValue:f.value,"onUpdate:modelValue":s[0]||(s[0]=t=>f.value=t),label:"Search...",clearable:""},{prepend:d(()=>[a(M,{name:"search"})]),_:1},8,["dense","modelValue"])]),a(C),m("div",{class:b(["text-dark text-caption text-italic",o(n).screen.lt.md?"offset-xs-5":""])},"(Total: "+P(o(u).length)+")",3),a(S,{dense:o(n).screen.lt.md,class:b(["q-ml-sm",o(n).screen.lt.md?"full-width":""]),color:"primary",label:"Download",disable:o(u).length<1,onClick:j},null,8,["dense","class","disable"])]),"body-cell-action":d(t=>[a(R,{props:t},{default:d(()=>[a(S,{color:"primary",label:"Continue Building Project",onClick:e=>V(t.row),size:".75rem"},null,8,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","columns","pagination","filter","title","loading","visible-columns"])]))}};export{qe as default};
