import{Q as R}from"./QPage.3f484e7d.js";import{Q as y,a as A,b as $,c as q}from"./QTabPanels.98e8142e.js";import{Q as B}from"./QToolbar.fa2b5cc4.js";import{k as b,c1 as w,r as g,o as F,w as W,c as T,_ as k,z as o,A as d,C as t,am as v,bh as c,d as i,F as _,aX as f,c3 as D,c2 as P,aa as n,E as V,an as x,aY as N}from"./index.8744acc9.js";import{Q as C}from"./QMarkupTable.96bc4b89.js";import{Q as S}from"./QSplitter.d2bc02ba.js";import{m as E,b as U,h as z}from"./quickbase.368b5cef.js";import{analytics as Q}from"./analytics.929caca6.js";import{u as H}from"./use-quasar.c9fdbdc8.js";import"./QResizeObserver.4bc3ad97.js";import"./rtl.65b79c69.js";import"./use-panel.4df19e8b.js";import"./touch.d8ab472d.js";import"./selection.93d2bcd6.js";import"./TouchPan.29c93fd7.js";import"./_commonjsHelpers.dfee5925.js";import"./dayjs.fb19d223.js";import"./localForage.33f4b296.js";import"./index.7dbe61ef.js";import"./i18n.95e10b4b.js";import"./api.ab696573.js";const I=b({components:{},setup(){const e=H();e.loadingBar.setDefaults({color:"accent",size:"10px",position:"top"});const{assignmentsForProject:l}=w(E()),{projectCrafts:h}=w(U()),p=g(null),u=g(null),m=g(null),a=["bg-primary text-white","bg-info text-white","bg-accent text-dark","bg-dark text-white"];return F(async()=>{e.loadingBar.start(),l.value.length>0&&(u.value=await Q.calcRateData({assignments:l.value.filter(r=>!r[112]),projectCrafts:h.value}),p.value=u.value[0][3]),e.loadingBar.stop()}),W(l,async()=>{m.value=null,e.loadingBar.start(),l.value.length>0&&(u.value=await Q.calcRateData({assignments:l.value.filter(r=>!r[112]),projectCrafts:h.value}),p.value=u.value[0][3]),e.loadingBar.stop()}),W(m,async(r,Tt)=>{m.value&&console.log(m.value)}),{craftWageArray:T(()=>u.value?u.value:[]),colors:a,clickedCraft:m,tab:p,splitValue:g(20),helpers:z}}}),J={class:"row text-caption"},M={class:"col-12 col-md-2"},G=t("div",null,[t("span",{class:"text-accent"},"Total Employees:")],-1),L={class:"text-white q-ml-sm"},X={class:"col-12 col-md-2"},Y=t("div",null,[t("span",{class:"text-accent"},"Classifications:")],-1),K={class:"text-white q-ml-sm"},O={class:"col-12 col-md-2"},Z=t("div",null,[t("span",{class:"text-accent"},"Avg. Wage:")],-1),j={class:"text-white q-ml-sm"},tt={class:"col-12 col-md-2"},et=t("div",null,[t("span",{class:"text-accent"},"Avg. Craft Wage:")],-1),at={class:"text-white q-ml-sm"},st={class:"col-12 col-md-3"},lt=t("div",null,[t("span",{class:"text-accent"},"Wage Status")],-1),ot={class:"text-white q-ml-sm"},nt=t("thead",{class:"bg-dark text-white"},[t("tr",null,[t("th",{class:"text-left"},"Job Title"),t("th",{class:"text-right"},"# of Employees"),t("th",{class:"text-right"},"Fixed Rate"),t("th",{class:"text-right"},"Average Rate"),t("th",{class:"text-right"},"Difference")])],-1),it=["onClick"],rt={class:"text-left"},ct={class:"text-right"},dt={class:"text-right"},ut={class:"text-right"},mt={class:"text-right"},pt={key:1},ht=t("td",{colspan:"100%",class:"text-center"},"No classifications to show",-1),_t=[ht],gt={key:2},ft={colspan:"100%"},vt=t("thead",{class:"bg-dark text-white"},[t("tr",null,[t("th",{class:"text-left"},"Name"),t("th",{class:"text-left"},"Employee ID"),t("th",{class:"text-left"},"Payroll ID"),t("th",{class:"text-left"},"Job Number"),t("th",{class:"text-right"},"Rate")])],-1),xt={class:"text-left"},yt={class:"text-left"},$t={class:"text-left"},bt={class:"text-left"},kt={class:"text-right"},wt={key:1},Wt=t("div",{class:"text-h6"},"Not available on mobile yet.",-1),Vt=[Wt];function Ct(e,l,h,p,u,m){return o(),d("div",null,[t("div",null,[e.$q.screen.gt.sm&&e.craftWageArray?(o(),v(S,{key:0,modelValue:e.splitValue,"onUpdate:modelValue":l[2]||(l[2]=a=>e.splitValue=a)},{before:c(()=>[i(A,{modelValue:e.tab,"onUpdate:modelValue":l[0]||(l[0]=a=>e.tab=a),vertical:e.$q.screen.gt.md,align:"left","indicator-color":"accent","active-bg-color":"dark","active-color":"white"},{default:c(()=>[(o(!0),d(_,null,f(e.craftWageArray,a=>(o(),v(y,{key:a[3],name:a[3],label:a[10]},null,8,["name","label"]))),128))]),_:1},8,["modelValue","vertical"])]),after:c(()=>[i(q,{modelValue:e.tab,"onUpdate:modelValue":l[1]||(l[1]=a=>e.tab=a),animated:"",vertical:e.$q.screen.gt.md},{default:c(()=>[(o(!0),d(_,null,f(e.craftWageArray,a=>(o(),v($,{key:a[3],name:a[3],class:"q-pt-none"},{default:c(()=>[t("div",null,[i(D,{class:"q-mb-md bg-dark"},{default:c(()=>[i(P,{class:"q-pa-sm"},{default:c(()=>[t("div",J,[t("div",M,[G,t("div",null,[t("span",L,n(a.craftRoster.length),1)])]),t("div",X,[Y,t("div",null,[t("span",K,n(a.classifications.length),1)])]),t("div",O,[Z,t("div",null,[t("span",j,"$"+n(a.avgWage.toFixed(2)),1)])]),t("div",tt,[et,t("div",null,[t("span",at,"$"+n(a.avgCraftWorkerWage.toFixed(2)),1)])]),t("div",st,[lt,t("div",null,[t("span",ot,n(a.highWages?`${a.highWageCount} with High Wages`:"Good"),1)])])])]),_:2},1024)]),_:2},1024),i(C,null,{default:c(()=>[nt,t("tbody",null,[(o(!0),d(_,null,f(a.classifications,s=>(o(),d(_,{key:s[3]},[s?(o(),d("tr",{key:0,class:V(["cursor-pointer",s.analytics.highWages?"bg-negative text-white":""]),onClick:r=>s.expanded=!s.expanded},[t("td",rt,n(s[18]),1),t("td",ct,n(s.analytics.roster.length),1),t("td",dt,n(s.analytics.fixedWage>0?`$${s.analytics.fixedWage.toFixed(2)}`:"N/A"),1),t("td",ut,n(s.analytics.avgWage>0?`$${s.analytics.avgWage.toFixed(2)}`:"N/A"),1),t("td",mt,n(s.analytics.avgWage>0&&s.analytics.fixedWage>0?`${s.analytics.diff>0?"+":""}${s.analytics.diff}`:"N/A"),1)],10,it)):x("",!0),s?x("",!0):(o(),d("tr",pt,_t)),s.expanded?(o(),d("tr",gt,[t("td",ft,[i(C,{dense:""},{default:c(()=>[vt,t("tbody",null,[(o(!0),d(_,null,f(s.analytics.roster,r=>(o(),d("tr",{key:r[3],class:V(r[116]>s.analytics.fixedWage&&s.analytics.fixedWage>0?"bg-accent":"")},[t("td",xt,n(e.helpers.formatName(r[75])),1),t("td",yt,n(r.employee[378]),1),t("td",$t,n(r.employee[213]===""?"N/A":r.employee[213]),1),t("td",bt,n(r[105]),1),t("td",kt,"$"+n(r[116].toFixed(2)),1)],2))),128))])]),_:2},1024)])])):x("",!0)],64))),128))])]),_:2},1024)])]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue","vertical"])]),_:1},8,["modelValue"])):(o(),d("div",wt,Vt))])])}var Qt=k(I,[["render",Ct]]);const At=b({components:{RatesPanel:Qt},setup(){return{tab:g(0)}}}),qt={class:"q-px-sm"};function Nt(e,l,h,p,u,m){const a=N("rates-panel");return o(),d("div",qt,[i(B,{class:"bg-info text-white shadow-2 rounded-borders"},{default:c(()=>[i(A,{modelValue:e.tab,"onUpdate:modelValue":l[0]||(l[0]=s=>e.tab=s),"bg-color":"none","indicator-color":"accent"},{default:c(()=>[i(y,{name:0,label:"Rates"}),i(y,{name:1,label:"Requests"})]),_:1},8,["modelValue"])]),_:1}),i(q,{modelValue:e.tab,"onUpdate:modelValue":l[1]||(l[1]=s=>e.tab=s),animated:""},{default:c(()=>[i($,{name:0},{default:c(()=>[i(a)]),_:1}),i($,{name:1})]),_:1},8,["modelValue"])])}var Rt=k(At,[["render",Nt]]);const Bt=b({name:"Analytics",components:{dash:Rt},setup(){return{}}});function Ft(e,l,h,p,u,m){const a=N("dash");return o(),v(R,{style:{"max-width":"100vw"}},{default:c(()=>[i(a)]),_:1})}var se=k(Bt,[["render",Ft]]);export{se as default};
