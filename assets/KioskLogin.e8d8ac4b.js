import{bT as P,bV as L,r as g,c as _,A as D,aq as N,br as t,d as s,cS as O,cT as p,cU as q,a8 as i,b as x,bQ as k,cV as T,bW as V,D as c,ac as $,H as z,bO as E,bN as I,cy as j}from"./index.12db37a0.js";import{u as F}from"./use-quasar.34cab930.js";import{u as Q}from"./vee-validate.esm.ec1f1315.js";import{c as B}from"./array.59f93f43.js";import{d as H,q as W}from"./app.28fdf8e0.js";const G=c("div",{class:"text-h6"},"Kiosk Login",-1),J={class:"divider"},X={class:"divider-text"},Y={class:"text-h6"},le={__name:"KioskLogin",setup(Z){const{screen:n,notify:u}=F(),f=P(),v=H(),{fetchKioskAccount:K,setBookmarks:C,setBookmarksOnly:R,loginKiosk:ee}=v,{getBookMarksOnly:M}=L(v),d=g(!0),b=g(null),o=g(!1),S=_(()=>B().email().required().nullable()),U=_(()=>B().required().nullable()),{errorMessage:y,value:r}=Q("email",S),{errorMessage:w,value:l}=Q("password",U),h=async()=>{if(r.value===""||l.value===""||!r.value||!l.value){u({type:"negative",message:"Email and password Required!",timeout:7e3,position:n.lt.md?"top":"top-right"});return}o.value=!0;const m={email:r.value,password:l.value};try{const e=await W.nativeQuickbaseLogin(m);(await K(e,!0)).length===0?(u({type:"negative",message:"Valid Kiosk Account Required!",timeout:7e3,position:n.lt.md?"top":"top-right"}),o.value=!1):(o.value=!1,b.value.hide(),M.value&&f.push({name:"bookmarks"}))}catch(e){o.value=!1;const{response:a}=e;a&&a.data.errtext&&a.data.errdetail?u({type:"negative",message:a.data.errdetail,timeout:7e3,position:n.lt.md?"top":"top-right"}):(console.log(e),u({type:"negative",message:"An error occurred, please try again later",timeout:7e3,position:n.lt.md?"top":"top-right"}))}},A=()=>{C(null,!0),R(!0,!0),f.push({name:"bookmarks"})};return(m,e)=>(D(),N(j,z({persistent:""},m.$attrs,{ref_key:"dialog",ref:b,onSubmit:e[3]||(e[3]=E(()=>{},["prevent"])),onKeyup:I(h,["enter"])}),{default:t(()=>[s(O,{style:{"min-width":"350px"}},{default:t(()=>[s(p,null,{default:t(()=>[G]),_:1}),s(p,{class:"q-pt-none"},{default:t(()=>[s(q,{for:"email-kiosk",style:{"padding-bottom":"0px"},autocomplete:"username",clearable:"",outlined:"",modelValue:i(r),"onUpdate:modelValue":e[0]||(e[0]=a=>x(r)?r.value=a:null),type:"email",label:"Email",tabindex:"1",error:!!i(y),"error-message":i(y)},{prepend:t(()=>[s(k,{name:"email"})]),_:1},8,["modelValue","error","error-message"])]),_:1}),s(p,{class:"q-pt-none"},{default:t(()=>[s(q,{for:"password-kiosk",class:"q-mt-lg",outlined:"",modelValue:i(l),"onUpdate:modelValue":e[2]||(e[2]=a=>x(l)?l.value=a:null),type:d.value?"password":"text",label:"Password",autocomplete:"current-password",tabindex:"2",error:!!i(w),"error-message":i(w)},{append:t(()=>[s(k,{name:d.value?"visibility_off":"visibility",class:"cursor-pointer",onClick:e[1]||(e[1]=a=>d.value=!d.value)},null,8,["name"])]),prepend:t(()=>[s(k,{name:"lock"})]),_:1},8,["modelValue","type","error","error-message"])]),_:1}),s(T,{align:"right",class:"text-primary"},{default:t(()=>[s(V,{label:"Login",color:"primary",size:"lg",class:"full-width text-white",onClick:h,loading:o.value,disabled:o.value},null,8,["loading","disabled"])]),_:1}),c("div",J,[c("div",X,$(m.$t("or")),1)]),s(p,{align:"center"},{default:t(()=>[c("div",Y,[s(V,{label:"Bookmarks",color:"primary",size:"lg",class:"full-width text-white",onClick:A})])]),_:1})]),_:1})]),_:1},16,["onKeyup"]))}};export{le as _};
