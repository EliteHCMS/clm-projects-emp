import{l as z,c as _,_ as j,A as c,an as h,bi as n,d as o,cw as Q,D as a,au as q,ab as u,bK as U,cz as V,r as L,y as J,aZ as E,B as P,bI as w,bO as I,ao as T,F as A,aY as N,G as F}from"./index.50a0cfd4.js";import{Q as G}from"./QInnerLoading.0bb94f29.js";import{Q as S,a as K}from"./QTable.335cc480.js";import{Q as B}from"./QTr.bac2d088.js";import{Q as M}from"./QTd.04fdd51a.js";import{u as R}from"./use-quasar.71e23bf0.js";import{e as W}from"./export-file.751205c9.js";import{dayjs as $}from"./dayjs.e4b3ebad.js";import{b as Z,u as H}from"./quickbase.6e17af23.js";const X=z({name:"Pipeline Summary",components:{},props:{pipeline:Array},setup(t,y){const f=_(()=>t.pipeline.filter(l=>l.type==="In Process"||l.type==="Dispatch")),i=_(()=>t.pipeline.filter(l=>l.type==="Deployed"&&l[20]==="In Process")),b=_(()=>f.value.length+i.value.length);return{props:t,inProcess:f,deployed:i,total:b}}}),ee=a("div",{class:"text-body1 text-primary"},"Summary",-1),te={class:"text-body2"},se=a("span",{class:"q-mr-md"},"In Process:",-1),re=a("span",null,null,-1),ae={class:"text-body2"},ne=a("span",{class:"q-mr-md"},"Deployed:",-1),oe={class:"text-body2"},le=a("span",{class:"q-mr-md"},"Total:",-1);function ie(t,y,f,i,b,g){return c(),h(V,null,{default:n(()=>[o(Q,{class:"q-pb-xs"},{default:n(()=>[ee]),_:1}),o(Q,{class:"text-right q-pt-xs"},{default:n(()=>[a("div",te,[se,q(u(t.inProcess.length),1),re]),a("div",ae,[ne,a("span",null,u(t.deployed.length),1)]),o(U,{color:"primary",class:"q-my-sm"}),a("div",oe,[le,a("span",null,u(t.total),1)])]),_:1})]),_:1})}var de=j(X,[["render",ie]]);const{openWindow:pe}=Z(),ce=z({name:"Pipeline Table",components:{PipelineSummary:de},props:{rows:Array,selected:Array},setup(t,y){const f=R(),{capitalize:i}=J,b=L(!1),{getUserType:g}=H(),l=_(()=>f.screen.gt.sm?[{name:1,label:"Name",align:"left",field:e=>s(e.employee),format:e=>`${e}`,sortable:!0},{name:7,label:"Status",align:"left",field:e=>d(e),format:e=>`${e}`,sortable:!0,sortOrder:"ad"},{name:2,label:"Offer Date",align:"left",field:e=>Y(e),format:e=>`${$(e).format("MM/DD/YYYY")}`,sortable:!0},{name:4,label:"Classification",align:"left",field:e=>k(e),format:e=>`${!e||e===""?"Not Assigned":e}`,sortable:!0},{name:5,label:"Job #",align:"left",field:e=>v(e),format:e=>`${e===""||!e?"Not Assigned":e}`,sortable:!0},{name:6,label:"Arrival Date",align:"left",field:e=>x(e),format:e=>`${e?$(e).format("MM/DD/YYYY"):"TBD"}`,sortable:!0}]:[{name:1,label:"Name",align:"left",field:e=>s(e.employee),format:e=>`${e}`,sortable:!0},{name:7,label:"Status",align:"left",field:e=>d(e),format:e=>`${e}`,sortable:!0,sortOrder:"ad"},{name:2,label:"Offer Date",align:"left",field:e=>Y(e),format:e=>`${$(e).format("MM/DD/YYYY")}`,sortable:!0},{name:4,label:"Classification",align:"left",field:e=>k(e),format:e=>`${!e||e===""?"Not Assigned":e}`,sortable:!0},{name:5,label:"Job #",align:"left",field:e=>v(e),format:e=>`${e===""||!e?"Not Assigned":e}`,sortable:!0},{name:6,label:"Arrival Date",align:"left",field:e=>x(e),format:e=>`${e?$(e).format("MM/DD/YYYY"):"TBD"}`,sortable:!0}]),s=e=>{const m=e[20]!==""?i(e[20].toLowerCase().trim()):"",D=e[22]!==""?i(e[22].toLowerCase().trim()):"",r=e[21]!==""?` ${i(e[21].toLowerCase().trim())}`:"",p=e[23]!==""?` ${i(e[23])}`:"";return`${D}${p}, ${m}${r}`};function d(e){if(e.type==="In Process")return"In Process";if(e.type==="Dispatch")return"In Process";if(e.type==="Deployed")return"Deployed"}function Y(e){if(e.type==="In Process")return e[197].$d;if(e.type==="Dispatch")return e[165].$d;if(e.type==="Deployed")return e[144].$d}function k(e){if(e.type==="In Process")return e[106];if(e.type==="Dispatch")return e[45];if(e.type==="Deployed")return e[45]}function v(e){if(e.type==="In Process")return e[44];if(e.type==="Dispatch")return e[63];if(e.type==="Deployed")return e[85]}function x(e){if(e.type==="In Process")return null;if(e.type==="Dispatch")return null;if(e.type==="Deployed")return e[33].$d}const C=(e,m,D)=>{let r=m!==void 0?m(e,D):e;return r=r==null?"":String(r),r=r.split('"').join('""'),`"${r}"`};function O(){const e=t.rows&&t.rows.value?t.rows.value:t.rows,m=[l.value.map(r=>C(r.label))].concat(e.map(r=>l.value.map(p=>C(typeof p.field=="function"?p.field(r):r[p.field===void 0?p.name:p.field],p.format,r)).join(","))).join(`\r
`);W(`${$().format("MM.DD.YYYY")} Project-Pipeline-Export.csv`,m,"text/csv")!==!0&&f.notify({message:"Browser denied file download...",color:"negative",icon:"warning"})}return{columns:l,props:t,loading:b,exportPipeline:O,viewProfile:e=>{pe(null,{url:`https://elitehcms.quickbase.com/db/bpzpy6n3x?a=dbpage&pageID=2&ee=${e[16]}`,name:"View Profile"})},getUserType:g}}}),fe={class:"q-px-sm"},me={class:"row"},ue={class:"col-12 col-md-10 q-px-xs"},ye={class:"full-width row flex-center text-primary q-gutter-sm q-py-md"};function be(t,y,f,i,b,g){const l=E("pipeline-summary");return c(),P("div",fe,[a("div",me,[a("div",ue,[o(K,{dense:"",columns:t.columns,rows:t.props.rows,"row-key":s=>s[3],class:"q-pa-sm",pagination:{rowsPerPage:t.$q.screen.gt.sm?25:100},separator:"vertical","table-header-class":"bg-dark text-white","no-data-label":"There is no one in the pipeline",loading:t.loading,grid:t.$q.screen.lt.md},{"no-data":n(({message:s})=>[a("div",ye,[o(w,{size:"2em",name:"fa-solid fa-person-circle-exclamation"}),a("span",null,u(s),1)])]),"top-right":n(()=>[o(I,{color:"secondary",flat:"","icon-right":"refresh",label:"Refresh",onClick:y[0]||(y[0]=s=>t.$emit("refresh"))}),o(I,{dense:t.$q.screen.lt.md,color:"primary",label:"Download",onClick:t.exportPipeline,disable:t.props.rows.length<1},null,8,["dense","onClick","disable"])]),loading:n(()=>[o(G,{showing:"",color:"primary"})]),header:n(s=>[o(B,{class:"bg-dark text-white",props:s},{default:n(()=>[t.getUserType==="QuickBase User"?(c(),h(S,{key:0,"auto-width":""})):T("",!0),(c(!0),P(A,null,N(s.cols,d=>(c(),h(S,{key:d.name,props:s},{default:n(()=>[q(u(d.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),body:n(s=>[o(B,{props:s},{default:n(()=>[t.getUserType==="QuickBase User"?(c(),h(M,{key:0,"auto-width":""},{default:n(()=>[o(w,{class:"cursor-pointer",size:t.$q.screen.gt.sm?"sm":"xs",color:"info",round:"",dense:"",onClick:d=>t.viewProfile(s.row),name:s.expand?"visibility_off":"visibility"},null,8,["size","onClick","name"])]),_:2},1024)):T("",!0),(c(!0),P(A,null,N(s.cols,d=>(c(),h(M,{key:d.name,props:s},{default:n(()=>[q(u(d.value),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),_:1},8,["columns","rows","row-key","pagination","loading","grid"])]),a("div",{class:F(t.$q.screen.lt.md?"col-12 q-px-xs q-mt-sm order-first":"col-2 q-px-xs")},[o(l,{pipeline:t.props.rows},null,8,["pipeline"])],2)])])}var xe=j(ce,[["render",be]]);export{xe as P};
