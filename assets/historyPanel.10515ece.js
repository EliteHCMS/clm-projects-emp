import{l as z,bM as O,r as h,c as g,_ as E,A as t,B as l,an as c,bi as s,d as m,bO as F,D as p,ab as i,ao as d,F as b,aY as k,au as I,bI as L}from"./index.87503ddf.js";import{Q}from"./QRating.30f7bf5d.js";import{Q as U}from"./QInnerLoading.d28d3fff.js";import{Q as V,a as _}from"./QTable.7cb52783.js";import{Q as R}from"./QTr.6daf63e7.js";import{Q as D}from"./QTd.c25b7489.js";import{u as A}from"./use-quasar.78532780.js";import{u as H}from"./dataStore.80b69ee2.js";import"./quickbase.184ca993.js";const S=z({props:{category:Object},components:{},setup(e){A();const u=O(),y=h(!0),w=h(!1),{getEmployee:v,updateViewedEmployees:$}=H(),a=g(()=>v(u.params.id)),o=g(()=>(a.value&&a.value.history&&a.value.history[e.category.key]?a.value.history[e.category.key]:[]).sort((r,q)=>r[1].$d>q[1].$d?-1:1)),f=async n=>{const{getter:r}=e.category;y.value=!0,await r(),y.value=!1},C=g(()=>{const{averageDuration:n,showDuration:r}=e.category;return r&&n?n(o.value):null}),T=g(()=>{const{completionRate:n,showCompletion:r}=e.category;return r&&n?n(o.value):null}),B=g(()=>{const{showRating:n,averageRating:r}=e.category;return n&&r?r(o.value):null}),N=n=>{const{viewer:r}=e.category;r&&r(n)};function P(n){}return f(),{props:e,loading:y,loadData:f,rows:o,initialPagination:h({rowsPerPage:100}),removeRow:P,addNew:w,duration:C,completion:T,rating:B,viewData:N}}}),j={key:0,class:"text-dark text-italic text-caption"},G={key:0},M={key:1},Y={key:2},J=p("span",{class:"q-mr-sm"},"Rating:",-1),K={key:0,class:"text-caption"},W={class:"full-width row flex-center text-primary q-gutter-sm q-py-md"};function X(e,u,y,w,v,$){return t(),l("div",null,[e.addNew?d("",!0):(t(),c(_,{key:0,dense:"",columns:e.category.columns.filter(a=>!a.hide),rows:e.rows,"row-key":a=>a[3],"table-header-class":"bg-dark text-white",class:"sticky-header-table",pagination:e.initialPagination,loading:e.loading,"no-data-label":`This employee has no ${e.category.label}.`},{"top-right":s(()=>[m(F,{color:"secondary",flat:"","icon-right":"refresh",label:"Refresh",onClick:u[0]||(u[0]=a=>e.loadData(!0))})]),"top-left":s(()=>[e.rows.length>0?(t(),l("div",j,[p("div",null,"Total - "+i(e.rows.length)+" "+i(e.category.label),1),e.category.showDuration&&e.duration?(t(),l("div",G,"Avg. Duration - "+i(e.duration.toFixed(2))+" days",1)):d("",!0),e.category.showCompletion&&e.completion?(t(),l("div",M,i(e.category.completionRateOverride?e.category.completionRateOverride:"Completion Rate")+" - "+i(e.completion)+"%",1)):d("",!0),e.category.showRating&&e.rating?(t(),l("div",Y,[J,m(Q,{modelValue:e.rating,"onUpdate:modelValue":u[1]||(u[1]=a=>e.rating=a),max:"5",size:"xs",color:"accent",icon:"star_border","icon-selected":"star","icon-half":"star_half","no-dimming":"",readonly:""},null,8,["modelValue"])])):d("",!0)])):d("",!0)]),loading:s(()=>[m(U,{showing:e.loading,label:"Loading...","label-class":"text-info"},null,8,["showing"])]),header:s(a=>[m(R,{class:"bg-dark text-white",props:a},{default:s(()=>[e.category.showView?(t(),c(V,{key:0,"auto-width":""})):d("",!0),(t(!0),l(b,null,k(a.cols,o=>(t(),c(V,{class:"text-left",key:o.name},{default:s(()=>[I(i(o.label),1)]),_:2},1024))),128))]),_:2},1032,["props"])]),body:s(a=>[m(R,{props:a},{default:s(()=>[e.category.showView?(t(),c(D,{key:0},{default:s(()=>[m(L,{class:"cursor-pointer",size:e.$q.screen.gt.sm?"sm":"xs",color:"info",round:"",dense:"",onClick:o=>e.viewData(a.row),name:a.expand?"visibility_off":"visibility"},null,8,["size","onClick","name"])]),_:2},1024)):d("",!0),(t(!0),l(b,null,k(a.cols,o=>(t(),c(D,{key:o.name,props:a},{default:s(()=>[o.showRating?(t(),c(Q,{key:1,modelValue:o.value,"onUpdate:modelValue":f=>o.value=f,max:"5",size:"xs",color:"accent",icon:"star_border","icon-selected":"star","icon-half":"star_half","no-dimming":"",readonly:""},null,8,["modelValue","onUpdate:modelValue"])):(t(),l("span",K,i(o.value),1))]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),"no-data":s(({message:a})=>[p("div",W,[p("span",null,i(a),1)])]),_:1},8,["columns","rows","row-key","pagination","loading","no-data-label"]))])}var le=E(S,[["render",X]]);export{le as H};
