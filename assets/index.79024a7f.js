var Xe=Object.defineProperty,He=Object.defineProperties;var ze=Object.getOwnPropertyDescriptors;var Le=Object.getOwnPropertySymbols;var We=Object.prototype.hasOwnProperty,Ge=Object.prototype.propertyIsEnumerable;var Oe=(e,t,u)=>t in e?Xe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:u}):e[t]=u,me=(e,t)=>{for(var u in t||(t={}))We.call(t,u)&&Oe(e,u,t[u]);if(Le)for(var u of Le(t))Ge.call(t,u)&&Oe(e,u,t[u]);return e},$e=(e,t)=>He(e,ze(t));import{k as x,bN as te,r as S,c as L,_ as H,y as Ue,A as m,B as N,an as D,bi as r,d as o,D as l,ab as y,F as Z,aY as ae,bO as V,bk as Ee,bD as Me,ao as A,cw as B,cz as oe,cx as I,cy as ie,bF as ge,aZ as G,au as qe,bP as Je,h as be,bQ as Qe,dk as Be,bW as Ke,cV as Ze,dl as xe,w as ve,o as et,bI as Ie,g as tt,cI as at,bK as ke,bJ as ot,bH as lt,cA as st,G as pe,as as rt,bM as nt,bL as it}from"./index.d156221a.js";import{Q as z,a as Ve,b as W}from"./QTabPanels.e8aeaad0.js";import{Q as Ae}from"./QTabs.ea633e00.js";import{Q as dt}from"./QToolbar.d810fa94.js";import{Q as ut}from"./QPage.cce46bf2.js";import{u as U}from"./project.1be0443a.js";import{u as le}from"./use-quasar.17bfadd8.js";import{Q as re}from"./QTd.802f2fdb.js";import{Q as ne}from"./QTr.fbebb94e.js";import{a as K,Q as De}from"./QTable.6601b475.js";import{Q as ct}from"./QSplitter.f23600d7.js";import{dayjs as fe}from"./dayjs.42389116.js";import{Q as Te}from"./QMarkupTable.ffd300b6.js";import{d as Fe}from"./decode.593c6ccc.js";import{q as E,u as mt,H as ft}from"./quickbase.000914fc.js";import{Q}from"./QSelect.3b2aebcc.js";import{Q as ye}from"./QForm.6d48a03b.js";import{a as F,c as J,b as he,u as O,e as bt}from"./array.804de1eb.js";import{s as pt}from"./states.03e3d448.js";import{Q as vt}from"./QList.31fef766.js";import{Q as gt}from"./QMenu.27cad430.js";import{Q as yt}from"./QBadge.b2fa89a4.js";import{Q as ht}from"./QInnerLoading.44bc1ab1.js";import"./use-panel.167f6dc2.js";import"./touch.60582172.js";import"./selection.03c1209a.js";import"./QResizeObserver.1a77a9e4.js";import"./rtl.cf9bbe47.js";import"./use-fullscreen.c582caf6.js";import"./TouchPan.f3ca46c0.js";import"./_commonjsHelpers.a26ce4be.js";import"./index.7dbe61ef.js";import"./localForage.5c9cf61e.js";import"./i18n.6b65d4f8.js";import"./api.8f52ca6d.js";import"./QChip.53326447.js";import"./QItemLabel.71527ca8.js";import"./position-engine.b27ef5cb.js";const wt=[{name:0,label:"Name",align:"left",field:e=>e.fullName,format:e=>`${e}`,sortable:!0},{name:1,label:"Phone",align:"left",field:e=>e[8],format:e=>`${e}`},{name:3,label:"Request#",align:"left",field:e=>e.requestID,format:e=>`${e}`,sortable:!0},{name:4,label:"Classification",align:"left",field:e=>e.job,format:e=>`${e}`,sortable:!0},{name:5,label:"Status",align:"left",field:e=>e.employee[0]?e.employee[0][80]:null,format:(e,t)=>`${e===""||!e?t[10]:e}`,sortable:!0}],$t=[{name:0,label:"Name",align:"left",field:e=>e[6],format:(e,t)=>`${e} ${t[7]}`,sortable:!0,required:!0},{name:1,label:"Phone",align:"left",field:e=>e[8],format:e=>`${e}`,sortable:!0},{name:2,label:"Status",align:"left",field:e=>e.employee[0]?e.employee[0][80]:null,format:(e,t)=>`${e===""||!e?t[10]:e}`}],kt=[{name:0,label:"Date",align:"left",field:e=>e[1].$d,format:e=>`${fe(e).format("MM/DD/YYYY")}`,sortable:!0},{name:1,label:"Name",align:"left",field:e=>e[31],format:e=>`${e}`,sortable:!0,required:!0},{name:2,label:"Phone",align:"left",field:e=>e[42],format:e=>`${e}`,sortable:!0},{name:3,label:"Start Date",align:"left",field:e=>e[33].$d?e[33].$d:null,format:e=>e?`${fe(e).format("MM/DD/YYYY")}`:"N/A"},{name:4,label:"Status",align:"left",field:e=>e[20],format:e=>e==="Complete"?"Arrived":"Deployed"}],qt=[{name:0,label:"Date",align:"left",field:e=>e[1].$d,format:e=>`${fe(e).format("MM/DD/YYYY")}`,sortable:!0},{name:1,label:"Name",align:"left",field:e=>e[75],format:e=>`${e}`,sortable:!0,required:!0},{name:2,label:"Phone",align:"left",field:e=>e[76],format:e=>`${e}`,sortable:!0}],jt=[{name:0,label:"Date",align:"left",field:e=>e[1].date,format:e=>`${fe(e,"MM-DD-YYYY").format("MM/DD/YYYY")}`,sortable:!0},{name:1,label:"Name",align:"left",field:e=>e.employee[24],format:e=>`${e}`,sortable:!0,required:!0},{name:2,label:"Phone",align:"left",field:e=>e.employee[25],format:e=>`${e}`,sortable:!0},{name:3,label:"Rate",align:"left",field:e=>e[22],format:e=>`$${e.toFixed(2)}`},{name:4,label:"Office",align:"left",field:e=>e[44],format:e=>`${e}`},{name:5,label:"Status",align:"left",field:e=>e[21],format:e=>`${e}`}],Ct=[{name:0,label:"Created",align:"left",field:e=>e[1].$d,format:e=>`${fe(e).format("MM/DD/YYYY")}`,sortable:!0},{name:1,label:"Classification",align:"left",field:e=>e[21],format:e=>`${e}`,sortable:!0,required:!0},{name:2,label:"Job #",align:"left",field:e=>e[15],format:e=>`${e}`,sortable:!0,required:!0},{name:3,label:"Need",align:"right",field:e=>e[18],format:e=>`${e}`,sortable:!0},{name:4,label:"Balance",align:"right",field:e=>e.remaining,format:e=>`${e}`,sortable:!0},{name:5,label:"Names",align:"right",field:e=>e.names.length,format:e=>`${e}`,sortable:!0,drilldown:!0,dataType:"names",drilldownColumns:$t},{name:6,label:"Offers",align:"right",field:e=>e.offers.length,format:e=>`${e}`,sortable:!0,drilldown:!0,dataType:"offers",drilldownColumns:jt},{name:7,label:"Deployed",align:"right",field:e=>e.deployments.length,format:e=>`${e}`,sortable:!0,drilldown:!0,dataType:"deployments",drilldownColumns:kt},{name:8,label:"Arrived",align:"right",field:e=>e.arrivals.length,format:e=>`${e}`,sortable:!0,drilldown:!0,dataType:"arrivals",drilldownColumns:qt},{name:9,label:"Rate",align:"right",field:e=>e[23],format:e=>`$${e.toFixed(2)}`,sortable:!0,required:!0},{name:10,label:"Request#",align:"right",field:e=>e[6],format:e=>`${e}`,sortable:!0,required:!0}],Nt=x({setup(){const{capitalize:e}=Ue,{projectData:t}=te(U()),u=S(0),d=S(null),b=S(null),w=S(null),a=L(()=>{const k=[],C=t.value?t.value.openRequests?t.value.openRequests:[]:[];return C.forEach($=>{$.classes.forEach(v=>{v.offers&&v.offers.length>0&&(v.offers.sort((q,_)=>q[3]>_[3]?-1:1),v.offers=[...new Map(v.offers.map(q=>[q.employee[3],q])).values()]);let j=t.value.pipeline.deployments.filter(q=>q[20]==="In Process"&&q[89]===v[3]),R=t.value.roster.filter(q=>q[46]===v[3]);R.length>0&&(R.sort((q,_)=>q[3]>_[3]?-1:1),R=[...new Map(R.map(q=>[q.employee[3],q])).values()]),j.length>0&&(j.sort((q,_)=>q[3]>_[3]?-1:1),j=[...new Map(j.map(q=>[q.employee[3],q])).values()]),Object.assign(v,{office:$[103],deployments:j,arrivals:R,remaining:v[18]-j.length,type:$[282]===""?"Open":$[282]}),k.push(v)})}),t.value?{classifications:k.sort(($,v)=>$[6]===v[6]?$[1].$d>v[1].$d?-1:1:$[6]<v[6]?1:-1),requests:C}:null}),n=L(()=>{const k=[],C=t.value?t.value.pendingRequests:[];return C.forEach($=>{$.classes.forEach(v=>{Object.assign(v,{office:$[103],deployments:[],arrivals:[],remaining:0,type:$[282]===""?"Open":$[282]}),k.push(v)})}),t.value?{classifications:k.sort(($,v)=>$[6]===v[6]?$[1].$d>v[1].$d?-1:1:$[6]<v[6]?1:-1),requests:C}:null}),f=L(()=>{const k=[],C=t.value?t.value.closedRequests:[];return C.forEach($=>{$.classes.forEach(v=>{v.offers&&v.offers.length>0&&(v.offers.sort((q,_)=>q[3]>_[3]?-1:1),v.offers=[...new Map(v.offers.map(q=>[q.employee[3],q])).values()]);let j=t.value.pipeline.deployments.filter(q=>q[20]==="In Process"&&q[89]===v[3]),R=t.value.roster.filter(q=>q[46]===v[3]);R.length>0&&(R.sort((q,_)=>q[3]>_[3]?-1:1),R=[...new Map(R.map(q=>[q.employee[3],q])).values()]),j.length>0&&(j.sort((q,_)=>q[3]>_[3]?-1:1),j=[...new Map(j.map(q=>[q.employee[3],q])).values()]),Object.assign(v,{office:$[103],deployments:j,arrivals:R,remaining:v[18]-j.length,type:$[282]===""?"Open":$[282]}),k.push(v)})}),t.value?{classifications:k.sort(($,v)=>$[6]===v[6]?$[1].$d>v[1].$d?-1:1:$[6]<v[6]?1:-1),requests:C}:null}),h=L(()=>{const k=[];return a.value.classifications.forEach(C=>{C.names.forEach($=>{Object.assign($,{requestID:C[6],job:C[21],fullName:`${e($[6].toLowerCase())} ${e($[7].toLowerCase())}`}),k.push($)})}),k});function c(k,C){console.log(C),b.value&&b.value===C.row[k.dataType]?(d.value=null,w.value=null,b.value=null):(d.value=C.row,b.value=C.row[k.dataType],w.value=k.drilldownColumns)}function p(){d.value=null,w.value=null,b.value=null}return{projectData:t,splitValue:S(10),tab:u,open:a,dayjs:fe,columns:Ct,pending:n,completed:f,names:h,nameColumns:wt,expandOpenRow:c,openRow:d,drillDownData:b,drillDownColumns:w,hideOpenRow:p,initialPagination:{rowsPerPage:20}}}}),St={class:"full-width row flex-center text-primary q-gutter-sm"},Dt={class:"text-primary text-bold",style:{"text-decoration":"underline"}},Vt={key:1},At={class:"full-width row flex-center text-primary q-gutter-sm"},Rt={class:"full-width row flex-center text-primary q-gutter-sm"},_t={class:"text-primary text-bold",style:{"text-decoration":"underline"}},Et={key:1},Mt={class:"full-width row flex-center text-primary q-gutter-sm"},Tt={class:"text-primary text-bold",style:{"text-decoration":"underline"}},Pt={key:1};function Lt(e,t,u,d,b,w){return m(),N("div",null,[e.projectData?(m(),D(ct,{key:0,modelValue:e.splitValue,"onUpdate:modelValue":t[2]||(t[2]=a=>e.splitValue=a)},{before:r(()=>[o(Ae,{dense:"",modelValue:e.tab,"onUpdate:modelValue":t[0]||(t[0]=a=>e.tab=a),vertical:"",align:"left","indicator-color":"accent","active-bg-color":"info","active-color":"white"},{default:r(()=>[o(z,{name:0,label:"Open"}),o(z,{name:1,label:"Names"}),o(z,{name:2,label:"Pending"}),o(z,{name:3,label:"Complete"})]),_:1},8,["modelValue"])]),after:r(()=>[o(Ve,{modelValue:e.tab,"onUpdate:modelValue":t[1]||(t[1]=a=>e.tab=a),animated:"",vertical:""},{default:r(()=>[o(W,{class:"q-pt-none",name:0},{default:r(()=>[l("div",null,[e.open?(m(),D(K,{key:0,dense:"",columns:e.columns,rows:e.open.classifications||[],"row-key":a=>a[3],pagination:e.initialPagination,"table-header-class":"bg-dark text-white",class:"sticky-header-table","no-data-label":"There are no open requests for this project."},{"no-data":r(({message:a})=>[l("div",St,[l("span",null,y(a),1)])]),body:r(a=>[o(ne,{props:a},{default:r(()=>[(m(!0),N(Z,null,ae(a.cols,n=>(m(),D(re,{key:n.name,props:a},{default:r(()=>[n.drilldown?(m(),D(V,{key:0,dense:"",class:"q-pa-none q-ma-none",flat:"",onClick:f=>!e.openRow||e.openRow[3]!==a.key?e.expandOpenRow(n,a):e.hideOpenRow()},{default:r(()=>[l("span",Dt,y(n.value),1)]),_:2},1032,["onClick"])):(m(),N("span",Vt,y(n.value),1))]),_:2},1032,["props"]))),128))]),_:2},1032,["props"]),Ee(o(ne,{props:a},{default:r(()=>[o(re,{colspan:"100%"},{default:r(()=>[o(K,{rows:e.drillDownData||[],"row-key":n=>n[3],columns:e.drillDownColumns||[],"table-header-class":"bg-info text-white",dense:"","hide-pagination":"",pagination:{rowsPerPage:200}},null,8,["rows","row-key","columns"])]),_:1})]),_:2},1032,["props"]),[[Me,e.openRow&&e.openRow[3]===a.key]])]),_:1},8,["columns","rows","row-key","pagination"])):A("",!0)])]),_:1}),o(W,{class:"q-pt-none",name:1},{default:r(()=>[l("div",null,[o(K,{dense:"",columns:e.nameColumns,rows:e.names,"row-key":a=>a[3],"table-header-class":"bg-dark text-white",pagination:e.initialPagination,class:"sticky-header-table","no-data-label":"There are no named requests for this project."},{"no-data":r(({message:a})=>[l("div",At,[l("span",null,y(a),1)])]),_:1},8,["columns","rows","row-key","pagination"])])]),_:1}),o(W,{class:"q-pt-none",name:2},{default:r(()=>[l("div",null,[o(K,{dense:"",columns:e.columns,rows:e.pending.classifications||[],"row-key":a=>a[3],"table-header-class":"bg-dark text-white",pagination:e.initialPagination,class:"sticky-header-table","no-data-label":"There are no pending requests for this project."},{"no-data":r(({message:a})=>[l("div",Rt,[l("span",null,y(a),1)])]),body:r(a=>[o(ne,{props:a},{default:r(()=>[(m(!0),N(Z,null,ae(a.cols,n=>(m(),D(re,{key:n.name,props:a},{default:r(()=>[n.drilldown?(m(),D(V,{key:0,dense:"",class:"q-pa-none q-ma-none",flat:"",onClick:f=>!e.openRow||e.openRow[3]!==a.key?e.expandOpenRow(n,a):e.hideOpenRow()},{default:r(()=>[l("span",_t,y(n.value),1)]),_:2},1032,["onClick"])):(m(),N("span",Et,y(n.value),1))]),_:2},1032,["props"]))),128))]),_:2},1032,["props"]),Ee(o(ne,{props:a},{default:r(()=>[o(re,{colspan:"100%"},{default:r(()=>[o(K,{rows:e.drillDownData||[],"row-key":n=>n[3],columns:e.drillDownColumns||[],"table-header-class":"bg-info text-white",dense:"","hide-pagination":"",pagination:{rowsPerPage:200}},null,8,["rows","row-key","columns"])]),_:1})]),_:2},1032,["props"]),[[Me,e.openRow&&e.openRow[3]===a.key]])]),_:1},8,["columns","rows","row-key","pagination"])])]),_:1}),o(W,{class:"q-pt-none",name:3},{default:r(()=>[l("div",null,[o(K,{dense:"",columns:e.columns,rows:e.completed.classifications||[],"row-key":a=>a[3],"table-header-class":"bg-dark text-white",pagination:e.initialPagination,class:"sticky-header-table","no-data-label":"There are no completed requests for this project."},{"no-data":r(({message:a})=>[l("div",Mt,[l("span",null,y(a),1)])]),body:r(a=>[o(ne,{props:a},{default:r(()=>[(m(!0),N(Z,null,ae(a.cols,n=>(m(),D(re,{key:n.name,props:a},{default:r(()=>[n.drilldown?(m(),D(V,{key:0,dense:"",class:"q-pa-none q-ma-none",flat:"",onClick:f=>e.expandOpenRow(n,a)},{default:r(()=>[l("span",Tt,y(n.value),1)]),_:2},1032,["onClick"])):(m(),N("span",Pt,y(n.value),1))]),_:2},1032,["props"]))),128))]),_:2},1032,["props"]),Ee(o(ne,{props:a},{default:r(()=>[o(re,{colspan:"100%"},{default:r(()=>[o(K,{rows:e.drillDownData||[],"row-key":n=>n[3],columns:e.drillDownColumns||[],"table-header-class":"bg-info text-white",dense:"","hide-pagination":"",pagination:{rowsPerPage:200}},null,8,["rows","row-key","columns"])]),_:1})]),_:2},1032,["props"]),[[Me,e.openRow&&e.openRow[3]===a.key]])]),_:1},8,["columns","rows","row-key","pagination"])])]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["modelValue"])):A("",!0)])}var Ot=H(Nt,[["render",Lt],["__scopeId","data-v-47ae9823"]]);const Ut={components:{},setup(){const{projectData:e}=te(U()),t=S(!1);return{projectData:e,decodeHTML:Fe,showEditOrgs:t}}},Jt=l("div",{class:"text-h6 text-primary q-py-sm q-pl-md"},"Details",-1),Qt=l("thead",{class:"bg-dark text-white"},[l("tr",null,[l("th",{class:"text-left"},"Type"),l("th",{class:"text-left"},"ID"),l("th",{class:"text-left"},"Name")])],-1),Bt=l("td",{class:"text-left"},"Location",-1),It={class:"text-left"},Ft={class:"text-left"},Yt=l("td",{class:"text-left"},"Supervisory",-1),Xt={class:"text-left"},Ht={class:"text-left"},zt=l("td",{class:"text-left"},"Company",-1),Wt={class:"text-left"},Gt={class:"text-left"},Kt=l("td",{class:"text-left"},"Region",-1),Zt={class:"text-left"},xt={class:"text-left"},ea=l("td",{class:"text-left"},"Branch",-1),ta={class:"text-left"},aa={class:"text-left"},oa=l("td",{class:"text-left"},"Pay Group",-1),la={class:"text-left"},sa={class:"text-left"},ra=l("td",{class:"text-left"},"Cost Center",-1),na={class:"text-left"},ia={class:"text-left"};function da(e,t,u,d,b,w){return m(),N("div",null,[o(oe,null,{default:r(()=>[o(B,{class:"q-pa-none"},{default:r(()=>[Jt,d.projectData?(m(),D(Te,{key:0,flat:"",dense:"",square:""},{default:r(()=>[Qt,l("tbody",null,[l("tr",null,[Bt,l("td",It,y(d.projectData[242]||"N/A"),1),l("td",Ft,y(d.projectData[241]?d.decodeHTML(d.projectData[241]):"N/A"),1)]),l("tr",null,[Yt,l("td",Xt,y(d.projectData[244]?d.decodeHTML(d.projectData[244]):"N/A"),1),l("td",Ht,y(d.projectData[259]?d.decodeHTML(d.projectData[259]):"N/A"),1)]),l("tr",null,[zt,l("td",Wt,y(d.projectData[287]?d.decodeHTML(d.projectData[287]):"N/A"),1),l("td",Gt,y(d.projectData[286]?d.decodeHTML(d.projectData[286]):"N/A"),1)]),l("tr",null,[Kt,l("td",Zt,y(d.projectData[284]?d.decodeHTML(d.projectData[284]):"N/A"),1),l("td",xt,y(d.projectData[283]?d.decodeHTML(d.projectData[283]):"N/A"),1)]),l("tr",null,[ea,l("td",ta,y(d.projectData[290]?d.decodeHTML(d.projectData[290]):"N/A"),1),l("td",aa,y(d.projectData[289]?d.decodeHTML(d.projectData[289]):"N/A"),1)]),l("tr",null,[oa,l("td",la,y(d.projectData[262]?d.decodeHTML(d.projectData[262]):"N/A"),1),l("td",sa,y(d.projectData[261]?d.decodeHTML(d.projectData[261]):"N/A"),1)]),l("tr",null,[ra,l("td",na,y(d.projectData[275]?d.decodeHTML(d.projectData[275]):"N/A"),1),l("td",ia,y(d.projectData[276]?d.decodeHTML(d.projectData[276]):"N/A"),1)])])]),_:1})):A("",!0)]),_:1})]),_:1})])}var ua=H(Ut,[["render",da]]);const ca=x({setup(e,t){const u=le(),{projectData:d}=te(U()),{pushNewObject:b}=U(),w=F({jobNumber:J().required().label("Job Number"),craft:F(),description:J()}),{meta:a,errors:n,handleSubmit:f,handleReset:h}=he({validationSchema:w}),{value:c}=O("jobNumber"),{value:p}=O("craft"),{value:k}=O("description"),C=f(async $=>{const v={6:{value:d.value[3]},11:{value:$.jobNumber}};$.craft&&Object.assign(v,{14:{value:$.craft[3]}}),$.description&&Object.assign(v,{20:{value:$.description}});try{const{data:j}=await E.upsertRecordsXML({to:"bpzpwr2eh",data:[v],fieldsToReturn:[35],formatObject:35});b({array:"jobNumbers",object:j[0][35]}),u.notify({type:"positive",message:`Job Number ${j[0][35][11]} successfully added`})}catch(j){console.log(j),u.notify({type:"negative",message:"Something went wrong!"})}t.emit("jobNumberAdded"),h()});return{projectData:d,jobNumber:c,craft:p,description:k,formErrors:n,formMeta:a,submit:C}}}),ma={class:"row"},fa={class:"col-12 col-md-4 q-pr-sm"},ba={class:"text-caption"},pa={class:"col-12 col-md-4 q-pr-sm"},va={class:"col-12 col-md-4"};function ga(e,t,u,d,b,w){return m(),N("div",null,[o(ye,{onSubmit:ge(e.submit,["prevent"])},{default:r(()=>[o(oe,null,{default:r(()=>[o(B,null,{default:r(()=>[l("div",ma,[l("div",fa,[o(I,{label:"Job Number",dense:"",modelValue:e.jobNumber,"onUpdate:modelValue":t[0]||(t[0]=a=>e.jobNumber=a),error:!!e.formErrors.jobNumber,"bottom-slots":""},{error:r(()=>[l("div",ba,y(e.formErrors.jobNumber),1)]),_:1},8,["modelValue","error"])]),l("div",pa,[o(Q,{dense:"",label:"Craft","transition-show":"flip-up","transition-hide":"flip-down",modelValue:e.craft,"onUpdate:modelValue":t[1]||(t[1]=a=>e.craft=a),options:e.projectData.crafts,"option-label":"10","display-value":`${e.craft?e.craft[10]:""}`},null,8,["modelValue","options","display-value"])]),l("div",va,[o(I,{label:"Description",dense:"",modelValue:e.description,"onUpdate:modelValue":t[2]||(t[2]=a=>e.description=a)},null,8,["modelValue"])])])]),_:1}),o(ie,{align:"right"},{default:r(()=>[o(V,{color:"secondary",label:"Cancel",onClick:t[3]||(t[3]=a=>e.$emit("cancelAddJobNumber"))}),o(V,{color:"primary",label:"Submit",type:"submit",onClick:e.submit},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["onSubmit"])])}var ya=H(ca,[["render",ga]]);const ha=[{name:0,label:"Job Number",align:"left",field:e=>e[11],format:e=>`${e}`,sortable:!0},{name:1,label:"Craft",align:"left",field:e=>e[15],format:e=>`${e}`,sortable:!0,required:!0},{name:2,label:"Description",align:"left",field:e=>e[20],format:e=>`${e}`,sortable:!0,required:!0}],wa=x({components:{AddJobNumber:ya},setup(){const e=le(),t=S(!1),{projectData:u}=te(U()),{removeObject:d}=U(),b=L(()=>(u.value&&u.value.jobNumbers?u.value.jobNumbers:[]).sort((f,h)=>f[1].$d>h[1].$d?1:-1));function w(n){console.log(n),e.dialog({title:"Confirm",message:`Are you sure you want to remove job number ${n[11]}?`,cancel:!0,persistent:!0}).onOk(()=>{a(n)})}async function a(n){try{const{data:f}=await E.upsertRecordsXML({to:"bpzpwr2eh",data:[{3:{value:n[3]},29:{value:"Inactive"}}],fieldsToReturn:[35],formatObject:35});d({array:"jobNumbers",object:f[0][35]})}catch(f){console.log(f),e.notify({type:"negative",message:"Something went wrong"})}}return{projectData:u,jobNumberColumns:ha,jobNumbers:b,initialPagination:{rowsPerPage:S(15)},showAddJobNumber:t,removeRow:w}}});function $a(e,t,u,d,b,w){const a=G("add-job-number");return m(),N("div",null,[e.showAddJobNumber?A("",!0):(m(),D(K,{key:0,dense:"",title:"Job Numbers","title-class":"text-primary",style:{},columns:e.jobNumberColumns,rows:e.jobNumbers,"row-key":n=>n[3],"table-header-class":"bg-dark text-white",pagination:e.initialPagination},{"top-left":r(()=>[o(V,{color:"accent",label:"Add a Job Number",icon:"add",onClick:t[0]||(t[0]=n=>e.showAddJobNumber=!0)})]),header:r(n=>[o(ne,{class:"bg-dark text-white",props:n},{default:r(()=>[(m(!0),N(Z,null,ae(n.cols,f=>(m(),D(De,{class:"text-left",key:f.name},{default:r(()=>[qe(y(f.label),1)]),_:2},1024))),128)),o(De,{"auto-width":""})]),_:2},1032,["props"])]),body:r(n=>[o(ne,{props:n},{default:r(()=>[(m(!0),N(Z,null,ae(n.cols,f=>(m(),D(re,{key:f.name,props:n},{default:r(()=>[qe(y(f.value),1)]),_:2},1032,["props"]))),128)),o(re,{"auto-width":""},{default:r(()=>[o(V,{color:"accent",dense:"",flat:"",round:"",icon:"delete",onClick:f=>e.removeRow(n.row)},null,8,["onClick"])]),_:2},1024)]),_:2},1032,["props"])]),_:1},8,["columns","rows","row-key","pagination"])),e.showAddJobNumber?(m(),D(a,{key:1,onJobNumberAdded:t[1]||(t[1]=n=>e.showAddJobNumber=!1),onCancelAddJobNumber:t[2]||(t[2]=n=>e.showAddJobNumber=!1)})):A("",!0)])}var ka=H(wa,[["render",$a]]);const qa=x({setup(e,t){const u=le(),{projectData:d}=te(U()),{pushNewObject:b}=U(),w=F({name:J().required().label("Location Name"),street1:J().required().label("Street Address 1"),street2:J(),city:J().required().label("City"),state:J().required().label("State"),postal:J().required().label("Postal Code")}),{meta:a,errors:n,handleSubmit:f,handleReset:h}=he({validationSchema:w}),{value:c}=O("name"),{value:p}=O("street1"),{value:k}=O("street2"),{value:C}=O("city"),{value:$}=O("state"),{value:v}=O("postal"),j=f(async R=>{const q={6:{value:R.name},8:{value:R.street1},9:{value:R.street2?R.street2:""},10:{value:R.city},11:{value:R.state},12:{value:R.postal},13:{value:"United States"}};d.value[8]&&Object.assign(q,{15:{value:d.value[8]}});try{const{data:_}=await E.upsertRecordsXML({to:"bp5d2twyj",data:[q],fieldsToReturn:[22],formatObject:22});b({array:"locations",object:_[0][22]}),u.notify({type:"positive",message:`Meeting location ${_[0][22][6]} successfully added`})}catch(_){console.log(_),u.notify({type:"negative",message:"Something went wrong!"})}t.emit("addComplete"),h()});return{projectData:d,formErrors:n,formMeta:a,submit:j,name:c,street1:p,street2:k,city:C,state:$,postal:v,states:pt}}}),ja={class:"row"},Ca={class:"col-12 col-md-6"},Na={class:"text-caption"},Sa={class:"text-caption"},Da={class:"text-caption"},Va={class:"text-caption"},Aa={class:"text-caption"};function Ra(e,t,u,d,b,w){return m(),N("div",null,[o(ye,{onSubmit:ge(e.submit,["prevent"])},{default:r(()=>[o(oe,null,{default:r(()=>[o(B,null,{default:r(()=>[l("div",ja,[l("div",Ca,[o(I,{label:"Location Name",dense:"",modelValue:e.name,"onUpdate:modelValue":t[0]||(t[0]=a=>e.name=a),error:!!e.formErrors.name,"bottom-slots":""},{error:r(()=>[l("div",Na,y(e.formErrors.name),1)]),_:1},8,["modelValue","error"]),o(I,{label:"Street Address 1",dense:"",modelValue:e.street1,"onUpdate:modelValue":t[1]||(t[1]=a=>e.street1=a),error:!!e.formErrors.street1,"bottom-slots":""},{error:r(()=>[l("div",Sa,y(e.formErrors.street1),1)]),_:1},8,["modelValue","error"]),o(I,{label:"Street Address 2",dense:"",modelValue:e.street2,"onUpdate:modelValue":t[2]||(t[2]=a=>e.street2=a),error:!!e.formErrors.street2,"bottom-slots":""},{error:r(()=>[l("div",Da,y(e.formErrors.street2),1)]),_:1},8,["modelValue","error"]),o(I,{label:"City",dense:"",modelValue:e.city,"onUpdate:modelValue":t[3]||(t[3]=a=>e.city=a),error:!!e.formErrors.city,"bottom-slots":""},{error:r(()=>[l("div",Va,y(e.formErrors.city),1)]),_:1},8,["modelValue","error"]),o(Q,{dense:"",label:"State","transition-show":"flip-up","transition-hide":"flip-down",modelValue:e.state,"onUpdate:modelValue":t[4]||(t[4]=a=>e.state=a),options:e.states,"bottom-slots":""},null,8,["modelValue","options"]),o(I,{label:"Postal Code",dense:"",modelValue:e.postal,"onUpdate:modelValue":t[5]||(t[5]=a=>e.postal=a),error:!!e.formErrors.postal,"bottom-slots":""},{error:r(()=>[l("div",Aa,y(e.formErrors.postal),1)]),_:1},8,["modelValue","error"])])])]),_:1}),o(ie,{align:"right"},{default:r(()=>[o(V,{color:"secondary",label:"Cancel",onClick:t[6]||(t[6]=a=>e.$emit("cancelAddJobNumber"))}),o(V,{color:"primary",label:"Submit",type:"submit",onClick:e.submit},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["onSubmit"])])}var _a=H(qa,[["render",Ra]]);const Ea=[{name:0,label:"Location Name",align:"left",field:e=>e[6],format:e=>`${e}`,sortable:!0},{name:1,label:"Address",align:"left",field:e=>e[7],format:e=>`${e}`,sortable:!0,required:!0}],Ma=x({components:{AddMeetingLocation:_a},setup(){const e=le(),t=S(!1),{projectData:u}=te(U()),{removeObject:d}=U();function b(a){console.log(a),e.dialog({title:"Confirm",message:`Are you sure you want to remove the ${a[6]} location?`,cancel:!0,persistent:!0}).onOk(()=>{w(a)})}async function w(a){try{const{data:n}=await E.upsertRecordsXML({to:"bp5d2twyj",data:[{3:{value:a[3]},14:{value:"Inactive"}}],fieldsToReturn:[22],formatObject:22});d({array:"locations",object:n[0][22]})}catch(n){console.log(n),e.notify({type:"negative",message:"Something went wrong"})}}return{projectData:u,columns:Ea,initialPagination:{rowsPerPage:S(15)},showAdd:t,removeRow:b}}});function Ta(e,t,u,d,b,w){const a=G("add-meeting-location");return m(),N("div",null,[e.showAdd?A("",!0):(m(),D(K,{key:0,dense:"",title:"Meeting Locations","title-class":"text-primary",style:{},columns:e.columns,rows:e.projectData.locations,"table-header-class":"bg-dark text-white",pagination:e.initialPagination},{"top-left":r(()=>[o(V,{color:"accent",label:"Add a Meeting Location",icon:"add",onClick:t[0]||(t[0]=n=>e.showAdd=!0)})]),header:r(n=>[o(ne,{class:"bg-dark text-white",props:n},{default:r(()=>[(m(!0),N(Z,null,ae(n.cols,f=>(m(),D(De,{class:"text-left",key:f.name},{default:r(()=>[qe(y(f.label),1)]),_:2},1024))),128)),o(De,{"auto-width":""})]),_:2},1032,["props"])]),body:r(n=>[o(ne,{props:n},{default:r(()=>[(m(!0),N(Z,null,ae(n.cols,f=>(m(),D(re,{key:f.name,props:n},{default:r(()=>[qe(y(f.value),1)]),_:2},1032,["props"]))),128)),o(re,{"auto-width":""},{default:r(()=>[o(V,{color:"accent",dense:"",flat:"",round:"",icon:"delete",onClick:f=>e.removeRow(n.row)},null,8,["onClick"])]),_:2},1024)]),_:2},1032,["props"])]),_:1},8,["columns","rows","pagination"])),e.showAdd?(m(),D(a,{key:1,onAddComplete:t[1]||(t[1]=n=>e.showAdd=!1),onCancelAdd:t[2]||(t[2]=n=>e.showAdd=!1)})):A("",!0)])}var Pa=H(Ma,[["render",Ta]]),La=Je({name:"QBtnGroup",props:{unelevated:Boolean,outline:Boolean,flat:Boolean,rounded:Boolean,square:Boolean,push:Boolean,stretch:Boolean,glossy:Boolean,spread:Boolean},setup(e,{slots:t}){const u=L(()=>{const d=["unelevated","outline","flat","rounded","square","push","stretch","glossy"].filter(b=>e[b]===!0).map(b=>`q-btn-group--${b}`).join(" ");return`q-btn-group row no-wrap${d.length>0?" "+d:""}`+(e.spread===!0?" q-btn-group--spread":" inline")});return()=>be("div",{class:u.value},Qe(t.default))}});const Oa=Object.keys(Be),Ua=e=>Oa.reduce((t,u)=>{const d=e[u];return d!==void 0&&(t[u]=d),t},{});var Ja=Je({name:"QBtnDropdown",props:$e(me(me({},Be),Ke),{modelValue:Boolean,split:Boolean,dropdownIcon:String,contentClass:[Array,String,Object],contentStyle:[Array,String,Object],cover:Boolean,persistent:Boolean,noRouteDismiss:Boolean,autoClose:Boolean,menuAnchor:{type:String,default:"bottom end"},menuSelf:{type:String,default:"top end"},menuOffset:Array,disableMainBtn:Boolean,disableDropdown:Boolean,noIconAnimation:Boolean,toggleAriaLabel:String}),emits:["update:modelValue","click","beforeShow","show","beforeHide","hide"],setup(e,{slots:t,emit:u}){const{proxy:d}=tt(),b=S(e.modelValue),w=S(null),a=Ze(),n=L(()=>{const M={"aria-expanded":b.value===!0?"true":"false","aria-haspopup":"true","aria-controls":a,"aria-label":e.toggleAriaLabel||d.$q.lang.label[b.value===!0?"collapse":"expand"](e.label)};return(e.disable===!0||e.split===!1&&e.disableMainBtn===!0||e.disableDropdown===!0)&&(M["aria-disabled"]="true"),M}),f=L(()=>"q-btn-dropdown__arrow"+(b.value===!0&&e.noIconAnimation===!1?" rotate-180":"")+(e.split===!1?" q-btn-dropdown__arrow-container":"")),h=L(()=>xe(e)),c=L(()=>Ua(e));ve(()=>e.modelValue,M=>{w.value!==null&&w.value[M?"show":"hide"]()}),ve(()=>e.split,_);function p(M){b.value=!0,u("beforeShow",M)}function k(M){u("show",M),u("update:modelValue",!0)}function C(M){b.value=!1,u("beforeHide",M)}function $(M){u("hide",M),u("update:modelValue",!1)}function v(M){u("click",M)}function j(M){at(M),_(),u("click",M)}function R(M){w.value!==null&&w.value.toggle(M)}function q(M){w.value!==null&&w.value.show(M)}function _(M){w.value!==null&&w.value.hide(M)}return Object.assign(d,{show:q,hide:_,toggle:R}),et(()=>{e.modelValue===!0&&q()}),()=>{const M=[be(Ie,{class:f.value,name:e.dropdownIcon||d.$q.iconSet.arrow.dropdown})];return e.disableDropdown!==!0&&M.push(be(gt,{ref:w,id:a,class:e.contentClass,style:e.contentStyle,cover:e.cover,fit:!0,persistent:e.persistent,noRouteDismiss:e.noRouteDismiss,autoClose:e.autoClose,anchor:e.menuAnchor,self:e.menuSelf,offset:e.menuOffset,separateClosePopup:!0,transitionShow:e.transitionShow,transitionHide:e.transitionHide,transitionDuration:e.transitionDuration,onBeforeShow:p,onShow:k,onBeforeHide:C,onHide:$},t.default)),e.split===!1?be(V,$e(me(me({class:"q-btn-dropdown q-btn-dropdown--simple"},c.value),n.value),{disable:e.disable===!0||e.disableMainBtn===!0,noWrap:!0,round:!1,onClick:v}),{default:()=>Qe(t.label,[]).concat(M),loading:t.loading}):be(La,$e(me({class:"q-btn-dropdown q-btn-dropdown--split no-wrap q-btn-item",rounded:e.rounded,square:e.square},h.value),{glossy:e.glossy,stretch:e.stretch}),()=>[be(V,$e(me({class:"q-btn-dropdown--current"},c.value),{disable:e.disable===!0||e.disableMainBtn===!0,noWrap:!0,round:!1,onClick:j}),{default:t.label,loading:t.loading}),be(V,$e(me(me({class:"q-btn-dropdown__arrow-container q-anchor--skip"},n.value),h.value),{disable:e.disable===!0||e.disableDropdown===!0,rounded:e.rounded,color:e.color,textColor:e.textColor,dense:e.dense,size:e.size,padding:e.padding,ripple:e.ripple}),()=>M)])}}});const Qa=x({props:{job:Object,craft:Object},setup(e,t){const u=le(),{upsertProjectCraft:d}=U(),b=L(()=>e.craft.options.jobs.find(v=>v[3]===e.job[13]).aliases),w=L(()=>F({alias:F().required().label("Custom Job Title"),fixedRate:bt().moreThan(7.25,"Fixed rate must be greater than minimum wage.").lessThan(1e3).label("Fixed Rate").nullable()})),{meta:a,errors:n,handleSubmit:f,handleReset:h}=he({validationSchema:w,initialValues:{alias:{3:e.job[9],7:e.job[18]},fixedRate:e.job.fixedRate>0?e.job.fixedRate:null}}),{value:c}=O("alias"),{value:p}=O("fixedRate"),k=f(async $=>{u.loading.show();const v={3:{value:e.job[3]},20:{value:e.craft[3]}};c.value!=={3:e.job[9],7:e.job[18]}&&Object.assign(v,{9:{value:$.alias[3]}}),p.value&&p.value!==e.job.fixedRate&&Object.assign(v,{155:{value:$.fixedRate}});try{const{data:j}=await E.upsertRecordsXML({to:"bpzpx5m7x",data:[v],fieldsToReturn:[153],formatObject:153});j.length>0&&(d({craft:j[0][153]}),h(),u.loading.hide(),t.emit("editJobComplete"))}catch{u.notify({type:"negative",message:"Something went wrong"})}});async function C($,v){u.dialog({title:"Confirm",message:`Confirm you want to add "${$}" as a new alias.`,cancel:!0,persistent:!0}).onOk(async()=>{try{const{data:j}=await E.upsertRecordsXML({to:"bpzpi5rjh",data:[{6:{value:e.job[13]},7:{value:$},11:{value:"No"}}],fieldsToReturn:[25],formatObject:25});console.log(j),j.length>0&&(c.value=j[0][25],v(j[0][25]))}catch{u.notify({type:"negative",message:"Something went wrong"})}}).onCancel(()=>{v()})}return{formMeta:a,formErrors:n,submit:k,alias:c,fixedRate:p,aliasOptions:b,submitAlias:C}}}),Ba={class:"text-body1 text-white"},Ia={class:"text-caption"},Fa={class:"text-caption"};function Ya(e,t,u,d,b,w){return m(),N("div",null,[l("div",null,[o(ye,{onSubmit:ge(e.submit,["prevent"])},{default:r(()=>[o(oe,null,{default:r(()=>[o(B,{class:"bg-dark"},{default:r(()=>[l("div",Ba,"Edit "+y(e.craft[10])+" "+y(e.job[18]),1)]),_:1}),o(B,null,{default:r(()=>[o(Q,{class:"q-mb-sm",dense:"",label:"Select Custom Job Title (Alias)","transition-show":"flip-up","transition-hide":"flip-down",modelValue:e.alias,"onUpdate:modelValue":t[0]||(t[0]=a=>e.alias=a),options:e.aliasOptions,"option-label":"7","display-value":`${e.alias?e.alias[7]:""}`,"bottom-slots":"",error:!!e.formErrors.alias,onNewValue:e.submitAlias,"use-input":""},{error:r(()=>[l("div",Ia,y(e.formErrors.alias),1)]),_:1},8,["modelValue","options","display-value","error","onNewValue"]),e.$can("manage","rates")?(m(),D(I,{key:0,step:"any",prefix:"$",type:"number",dense:"",label:"Fixed Rate",modelValue:e.fixedRate,"onUpdate:modelValue":t[1]||(t[1]=a=>e.fixedRate=a),error:!!e.formErrors.fixedRate,"bottom-slots":""},{error:r(()=>[l("div",Fa,y(e.formErrors.fixedRate),1)]),_:1},8,["modelValue","error"])):A("",!0)]),_:1}),o(ke),o(ie,{class:"bg-accent",align:"right"},{default:r(()=>[o(V,{size:e.$q.screen.lt.md?"sm":"",color:"secondary",label:"Cancel",onClick:t[2]||(t[2]=a=>e.$emit("closeEditJob"))},null,8,["size"]),o(V,{type:"submit",size:e.$q.screen.lt.md?"sm":"",color:"primary",label:"Save"},null,8,["size"])]),_:1})]),_:1})]),_:1},8,["onSubmit"])])])}var Xa=H(Qa,[["render",Ya]]);const Ha=x({props:{craft:Object},setup(e,t){const u=le(),d=F({job:F().required("Job is required."),alias:F().required("Alias is required.").nullable()}),{meta:b,errors:w,handleSubmit:a,handleReset:n}=he({validationSchema:d}),{value:f}=O("job"),{value:h}=O("alias"),c=a(async C=>{try{const{data:$}=await E.upsertRecordsXML({to:"bpzpx5m7x",data:[{9:{value:C.alias[3]},13:{value:C.job[3]},20:{value:e.craft[3]}}],fieldsToReturn:[153],formatObject:153});$.length>0&&(t.emit("newJobAdded",{craft:$[0][153]}),n())}catch{u.notify({type:"negative",message:"Something went wrong"})}});async function p(C,$){u.dialog({title:"Confirm",message:`Confirm you want to add "${C}" as a new alias.`,cancel:!0,persistent:!0}).onOk(async()=>{try{const{data:v}=await E.upsertRecordsXML({to:"bpzpi5rjh",data:[{6:{value:f.value[3]},7:{value:C},11:{value:"No"}}],fieldsToReturn:[25],formatObject:25});console.log(v),v.length>0&&(h.value=v[0][25],$(v[0][25]))}catch{u.notify({type:"negative",message:"Something went wrong"})}}).onCancel(()=>{$()})}function k(){t.emit("cancelAddJob"),n()}return{formErrors:w,formMeta:b,submitJob:c,submitAlias:p,cancelAddJob:k,job:f,alias:h,props:e}}}),za={class:"row justify-between"},Wa={class:"col-5"},Ga={class:"text-caption"},Ka={class:"col-6"},Za={class:"text-caption"};function xa(e,t,u,d,b,w){return m(),N("div",null,[o(ye,{onSubmit:ge(e.submitJob,["prevent"])},{default:r(()=>[o(oe,{flat:""},{default:r(()=>[o(B,null,{default:r(()=>[l("div",za,[l("div",Wa,[o(Q,{class:"q-mb-sm",dense:"",label:"Select Default Job","transition-show":"flip-up","transition-hide":"flip-down",modelValue:e.job,"onUpdate:modelValue":t[0]||(t[0]=a=>e.job=a),options:e.props.craft.options.jobs,"option-label":"9","display-value":`${e.job?e.job[9]:""}`,"bottom-slots":"",error:!!e.formErrors.job},{error:r(()=>[l("div",Ga,y(e.formErrors.job),1)]),_:1},8,["modelValue","options","display-value","error"])]),l("div",Ka,[o(Q,{disable:!e.job,class:"q-mb-sm",dense:"",label:"Select Custom Job Title (Alias)","transition-show":"flip-up","transition-hide":"flip-down",modelValue:e.alias,"onUpdate:modelValue":t[1]||(t[1]=a=>e.alias=a),options:e.job?e.job.aliases:[],"option-label":"7","display-value":`${e.alias?e.alias[7]:""}`,"bottom-slots":"",error:!!e.formErrors.alias,onNewValue:e.submitAlias,"use-input":""},{error:r(()=>[l("div",Za,y(e.formErrors.alias),1)]),_:1},8,["disable","modelValue","options","display-value","error","onNewValue"])])])]),_:1}),o(ie,{align:"right"},{default:r(()=>[o(V,{color:"secondary",label:"Cancel",onClick:e.cancelAddJob},null,8,["onClick"]),o(V,{color:"primary",label:"Submit Job",type:"submit"})]),_:1})]),_:1})]),_:1},8,["onSubmit"])])}var eo=H(Ha,[["render",xa]]);const to=x({props:{crafts:Array,project:Number},setup(e,t){const u=le(),d=S([]),b=L(()=>{const v=new Set(e.crafts.map(R=>R[9]));return d.value.filter(R=>!v.has(R[3]))}),w=F({craftSelection:F().required("Craft is required.")}),{meta:a,errors:n,handleSubmit:f,handleReset:h}=he({validationSchema:w}),{value:c}=O("craftSelection"),p=f(async v=>{u.loading.show();const j=await k(v.craftSelection[3]),R=[];v.craftSelection.jobs.forEach(q=>{const _={9:{value:q[93]},13:{value:q[3]},20:{value:j[3]}};R.push(_)});try{const{data:q}=await E.upsertRecordsXML({to:"bpzpx5m7x",data:R,fieldsToReturn:[141],formatObject:141});q.forEach(_=>{j.classifications.push(_[141])}),u.loading.hide(),t.emit("newCraftAdded",{craft:j}),h()}catch{u.notify({type:"negative",message:"Something went wrong"})}});async function k(v){try{const{data:j}=await E.upsertRecordsXML({to:"bp5g8rym8",data:[{6:{value:"Active"},7:{value:e.project},9:{value:v}}],fieldsToReturn:[120],formatObject:120});return j[0][120]}catch{u.notify({type:"negative",message:"Something went wrong"})}}async function C(){u.loading.show();const{data:v}=await E.fetchFromStructureApp({fields:[{6:{value:"bp2pcb379"},7:{value:"Table Query"},8:{value:"{'16'.EX.'Yes'}"},9:{value:1},14:{value:62}}]});d.value=v,u.loading.hide()}function $(){t.emit("cancelAddCraft"),h()}return C(),{formErrors:n,formMeta:a,submit:p,cancelAdd:$,props:e,craftSelection:c,availableCrafts:b}}}),ao={class:"row justify-between"},oo={class:"col-5"},lo={class:"text-caption"},so=l("div",{class:"text-primary text-body1"},"This project already has all available crafts. Click cancel below to return.",-1);function ro(e,t,u,d,b,w){return m(),N("div",null,[o(ye,{onSubmit:ge(e.submit,["prevent"])},{default:r(()=>[o(oe,{flat:""},{default:r(()=>[e.availableCrafts.length>0?(m(),D(B,{key:0},{default:r(()=>[l("div",ao,[l("div",oo,[o(Q,{class:"q-mb-sm",dense:"",label:"Select the Craft","transition-show":"flip-up","transition-hide":"flip-down",modelValue:e.craftSelection,"onUpdate:modelValue":t[0]||(t[0]=a=>e.craftSelection=a),options:e.availableCrafts||[],"option-label":"6","display-value":`${e.craftSelection?e.craftSelection[6]:""}`,"bottom-slots":"",error:!!e.formErrors.craftSelection},{error:r(()=>[l("div",lo,y(e.formErrors.craftSelection),1)]),_:1},8,["modelValue","options","display-value","error"])])])]),_:1})):A("",!0),o(B,null,{default:r(()=>[so]),_:1}),o(ie,{align:"right"},{default:r(()=>[o(V,{color:"secondary",label:"Cancel",onClick:e.cancelAdd},null,8,["onClick"]),e.availableCrafts.length>0?(m(),D(V,{key:0,color:"primary",label:"Submit",type:"submit"})):A("",!0)]),_:1})]),_:1})]),_:1},8,["onSubmit"])])}var no=H(to,[["render",ro]]);const io=[{name:0,label:"Default Classification",align:"left",field:e=>e[17],format:e=>`${e}`,sortable:!1},{name:1,label:"Vanity Job Title (Alias)",align:"left",field:e=>e[18],format:e=>`${e}`,sortable:!1}],uo=x({components:{EditJobDialog:Xa,AddNewJob:eo,AddNewCraft:no},setup(){const e=le(),{projectCrafts:t,projectData:u}=te(U()),{upsertProjectCraft:d}=U(),b=L(()=>{const j=t.value?t.value:[];return j.forEach(R=>{R.classifications&&R.classifications.sort((q,_)=>q.order>_.order||q.order===_.order&&q.fixedRate>_.fixedRate?-1:1)}),j.sort((R,q)=>R[9]>q[9]?1:-1)}),w=b.value.length>0?S(b.value[0][3]):S(0),a=S(!1),n=S(null),f=S(null),h=S(!1),c=S(!1);ve(t,()=>{t.value&&b.value.length>0&&(w.value=b.value[0][3])});function p(j,R){n.value=j,f.value=R,a.value=!0,console.log(j),console.log(R)}function k(){a.value=!1,n.value=null,f.value=null}function C(){a.value=!1,n.value=null,f.value=null,e.notify({type:"positive",message:"Job successfully updated!"})}function $({craft:j}){d({craft:j}),h.value=!1,e.notify({type:"positive",message:"New job added!"})}function v({craft:j}){d({craft:j}),c.value=!1,e.notify({type:"positive",message:"New craft added!"})}return{projectCrafts:t,projectData:u,crafts:b,jobColumns:io,splitValue:S(20),tab:w,showEditJob:a,editJobCraft:n,editJobJob:f,editJob:p,closeEditJob:k,showAddJob:h,newJobAddComplete:$,editJobComplete:C,showAddCraft:c,newCraftAddComplete:v}}}),co={key:0,class:"row"},mo={class:"col-12 q-px-sm"},fo={class:"row"},bo={class:"col-12 col-md-10 q-pr-xs"},po={class:"col-12 col-md-2 text-right"},vo={key:0},go=l("thead",{class:"bg-dark text-white"},[l("tr",null,[l("th",{class:"text-left"},"Default Classification"),l("th",{class:"text-left"},"Vanity Job Title (Alias)"),l("th")])],-1),yo={class:"text-left"},ho={class:"text-left"},wo={class:"text-right"},$o={key:1};function ko(e,t,u,d,b,w){const a=G("add-new-job"),n=G("add-new-craft"),f=G("edit-job-dialog");return m(),N("div",null,[e.showAddCraft?A("",!0):(m(),N("div",co,[l("div",mo,[l("div",fo,[l("div",bo,[o(Ae,{dense:"",modelValue:e.tab,"onUpdate:modelValue":t[0]||(t[0]=h=>e.tab=h),align:"left","indicator-color":"accent","active-bg-color":"dark","active-color":"white","outside-arrows":"","inline-label":"",class:"bg-dark text-white shadow-2 rounded-borders"},{default:r(()=>[(m(!0),N(Z,null,ae(e.crafts,(h,c)=>(m(),N(Z,{key:h[3]},[c<=4?(m(),D(z,{key:0,name:h[3],label:h[10]},null,8,["name","label"])):A("",!0)],64))),128)),e.crafts.length>5?(m(),D(Ja,{key:0,"auto-close":"",stretch:"",flat:"",label:"More..."},{default:r(()=>[o(vt,null,{default:r(()=>[(m(!0),N(Z,null,ae(e.crafts,(h,c)=>(m(),N(Z,{key:h[3]},[c>4?(m(),D(ot,{key:0,clickable:"",onClick:p=>e.tab=h[3]},{default:r(()=>[o(lt,null,{default:r(()=>[qe(y(h[10]),1)]),_:2},1024)]),_:2},1032,["onClick"])):A("",!0)],64))),128))]),_:1})]),_:1})):A("",!0)]),_:1},8,["modelValue"])]),l("div",po,[e.$can("manage","projects")?(m(),D(V,{key:0,color:"accent",label:"Add a Craft",icon:"add",onClick:t[1]||(t[1]=h=>e.showAddCraft=!0)})):A("",!0)])]),o(Ve,{modelValue:e.tab,"onUpdate:modelValue":t[4]||(t[4]=h=>e.tab=h),animated:""},{default:r(()=>[(m(!0),N(Z,null,ae(e.crafts,h=>(m(),D(W,{key:h[3],name:h[3],class:"q-px-xs"},{default:r(()=>[e.showAddJob?A("",!0):(m(),N("div",vo,[e.$can("manage","projects")?(m(),D(oe,{key:0,flat:""},{default:r(()=>[o(ie,{class:"q-px-none q-pt-none",align:"left"},{default:r(()=>[o(V,{color:"accent",label:`Add another ${h[10]} Job`,icon:"add",onClick:t[2]||(t[2]=c=>e.showAddJob=!0)},null,8,["label"])]),_:2},1024)]),_:2},1024)):A("",!0),o(Te,{dense:""},{default:r(()=>[go,l("tbody",null,[(m(!0),N(Z,null,ae(h.classifications,c=>(m(),N("tr",{key:c[3]},[l("td",yo,y(c[17]),1),l("td",ho,y(c[18]),1),l("td",wo,[e.$can("manage","projects")?(m(),D(V,{key:0,size:"sm",label:"edit",color:"primary",onClick:p=>e.editJob(h,c)},null,8,["onClick"])):A("",!0)])]))),128))])]),_:2},1024)])),e.showAddJob?(m(),N("div",$o,[o(a,{craft:h,onCancelAddJob:t[3]||(t[3]=c=>e.showAddJob=!1),onNewJobAdded:e.newJobAddComplete},null,8,["craft","onNewJobAdded"])])):A("",!0)]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue"])])])),e.showAddCraft?(m(),D(n,{key:1,crafts:e.projectCrafts,project:e.projectData[3],onCancelAddCraft:t[5]||(t[5]=h=>e.showAddCraft=!1),onNewCraftAdded:e.newCraftAddComplete},null,8,["crafts","project","onNewCraftAdded"])):A("",!0),o(st,{modelValue:e.showEditJob,"onUpdate:modelValue":t[6]||(t[6]=h=>e.showEditJob=h),persistent:""},{default:r(()=>[o(f,{craft:e.editJobCraft,job:e.editJobJob,onCloseEditJob:e.closeEditJob,onEditJobComplete:e.editJobComplete},null,8,["craft","job","onCloseEditJob","onEditJobComplete"])]),_:1},8,["modelValue"])])}var qo=H(uo,[["render",ko]]);const jo=x({props:{item:Object,spec:Number},setup(e,t){const u=le(),{projectData:d}=te(U()),{pushNewObject:b,pushNewRequirementOptions:w,fetchOrientations:a,fetchDrugScreens:n,fetchFitTests:f,fetchMedicalScreens:h,fetchBackgroundScreens:c,storeNewRequirements:p}=U(),k=S(null),C=S([]),$=S([]),v=S([]),j=S(!0),R=L(()=>{let i={};return e.item.key==="orientations"?i=F({category:F().required().label("Category").nullable(),name:J().required().label("Course Name").nullable(),code:J().label("Course Code").nullable()}):e.item.key==="drugScreens"?i=F({category:F().required().label("Category").nullable(),name:J().required().label("Description").nullable(),code:J().required().label("Type").nullable()}):e.item.key==="fitTests"?i=F({category:J().required().label("Manufacturer").nullable(),name:J().required().label("Model").nullable(),code:J().required().label("Type").nullable()}):e.item.key==="medical"&&(i=F({category:J().required().label("Screen Type").nullable()})),i}),{meta:q,errors:_,handleSubmit:M,handleReset:je}=he({validationSchema:R}),{value:Y}=O("category"),{value:de}=O("name"),{value:se}=O("code"),Ne=L(()=>{let i=k.value?k.value:[];if(e.item.key==="orientations")i=Y.value?i.filter(s=>s[10]===Y.value.value):i,i=de.value?i.filter(s=>s[6].toLowerCase().includes(de.value.toLowerCase())):i,i=se.value?i.filter(s=>s[8].toLowerCase().includes(se.value.toLowerCase())):i,i=i.sort((s,g)=>s[8]===""||s[6]>g[6]?1:-1);else if(e.item.key==="drugScreens")i=Y.value?i.filter(s=>s[8]===Y.value.value):i,i=de.value?i.filter(s=>s[7].toLowerCase().includes(de.value.toLowerCase())):i,i=se.value?i.filter(s=>s[6].toLowerCase().includes(se.value.toLowerCase())):i,i=i.sort((s,g)=>s[7]===""||s[6]>g[6]?1:-1);else if(e.item.key==="fitTests")i=Y.value?i.filter(s=>s[11]===Y.value):i,i=de.value?i.filter(s=>s[8].toLowerCase().includes(de.value.toLowerCase())):i,i=se.value?i.filter(s=>s[13].toLowerCase().includes(se.value.toLowerCase())):i,i=i.sort((s,g)=>s[11]===""||s[11]>g[11]?1:-1);else if(e.item.key==="medical")i=Y.value?i.filter(s=>s[6]===Y.value):i,i=i.sort((s,g)=>s[6]>g[6]?1:-1);else if(e.item.key==="backgrounds"){const s=Y.value?Y.value.value?Y.value.label:Y.value:null;i=s?i.filter(g=>g[6]===Y.value||g[7].toLowerCase().includes(s.toLowerCase())):i,i=se.value?i.filter(g=>g[8].toLowerCase().includes(se.value.toLowerCase())):i,i=i.sort((g,P)=>g[7]>P[7]?1:-1)}return i}),Re=L(()=>{let i=[];return e.item.key==="orientations"?i=[{name:0,label:"Course Code",align:"left",field:s=>s[8],format:s=>`${s}`,sortable:!0},{name:1,label:"Course Name",align:"left",field:s=>s[6],format:s=>s===""?"N/A":`${s}`,sortable:!0,required:!0}]:e.item.key==="drugScreens"?i=[{name:0,label:"Category",align:"left",field:s=>s[9],format:s=>`${s}`,sortable:!0},{name:1,label:"Type",align:"left",field:s=>s[6],format:s=>s===""?"N/A":`${s}`,sortable:!0,required:!0},{name:2,label:"Description",align:"left",field:s=>s[7],format:s=>s===""?"N/A":`${s}`,sortable:!0,required:!0}]:e.item.key==="fitTests"?i=[{name:0,label:"Manufacturer",align:"left",field:s=>s[11],format:s=>`${s}`,sortable:!0},{name:1,label:"Model",align:"left",field:s=>s[8],format:s=>s===""?"N/A":`${s}`,sortable:!0,required:!0},{name:2,label:"Type",align:"left",field:s=>s[13],format:s=>s===""?"N/A":`${s} Face`,sortable:!0,required:!0}]:e.item.key==="medical"?i=[{name:0,label:"Medical Screen Type",align:"left",field:s=>s[6],format:s=>`${s}`,sortable:!0}]:e.item.key==="backgrounds"&&(i=[{name:0,label:"Background Type",align:"left",field:s=>s[7],format:(s,g)=>g[8]!==s?`${s} - ${g[8]}`:`${s}`,sortable:!0}]),i}),T=L(()=>{let i=[];return e.item.key==="orientations"?i=[{name:0,label:"Course Code",align:"left",field:s=>s[8],format:s=>`${s}`,sortable:!0},{name:1,label:"Course Name",align:"left",field:s=>s[6],format:s=>s===""?"N/A":`${s}`,sortable:!0,required:!0}]:e.item.key==="drugScreens"?i=[{name:0,label:"Category",align:"left",field:s=>s[9],format:s=>`${s}`,sortable:!0},{name:1,label:"Type",align:"left",field:s=>s[6],format:s=>s===""?"N/A":`${s}`,sortable:!0,required:!0},{name:2,label:"Description",align:"left",field:s=>s[7],format:s=>s===""?"N/A":`${s}`,sortable:!0,required:!0}]:e.item.key==="fitTests"?i=[{name:0,label:"Manufacturer",align:"left",field:s=>s[11],format:s=>`${s}`,sortable:!0},{name:1,label:"Model",align:"left",field:s=>s[8],format:s=>s===""?"N/A":`${s}`,sortable:!0,required:!0},{name:2,label:"Type",align:"left",field:s=>s[13],format:s=>s===""?"N/A":`${s} Face`,sortable:!0,required:!0}]:e.item.key==="medical"?i=[{name:0,label:"Medical Screen Type",align:"left",field:s=>s[6],format:s=>`${s}`,sortable:!0}]:e.item.key==="backgrounds"&&(i=[{name:0,label:"Background Type",align:"left",field:s=>s[7],format:(s,g)=>g[8]!==s?`${s} - ${g[8]}`:`${s}`,sortable:!0}]),i}),ee=L(()=>{const i=k.value?k.value:[];if(e.item.key==="orientations")return[...new Map(i.map(s=>[s[10],{value:s[10],label:s[11]}])).values()];if(e.item.key==="drugScreens")return[...new Map(i.map(s=>[s[8],{value:s[8],label:s[9]}])).values()];if(e.item.key==="fitTests"){const s=i.concat($.value);return[...new Map(s.map(g=>[g[11],g[11]])).values()]}else if(e.item.key==="medical"){const s=i.concat($.value);return[...new Map(s.map(g=>[g[6],g[6]])).values()]}else if(e.item.key==="backgrounds"){const s=i.concat($.value);return[...new Map(s.map(g=>[g[6],{value:g[6],label:g[7]}])).values()]}else return[]}),Ce=L(()=>{const i=k.value?k.value:[];if(e.item.key==="fitTests")return[...new Map(i.map(s=>[s[13],s[13]])).values()];if(e.item.key==="backgrounds"){const s=i.filter(g=>g[6]===1).concat(v.value);return[...new Map(s.map(g=>[g[8],g[8]])).values()].sort((g,P)=>g>P?1:-1)}else return[]});function X(i,s){$.value.push(i),s(i)}function ue(i,s){v.value.push(i),s(i)}const _e=M(async i=>{if(console.log(i),e.item.key==="orientations"){const s={6:{value:i.name},8:{value:i.code},10:{value:i.category.value}};try{const{data:g}=await E.upsertRecordsXML({to:"bp6rvwu6i",data:[s],fieldsToReturn:[20],formatObject:20});k.value.unshift(g[0][20]),C.value.push(g[0][20]),w({array:"orientations",object:g[0][20]})}catch(g){console.log(g),u.notify({type:"negative",message:"Something went wrong!"})}}else if(e.item.key==="drugScreens"){const s={7:{value:i.name},6:{value:i.code},8:{value:i.category.value}};try{const{data:g}=await E.upsertRecordsXML({to:"bp6rvxmg3",data:[s],fieldsToReturn:[15],formatObject:15});k.value.unshift(g[0][15]),C.value.push(g[0][15]),w({array:"drugScreens",object:g[0][15]})}catch(g){console.log(g),u.notify({type:"negative",message:"Something went wrong!"})}}else if(e.item.key==="fitTests"){const s={8:{value:i.name},11:{value:i.category},13:{value:i.code}};try{const{data:g}=await E.upsertRecordsXML({to:"bp6rv4qnn",data:[s],fieldsToReturn:[16],formatObject:16});k.value.unshift(g[0][16]),C.value.push(g[0][16]),w({array:"fitTests",object:g[0][16]})}catch(g){console.log(g),u.notify({type:"negative",message:"Something went wrong!"})}}else if(e.item.key==="medical"){const s={6:{value:i.category}};try{const{data:g}=await E.upsertRecordsXML({to:"bp6rv3ne3",data:[s],fieldsToReturn:[12],formatObject:12});k.value.unshift(g[0][12]),C.value.push(g[0][12]),w({array:"medical",object:g[0][12]})}catch(g){console.log(g),u.notify({type:"negative",message:"Something went wrong!"})}}else if(e.item.key==="backgrounds"){const g={6:{value:i.category.value?i.category.value:await Se(i.category)},8:{value:i.code?i.code:i.category}};try{const{data:P}=await E.upsertRecordsXML({to:"bp6rvyr7k",data:[g],fieldsToReturn:[17],formatObject:17});k.value.unshift(P[0][17]),C.value.push(P[0][17]),w({array:"backgrounds",object:P[0][17]})}catch(P){console.log(P),u.notify({type:"negative",message:"Something went wrong!"})}}je()});async function Se(i){const s={6:{value:i}};try{const{data:g}=await E.upsertRecordsXML({to:"bp6sjuy5b",data:[s],fieldsToReturn:[3]});return g[0][3]}catch(g){console.log(g),u.notify({type:"negative",message:"Something went wrong!"})}}async function we(){if(e.item.key==="orientations"){const i=await a();console.log(i),k.value=i}else if(e.item.key==="drugScreens"){const i=await n();console.log(i),k.value=i}else if(e.item.key==="fitTests"){const i=await f();console.log(i),k.value=i}else if(e.item.key==="medical"){const i=await h();console.log(i),k.value=i}else if(e.item.key==="backgrounds"){const i=await c();console.log(i),k.value=i}j.value=!1}async function Pe(){const{data:i}=await E.upsertRecordsXML({to:"bp6ru9fdi",data:[{6:{value:d.value[3]}}],fieldsToReturn:[20],formatObject:20});return console.log(i),b({array:"requirements",object:i[0][20]}),i[0][20][3]}async function Ye(){const i=[],s=d.value.requirements[0]?d.value.requirements[0][3]:await Pe();if(e.item.key==="orientations"){C.value.forEach(P=>{const ce={6:{value:s},7:{value:P[3]}};i.push(ce)});const{data:g}=await E.upsertRecordsXML({to:"bp6rvdha2",data:i,fieldsToReturn:[24],formatObject:24});g.forEach(P=>{p({index:e.spec,array:"orientations",object:P[24]})})}else if(e.item.key==="drugScreens"){C.value.forEach(P=>{const ce={6:{value:s},7:{value:P[3]}};i.push(ce)});const{data:g}=await E.upsertRecordsXML({to:"bp6rvd7zc",data:i,fieldsToReturn:[22],formatObject:22});g.forEach(P=>{p({index:e.spec,array:"drugScreens",object:P[22]})})}else if(e.item.key==="fitTests"){C.value.forEach(P=>{const ce={6:{value:s},7:{value:P[3]}};i.push(ce)});const{data:g}=await E.upsertRecordsXML({to:"bp6rvmzc6",data:i,fieldsToReturn:[24],formatObject:24});g.forEach(P=>{p({index:e.spec,array:"fitTests",object:P[24]})})}else if(e.item.key==="backgrounds"){C.value.forEach(P=>{const ce={6:{value:s},7:{value:P[3]}};i.push(ce)});const{data:g}=await E.upsertRecordsXML({to:"bp6rvfzpj",data:i,fieldsToReturn:[25],formatObject:25});g.forEach(P=>{p({index:e.spec,array:"backgrounds",object:P[25]})})}else if(e.item.key==="medical"){C.value.forEach(P=>{const ce={6:{value:s},7:{value:P[3]}};i.push(ce)});const{data:g}=await E.upsertRecordsXML({to:"bp6rvj39b",data:i,fieldsToReturn:[18],formatObject:18});g.forEach(P=>{p({index:e.spec,array:"medical",object:P[18]})})}t.emit("addComplete",e.item)}return we(),ve(C,(i,s)=>{console.log(i),console.log(Ne.value),je()}),ve(Y,(i,s)=>{console.log(i)}),{pushNewObject:b,handleReset:je,quickbase:E,initialPagination:{rowsPerPage:S(10)},projectData:d,formErrors:_,formMeta:q,submit:_e,props:e,selection:C,selectedColumns:T,options:k,tableColumns:Re,tableRows:Ne,categories:ee,category:Y,name:de,code:se,types:Ce,addCustomOptions:X,addCustomTypes:ue,optionsLoading:j,addSelectionsToProject:Ye}}}),Co={class:"row"},No={class:"col-12 col-md-3 q-pr-sm"},So={class:"text-caption"},Do={class:"col-12 col-md-2 q-pr-sm"},Vo={class:"text-caption"},Ao={class:"col-12 col-md-4 q-pr-sm"},Ro={class:"text-caption"},_o={key:0,class:"col-12 col-md-3 text-right"},Eo={class:"row"},Mo={class:"col-12 col-md-3 q-pr-sm"},To={class:"text-caption"},Po={class:"col-12 col-md-2 q-pr-sm"},Lo={class:"text-caption"},Oo={class:"col-12 col-md-4 q-pr-sm"},Uo={class:"text-caption"},Jo={key:0,class:"col-12 col-md-3 text-right"},Qo={class:"row"},Bo={class:"col-12 col-md-3 q-pr-sm"},Io={class:"text-caption"},Fo={class:"col-12 col-md-2 q-pr-sm"},Yo={class:"text-caption"},Xo={class:"col-12 col-md-4 q-pr-sm"},Ho={class:"text-caption"},zo={key:0,class:"col-12 col-md-3 text-right"},Wo={class:"row"},Go={class:"col-12 col-md-4 q-pr-sm"},Ko={class:"text-caption"},Zo=l("div",{class:"col-12 col-md-1 q-pr-sm"},null,-1),xo=l("div",{class:"col-12 col-md-4 q-pr-sm"},null,-1),el={key:0,class:"col-12 col-md-3 text-right"},tl={class:"row"},al={class:"col-12 col-md-4 q-pr-sm"},ol={class:"text-caption"},ll={class:"col-12 col-md-4 q-pr-sm"},sl={class:"text-caption"},rl=l("div",{class:"col-12 col-md-1 q-pr-sm"},null,-1),nl={key:0,class:"col-12 col-md-3 text-right"},il={class:"row items-start"},dl={key:0,class:"full-width row flex-center text-primary q-gutter-sm"},ul={key:0,class:"col-12 col-md-5"};function cl(e,t,u,d,b,w){return m(),N("div",null,[o(ye,{onSubmit:ge(e.submit,["prevent"])},{default:r(()=>[o(oe,{flat:""},{default:r(()=>[e.props.item.key==="orientations"?(m(),D(B,{key:0},{default:r(()=>[l("div",Co,[l("div",No,[o(Q,{dense:"",label:"Select Category","transition-show":"flip-up","transition-hide":"flip-down",modelValue:e.category,"onUpdate:modelValue":t[0]||(t[0]=a=>e.category=a),options:e.categories||[],error:!!e.formErrors.category,"bottom-slots":""},{error:r(()=>[l("div",So,y(e.formErrors.category),1)]),_:1},8,["modelValue","options","error"])]),l("div",Do,[o(I,{dense:"",label:"Course Code",modelValue:e.code,"onUpdate:modelValue":t[1]||(t[1]=a=>e.code=a),error:!!e.formErrors.code,"bottom-slots":""},{error:r(()=>[l("div",Vo,y(e.formErrors.code),1)]),_:1},8,["modelValue","error"])]),l("div",Ao,[o(I,{dense:"",label:"Course Name",modelValue:e.name,"onUpdate:modelValue":t[2]||(t[2]=a=>e.name=a),error:!!e.formErrors.name,"bottom-slots":""},{error:r(()=>[l("div",Ro,y(e.formErrors.name),1)]),_:1},8,["modelValue","error"])]),e.tableRows.length===0?(m(),N("div",_o,[o(V,{class:"q-mr-sm",color:"accent",label:"Reset",onClick:e.handleReset},null,8,["onClick"]),o(V,{color:"info",label:"Save",type:"submit"})])):A("",!0)])]),_:1})):A("",!0),e.props.item.key==="drugScreens"?(m(),D(B,{key:1},{default:r(()=>[l("div",Eo,[l("div",Mo,[o(Q,{dense:"",label:"Select Category","transition-show":"flip-up","transition-hide":"flip-down",modelValue:e.category,"onUpdate:modelValue":t[3]||(t[3]=a=>e.category=a),options:e.categories||[],error:!!e.formErrors.category,"bottom-slots":"","stack-label":""},{error:r(()=>[l("div",To,y(e.formErrors.category),1)]),_:1},8,["modelValue","options","error"])]),l("div",Po,[o(I,{dense:"",label:"Type of Test",modelValue:e.code,"onUpdate:modelValue":t[4]||(t[4]=a=>e.code=a),error:!!e.formErrors.code,"bottom-slots":"","stack-label":""},{error:r(()=>[l("div",Lo,y(e.formErrors.code),1)]),_:1},8,["modelValue","error"])]),l("div",Oo,[o(I,{dense:"",label:"Description or Consortium",placeholder:"Ex: DCCHA or 10 Panel Urine",modelValue:e.name,"onUpdate:modelValue":t[5]||(t[5]=a=>e.name=a),error:!!e.formErrors.name,"bottom-slots":"","stack-label":""},{error:r(()=>[l("div",Uo,y(e.formErrors.name),1)]),_:1},8,["modelValue","error"])]),e.tableRows.length===0?(m(),N("div",Jo,[o(V,{class:"q-mr-sm",color:"accent",label:"Reset",onClick:e.handleReset},null,8,["onClick"]),o(V,{color:"info",label:"Save",type:"submit"})])):A("",!0)])]),_:1})):A("",!0),e.props.item.key==="fitTests"?(m(),D(B,{key:2},{default:r(()=>[l("div",Qo,[l("div",Bo,[o(Q,{dense:"",label:"Select Manufacturer","transition-show":"flip-up","transition-hide":"flip-down",modelValue:e.category,"onUpdate:modelValue":t[6]||(t[6]=a=>e.category=a),options:e.categories||[],error:!!e.formErrors.category,"bottom-slots":"","stack-label":"","use-input":"","hide-dropdown-icon":"","new-value-mode":"add-unique",onNewValue:e.addCustomOptions},{error:r(()=>[l("div",Io,y(e.formErrors.category),1)]),_:1},8,["modelValue","options","error","onNewValue"])]),l("div",Fo,[o(Q,{dense:"",label:"Select Type","transition-show":"flip-up","transition-hide":"flip-down",modelValue:e.code,"onUpdate:modelValue":t[7]||(t[7]=a=>e.code=a),options:e.types||[],error:!!e.formErrors.code,"bottom-slots":"","stack-label":""},{error:r(()=>[l("div",Yo,y(e.formErrors.code),1)]),_:1},8,["modelValue","options","error"])]),l("div",Xo,[o(I,{dense:"",label:"Model",placeholder:"Ex: 6000 or AV2000",modelValue:e.name,"onUpdate:modelValue":t[8]||(t[8]=a=>e.name=a),error:!!e.formErrors.name,"bottom-slots":"","stack-label":""},{error:r(()=>[l("div",Ho,y(e.formErrors.name),1)]),_:1},8,["modelValue","error"])]),e.tableRows.length===0?(m(),N("div",zo,[o(V,{class:"q-mr-sm",color:"accent",label:"Reset",onClick:e.handleReset},null,8,["onClick"]),o(V,{color:"info",label:"Save",type:"submit"})])):A("",!0)])]),_:1})):A("",!0),e.props.item.key==="medical"?(m(),D(B,{key:3},{default:r(()=>[l("div",Wo,[l("div",Go,[o(Q,{dense:"",label:"Select Screen Type","transition-show":"flip-up","transition-hide":"flip-down",modelValue:e.category,"onUpdate:modelValue":t[9]||(t[9]=a=>e.category=a),options:e.categories||[],error:!!e.formErrors.category,"bottom-slots":"","stack-label":"","use-input":"","hide-dropdown-icon":"","new-value-mode":"add-unique",onNewValue:e.addCustomOptions},{error:r(()=>[l("div",Ko,y(e.formErrors.category),1)]),_:1},8,["modelValue","options","error","onNewValue"])]),Zo,xo,e.tableRows.length===0?(m(),N("div",el,[o(V,{class:"q-mr-sm",color:"accent",label:"Reset",onClick:e.handleReset},null,8,["onClick"]),o(V,{color:"info",label:"Save",type:"submit"})])):A("",!0)])]),_:1})):A("",!0),e.props.item.key==="backgrounds"?(m(),D(B,{key:4},{default:r(()=>[l("div",tl,[l("div",al,[o(Q,{dense:"",label:"Select or Enter Background Type","transition-show":"flip-up","transition-hide":"flip-down",modelValue:e.category,"onUpdate:modelValue":t[10]||(t[10]=a=>e.category=a),options:e.categories||[],error:!!e.formErrors.category,"bottom-slots":"","stack-label":"","use-input":"","hide-dropdown-icon":"","new-value-mode":"add-unique",onNewValue:e.addCustomOptions},{error:r(()=>[l("div",ol,y(e.formErrors.category),1)]),_:1},8,["modelValue","options","error","onNewValue"])]),l("div",ll,[e.category&&e.category.value===1?(m(),D(Q,{key:0,dense:"",label:"Select or Enter Owner","transition-show":"flip-up","transition-hide":"flip-down",modelValue:e.code,"onUpdate:modelValue":t[11]||(t[11]=a=>e.code=a),options:e.types||[],error:!!e.formErrors.code,"bottom-slots":"","stack-label":"","use-input":"","hide-dropdown-icon":"","new-value-mode":"add-unique",onNewValue:e.addCustomTypes},{error:r(()=>[l("div",sl,y(e.formErrors.code),1)]),_:1},8,["modelValue","options","error","onNewValue"])):A("",!0)]),rl,e.tableRows.length===0?(m(),N("div",nl,[o(V,{class:"q-mr-sm",color:"accent",label:"Reset",onClick:e.handleReset},null,8,["onClick"]),o(V,{color:"info",label:"Save",type:"submit"})])):A("",!0)])]),_:1})):A("",!0),o(B,{class:"q-py-xs q-px-xs"},{default:r(()=>[l("div",il,[l("div",{class:pe(["col-12",e.selection.length>0?"col-md-7 q-pr-sm":""])},[o(K,{dense:"","title-class":"text-primary",title:`Available ${e.props.item.label}${e.props.item.label.charAt(e.props.item.label.length-1).toLowerCase()==="s"?"":"s"}`,columns:e.tableColumns||[],rows:e.tableRows||[],"row-key":a=>a[3],"table-header-class":"bg-dark text-white",pagination:e.initialPagination,selection:"multiple",selected:e.selection,"onUpdate:selected":t[13]||(t[13]=a=>e.selection=a),loading:e.optionsLoading,"no-data-label":`No ${e.props.item.label}${e.props.item.label.charAt(e.props.item.label.length-1).toLowerCase()==="s"?"":"s"} available to choose from. Please add one.`},{"top-right":r(()=>[e.selection.length===0?(m(),D(V,{key:0,color:"secondary",label:"Cancel",onClick:t[12]||(t[12]=a=>e.$emit("cancelAdd"))})):A("",!0)]),loading:r(()=>[o(ht,{showing:"",color:"primary"})]),"no-data":r(({message:a})=>[e.optionsLoading?A("",!0):(m(),N("div",dl,[o(Ie,{size:"2em",name:"sentiment_very_dissatisfied"}),l("span",null,y(a),1)]))]),_:1},8,["title","columns","rows","row-key","pagination","selected","loading","no-data-label"])],2),e.selection.length>0?(m(),N("div",ul,[o(K,{dense:"","title-class":"text-primary",title:`Selected ${e.props.item.label}${e.props.item.label.charAt(e.props.item.label.length-1).toLowerCase()==="s"?"":"s"}`,columns:e.selectedColumns||[],rows:e.selection||[],"row-key":a=>a[3],"table-header-class":"bg-dark text-white",pagination:{rowsPerPage:5}},null,8,["title","columns","rows","row-key"]),e.selection.length>0&&e.tableRows.length>0?(m(),D(ie,{key:0,align:"right"},{default:r(()=>[o(V,{color:"secondary",label:"Cancel",onClick:t[14]||(t[14]=a=>e.$emit("cancelAdd"))}),o(V,{color:"primary",label:"Submit",onClick:e.addSelectionsToProject},null,8,["onClick"])]),_:1})):A("",!0)])):A("",!0)])]),_:1})]),_:1})]),_:1},8,["onSubmit"])])}var ml=H(jo,[["render",cl]]);const fl=x({components:{AddNewRequirement:ml},setup(){const e=le(),{capitalize:t}=Ue,u=S(0),d=S("orientations"),b=S(null),{projectData:w}=te(U()),a=L(()=>{const c=w.value.requirements[u.value];return c||null}),n=L(()=>[{label:"Orientation",key:"orientations",values:a.value?a.value.orientations:[],fields:[8,9],columns:[{name:0,label:"Course Code",align:"left",field:p=>p[8],format:p=>p===""?"N/A":`${p}`,sortable:!0,required:!0},{name:1,label:"Course Name",align:"left",field:p=>p[9],format:p=>`${p}`,sortable:!0}]},{label:"D&A Screen",key:"drugScreens",values:a.value?a.value.drugScreens:[],fields:[10,8],columns:[{name:0,label:"Test Type",align:"left",field:p=>p[8],format:p=>p===""?"N/A":`${p}`,sortable:!0,required:!0},{name:1,label:"Description",align:"left",field:p=>p[10],format:p=>`${p}`,sortable:!0}]},{label:"Background",key:"backgrounds",values:a.value?a.value.backgrounds:[],fields:[8,9],columns:[{name:0,label:"Background Type",align:"left",field:p=>p[8],format:p=>p===""?"N/A":`${p}`,sortable:!0,required:!0},{name:1,label:"Background Name",align:"left",field:p=>p[9],format:p=>`${p}`,sortable:!0}]},{label:"Fit Test",key:"fitTests",values:a.value?a.value.fitTests:[],fields:[18],columns:[{name:0,label:"Mask",align:"left",field:p=>p[18],format:p=>p===""?"N/A":`${p}`,sortable:!0,required:!0},{name:1,label:"Manufacturer",align:"left",field:p=>p[20],format:p=>p===""?"N/A":`${p}`,sortable:!0}]},{label:"Medical Screen",key:"medical",values:a.value?a.value.medical:[],fields:[10],columns:[{name:0,label:"Screen Type",align:"left",field:p=>p[10],format:p=>p===""?"N/A":`${p}`,sortable:!0,required:!0}]}]);function f(c){console.log(c),b.value=c}function h(c){b.value=null,e.notify({type:"positive",message:`New ${c.label} Added!`})}return{projectData:w,requirements:a,categories:n,capitalize:t,spec:u,tab:d,initialPagination:S({rowsPerPage:100}),addNew:b,addNewItem:f,newItemAdded:h}}});function bl(e,t,u,d,b,w){const a=G("add-new-requirement");return m(),N("div",null,[o(Ae,{dense:"",modelValue:e.tab,"onUpdate:modelValue":t[0]||(t[0]=n=>e.tab=n),align:"left","indicator-color":"accent","active-bg-color":"dark","active-color":"white","inline-label":"",class:"bg-dark text-white shadow-2 rounded-borders"},{default:r(()=>[(m(!0),N(Z,null,ae(e.categories,n=>(m(),D(z,{key:n.key,name:n.key,label:`${n.label}s`},{default:r(()=>[o(yt,{color:"accent",floating:"",transparent:""},{default:r(()=>[qe(y(n.values.length),1)]),_:2},1024)]),_:2},1032,["name","label"]))),128))]),_:1},8,["modelValue"]),o(Ve,{modelValue:e.tab,"onUpdate:modelValue":t[3]||(t[3]=n=>e.tab=n),animated:""},{default:r(()=>[(m(!0),N(Z,null,ae(e.categories,n=>(m(),D(W,{key:n.key,name:n.key,class:"q-px-xs"},{default:r(()=>[e.addNew?A("",!0):(m(),D(K,{key:0,dense:"",columns:n.columns,rows:n.values,"row-key":f=>f[3],"table-header-class":"bg-dark text-white",class:"sticky-header-table","hide-pagination":"",pagination:e.initialPagination,"onUpdate:pagination":t[1]||(t[1]=f=>e.initialPagination=f),"rows-per-page-options":[0]},{"top-left":r(()=>[o(V,{color:"accent",label:`Add new ${n.label}`,icon:"add",onClick:f=>e.addNewItem(n)},null,8,["label","onClick"])]),_:2},1032,["columns","rows","row-key","pagination"])),e.addNew?(m(),D(a,{key:1,spec:e.spec,item:n,onCancelAdd:t[2]||(t[2]=f=>e.addNew=null),onAddComplete:e.newItemAdded},null,8,["spec","item","onAddComplete"])):A("",!0)]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue"])])}var pl=H(fl,[["render",bl]]);const vl=[{name:0,label:"Name",align:"left",field:e=>e.tableData.name,format:e=>`${e}`,sortable:!0},{name:1,label:"Status",align:"left",field:e=>e.tableData.status,format:e=>`${e}`,sortable:!0},{name:2,label:"Offer Date",align:"left",field:e=>e.tableData.offerDate,format:e=>e?`${fe(e).format("MM/DD/YYYY")}`:"",sortable:!0,required:!0},{isSSN:!0,name:4,label:"SSN",align:"left",field:e=>e.tableData.ssn,format:(e,t)=>t.tableData.showSSN?`${e}`:`***-**-${e.slice(e.length-4)}`,sortable:!0,required:!0},{name:5,label:"Phone",align:"left",field:e=>e.tableData.phone,format:e=>`${e}`,sortable:!0,required:!0},{name:6,label:"Classification",align:"left",field:e=>e.tableData.job,format:e=>`${e}`,sortable:!0,required:!0},{name:7,label:"Job#",align:"left",field:e=>e.tableData.jobNumber,format:e=>`${e}`,sortable:!0,required:!0},{name:8,label:"Start Date",align:"left",field:e=>e.tableData.start,format:e=>e?`${fe(e).format("MM/DD/YYYY")}`:"",sortable:!0,required:!0}],gl=x({setup(){const e=S(null),t=S(null),u=S(null),d=S(null),b=S(""),{projectData:w}=te(U()),a=L(()=>{const f=w.value.pipeline||null;if(f){f.inProcess=[...new Map(f.inProcess.map(c=>[c.employee[3],c])).values()],f.dispatches=[...new Map(f.dispatches.map(c=>[c.employee[3],c])).values()],f.deployments=[...new Map(f.deployments.map(c=>[c.employee[3],c])).values()],f.inProcess.forEach((c,p)=>{Object.assign(c,{order:0,first:p===0,tableData:{showSSN:!1,name:c.employee[24],ssn:c.employee[109],phone:c.employee[25],offerDate:c[197].$d,hc:c[126],job:c[106],jobNumber:c[44],start:null,status:"In Process",request:c[138],craft:c[119]}})}),f.dispatches.forEach((c,p)=>{Object.assign(c,{order:1,first:p===0,tableData:{showSSN:!1,name:c.employee[24],ssn:c.employee[109],phone:c.employee[25],offerDate:c[165].$d,hc:c[61],job:c[45],jobNumber:c[63],start:null,status:"Pending",request:c[95],craft:c[141]}})}),f.deployments.forEach((c,p)=>{Object.assign(c,{order:2,first:p===0,tableData:{showSSN:!1,name:c.employee[24],ssn:c.employee[109],phone:c.employee[25],offerDate:c[144].$d,hc:c[68],job:c[45],jobNumber:c[85],start:fe(c[33].$d).isValid()?c[33].$d:null,status:"Deployed",request:c[80],craft:c[132]}})});let h=f.inProcess.concat(f.dispatches.concat(f.deployments));return h=e.value?h.filter(c=>c.tableData.jobNumber===e.value):h,h=t.value?h.filter(c=>c.tableData.craft===t.value):h,h=u.value?h.filter(c=>c.tableData.request===u.value):h,h=d.value?h.filter(c=>c.tableData.status===d.value):h,h=h.filter(c=>c.tableData.name.toLowerCase().includes(b.value.toLowerCase())),h}else return null}),n=L(()=>{const f=a.value?[...new Map(a.value.map(k=>[k.tableData.jobNumber,k.tableData.jobNumber])).values()]:[],h=a.value?[...new Map(a.value.map(k=>[k.tableData.request,k.tableData.request])).values()]:[],c=a.value?[...new Map(a.value.map(k=>[k.tableData.craft,k.tableData.craft])).values()]:[],p=a.value?[...new Map(a.value.map(k=>[k.tableData.status,k.tableData.status])).values()]:[];return{jobNumbers:f,requestNumbers:h,crafts:c,statuses:p}});return{projectData:w,columns:vl,initialPagination:{rowsPerPage:S(25)},pipeline:a,filters:n,jobNumberFilter:e,craftFilter:t,requestNumberFilter:u,statusFilter:d,searchString:b}}}),yl={class:"row items-start"},hl={class:"col-12 col-md-9 q-pr-md"},wl=l("div",{class:"text-primary q-mb-sm text-body1"},"Search / Filter",-1),$l={class:"row q-my-sm"},kl={class:"col-12 col-md-6"},ql={class:"row q-mt-md items-start"},jl={class:"col-12 col-md-5 q-pr-sm"},Cl={class:"col-12 col-md-2 q-pr-sm"},Nl={class:"col-12 col-md-2 q-pr-sm"},Sl={class:"col-12 col-md-2"},Dl={class:"col-12 col-md-3 self-center"},Vl=l("thead",{class:"bg-dark text-white"},[l("tr",null,[l("th",{class:"text-left"},"Status"),l("th",{class:"text-right"},"Qty")])],-1),Al=l("td",{class:"text-left"},"In Process",-1),Rl={class:"text-right"},_l=l("td",{class:"text-left"},"Pending",-1),El={class:"text-right"},Ml=l("td",{class:"text-left"},"Deployed",-1),Tl={class:"text-right"},Pl={class:"text-body2 text-italic"},Ll=l("span",{class:"text-primary"},"Total in Pipeline:",-1),Ol={class:"q-pl-md text-dark"};function Ul(e,t,u,d,b,w){return m(),N("div",null,[o(oe,{flat:"",class:"q-mb-sm"},{default:r(()=>[o(B,{class:"q-pa-sm"},{default:r(()=>[l("div",yl,[l("div",hl,[wl,l("div",$l,[l("div",kl,[o(I,{clearable:"","clear-icon":"close",dense:"",modelValue:e.searchString,"onUpdate:modelValue":t[0]||(t[0]=a=>e.searchString=a),label:"Search","stack-label":"",onClear:t[1]||(t[1]=a=>e.searchString="")},null,8,["modelValue"])])]),l("div",ql,[l("div",jl,[o(Q,{dense:"",modelValue:e.jobNumberFilter,"onUpdate:modelValue":t[2]||(t[2]=a=>e.jobNumberFilter=a),options:e.filters.jobNumbers,label:"Job Number","use-chips":"","stack-label":""},null,8,["modelValue","options"])]),l("div",Cl,[o(Q,{dense:"",modelValue:e.craftFilter,"onUpdate:modelValue":t[3]||(t[3]=a=>e.craftFilter=a),options:e.filters.crafts,label:"Craft","use-chips":"","stack-label":""},null,8,["modelValue","options"])]),l("div",Nl,[o(Q,{dense:"",modelValue:e.requestNumberFilter,"onUpdate:modelValue":t[4]||(t[4]=a=>e.requestNumberFilter=a),options:e.filters.requestNumbers,label:"Request#","use-chips":"","stack-label":""},null,8,["modelValue","options"])]),l("div",Sl,[o(Q,{dense:"",modelValue:e.statusFilter,"onUpdate:modelValue":t[5]||(t[5]=a=>e.statusFilter=a),options:e.filters.statuses,label:"Status","use-chips":"","stack-label":""},null,8,["modelValue","options"])])])]),l("div",Dl,[o(Te,{bordered:"",flat:"",dense:""},{default:r(()=>[Vl,l("tbody",null,[l("tr",null,[Al,l("td",Rl,y(e.pipeline?e.pipeline.filter(a=>a.tableData.status==="In Process").length:0),1)]),l("tr",null,[_l,l("td",El,y(e.pipeline?e.pipeline.filter(a=>a.tableData.status==="Pending").length:0),1)]),l("tr",null,[Ml,l("td",Tl,y(e.pipeline?e.pipeline.filter(a=>a.tableData.status==="Deployed").length:0),1)])])]),_:1})])])]),_:1})]),_:1}),o(K,{dense:"",title:"Pipeline","title-class":"text-primary",style:{},columns:e.columns,rows:e.pipeline||[],"row-key":a=>a[3],"table-header-class":"bg-dark text-white",pagination:e.initialPagination},{"top-right":r(()=>[l("div",Pl,[Ll,l("span",Ol,y(e.pipeline.length),1)])]),_:1},8,["columns","rows","row-key","pagination"])])}var Jl=H(gl,[["render",Ul]]);const Ql=[{name:0,label:"Name",align:"left",field:e=>e[75],format:e=>`${e}`,sortable:!0},{name:1,label:"Employee ID",align:"left",field:e=>e[104],format:e=>`${e}`},{name:2,label:"Payroll ID",align:"left",field:e=>e.employee[213],format:e=>`${e}`},{name:4,label:"SSN",align:"left",field:e=>e.employee[109],format:(e,t)=>t.showSSN?`${e}`:`***-**-${e.slice(e.length-4)}`,isSSN:!0},{name:5,label:"Phone",align:"left",field:e=>e.employee[25],format:e=>`${e}`},{name:6,label:"Classification",align:"left",field:e=>e[20],format:e=>`${e}`,sortable:!0},{name:7,label:"Job#",align:"left",field:e=>e[105],format:e=>`${e}`,sortable:!0}],Bl=x({setup(){const e=S(null),t=S(null),u=S(""),{projectData:d}=te(U()),b=L(()=>{let a=d.value.roster||null;return a?(a.sort((n,f)=>n[1].$d>f[1].$d?-1:1),a=[...new Map(a.map(n=>[n.employee[3],n])).values()],a=a.filter(n=>!n[112]),a.forEach(n=>{Object.assign(n,{showSSN:!1})}),a=e.value?a.filter(n=>n[105]===e.value):a,a=t.value?a.filter(n=>n[68]===t.value):a,a=a.filter(n=>n[75].toLowerCase().includes(u.value.toLowerCase())||n[104].toLowerCase().includes(u.value.toLowerCase())||n.employee[109].toLowerCase().includes(u.value.toLowerCase())),a.sort((n,f)=>n[75].toLowerCase()>f[75].toLowerCase()?1:-1)):null}),w=L(()=>{const a=b.value?[...new Map(b.value.map(f=>[f[105],f[105]])).values()]:[],n=b.value?[...new Map(b.value.map(f=>[f[68],f[68]])).values()]:[];return{jobNumbers:a,crafts:n}});return{projectData:d,columns:Ql,initialPagination:{rowsPerPage:S(25)},roster:b,filters:w,jobNumberFilter:e,craftFilter:t,searchString:u}}}),Il=l("div",{class:"text-primary q-mb-sm text-body1"},"Search / Filter",-1),Fl={class:"row q-my-sm"},Yl={class:"col-12 col-md-5 q-pr-sm"},Xl={class:"col-12 col-md-4 q-pr-sm"},Hl={class:"col-12 col-md-3 q-pr-sm"},zl={class:"text-body2 text-italic"},Wl=l("span",{class:"text-primary"},"Total Employees:",-1),Gl={class:"q-pl-md text-dark"};function Kl(e,t,u,d,b,w){return m(),N("div",null,[o(oe,{flat:"",class:"q-mb-sm"},{default:r(()=>[o(B,{class:"q-pa-sm"},{default:r(()=>[Il,l("div",Fl,[l("div",Yl,[o(I,{clearable:"","clear-icon":"close",dense:"",modelValue:e.searchString,"onUpdate:modelValue":t[0]||(t[0]=a=>e.searchString=a),label:"Search","stack-label":"",onClear:t[1]||(t[1]=a=>e.searchString="")},null,8,["modelValue"])]),l("div",Xl,[o(Q,{dense:"",modelValue:e.jobNumberFilter,"onUpdate:modelValue":t[2]||(t[2]=a=>e.jobNumberFilter=a),options:e.filters.jobNumbers,label:"Job Number","use-chips":"","stack-label":""},null,8,["modelValue","options"])]),l("div",Hl,[o(Q,{dense:"",modelValue:e.craftFilter,"onUpdate:modelValue":t[3]||(t[3]=a=>e.craftFilter=a),options:e.filters.crafts,label:"Craft","use-chips":"","stack-label":""},null,8,["modelValue","options"])])])]),_:1})]),_:1}),o(K,{dense:"",title:"Roster","title-class":"text-primary",style:{},columns:e.columns,rows:e.roster||[],"row-key":a=>a[3],"table-header-class":"bg-dark text-white",pagination:e.initialPagination},{"top-right":r(()=>[l("div",zl,[Wl,l("span",Gl,y(e.roster.length),1)])]),_:1},8,["columns","rows","row-key","pagination"])])}var Zl=H(Bl,[["render",Kl]]);const xl=x({components:{},props:{project:Object},setup(e,t){const u=le(),d=S(10),b=S(null),{getUser:w}=te(mt()),a=S(null),n=L(()=>{const T=new RegExp("^[0-9]{"+d.value+"}","g");return F({firstName:J().required().label("First Name"),lastName:J().required().label("Last Name"),email:J().email().required().label("Email"),phoneNumber:J().matches(T,{excludeEmptyString:!0,message:"Valid Phone Number Required!"}).required().label("Phone Number"),role:F().required().nullable().label("Role"),workdayId:J().required().label("Workday ID")})}),{meta:f,errors:h,handleSubmit:c,handleReset:p}=he({validationSchema:n}),{value:k}=O("firstName"),{value:C}=O("lastName"),{value:$}=O("email"),{value:v}=O("phoneNumber"),{value:j}=O("role"),{value:R}=O("workdayId");async function q({accessID:T}){const{data:ee}=await E.upsertRecordsXML({to:"br598isx6",data:[{3:{value:T},20:{value:!0}}],fieldsToReturn:[28],formatObject:28});t.emit("userAdded",{user:ee[0][28]}),u.loading.hide(),p()}async function _(T){const{data:ee}=await E.fetchFromStructureApp({fields:[{6:{value:"br598isx6"},7:{value:"Table Query"},8:{value:`{'6'.EX.${T}}`},9:{value:1},14:{value:24}}]});if(new Set(ee.filter(X=>X[7]==="Project").map(X=>X[9])).has(e.project[3])){const X=ee.find(ue=>ue[9]===e.project[3]);q({accessID:X[3]})}else return!1}async function M(T){const ee=`{'10'.EX.'Active'}${T.email?`AND{'6'.EX.'${T.email}'}`:""}${T.phoneNumber?`AND{'8'.EX.'${T.phoneNumber}'}`:""}${T.userType?`AND{'32'.EX.'${T.userType}'}`:""}`,Ce=[{7:{value:"User Request"},8:{value:ee},9:{value:1},14:{value:77}}],{data:X}=await E.fetchFromStructureApp({fields:Ce});if(X.length<1)return null;if(!await _(X[0][3]))return null}const je=c(async T=>{u.loading.show();const ee={userType:"Project User",phoneNumber:`+${b.value?b.value.dialCode:"1"}${T.phoneNumber}`,email:T.email};if(e.project.users.filter(X=>X[6]===ee.email||X[8]===ee.phoneNumber).length>0)u.dialog({title:"Alert",message:"Your project already has a user with that phone or email."}).onOk(()=>{t.emit("userCanceled")});else{const X=await M(ee);if(console.log(X),X){const{data:ue}=await E.upsertRecordsXML({to:"br598isx6",data:[{6:{value:X[0][3]},7:{value:"Project"},9:{value:e.project[3]}}],fieldsToReturn:[28],formatObject:28});ue.length>0&&t.emit("userAdded",{user:ue[0][28]})}else{const ue=$.value.match(/^([^@]*)@/)[1],_e=Object.assign({phoneNumber:v.value},b.value),{data:Se}=await E.upsertRecordsXML({to:"br4pxrbs6",data:[{6:{value:T.email},7:{value:"temp"},8:{value:`+${b.value?b.value.dialCode:"1"}${T.phoneNumber}`},9:{value:JSON.stringify(_e)},10:{value:"Active"},11:{value:T.role[3]},17:{value:!0},23:{value:w.value[3]},24:{value:w.value[3]},25:{value:new Date},26:{value:new Date},32:{value:"Project User"},33:{value:ue},35:{value:k.value},37:{value:C.value},49:{value:!0},50:{value:!0},70:{value:T.workdayId}}],fieldsToReturn:[3,96],formatObject:96});if(Se[0]!==void 0){const we=await E.upsertRecordsXML({to:"br598isx6",data:[{6:{value:Se[0][3]},7:{value:"Project"},9:{value:e.project[3]}}],fieldsToReturn:[28],formatObject:28});we.data[0]!==void 0&&u.dialog({title:"Confirm",message:"User successfully added. Would you like to send them an invite?",cancel:!0,persistent:!0}).onOk(async()=>{(await E.upsertRecordsXML({to:"br4pxrbs6",data:[{3:{value:we.data[0][28][3]},93:{value:new Date}}],fieldsToReturn:[3]})).data[0]!==void 0&&(u.notify({type:"positive",message:"User invite submitted"}),t.emit("userAdded",{user:we.data[0][28]}))}).onCancel(()=>{t.emit("userAdded",{user:we.data[0][28]})})}}}p(),u.loading.hide()}),Y=L(()=>{const T=e.project.users.map(ee=>ee[9].phoneNumber);return new Set(T)});ve(v,T=>{Y.value.has(T)&&u.notify({type:"negative",message:"Phone Number is already in use!",timeout:1e4,position:u.screen.lt.md?"top":"center"})});const de=T=>{b.value=T},se=T=>{d.value=T};function Ne(){p(),t.emit("userCanceled")}async function Re(){u.loading.show();const{data:T}=await E.fetchFromStructureApp({fields:[{6:{value:"br5v4in72"},7:{value:"Table Query"},8:{value:"{'7'.EX.'Projects'}AND{'15'.EX.'Active'}AND{'17'.EX.true}"},9:{value:1},14:{value:18}}]});a.value=T,u.loading.hide()}return Re(),{updateCountry:de,updatePhoneMaxLength:se,firstName:k,lastName:C,email:$,phoneNumber:v,role:j,workdayId:R,formMeta:f,formErrors:h,submitUser:je,roleOptions:a,cancel:Ne}}}),es=l("div",{class:"text-primary text-h6 q-mb-sm"},"Add a New User",-1),ts={class:"row justify-between"},as={class:"row justify-between"},os={class:"text-caption"},ls={class:"text-caption"},ss={class:"text-caption"};function rs(e,t,u,d,b,w){return m(),N("div",null,[o(oe,null,{default:r(()=>[o(ye,{onSubmit:ge(e.submitUser,["prevent"])},{default:r(()=>[o(B,null,{default:r(()=>[es,l("div",ts,[l("div",{class:pe(["col-12 col-md-4",e.$q.screen.lt.md?"q-pt-sm":"q-pr-sm"])},[o(I,{dense:"",outlined:"",label:"First Name",modelValue:e.firstName,"onUpdate:modelValue":t[0]||(t[0]=a=>e.firstName=a),error:!!e.formErrors.firstName},null,8,["modelValue","error"])],2),l("div",{class:pe(["col-12 col-md-4",e.$q.screen.lt.md?"q-pt-sm":"q-pr-sm"])},[o(I,{dense:"",outlined:"",label:"Last Name",modelValue:e.lastName,"onUpdate:modelValue":t[1]||(t[1]=a=>e.lastName=a),error:!!e.formErrors.lastName},null,8,["modelValue","error"])],2),l("div",{class:pe(["col-12 col-md-4",e.$q.screen.lt.md?"q-pt-sm":"q-pr-sm"])},[o(I,{dense:"",outlined:"",label:"Workday ID",modelValue:e.workdayId,"onUpdate:modelValue":t[2]||(t[2]=a=>e.workdayId=a),error:!!e.formErrors.workdayId},null,8,["modelValue","error"])],2)]),l("div",as,[l("div",{class:pe(["col-12 col-md-4",e.$q.screen.lt.md?"q-pt-sm":"q-pr-sm"])},[o(I,{dense:"",outlined:"",label:"Phone Number",modelValue:e.phoneNumber,"onUpdate:modelValue":t[3]||(t[3]=a=>e.phoneNumber=a),error:!!e.formErrors.phoneNumber,"bottom-slots":""},{error:r(()=>[l("div",os,y(e.formErrors.phoneNumber),1)]),_:1},8,["modelValue","error"])],2),l("div",{class:pe(["col-12 col-md-4",e.$q.screen.lt.md?"q-pt-sm":"q-pr-sm"])},[o(I,{dense:"",outlined:"",label:"Email","bottom-slots":"",modelValue:e.email,"onUpdate:modelValue":t[4]||(t[4]=a=>e.email=a),error:!!e.formErrors.email},{error:r(()=>[l("div",ls,y(e.formErrors.email),1)]),_:1},8,["modelValue","error"])],2),l("div",{class:pe(["col-12 col-md-4",e.$q.screen.lt.md?"q-pt-sm":"q-pr-sm"])},[o(Q,{dense:"",outlined:"",label:"Role","transition-show":"flip-up","transition-hide":"flip-down",modelValue:e.role,"onUpdate:modelValue":t[5]||(t[5]=a=>e.role=a),options:e.roleOptions,"option-label":"6","display-value":`${e.role?e.role[6]:""}`,"bottom-slots":"",error:!!e.formErrors.role},{error:r(()=>[l("div",ss,y(e.formErrors.role),1)]),_:1},8,["modelValue","options","display-value","error"])],2)])]),_:1}),o(ie,{align:"right"},{default:r(()=>[o(V,{color:"secondary",onClick:e.cancel,label:"Cancel"},null,8,["onClick"]),o(V,{color:"primary",type:"submit",label:"Submit"})]),_:1})]),_:1},8,["onSubmit"])]),_:1})])}var ns=H(xl,[["render",rs]]);const is=[{name:0,label:"Date Created",align:"left",field:e=>e[1],format:e=>`${ft.formatDate(e.$d,"MM/DD/YYYY")}`,sortable:!0},{name:1,label:"Name",align:"left",field:e=>e[35],format:(e,t)=>`${e} ${t[37]}`,sortable:!0},{name:2,label:"Role",align:"left",field:e=>e[44],format:e=>`${e}`,sortable:!0},{name:3,label:"Email",align:"left",field:e=>e[6],format:e=>`${e}`,sortable:!0},{name:4,label:"Last Access",align:"left",field:e=>e.lastLogin,format:(e,t)=>`${t.registered?e.date:"Never"}`,sortable:!0}],ds=x({components:{AddUser:ns},setup(){const e=le(),{projectData:t}=te(U()),{pushNewObject:u}=U(),d=S(!1),b=L(()=>t.value.users.sort((f,h)=>f[44]>h[44]?-1:1));function w({user:n}){e.notify({type:"positive",message:"User successfully added!"}),d.value=!1,u({array:"users",object:n})}function a(n){console.log(n)}return{projectData:t,projectUsers:b,columns:is,initialPagination:{rowsPerPage:100},showAddUser:d,userAdded:w,sendInvite:a}}}),us={key:1};function cs(e,t,u,d,b,w){const a=G("add-user");return m(),N("div",null,[e.showAddUser?(m(),N("div",us,[o(a,{onUserAdded:e.userAdded,onUserCanceled:t[1]||(t[1]=n=>e.showAddUser=!1),project:e.projectData},null,8,["onUserAdded","project"])])):(m(),D(K,{key:0,rows:e.projectUsers,columns:e.columns,"hide-pagination":!0,"row-key":n=>n[3],pagination:e.initialPagination,"table-header-class":"bg-dark text-white",dense:""},rt({_:2},[e.$can("manage","projects")?{name:"top-left",fn:r(()=>[o(V,{color:"accent",label:"Add Another User",onClick:t[0]||(t[0]=n=>e.showAddUser=!0),icon:"add"})]),key:"0"}:void 0]),1032,["rows","columns","row-key","pagination"]))])}var ms=H(ds,[["render",cs]]);const fs={components:{Workday:ua,JobNumbers:ka,CraftsAndJobs:qo,Requests:Ot,Pipeline:Jl,Roster:Zl,MeetingLocations:Pa,Requirements:pl,Users:ms},setup(){const e=nt(),t=it(),u=le(),{fetchProject:d}=U(),{projectData:b}=te(U()),w=U();async function a(){u.loading.show(),await d({id:e.params.id}),u.loading.hide()}a(),ve(b,()=>{console.log(b.value)});function n(){t.replace({name:"projects"}),w.$reset()}return{projectData:b,splitterModel:S(20),tab:S(0),decodeHTML:Fe,closeViewProject:n}}},bs={key:0,class:"q-pa-sm"},ps={class:"row"},vs={class:"col-12 col-md-6"},gs={class:"col-12 col-md-6"},ys={class:"row"},hs={class:"col-12 col-md-3 q-pr-sm"},ws=l("div",{class:"text-h6 text-weight-regular"},"GENERAL INFO",-1),$s={class:"q-my-sm"},ks=l("div",{class:"text-primary"},"Project:",-1),qs={class:"text-dark q-pl-sm"},js={class:"q-my-sm"},Cs=l("div",{class:"text-primary"},"Job Site:",-1),Ns={class:"text-dark q-pl-sm"},Ss={class:"q-my-sm"},Ds=l("div",{class:"text-primary"},"Hiring Center:",-1),Vs={class:"text-dark q-pl-sm"},As={class:"q-my-sm"},Rs=l("div",{class:"text-primary"},"Sup Org Manager:",-1),_s={class:"text-dark q-pl-sm"},Es={class:"q-my-sm"},Ms=l("div",{class:"text-primary"},"Project Manager:",-1),Ts={class:"text-dark q-pl-sm"},Ps={class:"text-dark q-pl-sm"},Ls={class:"text-dark q-pl-sm"},Os={class:"q-my-sm"},Us=l("div",{class:"text-primary"},"Safety Manager:",-1),Js={class:"text-dark q-pl-sm"},Qs={class:"text-dark q-pl-sm"},Bs={class:"text-dark q-pl-sm"},Is={class:"col-12 col-md-9 q-pl-sm"};function Fs(e,t,u,d,b,w){const a=G("requests"),n=G("workday"),f=G("job-numbers"),h=G("meeting-locations"),c=G("crafts-and-jobs"),p=G("requirements"),k=G("pipeline"),C=G("roster"),$=G("users");return m(),D(ut,{style:{"max-width":"100vw"}},{default:r(()=>[d.projectData?(m(),N("div",bs,[o(oe,{flat:""},{default:r(()=>[o(B,{class:"q-pa-none"},{default:r(()=>[l("div",ps,[l("div",vs,[o(ie,{class:"q-pt-none",align:"left"},{default:r(()=>[o(V,{label:"Back",color:"secondary",icon:"keyboard_return",onClick:d.closeViewProject},null,8,["onClick"])]),_:1})]),l("div",gs,[o(ie,{class:"q-pt-none",align:"right"},{default:r(()=>[e.$can("create","hireRequests")?(m(),D(V,{key:0,label:"Add Hire Request",color:"accent",icon:"add"})):A("",!0),e.$can("manage","projects")?(m(),D(V,{key:1,label:"Close this Project",color:"dark"})):A("",!0)]),_:1})])])]),_:1})]),_:1}),l("div",ys,[l("div",hs,[o(oe,{class:"q-mb-md"},{default:r(()=>[o(B,{class:"q-py-sm q-pl-md bg-info text-white"},{default:r(()=>[ws]),_:1}),o(B,{class:"text-body2 q-py-xs"},{default:r(()=>[l("div",$s,[ks,l("div",qs,y(d.projectData[20]),1)]),o(ke),l("div",js,[Cs,l("div",Ns,y(d.projectData[24]),1)]),o(ke),l("div",Ss,[Ds,l("div",Vs,y(d.projectData[76]),1)]),o(ke),l("div",As,[Rs,l("div",_s,y(d.projectData[245]!==""?d.projectData[245]:"N/A"),1)]),o(ke),l("div",Es,[Ms,l("div",Ts,y(d.projectData[46]),1),l("div",Ps,y(d.projectData[47]),1),l("div",Ls,y(d.projectData[48]),1)]),o(ke),l("div",Os,[Us,l("div",Js,y(d.projectData[50]),1),l("div",Qs,y(d.projectData[51]),1),l("div",Bs,y(d.projectData[52]),1)])]),_:1})]),_:1})]),l("div",Is,[o(dt,{class:"bg-info text-white shadow-2 rounded-borders"},{default:r(()=>[o(Ae,{align:"left",modelValue:d.tab,"onUpdate:modelValue":t[0]||(t[0]=v=>d.tab=v),dense:"","indicator-color":"accent"},{default:r(()=>[o(z,{name:0,label:"Requests"}),o(z,{name:1,label:"Workday"}),o(z,{name:2,label:"Job Numbers"}),o(z,{name:3,label:"Per Diem"}),o(z,{name:4,label:"Locations"}),o(z,{name:5,label:"Crafts / Jobs"}),o(z,{name:6,label:"Requirements"}),o(z,{name:7,label:"Pipeline"}),o(z,{name:8,label:"Roster"}),o(z,{name:9,label:"Users"})]),_:1},8,["modelValue"])]),_:1}),d.projectData?(m(),D(Ve,{key:0,modelValue:d.tab,"onUpdate:modelValue":t[1]||(t[1]=v=>d.tab=v),animated:"",class:"q-px-none"},{default:r(()=>[o(W,{class:"q-px-xs",name:0},{default:r(()=>[o(a)]),_:1}),o(W,{class:"q-px-xs",name:1},{default:r(()=>[o(n)]),_:1}),o(W,{class:"q-px-xs",name:2},{default:r(()=>[o(f)]),_:1}),o(W,{class:"q-px-xs",name:3},{default:r(()=>[o(f)]),_:1}),o(W,{class:"q-px-xs",name:4},{default:r(()=>[o(h)]),_:1}),o(W,{class:"q-px-xs",name:5},{default:r(()=>[o(c)]),_:1}),o(W,{class:"q-px-xs",name:6},{default:r(()=>[o(p)]),_:1}),o(W,{class:"q-px-xs",name:7},{default:r(()=>[o(k)]),_:1}),o(W,{class:"q-px-xs",name:8},{default:r(()=>[o(C)]),_:1}),o(W,{class:"q-px-xs",name:9},{default:r(()=>[o($)]),_:1})]),_:1},8,["modelValue"])):A("",!0)])])])):A("",!0)]),_:1})}var Ar=H(fs,[["render",Fs]]);export{Ar as default};
