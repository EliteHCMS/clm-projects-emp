import{l as q,r as c,c as w,_ as C,A as l,aq as Y,br as o,B as d,D as p,ac as g,bW as b,ar as D,d as i,bO as T,cG as _,ax as $,E as z}from"./index.e8fb2253.js";import{Q as B}from"./QInnerLoading.52e3072b.js";import{Q as h}from"./QTooltip.604a832b.js";import{Q as E}from"./QForm.bc1b5926.js";import{Q as F}from"./QTd.a9c509ec.js";import{u as j}from"./use-quasar.0aa2fc3d.js";import{a as N,u as O}from"./vee-validate.esm.f9a9192e.js";import{a as R,b as H}from"./array.6a8b7cfb.js";import{dayjs as r}from"./dayjs.d1250a8a.js";import{q as k}from"./app.00bf1e10.js";import{u as I}from"./useQuerySaver.d29ff9ee.js";const L=q({props:{row:Object,rowType:String},setup(e,{emit:s}){const v=j(),u=c(!1),n=c(null),m=c(null),t=c(!0),M=w(()=>{const a=e.row[219];return a?r(a.$d).format("MM/DD/YYYY"):null}),Q=w(()=>R({entry:H().required("Arrival date is required").max(r().toDate(),"Arrival date cannot be in the future!").nullable().label("Arrival Date")})),{errors:V,handleSubmit:A,handleReset:x}=N({validationSchema:Q}),{value:f}=O("entry"),S=A(async a=>{t.value=!0,u.value=!1;try{const{data:y}=await k.upsertRecordsXML({to:"bp3gazpqj",data:[{3:{value:m.value},145:{value:r(a.entry)}}],fieldsToReturn:[144],formatObject:144});n.value=r(y[0][144][145].$d).toDate(),f.value=r(y[0][144][145].$d).format("YYYY-MM-DD"),t.value=!1,v.notify({type:"positive",message:"Arrival date was updated!"})}catch{v.notify({type:"negative",message:"There was a problem"}),t.value=!1,u.value=!1}});return(async()=>{if(e.rowType==="assignment"){const a=e.row[145].$d?e.row[145].$d:e.row[1].$d;m.value=e.row[3],n.value=r(a).toDate(),f.value=r(a).format("YYYY-MM-DD"),t.value=!1}else if(e.rowType==="deployment"&&e.row[207]){const{data:a}=await k.fetchFromHiringApp({fields:[I({type:"rawAssignments",id:e.row[207]})]});n.value=r(a[145].$d).toDate(),f.value=r(a[145].$d).format("YYYY-MM-DD"),m.value=a[3],t.value=!1}})(),{edit:u,entry:f,formErrors:V,submit:S,val:M,fieldValue:n,loading:t}}}),G={key:0},U={key:0},W={key:0},X={key:1},J={key:1},K={class:"q-pt-sm"},P={class:"text-caption"};function Z(e,s,v,u,n,m){return l(),Y(F,{"auto-width":!e.edit,style:z(e.edit?"min-width: 250px;":"")},{default:o(()=>[e.fieldValue?(l(),d("div",G,[e.edit?(l(),d("div",J,[i(E,{onSubmit:T(e.submit,["prevent"])},{default:o(()=>[i(_,{modelValue:e.entry,"onUpdate:modelValue":s[2]||(s[2]=t=>e.entry=t),type:"date",label:"Arrival Date",error:!!e.formErrors.entry,"bottom-slots":"","stack-label":"",dense:""},{after:o(()=>[p("div",K,[i(b,{class:"q-mr-xs",onClick:s[1]||(s[1]=t=>e.edit=!1),icon:"close",color:"secondary",dense:"",size:"sm"},{default:o(()=>[i(h,{class:"bg-secondary"},{default:o(()=>[$("Cancel")]),_:1})]),_:1}),i(b,{disable:!!e.formErrors.entry,type:"submit",onClick:e.submit,icon:"done",color:"info",dense:"",size:"sm"},{default:o(()=>[i(h,{class:"bg-info"},{default:o(()=>[$("Submit")]),_:1})]),_:1},8,["disable","onClick"])])]),error:o(()=>[p("div",P,g(e.formErrors.entry),1)]),_:1},8,["modelValue","error"])]),_:1},8,["onSubmit"])])):(l(),d("div",U,[e.loading?(l(),d("div",X,[i(B,{size:"sm",showing:"",color:"primary"})])):(l(),d("div",W,[p("span",null,g(e.$dayjs(e.fieldValue).format("MM/DD/YYYY")),1),e.$can("manage","employees")?(l(),Y(b,{key:0,icon:"edit",color:"accent",flat:"",size:"sm",onClick:s[0]||(s[0]=t=>e.edit=!0)})):D("",!0)]))]))])):D("",!0)]),_:1},8,["auto-width","style"])}var fe=C(L,[["render",Z]]);export{fe as A};
