import{Q as C}from"./QSpace.0aefa4da.js";import{c4 as $,c1 as O,r as c,w as N,aK as Y,c as _,z,A,d as a,bh as m,c2 as T,C as d,E as b,a6 as o,aa as D,c3 as E,cx as M,bX as U,c6 as y}from"./index.52c71ca6.js";import{Q as G}from"./QTd.be89a153.js";import{u as K}from"./use-quasar.8076b8cd.js";import{e as L}from"./export-file.6b95af49.js";import{R as X}from"./quickbase.0d6b62e6.js";import{dayjs as F}from"./dayjs.7e2f14dc.js";import{_ as H,a as J}from"./aTable.0ed71fc6.js";import{_ as W}from"./projectsTab.caf12251.js";import"./_commonjsHelpers.dfee5925.js";import"./localForage.83b50c47.js";import"./index.7dbe61ef.js";import"./i18n.3d69f992.js";import"./api.14a19609.js";import"./QSelect.02464590.js";import"./QChip.bee081d7.js";import"./QMenu.b5435217.js";import"./position-engine.901fa583.js";import"./selection.445971ab.js";import"./rtl.a367ced8.js";import"./QTable.34b4b377.js";import"./QList.dade0d45.js";import"./QMarkupTable.6709601e.js";import"./use-fullscreen.57b102bc.js";import"./QBadge.58e5f8ba.js";import"./QRouteTab.81b0e7cb.js";import"./QTabs.b09ba654.js";import"./QResizeObserver.cd0d3c43.js";const Z={class:"q-pa-md"},ee={class:"row items-center"},te={class:"col-12 col-md-6 q-px-sm"},ae={class:"col-12 col-md-4 q-px-sm"},oe={class:"col-12 col-md-5 q-px-sm"},Ie={__name:"index",setup(le){const n=K(),S=$(),g=X(),{fetchProjects:w,fetchAllProjects:x}=g,{getProjects:q,getSelectedOffice:r,getLoadingState:Q}=O(g),i=c(r.value?r.value[8]:null),p=c("Projects"),R=c("projects"),f=c(""),V=c({sortBy:"13",descending:!1,rowsPerPage:150});i.value?w({selectedId:i.value}):x({can:"read"}),N(r,()=>{i.value=r.value?r.value[8]:null,i.value?w({selectedId:i.value}):x({can:"read"})});const k=c(new Date),B=setInterval(()=>{k.value=new Date},1e3);Y(()=>{clearInterval(B)});const I=_(()=>["id","name","avgDRO","openRequests","action",...r.value?[]:["office"]]),v=_(()=>[{name:"id",align:"left",label:"ID",field:"3",sortable:!1},{name:"name",align:"left",label:"Name",field:"298",sortable:!0},{name:"office",align:"center",label:"Office",field:"76",sortable:!1},{name:"avgDRO",align:"center",label:"AVG DRO",field:"208",sortable:!0},{name:"openRequests",align:"center",label:"Open Request",field:"31",sortable:!0},{name:"action",align:"center",label:"",sortable:!1}]),u=_(()=>q.value(i.value).filter(l=>!0).sort((l,s)=>l[298].localeCompare(s[298]))),P=l=>{S.push({name:"project",params:{id:l[3]}})},h=(l,s,t)=>{let e=s!==void 0?s(l,t):l;return e=e==null?"":String(e),e=e.split('"').join('""'),`"${e}"`},j=()=>{const l=[v.value.map(t=>h(t.label))].concat(u.value.map(t=>v.value.map(e=>h(typeof e.field=="function"?e.field(t):t[e.field===void 0?e.name:e.field],e.format,t)).join(","))).join(`\r
`);L(`${p.value} ${F().format("MM.DD.YYYY")}.csv`,l,"text/csv")!==!0&&n.notify({message:"Browser denied file download...",color:"negative",icon:"warning"})};return(l,s)=>(z(),A("div",Z,[a(W),a(E,{flat:"",class:"q-pt-none"},{default:m(()=>[a(T,null,{default:m(()=>[d("div",ee,[d("div",te,[d("div",{class:b(["text-dark",o(n).screen.lt.md?"text-body1":"text-h5"])},D(p.value),3)]),a(C),d("div",ae,[a(H,{can:"read",styleSelection:!0})])])]),_:1})]),_:1}),a(J,{rows:o(u),columns:o(v),pagination:V.value,filter:f.value,title:p.value,separator:"vertical","row-key":"3",loading:o(Q)(R.value),"visible-columns":o(I),downloadButton:!0,onDownload:j},{top:m(()=>[d("div",oe,[a(M,{dense:o(n).screen.lt.md,modelValue:f.value,"onUpdate:modelValue":s[0]||(s[0]=t=>f.value=t),label:"Search...",clearable:""},{prepend:m(()=>[a(U,{name:"search"})]),_:1},8,["dense","modelValue"])]),a(C),d("div",{class:b(["text-dark text-caption text-italic",o(n).screen.lt.md?"offset-xs-5":""])},"(Total: "+D(o(u).length)+")",3),a(y,{dense:o(n).screen.lt.md,class:b(["q-ml-sm",o(n).screen.lt.md?"full-width":""]),color:"primary",label:"Download",disable:o(u).length<1,onClick:j},null,8,["dense","class","disable"])]),"body-cell-action":m(t=>[a(G,{props:t},{default:m(()=>[a(y,{color:"primary",label:"View Project",onClick:e=>P(t.row),size:".75rem"},null,8,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","columns","pagination","filter","title","loading","visible-columns"])]))}};export{Ie as default};
