import{Q as w}from"./QTd.1c77bd82.js";import{l as E,r as k,w as Q,_ as C,A as d,B as u,d as r,br as n,ax as v,bW as y,ar as p,c as S,y as T,b5 as A,aq as R,D as q,bQ as I,ac as z}from"./index.4dac2c6e.js";import{Q as B}from"./QTable.6768f1a9.js";import{u as N}from"./use-quasar.5f82aae6.js";import{dayjs as b}from"./dayjs.1133dfcf.js";import{Q as V}from"./QSpinnerGears.b6965776.js";import{Q as g}from"./QTooltip.6b0ca88a.js";import{i as L,q as $}from"./app.dc1ff75d.js";import{u as _}from"./useQuerySaver.d29ff9ee.js";import{u as G}from"./dataStore.154eba0b.js";const P=E({emits:["viewEmployee"],props:{data:Object,type:String,query:String},setup(t){const i=N(),{getEmployee:c,setEmployees:m}=G(),l=k(null),f=k(!0);async function s(){if(t.data[39]&&t.data[39]!==""){if(c(t.data[39]))l.value=c([t.data[39]]);else{const{data:a}=await $.fetchFromHiringApp({fields:[_({type:t.type,query:`{'3'.EX.'${t.data[39]}'}`})]});l.value=a[0],m({id:l.value[3],data:l.value})}f.value=!1}else{const{data:a}=await $.fetchFromHiringApp({fields:[_({type:t.type,query:t.query})]});f.value=!1,a.length>0&&(a.length===1?l.value=a[0]:l.value=a.find(e=>e[24].toLowerCase().includes(t.data.firstName)||e[24].toLowerCase().includes(t.data.lastName)?e:null)),l.value&&($.upsertRecordsXML({to:"bsg4yb4wa",data:[{3:{value:t.data[3]},39:{value:l.value[3]}}],fieldsToReturn:[3]}),m({id:l.value[3],data:l.value}))}}Q(l,async a=>{if(a&&a[408]==="Active"&&a[378]&&a[378]!==""&&!a[207]){let e;if(!b(a[573]).isValid()||!b(a[573].$d).isSameOrAfter(b().subtract(2,"day"))){const D={employeeRID:a[3],nationalId:a[566],idType:a[565]},h=await L.updateQuickbaseWorkerInterface(D);h[0].Status!=="N/A"?(e=h[0],l.value[378]=e.workerId,l.value[438]=e.Status):e=null}}});const o=()=>{i.notify({type:"negative",message:"This feature is not ready yet."})};return s(),{record:l,loading:f,viewEmployee:o}}}),X={key:0},Y={key:1},F={key:0},H={key:1},M={key:2},W={key:3};function j(t,i,c,m,l,f){return d(),u("div",null,[t.loading?(d(),u("div",X,[r(V,{size:"2em",color:"info"})])):(d(),u("div",Y,[t.record&&(t.record[408]===""||t.record[408]==="Terminated")&&t.record[421]?(d(),u("div",F,[r(y,{class:"table-button",size:"xs",color:"positive",label:"Available",onClick:i[0]||(i[0]=s=>t.$emit("viewEmployee",t.record))},{default:n(()=>[r(g,{anchor:"center left",self:"center end",class:"bg-positive"},{default:n(()=>[v("Click to view this employee.")]),_:1})]),_:1})])):p("",!0),t.record&&t.record[408]==="Terminated"&&!t.record[421]?(d(),u("div",H,[r(y,{class:"table-button",size:"xs",color:"negative",label:"Not Eligible",onClick:i[1]||(i[1]=s=>t.$emit("viewEmployee",t.record))},{default:n(()=>[r(g,{anchor:"center left",self:"center end",class:"bg-negative"},{default:n(()=>[v("Click to view this employee.")]),_:1})]),_:1})])):p("",!0),t.record&&t.record[408]==="Active"?(d(),u("div",M,[r(y,{class:"table-button",size:"xs",color:"accent",label:"Active Employee",onClick:i[2]||(i[2]=s=>t.$emit("viewEmployee",t.record))},{default:n(()=>[r(g,{anchor:"center left",self:"center end",class:"bg-accent"},{default:n(()=>[v("Click to view this employee.")]),_:1})]),_:1})])):p("",!0),t.record?p("",!0):(d(),u("div",W,[r(y,{class:"table-button",disable:"",size:"xs",color:"info",label:"Nothing Found"},{default:n(()=>[r(g,{anchor:"center left",self:"center end",class:"bg-info"},{default:n(()=>[v("No employee to view.")]),_:1})]),_:1})]))]))])}var J=C(P,[["render",j],["__scopeId","data-v-201b428a"]]);const O=E({emits:["refreshData","viewEmployee"],props:{requests:Array,status:String,loading:Boolean},components:{GetEmployee:J},setup(t,{emit:i}){const c=N(),{capitalize:m}=T,l=S(()=>c.screen.gt.sm?[{name:0,label:"",align:"left",field:""},{name:1,label:"Request ID",align:"left",field:e=>e[18],format:e=>`${e}`,sortable:!1,required:!0},{name:2,label:"Created",align:"left",field:e=>e[1],format:e=>`${o(e)}`,sortable:!0},{name:3,label:"Name",align:"left",field:e=>f(e),format:e=>`${e}`,sortable:!0},{name:4,label:"Phone",align:"left",field:e=>e[8],format:e=>`${e}`,sortable:!1,required:!0},{name:7,label:"Job",align:"left",field:e=>e[24],format:e=>`${e}`},{name:5,label:"Status",align:"left",field:e=>s(e),format:e=>`${e}`},{name:6,label:"",align:"center",field:""}]:[{name:0,label:"",align:"left",field:""},{name:1,label:"Request ID",align:"left",field:e=>e[18],format:e=>`${e}`,sortable:!1,required:!0},{name:2,label:"Created",align:"left",field:e=>e[1],format:e=>`${o(e)}`,sortable:!0},{name:3,label:"Name",align:"left",field:e=>f(e),format:e=>`${e}`,sortable:!0},{name:4,label:"Phone",align:"left",field:e=>e[8],format:e=>`${e}`,sortable:!1,required:!0},{name:7,label:"Job",align:"left",field:e=>e[24],format:e=>`${e}`},{name:5,label:"Status",align:"left",field:e=>s(e),format:e=>`${e}`},{name:6,label:"",align:"center",field:""}]);function f(e){return`${m(e[6].toLowerCase())} ${m(e[7].toLowerCase())}`}function s(e){return e.employee[0]===void 0?e[10]:e.employee[0][408]==="Terminated"&&!e.employee[0][421]?"Not Eligible":e.employee[0][552]===""?e[10]:e.employee[0][552]}function o(e){if(e.$d)return b(e.$d).fromNow();if(e.date)return b(e.date,"MM-DD-YYYY").fromNow()}return{columns:l,props:t,viewEmployee:e=>{i("viewEmployee",e)}}}}),K={class:"full-width row flex-center text-primary q-gutter-sm q-py-md"};function U(t,i,c,m,l,f){const s=A("get-employee");return d(),u("div",null,[r(B,{columns:t.columns,rows:t.requests,"row-key":o=>o[3],class:"q-pa-sm",pagination:{rowsPerPage:10},"table-header-class":"bg-dark text-white","no-data-label":"There are no named requests",dense:"",loading:t.loading},{"header-cell-0":n(()=>[r(w,{"auto-width":""})]),"body-cell-0":n(o=>[r(w,{class:"text-center","auto-width":""},{default:n(()=>[r(s,{data:o.row,onViewEmployee:t.viewEmployee,type:"employee",query:`{'27'.EX.'${o.row[29]}'}AND{'551'.EX.'${o.row[16]}'}`},null,8,["data","onViewEmployee","query"])]),_:2},1024)]),"body-cell-6":n(o=>[r(w,{class:"text-center","auto-width":""},{default:n(()=>[o.row[31]==="Closed"||o.row[31]==="Cancelled"?p("",!0):(d(),R(y,{key:0,class:"q-pa-none q-ma-none",flat:"",color:"primary",round:"",dense:"",onClick:a=>t.$emit("removeName",o.row),icon:"delete_forever"},null,8,["onClick"]))]),_:2},1024)]),"no-data":n(({message:o})=>[q("div",K,[r(I,{size:"2em",name:"fa-solid fa-person-circle-exclamation"}),q("span",null,z(o),1)])]),"top-right":n(()=>[r(y,{color:"secondary",flat:"","icon-right":"refresh",label:"Refresh",onClick:i[0]||(i[0]=o=>t.$emit("refreshData"))})]),_:1},8,["columns","rows","row-key","loading"])])}var se=C(O,[["render",U]]);export{se as N};
