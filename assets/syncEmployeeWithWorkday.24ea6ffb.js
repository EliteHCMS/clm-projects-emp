import{q as n}from"./quickbase.7e9e049d.js";import{dayjs as s}from"./dayjs.238de433.js";import{a as o}from"./dataStore.d626384f.js";import{workday as y}from"./workday.a92fdc5b.js";import"./workdayAPI.d9e90557.js";const v=async({clm:e})=>{if(e[207]){const{data:a}=await n.fetchFromHiringApp({fields:[o({type:"workdaySync",query:"",id:e[578]})]});return{clm:e,sync:a}}else if(e[576]&&e[576].$d&&s(e[576].$d).isSameOrAfter(s().subtract(s.duration({days:5})),"day")){const{data:a}=await n.fetchFromHiringApp({fields:[o({type:"workdaySync",query:"",id:e[578]})]});return await d({wd:a,clm:e})}else{let a={};if(e[378]!==""?a.workerId=e[378]:e[188].length===9?a.ssn=e[188]:a=null,a&&!e[207]&&!e[509]){const{data:r}=await y.getWorker(a);let i;if(r.length>0?i=r[0]:i=null,i){const t=i,u=[{6:{value:e[3]},8:{value:t.workerName},9:{value:t.nationalId},10:{value:t.userId},11:{value:t.workerId},12:{value:JSON.stringify(t.employmentData)},14:{value:JSON.stringify(t.personalData)},16:{value:JSON.stringify(t.workerReference)},17:{value:`${JSON.stringify(t.managementChainData)}`},18:{value:`${JSON.stringify(t.organizations)}`},19:{value:t.applicantReference?JSON.stringify(t.applicantReference):""}}],{data:f}=await n.upsertRecordsXML({to:"bspfhy84a",data:u,fieldsToReturn:[7],formatObject:7});return await d({wd:f[0][7],clm:e})}}}},d=async({wd:e,clm:a})=>{const{data:r}=await n.upsertRecordsXML({to:"bp3gb7ng2",data:[{3:{value:a[3]},568:{value:s()}}],fieldsToReturn:[549],formatObject:549});return{clm:r[0][549],sync:e}};export{v as a,d as s};
