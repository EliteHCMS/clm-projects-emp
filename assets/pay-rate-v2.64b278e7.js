var P=Object.defineProperty,E=Object.defineProperties;var N=Object.getOwnPropertyDescriptors;var f=Object.getOwnPropertySymbols;var b=Object.prototype.hasOwnProperty,C=Object.prototype.propertyIsEnumerable;var p=(e,a,t)=>a in e?P(e,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[a]=t,h=(e,a)=>{for(var t in a||(a={}))b.call(a,t)&&p(e,t,a[t]);if(f)for(var t of f(a))C.call(a,t)&&p(e,t,a[t]);return e},v=(e,a)=>E(e,N(a));import{u as m,q as d}from"./quickbase.ce7d8f68.js";import{dayjs as y}from"./dayjs.da6fbf87.js";import{l as $,_ as D,A as g,an as _,bi as q,B as M,d as k,bI as O,ao as B,D as L,ab as S,H as T,cx as U}from"./index.8856b4a9.js";const J=async({data:e})=>{const{project:a,general:t,classifications:n,names:s,matches:r}=e;if(r)return{data:await V({data:e})};try{return{data:await z({data:e})}}catch(c){throw console.log(c),{message:"There was a problem submitting the hire request"}}},V=async({data:e})=>{const{matches:a,classifications:t,names:n}=e,s=a,r=t.filter(o=>o.match),c=t.filter(o=>!o.match);r.forEach(o=>{o.names=n.filter(l=>l.job.id===o.id)}),c.forEach(o=>{o.names=n.filter(l=>l.job.id===o.id)});const i=[];c.forEach(o=>{const l=w({requestData:s,job:o});i.push(l)}),r.forEach(o=>{const l=Q({job:o});i.push(l)});const u=await Promise.allSettled(i);return s.classes=u.map(o=>o.value),s},z=async({data:e})=>{const{project:a,general:t,classifications:n,names:s}=e,{userData:r}=m();n.forEach(u=>{u.names=s.filter(o=>o.job.id===u.id)});const c={64:{value:t.dateNeeded},282:{value:t.restriction.value},284:{value:t.reason.value},31:{value:t.meetingLocation[3]},9:{value:t.jobNumber[3]},60:{value:t.siteContact[3]},92:{value:a[12]},6:{value:a[3]},272:{value:r[3]},281:{value:r[32]==="Project User"},14:{value:r[32]==="Project User"?"Pending":"Open"},147:{value:r[32]==="Project User"?2:3},82:{value:y()},68:{value:t.perDiem?"Yes":"No"}};return await X({fields:c,classifications:n})},X=async({fields:e,classifications:a})=>{const{data:t}=await d.upsertRecordsXML({to:"bpzpyjbuy",data:[e],fieldsToReturn:[289],formatObject:289});if(!t[0])throw{message:"Error adding request!"};const n=t[0][289],s=[];a.forEach(c=>{const i=w({requestData:n,job:c});s.push(i)});const r=await Promise.allSettled(s);return n.classes=r.map(c=>c.value),n},Q=async({job:e})=>{let a=0;a=e.match[18]+e.qty,a=a>e.names.length?a:e.names.length;const t={3:{value:e.match[3]},18:{value:a}},{data:n}=await d.upsertRecordsXML({to:"bpzpyqcu4",data:[t],fieldsToReturn:[250],formatObject:250});if(!n[0])throw{message:"Error updating classification!"};const s=n[0][250];if(e.names&&e.names.length>0){const r=[];e.names.forEach(i=>{const u=R({classificationData:s,name:i});r.push(u)});const c=await Promise.allSettled(r);return s.names=c.map(i=>i.value),s}else return s},w=async({requestData:e,job:a})=>{const{userData:t}=m(),n=v(h({6:{value:e[3]},9:{value:a.classification[3]},17:{value:t[32]==="Project User"?"Pending":"Open"}},t[32]==="QuickBase User"&&{128:{value:3}}),{18:{value:a.qty},23:{value:a.rate},238:{value:a.id}}),{data:s}=await d.upsertRecordsXML({to:"bpzpyqcu4",data:[n],fieldsToReturn:[250],formatObject:250});if(!s[0])throw{message:"Error adding classification!"};const r=s[0][250];if(a.names&&a.names.length>0){const c=[];a.names.forEach(u=>{const o=R({classificationData:r,name:u});c.push(o)});const i=await Promise.allSettled(c);return r.names=i.map(u=>u.value),r}else return r},R=async({classificationData:e,name:a})=>{const{userData:t}=m(),n={6:{value:a.firstName},7:{value:a.lastName},8:{value:a.phoneNumber},19:{value:y()},16:{value:a.ssn},10:{value:"Has Not Arrived"},14:{value:`${t[35]} ${t[37]}`},17:{value:e[3]}},{data:s}=await d.upsertRecordsXML({to:"bsg4yb4wa",data:[n],fieldsToReturn:[40],formatObject:40});if(!s[0])throw{message:"Error adding name!"};return s[0][40]},K=async({job:e,matches:a})=>{const{classification:t,rate:n}=e,s=e.match?null:a.classes.find(r=>r[9]===t[3]&&r[23]===n);return s&&(e.match=s),e},W=async({id:e,qty:a})=>{const t={3:{value:e},18:{value:a}},{data:n}=await d.upsertRecordsXML({to:"bpzpyqcu4",data:[t],fieldsToReturn:[220],formatObject:220});return n[0][220]},j=$({name:"PayRateV2"}),x={key:0,class:"text-right"},H={class:"text-caption"};function I(e,a,t,n,s,r){return g(),_(U,T(e.$attrs,{"bottom-slots":""}),{append:q(()=>[e.$attrs.job&&e.$attrs.job.hasFixedRate&&!e.$can("manage","rates")?(g(),M("div",x,[k(O,{name:"lock",size:"sm"})])):B("",!0)]),error:q(()=>[L("div",H,S(e.$attrs.errorMessage),1)]),_:1},16)}var Z=D(j,[["render",I]]);export{Z as P,w as c,K as f,J as n,W as u};
