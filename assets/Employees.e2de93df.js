import{Q as R}from"./QPage.6ad619dd.js";import{Q as k,a as V,b as W}from"./QTabPanels.f9656363.js";import{Q as H}from"./QBadge.58e5f8ba.js";import{Q as X}from"./QTabs.b09ba654.js";import{Q as G}from"./QToolbar.35802955.js";import{k as K,c1 as N,r as b,c as w,_ as x,z as q,A as Z,C as m,d as l,bh as i,am as O,at as ee,aa as g,an as ae,c3 as te,c2 as oe,cx as T,c6 as j,bX as E,v as le,aY as se}from"./index.52c71ca6.js";import{a as re}from"./QSelect.02464590.js";import{Q as M}from"./QTable.34b4b377.js";import{u as ne}from"./use-quasar.8076b8cd.js";import{O as P,b as S,J as F}from"./quickbase.0d6b62e6.js";import{e as B}from"./export-file.6b95af49.js";import{dayjs as p}from"./dayjs.7e2f14dc.js";import"./use-panel.7eae50bb.js";import"./touch.52aa58ff.js";import"./selection.445971ab.js";import"./QResizeObserver.cd0d3c43.js";import"./rtl.a367ced8.js";import"./QChip.bee081d7.js";import"./QMenu.b5435217.js";import"./position-engine.901fa583.js";import"./QList.dade0d45.js";import"./QMarkupTable.6709601e.js";import"./use-fullscreen.57b102bc.js";import"./_commonjsHelpers.dfee5925.js";import"./localForage.83b50c47.js";import"./index.7dbe61ef.js";import"./i18n.3d69f992.js";import"./api.14a19609.js";const{capitalize:$}=le,C=e=>{const o=e[20]!==""?$(e[20].toLowerCase().trim()):"",f=e[22]!==""?$(e[22].toLowerCase().trim()):"",d=e[21]!==""?` ${$(e[21].toLowerCase().trim())}`:"",u=e[23]!==""?` ${$(e[23])}`:"";return`${f}${u}, ${o}${d}`},y=[{name:1,label:"Name",align:"left",field:e=>e.employee[22],format:(e,o)=>`${C(o.employee)}`,sortable:!0,sortOrder:"ad"},{name:7,label:"Workday ID",align:"left",field:e=>e.employee[378],format:e=>`${e}`,sortable:!0,sortOrder:"ad"},{name:2,label:"Payroll ID",align:"left",field:e=>e.employee[213],format:e=>e===""?"not available":e,sortable:!0},{name:4,label:"Classification",align:"left",field:e=>e.map.fullJob,format:e=>`${!e||e===""?"Not Assigned":e}`,sortable:!0},{name:5,label:"Job #",align:"left",field:e=>e.map.jobNumber,format:e=>`${e===""||!e?"Not Assigned":e}`,sortable:!0},{name:6,label:"Arrival Date",align:"left",field:e=>e.map.start,format:e=>`${e?F.formatDate(e,"MM/DD/YYYY"):"TBD"}`,sortable:!0}],ie=[{name:1,label:"Name",align:"left",field:e=>e.employee[22],format:(e,o)=>`${C(o.employee)}`,sortable:!0},{name:7,label:"Workday ID",align:"left",field:e=>e.employee[378],format:e=>`${e}`,sortable:!0,sortOrder:"ad"},{name:2,label:"Payroll ID",align:"left",field:e=>e.employee[213],format:e=>e===""?"not available":e,sortable:!0},{name:4,label:"Classification",align:"left",field:e=>e.map.fullJob,format:e=>`${!e||e===""?"Not Assigned":e}`,sortable:!0},{name:5,label:"Job #",align:"left",field:e=>e.map.jobNumber,format:e=>`${e===""||!e?"Not Assigned":e}`,sortable:!0},{name:6,label:"Arrival Date",align:"left",field:e=>e.map.start,format:e=>`${e?F.formatDate(e,"MM/DD/YYYY"):"TBD"}`,sortable:!0}],me=K({name:"Table",components:{},setup(){const e=ne(),o=P(),f=S(),{assignmentsForProject:d}=N(o),u=d,{active:c}=N(S()),{getAssignments:r,checkDisa:I}=P(),Y=b(""),h=b(null),D=b(null),L=b(0),_=b(!1);r();const A=w(()=>{let a=[];return u.value.forEach(s=>{s[75].toLowerCase().includes(Y.value.toLowerCase())&&a.push(s)}),a=h.value?a.filter(s=>p(s[1].$d).tz("America/Chicago").format("MM/DD/YYYY")===p(h.value).tz("America/Chicago").format("MM/DD/YYYY")):a,a=D.value?a.filter(s=>s[68]===D.value):a,a.sort((s,n)=>s.employee[22]>n.employee[22]?1:-1)}),z=w(()=>e.screen.lt.md?100:25),J=w(()=>[...new Map(d.value.map(a=>[a[68],a[68]])).values()]),Q=w(()=>{const a=p().subtract(14,"day");return d.value.filter(s=>p(s[1].$d).isSameOrAfter(a)&&p(s[1].$d).isSameOrBefore(p())).sort((s,n)=>s.employee[22]>n.employee[22]?1:-1)});function v(a,s,n){let t=s!==void 0?s(a,n):a;return t=t==null?"":String(t),t=t.split('"').join('""'),`"${t}"`}console.log(d.value.filter(a=>!a[112]));async function U(){const a=await I({project:c.value,roster:A.value});console.log(a)}return{columns:y,mobileColumns:ie,rows:A,initialPagination:{rowsPerPage:z},separator:"vertical",projectStore:f,active:c,search:Y,startDateFilter:h,craftOptions:J,craftFilter:D,assignmentsForProject:d,tab:L,newArrivals:Q,showEmployee:_,formatName:C,exportNewArrivals(){const a=[y.map(n=>v(n.label))].concat(Q.value.map(n=>y.map(t=>v(typeof t.field=="function"?t.field(n):n[t.field===void 0?t.name:t.field],t.format,n)).join(","))).join(`\r
`);B(`${p().format("MM.DD.YYYY")} ${c.value[20]} New-Arrivals-Export.csv`,a,"text/csv")!==!0&&e.notify({message:"Browser denied file download...",color:"negative",icon:"warning"})},exportAllEmployees(){const a=[y.map(n=>v(n.label))].concat(A.value.map(n=>y.map(t=>v(typeof t.field=="function"?t.field(n):n[t.field===void 0?t.name:t.field],t.format,n)).join(","))).join(`\r
`);B(`${p().format("MM.DD.YYYY")} ${c.value[20]} All-Employees-Export.csv`,a,"text/csv")!==!0&&e.notify({message:"Browser denied file download...",color:"negative",icon:"warning"})},checkDisaStatus:U}}}),de={class:"q-px-sm"},pe={class:"row items-center"},ce={class:"col-12 col-md-4 q-px-sm"},fe={class:"col-12 col-md-4 q-px-sm"},ue={class:"col-12 col-md-4 q-px-sm"},be={class:"text-dark text-caption text-italic"},ge={class:"full-width row flex-center text-primary q-gutter-sm q-py-md"},ye={class:"text-dark text-caption text-italic"},ve={class:"full-width row flex-center text-primary q-gutter-sm q-py-md"};function we(e,o,f,d,u,c){return q(),Z("div",de,[m("div",null,[m("div",null,[l(G,{class:"bg-info text-white shadow-2 rounded-borders"},{default:i(()=>[l(X,{modelValue:e.tab,"onUpdate:modelValue":o[0]||(o[0]=r=>e.tab=r),"bg-color":"none","indicator-color":"accent",align:"justify",dense:""},{default:i(()=>[l(k,{name:0,label:e.$q.screen.gt.xs?"All Employees":"Employees"},null,8,["label"]),l(k,{name:1,label:"New Arrivals"},{default:i(()=>[e.newArrivals.length>0?(q(),O(H,{key:0,color:"accent",floating:"",transparent:""},{default:i(()=>[ee(g(e.newArrivals.length),1)]),_:1})):ae("",!0)]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(W,{modelValue:e.tab,"onUpdate:modelValue":o[4]||(o[4]=r=>e.tab=r),animated:""},{default:i(()=>[l(V,{class:"q-px-xs",name:0},{default:i(()=>[l(te,{flat:""},{default:i(()=>[l(oe,{class:"q-pt-none"},{default:i(()=>[m("div",pe,[m("div",ce,[l(T,{dense:"",modelValue:e.search,"onUpdate:modelValue":o[1]||(o[1]=r=>e.search=r),label:"Search"},null,8,["modelValue"])]),m("div",fe,[l(T,{dense:"",modelValue:e.startDateFilter,"onUpdate:modelValue":o[2]||(o[2]=r=>e.startDateFilter=r),label:"Arrival Date",type:"date","stack-label":""},null,8,["modelValue"])]),m("div",ue,[l(re,{dense:"",label:"Craft","transition-show":"flip-up","transition-hide":"flip-down",modelValue:e.craftFilter,"onUpdate:modelValue":o[3]||(o[3]=r=>e.craftFilter=r),options:e.craftOptions,"use-chips":""},null,8,["modelValue","options"])])])]),_:1})]),_:1}),l(M,{"title-class":e.$q.screen.gt.sm?"text-primary text-h6":"text-primary text-body1",title:e.$q.screen.lt.sm?"Employees":`Employees for ${e.active[20]}`,columns:e.$q.screen.lt.md?e.mobileColumns:e.columns,rows:e.rows,"row-key":"3",class:"q-pa-sm",pagination:e.initialPagination,separator:"vertical","table-header-class":"bg-dark text-white","no-data-label":`There are no employees for ${e.active[20]}`,grid:e.$q.screen.lt.sm},{"top-right":i(()=>[m("div",be,"(Total: "+g(e.rows.length)+" employees)",1),l(j,{dense:e.$q.screen.lt.md,class:"q-ml-sm",color:"primary",label:"Download",onClick:e.exportAllEmployees,disable:e.rows.length<1},null,8,["dense","onClick","disable"])]),"no-data":i(({message:r})=>[m("div",ge,[l(E,{size:"2em",name:"fa-solid fa-person-circle-exclamation"}),m("span",null,g(r),1)])]),_:1},8,["title-class","title","columns","rows","pagination","no-data-label","grid"])]),_:1}),l(V,{class:"q-px-xs",name:1},{default:i(()=>[l(M,{"title-class":e.$q.screen.gt.sm?"text-primary text-h6":"text-primary text-body1",title:e.$q.screen.lt.sm?"Arrived Last 14 Days":`Arrived Last 14 Days at ${e.active[20]}`,columns:e.$q.screen.lt.md?e.mobileColumns:e.columns,rows:e.newArrivals,"row-key":"3",class:"q-pa-sm",pagination:e.initialPagination,separator:"vertical","table-header-class":"bg-dark text-white","no-data-label":`There are no employees for ${e.active[20]}`,grid:e.$q.screen.lt.sm},{"top-right":i(()=>[m("div",ye,"(Total: "+g(e.newArrivals.length)+" new arrivals)",1),l(j,{dense:e.$q.screen.lt.md,class:"q-ml-sm",color:"primary",label:"Download",onClick:e.exportNewArrivals,disable:e.newArrivals.length<1},null,8,["dense","onClick","disable"])]),"no-data":i(({message:r})=>[m("div",ve,[l(E,{size:"2em",name:"fa-solid fa-person-circle-exclamation"}),m("span",null,g(r),1)])]),_:1},8,["title-class","title","columns","rows","pagination","no-data-label","grid"])]),_:1})]),_:1},8,["modelValue"])])])])}var $e=x(me,[["render",we],["__scopeId","data-v-9cf7a88c"]]);const he={name:"Arrivals",components:{employeesTable:$e},setup(){return{}}};function De(e,o,f,d,u,c){const r=se("employees-table");return q(),O(R,{style:{"max-width":"100vw"}},{default:i(()=>[l(r)]),_:1})}var Ge=x(he,[["render",De]]);export{Ge as default};
