import{Q as J}from"./QPage.de043d3b.js";import{a as _,Q as V,b as k,c as R}from"./QTabPanels.aa084490.js";import{Q as W}from"./QBadge.43158829.js";import{Q as H}from"./QToolbar.1236ea00.js";import{k as X,c0 as N,r as b,c as w,_ as x,y as q,z as G,B as m,d as o,bg as i,al as F,as as K,a9 as g,am as Z,c2 as ee,c1 as ae,cA as T,c5 as M,bW as E,d4 as te,aX as le}from"./index.b3e75908.js";import{a as oe}from"./QSelect.f41b057f.js";import{Q as P}from"./QTable.798085b6.js";import{u as se}from"./use-quasar.0709ee11.js";import{m as j,b as B,f as I}from"./quickbase.002c2695.js";import{e as S}from"./export-file.deb9806e.js";import{dayjs as p}from"./dayjs.d2fb0443.js";import"./QResizeObserver.cb43d377.js";import"./rtl.65b79c69.js";import"./use-panel.acfa707c.js";import"./touch.d8ab472d.js";import"./selection.f696f409.js";import"./QMenu.c7af2595.js";import"./position-engine.dc1fa88b.js";import"./QList.54b3498e.js";import"./QMarkupTable.f25c18f2.js";import"./use-fullscreen.7a786134.js";import"./_commonjsHelpers.dfee5925.js";import"./localForage.69471374.js";import"./index.7dbe61ef.js";import"./i18n.6357316e.js";import"./api.4d9372cc.js";const{capitalize:$}=te,A=e=>{const l=e[20]!==""?$(e[20]):"",f=e[22]!==""?$(e[22]):"",d=e[21]!==""?` ${$(e[21])}`:"",c=e[23]!==""?` ${$(e[23])}`:"";return`${f}${c}, ${l}${d}`},y=[{name:1,label:"Name",align:"left",field:e=>e.employee[22],format:(e,l)=>`${A(l.employee)}`,sortable:!0,sortOrder:"ad"},{name:7,label:"Workday ID",align:"left",field:e=>e.employee[378],format:e=>`${e}`,sortable:!0,sortOrder:"ad"},{name:2,label:"Payroll ID",align:"left",field:e=>e.employee[213],format:e=>e===""?"not available":e,sortable:!0},{name:4,label:"Classification",align:"left",field:e=>e.map.fullJob,format:e=>`${!e||e===""?"Not Assigned":e}`,sortable:!0},{name:5,label:"Job #",align:"left",field:e=>e.map.jobNumber,format:e=>`${e===""||!e?"Not Assigned":e}`,sortable:!0},{name:6,label:"Arrival Date",align:"left",field:e=>e.map.start,format:e=>`${e?I.formatDate(e,"MM/DD/YYYY"):"TBD"}`,sortable:!0}],re=[{name:1,label:"Name",align:"left",field:e=>e.employee[22],format:(e,l)=>`${A(l.employee)}`,sortable:!0},{name:7,label:"Workday ID",align:"left",field:e=>e.employee[378],format:e=>`${e}`,sortable:!0,sortOrder:"ad"},{name:2,label:"Payroll ID",align:"left",field:e=>e.employee[213],format:e=>e===""?"not available":e,sortable:!0},{name:4,label:"Classification",align:"left",field:e=>e.map.fullJob,format:e=>`${!e||e===""?"Not Assigned":e}`,sortable:!0},{name:5,label:"Job #",align:"left",field:e=>e.map.jobNumber,format:e=>`${e===""||!e?"Not Assigned":e}`,sortable:!0},{name:6,label:"Arrival Date",align:"left",field:e=>e.map.start,format:e=>`${e?I.formatDate(e,"MM/DD/YYYY"):"TBD"}`,sortable:!0}],ne=X({name:"Table",components:{},setup(){const e=se(),l=j(),f=B(),{assignmentsForProject:d}=N(l),c=d,{active:u}=N(B()),{getAssignments:r}=j(),Y=b(""),h=b(null),D=b(null),O=b(0),z=b(!1);r();const C=w(()=>{let t=[];return c.value.forEach(s=>{s[75].toLowerCase().includes(Y.value.toLowerCase())&&t.push(s)}),t=h.value?t.filter(s=>p(s[1].$d).tz("America/Chicago").format("MM/DD/YYYY")===p(h.value).tz("America/Chicago").format("MM/DD/YYYY")):t,t=D.value?t.filter(s=>s[68]===D.value):t,t.sort((s,n)=>s.employee[22]>n.employee[22]?1:-1)}),L=w(()=>e.screen.lt.md?100:25),U=w(()=>[...new Map(d.value.map(t=>[t[68],t[68]])).values()]),Q=w(()=>{const t=p().subtract(14,"day");return d.value.filter(s=>p(s[1].$d).isSameOrAfter(t)&&p(s[1].$d).isSameOrBefore(p())).sort((s,n)=>s.employee[22]>n.employee[22]?1:-1)});function v(t,s,n){let a=s!==void 0?s(t,n):t;return a=a==null?"":String(a),a=a.split('"').join('""'),`"${a}"`}return{columns:y,mobileColumns:re,rows:C,initialPagination:{rowsPerPage:L},separator:"vertical",projectStore:f,active:u,search:Y,startDateFilter:h,craftOptions:U,craftFilter:D,assignmentsForProject:d,tab:O,newArrivals:Q,showEmployee:z,formatName:A,exportNewArrivals(){const t=[y.map(n=>v(n.label))].concat(Q.value.map(n=>y.map(a=>v(typeof a.field=="function"?a.field(n):n[a.field===void 0?a.name:a.field],a.format,n)).join(","))).join(`\r
`);S(`${p().format("MM.DD.YYYY")} ${u.value[20]} New-Arrivals-Export.csv`,t,"text/csv")!==!0&&e.notify({message:"Browser denied file download...",color:"negative",icon:"warning"})},exportAllEmployees(){const t=[y.map(n=>v(n.label))].concat(C.value.map(n=>y.map(a=>v(typeof a.field=="function"?a.field(n):n[a.field===void 0?a.name:a.field],a.format,n)).join(","))).join(`\r
`);S(`${p().format("MM.DD.YYYY")} ${u.value[20]} All-Employees-Export.csv`,t,"text/csv")!==!0&&e.notify({message:"Browser denied file download...",color:"negative",icon:"warning"})}}}}),ie={class:"q-px-sm"},me={class:"row items-center"},de={class:"col-12 col-md-4 q-px-sm"},pe={class:"col-12 col-md-4 q-px-sm"},fe={class:"col-12 col-md-4 q-px-sm"},ce={class:"text-dark text-caption text-italic"},ue={class:"full-width row flex-center text-primary q-gutter-sm q-py-md"},be={class:"text-dark text-caption text-italic"},ge={class:"full-width row flex-center text-primary q-gutter-sm q-py-md"};function ye(e,l,f,d,c,u){return q(),G("div",ie,[m("div",null,[m("div",null,[o(H,{class:"bg-info text-white shadow-2 rounded-borders"},{default:i(()=>[o(_,{modelValue:e.tab,"onUpdate:modelValue":l[0]||(l[0]=r=>e.tab=r),"bg-color":"none","indicator-color":"accent",align:"justify",dense:""},{default:i(()=>[o(V,{name:0,label:e.$q.screen.gt.xs?"All Employees":"Employees"},null,8,["label"]),o(V,{name:1,label:"New Arrivals"},{default:i(()=>[e.newArrivals.length>0?(q(),F(W,{key:0,color:"accent",floating:"",transparent:""},{default:i(()=>[K(g(e.newArrivals.length),1)]),_:1})):Z("",!0)]),_:1})]),_:1},8,["modelValue"])]),_:1}),o(R,{modelValue:e.tab,"onUpdate:modelValue":l[4]||(l[4]=r=>e.tab=r),animated:""},{default:i(()=>[o(k,{class:"q-px-xs",name:0},{default:i(()=>[o(ee,{flat:""},{default:i(()=>[o(ae,{class:"q-pt-none"},{default:i(()=>[m("div",me,[m("div",de,[o(T,{dense:e.$q.screen.lt.md,modelValue:e.search,"onUpdate:modelValue":l[1]||(l[1]=r=>e.search=r),label:"Search"},null,8,["dense","modelValue"])]),m("div",pe,[o(T,{dense:e.$q.screen.lt.md,modelValue:e.startDateFilter,"onUpdate:modelValue":l[2]||(l[2]=r=>e.startDateFilter=r),label:"Arrival Date",type:"date","stack-label":""},null,8,["dense","modelValue"])]),m("div",fe,[o(oe,{dense:e.$q.screen.lt.md,label:"Craft","transition-show":"flip-up","transition-hide":"flip-down",modelValue:e.craftFilter,"onUpdate:modelValue":l[3]||(l[3]=r=>e.craftFilter=r),options:e.craftOptions,"use-chips":""},null,8,["dense","modelValue","options"])])])]),_:1})]),_:1}),o(P,{"title-class":e.$q.screen.gt.sm?"text-primary text-h6":"text-primary text-body1",title:e.$q.screen.lt.sm?"Employees":`Employees for ${e.active[20]}`,columns:e.$q.screen.lt.md?e.mobileColumns:e.columns,rows:e.rows,"row-key":"3",class:"q-pa-sm",pagination:e.initialPagination,separator:"vertical","table-header-class":"bg-dark text-white","no-data-label":`There are no employees for ${e.active[20]}`,grid:e.$q.screen.lt.sm},{"top-right":i(()=>[m("div",ce,"(Total: "+g(e.rows.length)+" employees)",1),o(M,{dense:e.$q.screen.lt.md,class:"q-ml-sm",color:"primary",label:"Download",onClick:e.exportAllEmployees,disable:e.rows.length<1},null,8,["dense","onClick","disable"])]),"no-data":i(({message:r})=>[m("div",ue,[o(E,{size:"2em",name:"fa-solid fa-person-circle-exclamation"}),m("span",null,g(r),1)])]),_:1},8,["title-class","title","columns","rows","pagination","no-data-label","grid"])]),_:1}),o(k,{class:"q-px-xs",name:1},{default:i(()=>[o(P,{"title-class":e.$q.screen.gt.sm?"text-primary text-h6":"text-primary text-body1",title:e.$q.screen.lt.sm?"Arrived Last 14 Days":`Arrived Last 14 Days at ${e.active[20]}`,columns:e.$q.screen.lt.md?e.mobileColumns:e.columns,rows:e.newArrivals,"row-key":"3",class:"q-pa-sm",pagination:e.initialPagination,separator:"vertical","table-header-class":"bg-dark text-white","no-data-label":`There are no employees for ${e.active[20]}`,grid:e.$q.screen.lt.sm},{"top-right":i(()=>[m("div",be,"(Total: "+g(e.newArrivals.length)+" new arrivals)",1),o(M,{dense:e.$q.screen.lt.md,class:"q-ml-sm",color:"primary",label:"Download",onClick:e.exportNewArrivals,disable:e.newArrivals.length<1},null,8,["dense","onClick","disable"])]),"no-data":i(({message:r})=>[m("div",ge,[o(E,{size:"2em",name:"fa-solid fa-person-circle-exclamation"}),m("span",null,g(r),1)])]),_:1},8,["title-class","title","columns","rows","pagination","no-data-label","grid"])]),_:1})]),_:1},8,["modelValue"])])])])}var ve=x(ne,[["render",ye],["__scopeId","data-v-3b3f7d1e"]]);const we={name:"Arrivals",components:{employeesTable:ve},setup(){return{}}};function $e(e,l,f,d,c,u){const r=le("employees-table");return q(),F(J,{style:{"max-width":"100vw"}},{default:i(()=>[o(r)]),_:1})}var Re=x(we,[["render",$e]]);export{Re as default};
