var ue=Object.defineProperty;var G=Object.getOwnPropertySymbols;var de=Object.prototype.hasOwnProperty,ce=Object.prototype.propertyIsEnumerable;var J=(l,s,t)=>s in l?ue(l,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[s]=t,L=(l,s)=>{for(var t in s||(s={}))de.call(s,t)&&J(l,t,s[t]);if(G)for(var t of G(s))ce.call(s,t)&&J(l,t,s[t]);return l};import{Q as me}from"./QImg.8e96434f.js";import{_ as pe,c5 as ve,c4 as ge,r as u,c as Q,w as b,aY as U,z as c,am as v,bh as r,A as z,d as o,an as m,C as q,c2 as w,aa as P,bE as fe,bD as he,cx as W,ar as ye,c6 as I,bX as j,D as be,cy as we,at as D,c3 as _e,aH as K}from"./index.6c674a19.js";import{Q as ke}from"./QForm.a836d91e.js";import{Q as xe}from"./QPage.80490d1d.js";import{u as Ce}from"./use-quasar.4e60ec94.js";import{c as T,u as F}from"./array.f00f2e61.js";import{p as qe}from"./VueTelInput.ecd4dc67.js";import{_ as Pe}from"./languageSelector.d691c4cb.js";import{c as Te}from"./carousel.8ead42aa.js";import{c as Me,q as $}from"./quickbase.c9a9fc75.js";import{u as Se}from"./i18n.8e2a8376.js";import"./QSelect.fdd46d88.js";import"./QChip.6c6d3173.js";import"./QMenu.b7fb2919.js";import"./position-engine.703db134.js";import"./selection.7761caf6.js";import"./rtl.a367ced8.js";import"./use-panel.fe019f7f.js";import"./touch.52aa58ff.js";import"./use-fullscreen.f7d9f446.js";import"./_commonjsHelpers.dfee5925.js";import"./dayjs.69e964e9.js";import"./localForage.7e70884e.js";import"./index.7dbe61ef.js";import"./api.51f82bf2.js";const Ee={name:"Login",components:{phoneNumberInput:qe,carousel:Te,languageSelector:Pe},setup(){const l=Ce(),s=ve(),t=ge(),{locale:e,t:_}=Se(),{currentUserType:k,currentPageType:V}=Me(),n=u(!1),i=u(!1),x=u(10),d=u(!1),C=u(null),M=u(!1),ee=u("first"),f=u("username"),H=u(null),A=u(null),S=u(!1),E=u(!1);s.query.redirect&&(A.value=s.query.redirect,t.replace({query:{}}));const ae=Q(()=>n.value?T().email(`${_("validEmailIsRequired")}`).nullable():T().email(`${_("validEmailIsRequired")}`).nullable()),le=Q(()=>{if(i.value)return T().nullable();{const a=new RegExp("^[0-9]{"+x.value+"}","g");return T().matches(a,{excludeEmptyString:!0,message:`${_("validPhoneIsRequired")}`}).nullable()}}),se=Q(()=>T().required().matches(/^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d@$!%*#?&]{8,}$/,{excludeEmptyString:!0,message:`${_("passwordRules")}`}).nullable()),{errorMessage:R,value:h}=F("email",ae),{errorMessage:B,value:g}=F("phone",le),{errorMessage:O,value:y}=F("password",se),oe=u(!0);b(R,a=>{a||h.value===""?i.value=!1:i.value=!0}),b(h,a=>{!a||a===""?i.value=!1:/^\w+([.-]?\w+)*@\w+([.-]?\w+)*(\.\w{2,3})+$/.test(a)&&!R.value&&(i.value=!0)}),b(B,a=>{a||g.value===""?n.value=!1:n.value=!0}),b(g,a=>{!a||a===""?n.value=!1:a.length===x.value&&!B.value&&(n.value=!0)}),b(O,a=>{a||y.value===""?d.value=!1:d.value=!0}),b(y,a=>{M.value=!1,(!a||a==="")&&(d.value=!1)});const te=a=>{x.value=a},Y=Q(()=>!(n.value||i.value)),re=a=>{C.value=a},ne=()=>{f.value="username",y.value=null,K(()=>{document.querySelector("#email").focus()})},ie=()=>{f.value="username",y.value=null,K(()=>{document.querySelector("#phoneNumber").focus()})},Z=async()=>{E.value=!0;const a={userType:k};n.value?a.phoneNumber=`+${C.value?C.value.dialCode:"1"}${g.value}`:i.value&&(a.email=h.value);try{const p=await $.checkIfUserExist(a);E.value=!1,p?(f.value="password",K(()=>{document.querySelector("#password").focus()})):k==="Candidate"?t.push({name:"register",params:L(L({},n.value&&{phoneTemp:g.value}),i.value&&{emailTemp:a.email})}):l.dialog({title:"Alert",message:n.value?"That phone number does not exist. Try again.":"That email does not exist. Try again."}).onOk(()=>{g.value="",n.value=!1,h.value="",i.value=!1})}catch(p){E.value=!1,console.log(p)}},X=async()=>{S.value=!0,clearTimeout(H.value);const a={password:y.value,userType:k};n.value?a.phoneNumber=`+${C.value?C.value.dialCode:"1"}${g.value}`:i.value&&(a.email=h.value);try{const p=await $.login(a);S.value=!1,p&&(A.value?t.push(A.value):t.push({path:"/"}))}catch(p){S.value=!1,H.value=setTimeout(function(){M.value=!1},7e3);const{response:N}=p;N&&N.data.errtext&&N.data.errdetail?l.notify({type:"negative",message:N.data.errdetail,timeout:7e3,position:l.screen.lt.md?"top":"top-right"}):(console.log(p),l.notify({type:"negative",message:"An error occurred, please try again later",timeout:7e3,position:l.screen.lt.md?"top":"top-right"}))}};return{email:h,phone:g,password:y,isPwd:oe,validPhone:n,validEmail:i,step:f,validPassword:d,invalidLogin:M,continueProgress:E,loginProgress:S,passwordMessage:O,phoneMessage:B,emailMessage:R,userNameInvalid:Y,updatePhoneMaxLength:te,continueAction:Z,editUserNameEmail:ne,editUserNamePhoneNumber:ie,slide:ee,login:X,updateCountry:re,onSubmit:a=>{f.value==="username"&&!Y.value?Z():f.value==="password"&&!(!d.value||M.value)?X():a.preventDefault()},locale:e,currentUserType:k,currentPageType:V}}},Ne={key:0,class:"col-md-7 col-lg-8 col-lx-8"},Qe={class:"col-xs-12 col-sm-12 col-md-5 col-lg-4 col-lx-4 row justify-center items-center"},Ue={class:"text-dark"},Ie={key:1,class:"divider"},Ve={class:"divider-text"},Ae={key:0,class:"text-grey-6",tabindex:"4"},Re={class:"row justify-center"},Be={class:"row justify-center"};function Le(l,s,t,e,_,k){const V=U("carousel"),n=U("phone-number-input"),i=U("router-link"),x=U("languageSelector");return c(),v(xe,{class:"window-height window-width row"},{default:r(()=>[l.$q.screen.lt.md?m("",!0):(c(),z("div",Ne,[o(V)])),q("div",Qe,[o(_e,{class:"auth-card",flat:""},{default:r(()=>[o(w,{style:{"padding-left":"30px","padding-right":"30px"}},{default:r(()=>[o(me,{src:"https://cdn.jsdelivr.net/gh/EliteHCMS/assets@latest/public/logo.svg",fit:"scale-down",class:"auth-logo full-width"})]),_:1}),o(w,{class:"text-center auth-description"},{default:r(()=>[q("p",Ue,P(l.$t("pleaseSignInToYourAccount")),1)]),_:1}),o(w,null,{default:r(()=>[o(ke,{class:"q-px-sm q-pt-sm",onSubmit:s[4]||(s[4]=fe(()=>{},["prevent"])),onKeyup:he(e.onSubmit,["enter"])},{default:r(()=>[!e.validEmail&&!e.validPhone||e.validEmail?(c(),v(W,{key:0,for:"email",style:{"padding-bottom":"0px"},autocomplete:"username",clearable:"",outlined:"",modelValue:e.email,"onUpdate:modelValue":s[0]||(s[0]=d=>e.email=d),type:"email",label:l.$t("email"),tabindex:"1",error:!!e.emailMessage,"error-message":e.emailMessage,readonly:e.step!=="username"},ye({prepend:r(()=>[o(j,{name:"email"})]),_:2},[e.step!=="username"?{name:"append",fn:r(()=>[o(I,{round:"",dense:"",flat:"",icon:"edit",onClick:e.editUserNameEmail},null,8,["onClick"])])}:void 0]),1032,["modelValue","label","error","error-message","readonly"])):m("",!0),!e.validEmail&&!e.validPhone&&e.currentUserType!=="QuickBase User"?(c(),z("div",Ie,[q("div",Ve,P(l.$t("or")),1)])):m("",!0),(!e.validEmail&&!e.validPhone||e.validPhone)&&e.currentUserType!=="QuickBase User"?(c(),v(n,{key:2,outlined:"",for:"phoneNumber",modelValue:e.phone,"onUpdate:modelValue":s[1]||(s[1]=d=>e.phone=d),label:l.$t("phoneNumber"),tabindex:"1",autocomplete:"username",onMaxLengthChanged:e.updatePhoneMaxLength,style:be(e.phoneMessage?"padding-bottom: 20px;":"padding-bottom: 0px;"),error:!!e.phoneMessage,"error-message":e.phoneMessage,readonly:e.step!=="username",editIcon:e.step!=="username",onEditClicked:e.editUserNamePhoneNumber,onCountryChanged:e.updateCountry},null,8,["modelValue","label","onMaxLengthChanged","style","error","error-message","readonly","editIcon","onEditClicked","onCountryChanged"])):m("",!0),e.step==="password"?(c(),v(W,{key:3,for:"password",class:"q-mt-lg",outlined:"",modelValue:e.password,"onUpdate:modelValue":s[3]||(s[3]=d=>e.password=d),type:e.isPwd?"password":"text",label:l.$t("password"),autocomplete:"current-password",tabindex:"2",error:!!e.passwordMessage,"error-message":e.passwordMessage},{append:r(()=>[o(j,{name:e.isPwd?"visibility_off":"visibility",class:"cursor-pointer",onClick:s[2]||(s[2]=d=>e.isPwd=!e.isPwd)},null,8,["name"])]),prepend:r(()=>[o(j,{name:"lock"})]),_:1},8,["modelValue","type","label","error","error-message"])):m("",!0)]),_:1},8,["onKeyup"])]),_:1}),o(we,{class:"q-px-lg"},{default:r(()=>[e.step==="username"?(c(),v(I,{key:0,loading:e.continueProgress,unelevated:"",size:"lg",color:"primary",class:"full-width text-white",label:l.$t("continue"),tabindex:"3",disabled:e.userNameInvalid,onClick:e.continueAction},null,8,["loading","label","disabled","onClick"])):m("",!0),e.step==="password"?(c(),v(I,{key:1,loading:e.loginProgress,unelevated:"",size:"lg",color:"primary",class:"full-width text-white",label:l.$t("login"),tabindex:"3",disabled:!e.validPassword||e.invalidLogin,onClick:e.login},null,8,["loading","label","disabled","onClick"])):m("",!0)]),_:1}),o(w,{class:"text-center q-pa-sm"},{default:r(()=>[e.currentUserType==="Candidate"?(c(),z("p",Ae,[D(P(l.$t("needAnAccountQuestion"))+" ",1),o(i,{to:"/register",class:"text-grey-6"},{default:r(()=>[D(P(l.$t("register")),1)]),_:1})])):m("",!0),e.currentUserType!=="QuickBase User"?(c(),v(i,{key:1,to:"/forgot-password",class:"text-grey-6"},{default:r(()=>[D(P(l.$t("forgotPasswordQuestion")),1)]),_:1})):m("",!0)]),_:1}),o(w,{class:"q-pl-lg q-pa-sm"},{default:r(()=>[q("div",Re,[o(x,{dense:"",borderless:""})])]),_:1}),e.currentPageType==="Candidate Kiosk"?(c(),v(w,{key:0,class:"q-pl-lg q-pa-sm"},{default:r(()=>[q("div",Be,[o(I,{label:"Bookmarks",color:"primary",size:"md",class:"text-white q-mt-xl",to:{name:"bookmarks"}})])]),_:1})):m("",!0)]),_:1})])]),_:1})}var pa=pe(Ee,[["render",Le],["__scopeId","data-v-7ec56d53"]]);export{pa as default};
