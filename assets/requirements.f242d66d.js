import{Q as ye,a as ve,b as we}from"./QTabPanels.d6381f9e.js";import{Q as Ce}from"./QTabs.e3196157.js";import{Q as $e}from"./QToolbar.dab6cc44.js";import{Q as he}from"./QPage.50af9100.js";import{u as W}from"./use-quasar.32520ede.js";import{l as J,r as A,_ as K,A as b,B as M,d as o,br as l,cS as G,cT as P,D as p,ac as V,cU as Q,cV as B,bW as k,bO as re,y as ie,ar as L,cy as me,b5 as Z,aq as E,F as I,b4 as Y,ax as de,dg as fe,bU as pe,c as te,w as Ae}from"./index.6ad28899.js";import{a as D,c as N}from"./array.59f93f43.js";import{q as h}from"./app.ae18e828.js";import{d as _,a as ge}from"./useQuerySaver.d29ff9ee.js";import"./dayjs.32f0a35d.js";import{u as ke}from"./index.4a45d316.js";import{u as be}from"./dataStore.b26b6cac.js";import{Q as ue}from"./QInnerLoading.ba1209fa.js";import{Q as ce,a as x}from"./QTable.2cdd6b35.js";import{Q as ee}from"./QTr.ffefdfd4.js";import{Q as ae}from"./QTd.935a3373.js";import{a as oe}from"./QSelect.a35c72f5.js";import{Q as le}from"./QForm.8b10ff15.js";import{a as ne,u as X}from"./vee-validate.esm.8e982689.js";import"./use-panel.7c10604f.js";import"./touch.3df10340.js";import"./selection.53968a35.js";import"./QResizeObserver.bfe8e417.js";import"./rtl.b51694b1.js";import"./_commonjsHelpers.a26ce4be.js";import"./localForage.b23cd6d4.js";import"./api.2d8f8822.js";import"./index.04bc0a32.js";import"./i18n.693194ed.js";import"./QList.25171d0a.js";import"./QMarkupTable.8454fed9.js";import"./use-fullscreen.b062bb91.js";import"./QChip.26ec4575.js";import"./QMenu.798567a6.js";import"./position-engine.eb4313f6.js";const qe=J({emits:["cancelAdd","addComplete"],props:{},setup(e,{emit:t}){const v=W(),c=A(null),{capitalize:m}=ie,y=u=>{const q=u.split(" ");let F="";return q.forEach((z,H)=>{F+=H>0?` ${m(z.toLowerCase())}`:m(z.toLowerCase())}),F},i=D({name:N().required().label("Course Name"),category:D().required().label("Category").nullable(),code:N().label("Course Code").nullable()}),{meta:n,errors:$,handleSubmit:w,handleReset:S}=ne({validationSchema:i}),{value:d}=X("name"),{value:f}=X("category"),{value:a}=X("code"),s=w(async u=>{const q={6:{value:y(u.name)},8:{value:u.code||""},10:{value:u.category[3]}};try{const{data:F}=await h.upsertRecordsXML({to:"bp6rvwu6i",data:[q],fieldsToReturn:[20],formatObject:20});t("addComplete",F[0][20]),S()}catch(F){console.log(F),v.notify({type:"negative",message:"Something went wrong!"})}});return(async()=>{const{data:u}=await h.fetchFromCredentialsAndTrainingApp({fields:[_({type:"requirementCategories",query:"{'7'.EX.'Active'}"})]});c.value=u.sort((q,F)=>q[6]>F[6]?1:-1)})(),{formErrors:$,formMeta:n,submit:s,name:d,category:f,code:a,categories:c}}}),Ne={class:"q-mb-md"},Ve={class:"text-caption"},Se={class:"q-mb-md"},Te={class:"text-caption"},Oe={class:"text-caption"};function Ee(e,t,v,c,m,y){return b(),M("div",null,[o(le,{onSubmit:re(e.submit,["prevent"])},{default:l(()=>[o(G,null,{default:l(()=>[o(P,null,{default:l(()=>[p("div",null,[p("div",Ne,[o(oe,{class:"q-mb-sm",dense:"",label:"Select a Category","transition-show":"flip-up","transition-hide":"flip-down",modelValue:e.category,"onUpdate:modelValue":t[0]||(t[0]=i=>e.category=i),options:e.categories||[],"option-label":"6","display-value":`${e.category?e.category[6]:""}`,"bottom-slots":"",error:!!e.formErrors.category},{error:l(()=>[p("div",Ve,V(e.formErrors.category),1)]),_:1},8,["modelValue","options","display-value","error"])]),p("div",Se,[o(Q,{label:"Course Name",dense:"",modelValue:e.name,"onUpdate:modelValue":t[1]||(t[1]=i=>e.name=i),error:!!e.formErrors.name,"bottom-slots":""},{error:l(()=>[p("div",Te,V(e.formErrors.name),1)]),_:1},8,["modelValue","error"])]),p("div",null,[o(Q,{label:"Course Code",dense:"",modelValue:e.code,"onUpdate:modelValue":t[2]||(t[2]=i=>e.code=i),error:!!e.formErrors.code,"bottom-slots":""},{error:l(()=>[p("div",Oe,V(e.formErrors.code),1)]),_:1},8,["modelValue","error"])])])]),_:1}),o(B,{align:"right"},{default:l(()=>[o(k,{color:"secondary",label:"Cancel",onClick:t[3]||(t[3]=i=>e.$emit("cancelAdd"))}),o(k,{color:"primary",label:"Submit",type:"submit",onClick:e.submit},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["onSubmit"])])}var Me=K(qe,[["render",Ee]]);const Re=J({emits:["cancelAdd","addComplete"],props:{},setup(e,{emit:t}){const v=W(),c=A([]),m=A([]),y=A(!1),i=A(""),n=A(null),{capitalize:$}=ie,w=g=>{const C=g.split(" ");let O="";return C.forEach((R,U)=>{O+=U>0?` ${$(R.toLowerCase())}`:$(R.toLowerCase())}),O},S=D({name:N().required().label("Type"),category:D().required().label("Regulator").nullable(),code:N().required().label("Description").nullable()}),{meta:d,errors:f,handleSubmit:a,handleReset:s}=ne({validationSchema:S}),{value:r}=X("name"),{value:u}=X("category"),{value:q}=X("code"),F=a(async g=>{const C={6:{value:w(g.name)},7:{value:g.code},8:{value:g.category[3]}};try{const{data:O}=await h.upsertRecordsXML({to:"bp6rvxmg3",data:[C],fieldsToReturn:[15],formatObject:15});t("addComplete",O[0][15]),s()}catch(O){console.log(O),v.notify({type:"negative",message:"Something went wrong!"})}}),z=(g,C)=>{if(g===""){C(()=>{c.value=m.value});return}C(()=>{const O=g.toLowerCase();c.value=m.value.filter(R=>R[6].toLowerCase().indexOf(O)>-1)})},H=async()=>{await N().required().label("Regulator Name").isValid(i.value)?(n.value=null,se(i.value)):n.value="Regulator Name is required!"},se=async g=>{try{const{data:C}=await h.upsertRecordsXML({to:"bp6r8qzkg",data:[{6:{value:w(g)}}],fieldsToReturn:[12],formatObject:12});m.value.push(C[0][12]),u.value=C[0][12],c.value=m.value,T()}catch(C){v.dialog({title:"Alert",message:C}).onDismiss(()=>{T()})}},T=()=>{i.value="",n.value=!1,y.value=!1};return(async()=>{const{data:g}=await h.fetchFromCredentialsAndTrainingApp({fields:[_({type:"regulators",query:"{'7'.EX.'Active'}"})]});m.value=g.sort((C,O)=>C[6]>O[6]?1:-1),c.value=m.value})(),{formErrors:f,formMeta:d,submit:F,name:r,category:u,code:q,categories:c,filterOptions:z,addNew:y,newCategory:i,newCatError:n,closeAddNew:T,validateNewCategory:H}}}),Le={class:"q-mb-md"},Fe={class:"text-caption"},je={key:0,class:"text-center bg-info"},Xe={class:"text-center bg-info"},De={class:"q-mb-md"},Qe={class:"text-caption"},Ue={class:"text-caption"},Pe={class:"text-caption"};function Be(e,t,v,c,m,y){return b(),M("div",null,[o(le,{onSubmit:re(e.submit,["prevent"])},{default:l(()=>[o(G,null,{default:l(()=>[o(P,null,{default:l(()=>[p("div",null,[p("div",Le,[o(oe,{class:"q-mb-sm",dense:"",label:"Select a Regulator","transition-show":"flip-up","transition-hide":"flip-down",modelValue:e.category,"onUpdate:modelValue":t[2]||(t[2]=i=>e.category=i),options:e.categories,"option-label":"6","display-value":`${e.category?e.category[6]:""}`,"bottom-slots":"",error:!!e.formErrors.category,"use-input":"","input-debounce":"0",onFilter:e.filterOptions},{error:l(()=>[p("div",Fe,V(e.formErrors.category),1)]),"after-options":l(()=>[e.categories.length>0?(b(),M("div",je,[o(k,{flat:"",color:"white",label:"Add a New Regulator",onClick:t[0]||(t[0]=i=>e.addNew=!0)})])):L("",!0)]),"no-option":l(()=>[p("div",Xe,[o(k,{flat:"",color:"white",label:"Add a New Regulator",onClick:t[1]||(t[1]=i=>e.addNew=!0)})])]),_:1},8,["modelValue","options","display-value","error","onFilter"])]),p("div",De,[o(Q,{label:"Test Type",dense:"",modelValue:e.name,"onUpdate:modelValue":t[3]||(t[3]=i=>e.name=i),error:!!e.formErrors.name,"bottom-slots":""},{error:l(()=>[p("div",Qe,V(e.formErrors.name),1)]),_:1},8,["modelValue","error"])]),p("div",null,[o(Q,{label:"Description",dense:"",modelValue:e.code,"onUpdate:modelValue":t[4]||(t[4]=i=>e.code=i),error:!!e.formErrors.code,"bottom-slots":""},{error:l(()=>[p("div",Ue,V(e.formErrors.code),1)]),_:1},8,["modelValue","error"])])])]),_:1}),o(B,{align:"right"},{default:l(()=>[o(k,{color:"secondary",label:"Cancel",onClick:t[5]||(t[5]=i=>e.$emit("cancelAdd"))}),o(k,{color:"primary",label:"Submit",type:"submit",onClick:e.submit},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["onSubmit"]),o(me,{modelValue:e.addNew,"onUpdate:modelValue":t[7]||(t[7]=i=>e.addNew=i)},{default:l(()=>[o(G,null,{default:l(()=>[o(P,null,{default:l(()=>[o(Q,{dense:"",label:"Regulator Name",modelValue:e.newCategory,"onUpdate:modelValue":t[6]||(t[6]=i=>e.newCategory=i),error:!!e.newCatError,"bottom-slots":""},{error:l(()=>[p("div",Pe,V(e.newCatError),1)]),_:1},8,["modelValue","error"])]),_:1}),o(B,{align:"right"},{default:l(()=>[o(k,{color:"secondary",label:"Cancel",onClick:e.closeAddNew},null,8,["onClick"]),o(k,{color:"primary",label:"Submit",type:"submit",onClick:e.validateNewCategory},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}var ze=K(Re,[["render",Be]]);const He=[{label:"Half Face",value:"Half"},{label:"Full Face",value:"Full"}],Ie=J({emits:["cancelAdd","addComplete"],props:{options:Array},setup(e,{emit:t}){const v=W(),c=A([]),m=A([]),y=A(!1),i=A(""),n=A(null),$=D({name:N().required().label("Model"),category:N().required().label("Manufacturer").nullable(),code:D().required().label("Type").nullable()}),{meta:w,errors:S,handleSubmit:d,handleReset:f}=ne({validationSchema:$}),{value:a}=X("name"),{value:s}=X("category"),{value:r}=X("code"),u=d(async T=>{const j={8:{value:T.name},11:{value:T.category},13:{value:T.code.value}};try{const{data:g}=await h.upsertRecordsXML({to:"bp6rv4qnn",data:[j],fieldsToReturn:[16],formatObject:16});t("addComplete",g[0][16]),f()}catch(g){console.log(g),v.notify({type:"negative",message:"Something went wrong!"})}}),q=(T,j)=>{if(!T||T===""){j(()=>{c.value=m.value});return}j(()=>{const g=T.toLowerCase();c.value=m.value.filter(C=>C.toLowerCase().indexOf(g)>-1)})},F=async()=>{await N().required().isValid(i.value)?(n.value=null,z(i.value)):n.value="Manufacturer Name is required!"},z=T=>{const j=m.value.find(g=>g===T);j?s.value=j:(m.value.unshift(T),c.value=m.value),H()},H=()=>{i.value="",n.value=!1,y.value=!1};return(()=>{const T=e.options;m.value=[...new Map(T.map(j=>[j[11],j[11]])).values()],c.value=m.value})(),{formErrors:S,formMeta:w,submit:u,name:a,category:s,code:r,categories:c,types:He,filterOptions:q,addNew:y,newCategory:i,newCatError:n,closeAddNew:H,validateNewCategory:F}}}),Ye={class:"q-mb-md"},Ge={class:"text-caption"},We={key:0,class:"text-center bg-info"},Je={class:"text-center bg-info"},Ke={class:"q-mb-md"},Ze={class:"text-caption"},_e={class:"text-caption"},xe={class:"text-caption"};function ea(e,t,v,c,m,y){return b(),M("div",null,[o(le,{onSubmit:re(e.submit,["prevent"])},{default:l(()=>[o(G,null,{default:l(()=>[o(P,null,{default:l(()=>[p("div",null,[p("div",Ye,[o(oe,{class:"q-mb-sm",dense:"",label:"Select a Manufacturer",modelValue:e.category,"onUpdate:modelValue":t[2]||(t[2]=i=>e.category=i),options:e.categories,"bottom-slots":"",error:!!e.formErrors.category,"use-input":"","input-debounce":"0",onFilter:e.filterOptions},{error:l(()=>[p("div",Ge,V(e.formErrors.category),1)]),"after-options":l(()=>[e.categories.length>0?(b(),M("div",We,[o(k,{flat:"",color:"white",label:"Add a New Manufacturer",onClick:t[0]||(t[0]=i=>e.addNew=!0)})])):L("",!0)]),"no-option":l(()=>[p("div",Je,[o(k,{flat:"",color:"white",label:"Add a New Manufacturer",onClick:t[1]||(t[1]=i=>e.addNew=!0)})])]),_:1},8,["modelValue","options","error","onFilter"])]),p("div",Ke,[o(Q,{label:"Model",dense:"",modelValue:e.name,"onUpdate:modelValue":t[3]||(t[3]=i=>e.name=i),error:!!e.formErrors.name,"bottom-slots":""},{error:l(()=>[p("div",Ze,V(e.formErrors.name),1)]),_:1},8,["modelValue","error"])]),p("div",null,[o(oe,{class:"q-mb-sm",dense:"",label:"Mask Type","transition-show":"flip-up","transition-hide":"flip-down",modelValue:e.code,"onUpdate:modelValue":t[4]||(t[4]=i=>e.code=i),options:e.types,"bottom-slots":"",error:!!e.formErrors.code},{error:l(()=>[p("div",_e,V(e.formErrors.code),1)]),_:1},8,["modelValue","options","error"])])])]),_:1}),o(B,{align:"right"},{default:l(()=>[o(k,{color:"secondary",label:"Cancel",onClick:t[5]||(t[5]=i=>e.$emit("cancelAdd"))}),o(k,{color:"primary",label:"Submit",type:"submit",onClick:e.submit},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["onSubmit"]),o(me,{modelValue:e.addNew,"onUpdate:modelValue":t[7]||(t[7]=i=>e.addNew=i)},{default:l(()=>[o(G,null,{default:l(()=>[o(P,null,{default:l(()=>[o(Q,{dense:"",label:"Manufacturer Name",modelValue:e.newCategory,"onUpdate:modelValue":t[6]||(t[6]=i=>e.newCategory=i),error:!!e.newCatError,"bottom-slots":""},{error:l(()=>[p("div",xe,V(e.newCatError),1)]),_:1},8,["modelValue","error"])]),_:1}),o(B,{align:"right"},{default:l(()=>[o(k,{color:"secondary",label:"Cancel",onClick:e.closeAddNew},null,8,["onClick"]),o(k,{color:"primary",label:"Submit",type:"submit",onClick:e.validateNewCategory},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}var aa=K(Ie,[["render",ea]]);const ta=J({emits:["cancelAdd","addComplete"],props:{options:Array},setup(e,{emit:t}){const v=W(),{capitalize:c}=ie,m=f=>{const a=f.split(" ");let s="";return a.forEach((r,u)=>{s+=u>0?` ${c(r.toLowerCase())}`:c(r.toLowerCase())}),s},y=D({code:N().label("Course Code").nullable()}),{meta:i,errors:n,handleSubmit:$,handleReset:w}=ne({validationSchema:y}),{value:S}=X("code"),d=$(async f=>{if(e.options.find(r=>r[6].toLowerCase()===f.code.toLowerCase())){v.notify({type:"negative",message:"Medical Screen already exists!"}),t("cancelAdd");return}const s={6:{value:m(f.code)}};try{const{data:r}=await h.upsertRecordsXML({to:"bp6rv3ne3",data:[s],fieldsToReturn:[12],formatObject:12});t("addComplete",r[0][12]),w()}catch(r){console.log(r),v.notify({type:"negative",message:"Something went wrong!"})}});return{formErrors:n,formMeta:i,submit:d,code:S}}}),oa={class:"text-caption"};function ra(e,t,v,c,m,y){return b(),M("div",null,[o(le,{onSubmit:re(e.submit,["prevent"])},{default:l(()=>[o(G,null,{default:l(()=>[o(P,null,{default:l(()=>[p("div",null,[p("div",null,[o(Q,{label:"Medical Screen Type",dense:"",modelValue:e.code,"onUpdate:modelValue":t[0]||(t[0]=i=>e.code=i),error:!!e.formErrors.code,"bottom-slots":""},{error:l(()=>[p("div",oa,V(e.formErrors.code),1)]),_:1},8,["modelValue","error"])])])]),_:1}),o(B,{align:"right"},{default:l(()=>[o(k,{color:"secondary",label:"Cancel",onClick:t[1]||(t[1]=i=>e.$emit("cancelAdd"))}),o(k,{color:"primary",label:"Submit",type:"submit",onClick:e.submit},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["onSubmit"])])}var la=K(ta,[["render",ra]]);const na=[{label:"Half Face",value:"Half"},{label:"Full Face",value:"Full"}],sa=J({emits:["cancelAdd","addComplete"],props:{options:Array},setup(e,{emit:t}){const v=W(),c=A([]),m=A([]),y=A(!1),i=A(""),n=A(null),{capitalize:$}=ie,w=g=>{const C=g.split(" ");let O="";return C.forEach((R,U)=>{O+=U>0?` ${$(R.toLowerCase())}`:$(R.toLowerCase())}),O},S=D({name:N().required().label("Model"),category:N().required().label("Manufacturer").nullable()}),{meta:d,errors:f,handleSubmit:a,handleReset:s}=ne({validationSchema:S}),{value:r}=X("name"),{value:u}=X("category"),q=async g=>{const{data:C}=await h.upsertRecordsXML({to:"bp6sjuy5b",data:[{6:{value:w(g)}}],fieldsToReturn:[3]});return console.log(C),C[0][3]},F=a(async g=>{if(g.category==="Yes"){if(e.options.find(R=>R[8].toLowerCase()===g.name.toLowerCase())){v.notify({type:"negative",message:"Owner already exists!"}),t("cancelAdd");return}const O={6:{value:1},8:{value:g.name}};try{const{data:R}=await h.upsertRecordsXML({to:"bp6rvyr7k",data:[O],fieldsToReturn:[17],formatObject:17});t("addComplete",R[0][17]),s()}catch(R){console.log(R),v.notify({type:"negative",message:"Something went wrong!"})}}else{if(e.options.find(U=>U[8].toLowerCase()===g.name.toLowerCase())){v.notify({type:"negative",message:"Background Type already exists!"}),t("cancelAdd");return}v.loading.show();const R={6:{value:await q(g.name)},8:{value:w(g.name)}};try{const{data:U}=await h.upsertRecordsXML({to:"bp6rvyr7k",data:[R],fieldsToReturn:[17],formatObject:17});t("addComplete",U[0][17]),s()}catch(U){console.log(U),v.notify({type:"negative",message:"Something went wrong!"})}v.loading.hide()}}),z=(g,C)=>{if(!g||g===""){C(()=>{c.value=m.value});return}C(()=>{const O=g.toLowerCase();c.value=m.value.filter(R=>R.toLowerCase().indexOf(O)>-1)})},H=async()=>{await N().required().isValid(i.value)?(n.value=null,se(i.value)):n.value="Manufacturer Name is required!"},se=g=>{const C=m.value.find(O=>O===g);C?u.value=C:(m.value.unshift(g),c.value=m.value),T()},T=()=>{i.value="",n.value=!1,y.value=!1};return(()=>{const g=e.options;m.value=[...new Map(g.map(C=>[C[11],C[11]])).values()],c.value=m.value})(),{formErrors:f,formMeta:d,submit:F,name:r,category:u,categories:c,types:na,filterOptions:z,addNew:y,newCategory:i,newCatError:n,closeAddNew:T,validateNewCategory:H}}}),ia={class:"q-mb-sm"},da=p("div",{class:"text-body2 q-pb-md q-pr-md"}," Is this background Disa Express DCC Order? ",-1),ua={class:"text-caption"},ca={key:0,class:"q-mb-md"},ma={class:"text-caption"};function fa(e,t,v,c,m,y){return b(),M("div",null,[o(le,{onSubmit:re(e.submit,["prevent"])},{default:l(()=>[o(G,null,{default:l(()=>[o(P,null,{default:l(()=>[p("div",null,[p("div",ia,[da,o(oe,{dense:"",modelValue:e.category,"onUpdate:modelValue":t[0]||(t[0]=i=>e.category=i),label:"Make a Selection",options:["No","Yes"],"bottom-slots":"",error:!!e.formErrors.category,style:{width:"200px"}},{error:l(()=>[p("div",ua,V(e.formErrors.category),1)]),_:1},8,["modelValue","error"])]),e.category?(b(),M("div",ca,[o(Q,{label:e.category==="Yes"?"Owner Name":"Background Check Type",dense:"",modelValue:e.name,"onUpdate:modelValue":t[1]||(t[1]=i=>e.name=i),error:!!e.formErrors.name,"bottom-slots":""},{error:l(()=>[p("div",ma,V(e.formErrors.name),1)]),_:1},8,["label","modelValue","error"])])):L("",!0)])]),_:1}),o(B,{align:"right"},{default:l(()=>[o(k,{color:"secondary",label:"Cancel",onClick:t[2]||(t[2]=i=>e.$emit("cancelAdd"))}),o(k,{color:"primary",label:"Submit",type:"submit",onClick:e.submit},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["onSubmit"])])}var pa=K(sa,[["render",fa]]);const ga=J({components:{AddAvailableOrientation:Me,AddAvailableDrugScreen:ze,AddAvailableFitTest:aa,AddAvailableMedical:la,AddAvailableBackground:pa},emits:["hideAdd"],props:{config:Object},setup(e,{emit:t}){const v=W(),c=A(""),m=A([]),y=A(!1),i=A([]),n=A(null),$=A(!1),w=r=>{v.dialog({title:"Alert",message:r}).onOk(()=>{t("hideAdd")}).onCancel(()=>{t("hideAdd")})},S=r=>{const{filter:u}=e.config;if(r){const q=r.toLowerCase();i.value=u(n.value,q)}else i.value=n.value},d=async()=>{const{getter:r,tableColumns:u}=e.config;r?u?($.value=!0,n.value=await r(),i.value=n.value,$.value=!1):w("Table columns are required in config props!"):w("A getter is required in config props!")},f=()=>{m.value.length===0?t("hideAdd"):v.dialog({title:"Confirm",message:"Are you sure? All your selections will be lost.",cancel:!0,persistent:!0}).onOk(()=>{t("hideAdd")})},a=async()=>{const{setter:r}=e.config;r?($.value=!0,await r({selections:m.value}),t("hideAdd"),$.value=!1):w("A setter is required in config props!")},s=r=>{n.value.push(r),m.value.push(r),S(null),y.value=!1};return d(),{options:i,rawOptions:n,selection:m,addNew:y,search:c,filterOptions:S,loading:$,initialPagination:{rowsPerPage:A(10)},cancelAdd:f,submit:a,newOptionAdded:s}}}),ba={class:"row justify-between"},ya={class:"col-12 col-sm-4"},va={class:"col-4 text-right"},wa={class:"row"},Ca={class:"col-12 col-md-8 q-px-xs"},$a={class:"text-caption"},ha={key:0,class:"col-12 col-md-4 q-px-xs"},Aa={class:"text-caption"},ka={class:"full-width text-dark text-italic"};function qa(e,t,v,c,m,y){const i=Z("add-available-orientation"),n=Z("add-available-drug-screen"),$=Z("add-available-fit-test"),w=Z("add-available-medical"),S=Z("add-available-background");return b(),M("div",null,[o(G,{flat:""},{default:l(()=>[o(P,{class:"q-pa-sm"},{default:l(()=>[p("div",ba,[p("div",ya,[o(Q,{outlined:"",filled:"",clearable:"",dense:"",modelValue:e.search,"onUpdate:modelValue":[t[0]||(t[0]=d=>e.search=d),t[1]||(t[1]=d=>e.filterOptions(d))],placeholder:"Search"},null,8,["modelValue"])]),p("div",va,[o(k,{color:"dark",label:"Cancel",icon:"arrow_back",onClick:e.cancelAdd},null,8,["onClick"])])])]),_:1}),o(P,{class:"q-pa-xs"},{default:l(()=>[p("div",wa,[p("div",Ca,[o(ce,{title:"Available Options","title-class":"text-body1 text-primary",dense:"",columns:e.config.tableColumns,rows:e.options,"row-key":d=>d[3],"table-header-class":"bg-dark text-white text-caption",pagination:e.initialPagination,loading:e.loading,selection:"multiple",selected:e.selection,"onUpdate:selected":t[3]||(t[3]=d=>e.selection=d)},{"top-right":l(()=>[e.config.allowNew?(b(),E(k,{key:0,color:"accent",size:"sm",label:"Add Another Option",onClick:t[2]||(t[2]=d=>e.addNew=!0)})):L("",!0)]),header:l(d=>[o(ee,{class:"bg-dark text-white",props:d},{default:l(()=>[o(x,{"auto-width":""}),(b(!0),M(I,null,Y(d.cols,f=>(b(),E(x,{class:"text-left",key:f.name},{default:l(()=>[de(V(f.label),1)]),_:2},1024))),128))]),_:2},1032,["props"])]),body:l(d=>[o(ee,{"no-hover":"",props:d},{default:l(()=>[o(ae,{"auto-width":""},{default:l(()=>[o(fe,{class:"q-pa-none q-ma-none",size:"xs",modelValue:d.selected,"onUpdate:modelValue":f=>d.selected=f},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),(b(!0),M(I,null,Y(d.cols,f=>(b(),E(ae,{key:f.name,props:d},{default:l(()=>[p("span",$a,V(f.value),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),loading:l(()=>[o(ue,{showing:e.loading,label:"Loading...","label-class":"text-info"},null,8,["showing"])]),_:1},8,["columns","rows","row-key","pagination","loading","selected"])]),e.loading?L("",!0):(b(),M("div",ha,[o(ce,{title:"Selections","title-class":"text-body1 text-primary",dense:"",columns:e.config.tableColumns.filter(d=>d.showOnSelection),rows:e.selection,"row-key":d=>d[3],"table-header-class":"bg-dark text-white text-caption",loading:e.loading,"hide-pagination":"",pagination:{rowsPerPage:25},"rows-per-page-options":[0],"no-data-label":"No options have been selected",selection:"multiple",selected:e.selection,"onUpdate:selected":t[4]||(t[4]=d=>e.selection=d)},{header:l(d=>[o(ee,{class:"bg-dark text-white",props:d},{default:l(()=>[(b(!0),M(I,null,Y(d.cols,f=>(b(),E(x,{class:"text-left",key:f.name},{default:l(()=>[de(V(f.label),1)]),_:2},1024))),128)),o(x,{"auto-width":""})]),_:2},1032,["props"])]),body:l(d=>[o(ee,{"no-hover":"",props:d},{default:l(()=>[(b(!0),M(I,null,Y(d.cols,f=>(b(),E(ae,{key:f.name,props:d},{default:l(()=>[p("span",Aa,V(f.value),1)]),_:2},1032,["props"]))),128)),o(ae,{class:"q-pa-none","auto-width":""},{default:l(()=>[o(fe,{class:"q-pa-none q-ma-none",size:"xs",modelValue:d.selected,"onUpdate:modelValue":f=>d.selected=f},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1032,["props"])]),"no-data":l(({message:d})=>[p("div",ka,[p("span",null,V(d),1)])]),loading:l(()=>[o(ue,{showing:e.loading,label:"Loading...","label-class":"text-info"},null,8,["showing"])]),_:1},8,["columns","rows","row-key","loading","selected"]),o(B,{align:"right"},{default:l(()=>[e.selection.length>0?(b(),E(k,{key:0,dense:"",color:"info",label:"Submit",onClick:e.submit},null,8,["onClick"])):L("",!0)]),_:1})]))])]),_:1}),o(B,{align:"right"})]),_:1}),o(me,{persistent:"",modelValue:e.addNew,"onUpdate:modelValue":t[10]||(t[10]=d=>e.addNew=d)},{default:l(()=>[e.config.newType==="orientation"?(b(),E(i,{key:0,onCancelAdd:t[5]||(t[5]=d=>e.addNew=!1),onAddComplete:e.newOptionAdded},null,8,["onAddComplete"])):L("",!0),e.config.newType==="drugScreen"?(b(),E(n,{key:1,onCancelAdd:t[6]||(t[6]=d=>e.addNew=!1),onAddComplete:e.newOptionAdded},null,8,["onAddComplete"])):L("",!0),e.config.newType==="fitTest"?(b(),E($,{key:2,options:e.rawOptions,onCancelAdd:t[7]||(t[7]=d=>e.addNew=!1),onAddComplete:e.newOptionAdded},null,8,["options","onAddComplete"])):L("",!0),e.config.newType==="medical"?(b(),E(w,{key:3,options:e.rawOptions,onCancelAdd:t[8]||(t[8]=d=>e.addNew=!1),onAddComplete:e.newOptionAdded},null,8,["options","onAddComplete"])):L("",!0),e.config.newType==="background"?(b(),E(S,{key:4,options:e.rawOptions,onCancelAdd:t[9]||(t[9]=d=>e.addNew=!1),onAddComplete:e.newOptionAdded},null,8,["options","onAddComplete"])):L("",!0)]),_:1},8,["modelValue"])])}var Na=K(ga,[["render",qa]]);const Va=J({props:{category:Object,formConfig:Object},components:{AddMoreRequirements:Na},setup(e){const t=W(),v=pe(),c=A(!0),m=A(!1),{getViewedProjects:y,updateViewedProjects:i}=be(),n=te(()=>y(v.params.id)),$=te(()=>n.value?n.value[e.category.key]?n.value[e.category.key]:[]:[]),w=async f=>{if(c.value=!0,n.value&&(f||!n.value[e.category.key]||n.value[e.category.key].length===0)){const{data:a}=await h.fetchFromProjectsApp({fields:[ge({type:e.category.key,query:e.category.query})]});i({id:v.params.id,dataset:e.category.key,data:a})}c.value=!1};function S(f){const{removeMessage:a}=e.category;t.dialog({title:"Confirm",message:a(f),cancel:!0,persistent:!0}).onOk(()=>{d(f)})}const d=async f=>{const{remover:a}=e.category;c.value=!0,await a({row:f,current:$.value}),c.value=!1};return w(),Ae(n,()=>{n.value&&w()}),{props:e,loading:c,loadData:w,rows:$,initialPagination:A({rowsPerPage:100}),removeRow:S,addNew:m}}}),Sa={class:"text-caption"};function Ta(e,t,v,c,m,y){const i=Z("add-more-requirements");return b(),M("div",null,[e.addNew?L("",!0):(b(),E(ce,{key:0,dense:"",columns:e.category.columns,rows:e.rows,"row-key":n=>n[3],"table-header-class":"bg-dark text-white",class:"sticky-header-table","hide-pagination":"",pagination:e.initialPagination,"onUpdate:pagination":t[2]||(t[2]=n=>e.initialPagination=n),"rows-per-page-options":[0],loading:e.loading},{"top-left":l(()=>[e.$can("manage","projects")||e.$can("create","projectRequirements")?(b(),E(k,{key:0,onClick:t[0]||(t[0]=n=>e.addNew=!0),color:"accent",label:`Add new ${e.category.label}`},null,8,["label"])):L("",!0)]),"top-right":l(()=>[o(k,{color:"secondary",flat:"","icon-right":"refresh",label:"Refresh",onClick:t[1]||(t[1]=n=>e.loadData(!0))})]),loading:l(()=>[o(ue,{showing:e.loading,label:"Loading...","label-class":"text-info"},null,8,["showing"])]),header:l(n=>[o(ee,{class:"bg-dark text-white",props:n},{default:l(()=>[(b(!0),M(I,null,Y(n.cols,$=>(b(),E(x,{class:"text-left",key:$.name},{default:l(()=>[de(V($.label),1)]),_:2},1024))),128)),o(x,{"auto-width":""})]),_:2},1032,["props"])]),body:l(n=>[o(ee,{props:n},{default:l(()=>[(b(!0),M(I,null,Y(n.cols,$=>(b(),E(ae,{key:$.name,props:n},{default:l(()=>[p("span",Sa,V($.value),1)]),_:2},1032,["props"]))),128)),o(ae,{"auto-width":""},{default:l(()=>[e.$can("manage","projectRequirements")||e.$can("manage","projects")?(b(),E(k,{key:0,color:"accent",dense:"",flat:"",round:"",icon:"delete",onClick:$=>e.removeRow(n.row)},null,8,["onClick"])):L("",!0)]),_:2},1024)]),_:2},1032,["props"])]),_:1},8,["columns","rows","row-key","pagination","loading"])),e.addNew?(b(),E(i,{key:1,config:e.formConfig,onHideAdd:t[3]||(t[3]=n=>e.addNew=!1)},null,8,["config"])):L("",!0)])}var Oa=K(Va,[["render",Ta]]);const Ea=J({components:{RequirementPanel:Oa},setup(){const e=A("orientations"),t=W(),v=pe(),{can:c}=ke(),{getViewedProjects:m,updateViewedProjects:y,setViewedProjects:i}=be(),n=te(()=>m(v.params.id));(async()=>{if(!n.value){const{data:f}=await h.fetchFromProjectsApp({fields:[ge({type:"projects",id:v.params.id})]});i({id:v.params.id,data:f})}})();const w=te(()=>n.value?n.value[3]:v.params.id),S=(f,a,s)=>f!==a[s]?`${f} - ${a[s]}`:f,d=te(()=>[{label:"Orientation",key:"orientations",fields:[8,9],columns:[{name:0,label:"Course Code",align:"left",field:a=>a[8],format:a=>a===""?"N/A":`${a}`,sortable:!0,required:!0},{name:1,label:"Course Name",align:"left",field:a=>a[9],format:a=>a===""?"N/A":`${a}`,sortable:!0}],query:`{'13'.EX.'${w.value}'}AND{'25'.XEX.true}`,formSchema:{category:D().required().label("Category").nullable(),name:N().required().label("Course Name").nullable(),code:N().label("Course Code").nullable()},remover:async({row:a,current:s})=>{const{data:r}=await h.upsertRecordsXML({to:"bp6rvdha2",data:[{3:{value:a[3]},25:{value:!0}}],fieldsToReturn:[24],formatObject:24}),u=s.filter(q=>q[3]!==r[0][24][3]);y({id:w.value,dataset:"orientations",data:u})},removeMessage:a=>`Are you sure you want to remove ${a[9]} from the required orientations?`,addMoreFormConfig:{tableColumns:[{name:0,label:"Course Code",align:"left",field:a=>a[8],format:a=>a===""?"N/A":`${a}`,sortable:!0},{name:1,label:"Course Name",align:"left",field:a=>a[6],format:a=>a===""?"N/A":`${a}`,sortable:!0,required:!0,showOnSelection:!0},{name:2,label:"Category",align:"left",field:a=>a[11],format:a=>a===""?"N/A":`${a}`,sortable:!0,required:!0,showOnSelection:!1}],getter:async()=>{const{data:a}=await h.fetchFromCredentialsAndTrainingApp({fields:[_({type:"availableOrientations",query:"{'7'.EX.'Active'}"})]});return a.sort((s,r)=>s[6]>r[6]?1:-1)},setter:async({selections:a})=>{const s=[];a.forEach(r=>{const u={6:{value:n.value[84]},7:{value:r[3]}};s.push(u)});try{const{data:r}=await h.upsertRecordsXML({to:"bp6rvdha2",data:s,fieldsToReturn:[24],formatObject:24});y({id:n.value[3],dataset:"orientations",data:r.map(u=>u[24]),push:!0}),t.notify({type:"positive",message:"Orientations successfully updated"})}catch{t.notify({type:"negative",message:"Error updating Orientations"})}},filter:(a,s)=>a.filter(r=>r[6].toLowerCase().indexOf(s)>-1||r[8].toLowerCase().indexOf(s)>-1||r[11].toLowerCase().indexOf(s)>-1),allowNew:c("create","availableRequirements"),newType:"orientation",addNewFormConfig:{}}},{label:"D&A Screen",key:"drugScreens",fields:[10,8],columns:[{name:0,label:"Test Type",align:"left",field:a=>a[8],format:a=>a===""?"N/A":`${a}`,sortable:!0,required:!0},{name:1,label:"Description",align:"left",field:a=>a[10],format:a=>`${a}`,sortable:!0}],query:`{'14'.EX.'${w.value}'}AND{'23'.XEX.true}`,formSchema:{category:D().required().label("Category").nullable(),name:N().required().label("Course Name").nullable(),code:N().label("Course Code").nullable()},remover:async({row:a,current:s})=>{const{data:r}=await h.upsertRecordsXML({to:"bp6rvd7zc",data:[{3:{value:a[3]},23:{value:!0}}],fieldsToReturn:[23],formatObject:23}),u=s.filter(q=>q[3]!==r[0][23][3]);y({id:w.value,dataset:"drugScreens",data:u})},removeMessage:a=>`Are you sure you want to remove ${a[10]} ${a[8]} from the required drug and alcohol screens?`,addMoreFormConfig:{tableColumns:[{name:0,label:"Category",align:"left",field:a=>a[9],format:a=>`${a}`,sortable:!0},{name:1,label:"Type",align:"left",field:a=>a[6],format:a=>a===""?"N/A":`${a}`,sortable:!0,required:!0,showOnSelection:!0},{name:2,label:"Description",align:"left",field:a=>a[7],format:a=>a===""?"N/A":`${a}`,sortable:!0,required:!0,showOnSelection:!0}],getter:async()=>{const{data:a}=await h.fetchFromCredentialsAndTrainingApp({fields:[_({type:"availableDrugScreens",query:"{'10'.EX.'Active'}"})]});return a.sort((s,r)=>s[6]>r[6]?1:-1)},setter:async({selections:a})=>{const s=[];a.forEach(r=>{const u={6:{value:n.value[84]},7:{value:r[3]}};s.push(u)});try{const{data:r}=await h.upsertRecordsXML({to:"bp6rvd7zc",data:s,fieldsToReturn:[22],formatObject:22});y({id:n.value[3],dataset:"drugScreens",data:r.map(u=>u[22]),push:!0}),t.notify({type:"positive",message:"Drug Screens successfully updated"})}catch{t.notify({type:"negative",message:"Error updating Drug Screens"})}},filter:(a,s)=>a.filter(r=>r[6].toLowerCase().indexOf(s)>-1||r[7].toLowerCase().indexOf(s)>-1||r[9].toLowerCase().indexOf(s)>-1),allowNew:c("create","availableRequirements"),newType:"drugScreen",addNewFormConfig:{}}},{label:"Background",key:"backgrounds",fields:[8,9],columns:[{name:0,label:"Background Type",align:"left",field:a=>a[8],format:(a,s)=>S(a,s,9),sortable:!0,required:!0}],query:`{'13'.EX.'${w.value}'}AND{'26'.XEX.true}`,formSchema:{category:D().required().label("Category").nullable(),name:N().required().label("Course Name").nullable(),code:N().label("Course Code").nullable()},remover:async({row:a,current:s})=>{const{data:r}=await h.upsertRecordsXML({to:"bp6rvfzpj",data:[{3:{value:a[3]},26:{value:!0}}],fieldsToReturn:[25],formatObject:25}),u=s.filter(q=>q[3]!==r[0][25][3]);y({id:w.value,dataset:"backgrounds",data:u})},removeMessage:a=>`Are you sure you want to remove ${S(a[8],a,9)} from the required background checks?`,addMoreFormConfig:{tableColumns:[{name:0,label:"Background Type",align:"left",field:a=>a[7],format:(a,s)=>S(a,s,8),sortable:!0,required:!0,showOnSelection:!0}],getter:async()=>{const{data:a}=await h.fetchFromCredentialsAndTrainingApp({fields:[_({type:"availableBackgrounds",query:"{'6'.GT.0}"})]});return a.sort((s,r)=>s[7]>r[7]?1:-1)},setter:async({selections:a})=>{const s=[];a.forEach(r=>{const u={6:{value:n.value[84]},7:{value:r[3]}};s.push(u)});try{const{data:r}=await h.upsertRecordsXML({to:"bp6rvfzpj",data:s,fieldsToReturn:[25],formatObject:25});y({id:n.value[3],dataset:"backgrounds",data:r.map(u=>u[25]),push:!0}),t.notify({type:"positive",message:"Backgrounds successfully updated"})}catch{t.notify({type:"negative",message:"Error updating Backgrounds"})}},filter:(a,s)=>a.filter(r=>r[7].toLowerCase().indexOf(s)>-1||r[8].toLowerCase().indexOf(s)>-1),allowNew:c("create","availableRequirements"),newType:"background",addNewFormConfig:{}}},{label:"Fit Test",key:"fitTests",fields:[18],columns:[{name:0,label:"Mask",align:"left",field:a=>a[18],format:a=>a===""?"N/A":`${a}`,sortable:!0,required:!0},{name:1,label:"Manufacturer",align:"left",field:a=>a[20],format:a=>a===""?"N/A":`${a}`,sortable:!0}],query:`{'12'.EX.'${w.value}'}AND{'25'.XEX.true}`,formSchema:{category:N().required().label("Manufacturer").nullable(),name:N().required().label("Model").nullable(),code:N().required().label("Type").nullable()},remover:async({row:a,current:s})=>{const{data:r}=await h.upsertRecordsXML({to:"bp6rvmzc6",data:[{3:{value:a[3]},25:{value:!0}}],fieldsToReturn:[24],formatObject:24}),u=s.filter(q=>q[3]!==r[0][24][3]);y({id:w.value,dataset:"fitTests",data:u})},removeMessage:a=>`Are you sure you want to remove ${a[18]} from the required fit tests?`,addMoreFormConfig:{tableColumns:[{name:0,label:"Manufacturer",align:"left",field:a=>a[11],format:a=>`${a}`,sortable:!0,showOnSelection:!0},{name:1,label:"Model",align:"left",field:a=>a[8],format:a=>a===""?"N/A":`${a}`,sortable:!0,required:!0,showOnSelection:!0},{name:2,label:"Type",align:"left",field:a=>a[13],format:a=>a===""?"N/A":`${a} Face`,sortable:!0,required:!0}],getter:async()=>{const{data:a}=await h.fetchFromCredentialsAndTrainingApp({fields:[_({type:"availableFitTests",query:"{'9'.EX.'Active'}"})]});return a.sort((s,r)=>s[11]>r[11]?1:-1)},setter:async({selections:a})=>{const s=[];a.forEach(r=>{const u={6:{value:n.value[84]},7:{value:r[3]}};s.push(u)});try{const{data:r}=await h.upsertRecordsXML({to:"bp6rvmzc6",data:s,fieldsToReturn:[24],formatObject:24});y({id:n.value[3],dataset:"fitTests",data:r.map(u=>u[24]),push:!0}),t.notify({type:"positive",message:"Fit Tests successfully updated"})}catch{t.notify({type:"negative",message:"Error updating Fit Tests"})}},filter:(a,s)=>a.filter(r=>r[8].toLowerCase().indexOf(s)>-1||r[11].toLowerCase().indexOf(s)>-1||r[13].toLowerCase().indexOf(s)>-1),allowNew:c("create","availableRequirements"),newType:"fitTest",addNewFormConfig:{}}},{label:"Medical Screen",key:"medical",fields:[10],columns:[{name:0,label:"Screen Type",align:"left",field:a=>a[10],format:a=>a===""?"N/A":`${a}`,sortable:!0,required:!0}],query:`{'12'.EX.'${w.value}'}AND{'19'.XEX.true}`,formSchema:{category:N().required().label("Screen Type").nullable()},remover:async({row:a,current:s})=>{const{data:r}=await h.upsertRecordsXML({to:"bp6rvj39b",data:[{3:{value:a[3]},19:{value:!0}}],fieldsToReturn:[18],formatObject:18}),u=s.filter(q=>q[3]!==r[0][18][3]);y({id:w.value,dataset:"medical",data:u})},removeMessage:a=>`Are you sure you want to remove ${a[10]} from the required medical screens?`,addMoreFormConfig:{tableColumns:[{name:0,label:"Medical Screen Type",align:"left",field:a=>a[6],format:a=>`${a}`,sortable:!0,showOnSelection:!0}],getter:async()=>{const{data:a}=await h.fetchFromCredentialsAndTrainingApp({fields:[_({type:"availableMedical",query:"{'7'.EX.'Active'}"})]});return a.sort((s,r)=>s[6]>r[6]?1:-1)},setter:async({selections:a})=>{const s=[];a.forEach(r=>{const u={6:{value:n.value[84]},7:{value:r[3]}};s.push(u)});try{const{data:r}=await h.upsertRecordsXML({to:"bp6rvj39b",data:s,fieldsToReturn:[18],formatObject:18});y({id:n.value[3],dataset:"medical",data:r.map(u=>u[18]),push:!0}),t.notify({type:"positive",message:"Medical Screens successfully updated"})}catch{t.notify({type:"negative",message:"Error updating Medical Screens"})}},filter:(a,s)=>a.filter(r=>r[6].toLowerCase().indexOf(s)>-1),allowNew:c("create","availableRequirements"),newType:"medical",addNewFormConfig:{}}}]);return{tab:e,project:n,categories:d}}}),Ma={class:"q-pa-sm"};function Ra(e,t,v,c,m,y){const i=Z("requirement-panel");return b(),E(he,{style:{"max-width":"100vw"}},{default:l(()=>[p("div",Ma,[o($e,{class:"bg-info text-white shadow-2 rounded-borders"},{default:l(()=>[o(Ce,{dense:"",modelValue:e.tab,"onUpdate:modelValue":t[0]||(t[0]=n=>e.tab=n),align:"left","indicator-color":"accent"},{default:l(()=>[(b(!0),M(I,null,Y(e.categories,n=>(b(),E(ye,{key:n.key,name:n.key,label:`${n.label}s`},null,8,["name","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(ve,{modelValue:e.tab,"onUpdate:modelValue":t[1]||(t[1]=n=>e.tab=n),animated:""},{default:l(()=>[(b(!0),M(I,null,Y(e.categories,n=>(b(),E(we,{key:n.key,name:n.key,class:"q-px-xs"},{default:l(()=>[o(i,{category:n,formConfig:n.addMoreFormConfig},null,8,["category","formConfig"])]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue"])])]),_:1})}var gt=K(Ea,[["render",Ra]]);export{gt as default};
