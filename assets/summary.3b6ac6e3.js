var ie=Object.defineProperty,ce=Object.defineProperties;var ue=Object.getOwnPropertyDescriptors;var J=Object.getOwnPropertySymbols;var de=Object.prototype.hasOwnProperty,me=Object.prototype.propertyIsEnumerable;var T=(e,l,n)=>l in e?ie(e,l,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[l]=n,D=(e,l)=>{for(var n in l||(l={}))de.call(l,n)&&T(e,n,l[n]);if(J)for(var n of J(l))me.call(l,n)&&T(e,n,l[n]);return e},O=(e,l)=>ce(e,ue(l));import{i as fe,bR as z,bS as ve,c as d,g as ee,bQ as ye,h as H,bP as te,k as P,_ as j,A as f,B as k,d as h,bi as y,D as u,ab as I,bJ as ge,bH as he,au as be,cy as oe,bO as B,bF as pe,r as ae,aZ as R,an as q,cw as M,cz as le,ao as w,cW as $e,cN as _e,cX as Se,dm as Ae,aM as ke,ch as qe,bI as xe,dn as Ce,cd as Le,cb as U,F as W,aY as Ie,bM as we,w as Ve,G as Qe}from"./index.544726d2.js";import{Q as De}from"./QPage.2113fa42.js";import{u as Y,a as ne}from"./dataStore.44b34602.js";import{q as N}from"./quickbase.dc759386.js";import{Q as He}from"./QSelect.152777d1.js";import{Q as Me}from"./QForm.fc414047.js";import{a as Z,b as Re,u as Be}from"./array.6f0779c0.js";import{u as Pe}from"./use-quasar.de9b4251.js";import{u as je}from"./dataStore.e510ce04.js";import{E as Fe}from"./employeeJobDetails.c5461051.js";import{dayjs as E}from"./dayjs.18653603.js";import"./localForage.cf0f4dd4.js";import"./_commonjsHelpers.a26ce4be.js";import"./index.7dbe61ef.js";import"./i18n.95b8f7c4.js";import"./api.c454b805.js";import"./QChip.2eb47deb.js";import"./QItemLabel.9df651b6.js";import"./QMenu.afaf079f.js";import"./position-engine.9b566ae2.js";import"./selection.019ae5ac.js";import"./rtl.cf9bbe47.js";import"./decode.593c6ccc.js";const Oe={position:{type:String,default:"bottom-right",validator:e=>["top-right","top-left","bottom-right","bottom-left","top","right","bottom","left"].includes(e)},offset:{type:Array,validator:e=>e.length===2},expand:Boolean};function ze(){const{props:e,proxy:{$q:l}}=ee(),n=fe(ve,z);if(n===z)return console.error("QPageSticky needs to be child of QLayout"),z;const i=d(()=>{const m=e.position;return{top:m.indexOf("top")>-1,right:m.indexOf("right")>-1,bottom:m.indexOf("bottom")>-1,left:m.indexOf("left")>-1,vertical:m==="top"||m==="bottom",horizontal:m==="left"||m==="right"}}),c=d(()=>n.header.offset),v=d(()=>n.right.offset),a=d(()=>n.footer.offset),r=d(()=>n.left.offset),b=d(()=>{let m=0,p=0;const g=i.value,$=l.lang.rtl===!0?-1:1;g.top===!0&&c.value!==0?p=`${c.value}px`:g.bottom===!0&&a.value!==0&&(p=`${-a.value}px`),g.left===!0&&r.value!==0?m=`${$*r.value}px`:g.right===!0&&v.value!==0&&(m=`${-$*v.value}px`);const A={transform:`translate(${m}, ${p})`};return e.offset&&(A.margin=`${e.offset[1]}px ${e.offset[0]}px`),g.vertical===!0?(r.value!==0&&(A[l.lang.rtl===!0?"right":"left"]=`${r.value}px`),v.value!==0&&(A[l.lang.rtl===!0?"left":"right"]=`${v.value}px`)):g.horizontal===!0&&(c.value!==0&&(A.top=`${c.value}px`),a.value!==0&&(A.bottom=`${a.value}px`)),A}),S=d(()=>`q-page-sticky row flex-center fixed-${e.position} q-page-sticky--${e.expand===!0?"expand":"shrink"}`);function V(m){const p=ye(m.default);return H("div",{class:S.value,style:b.value},e.expand===!0?p:[H("div",p)])}return{$layout:n,getStickyContent:V}}var Ue=te({name:"QPageSticky",props:Oe,setup(e,{slots:l}){const{getStickyContent:n}=ze();return()=>n(l)}});const Ee=P({emits:["supUpdated"],props:{record:Object},setup(e,{emit:l}){const n=Pe(),{getAssignments:i,fetchAssignments:c}=je(),v=d(()=>i(e.record[74]).filter(g=>g[138]&&g[3]!==e.record[3]).sort((g,$)=>g[75]>$[75]?1:-1)),a=d(()=>Z({selection:Z().required().nullable().label("Supervisor")})),{errors:r,handleSubmit:b,handleReset:S}=Re({validationSchema:a}),{value:V}=Be("selection"),m=b(async p=>{const g=[{3:{value:e.record[3]},133:{value:p.selection[3]}}];try{const{data:$}=await N.upsertRecordsXML({to:"bp3gazpqj",data:g,fieldsToReturn:[110],formatObject:110});console.log($),l("supUpdated",$[0][110]),n.notify({type:"positive",message:"Supervisor successfully updated!"})}catch($){console.log($),n.notify({type:"negative",message:"Cannot save supervisor."}),S()}});return c({projectId:e.record[74],refresh:!0}),{props:e,options:v,selection:V,submit:m,formErrors:r,handleReset:S}}}),Ye={class:"text-caption"};function Ne(e,l,n,i,c,v){return f(),k("div",null,[h(Me,{onSubmit:pe(e.submit,["prevent"])},{default:y(()=>[h(He,{dense:"",clearable:"",label:"Select a Supervisor","transition-show":"flip-up","transition-hide":"flip-down",modelValue:e.selection,"onUpdate:modelValue":l[0]||(l[0]=a=>e.selection=a),options:e.options,"option-label":a=>`${a[75]} - ${a[20]}`,"display-value":`${e.selection?e.selection[75]:""}`,"bottom-slots":"",error:!!e.formErrors.selection},{error:y(()=>[u("div",Ye,I(e.formErrors.selection),1)]),"no-option":y(()=>[h(ge,null,{default:y(()=>[h(he,{class:"text-grey"},{default:y(()=>[be(" No Options Available ")]),_:1})]),_:1})]),_:1},8,["modelValue","options","option-label","display-value","error"]),h(oe,{align:"right"},{default:y(()=>[h(B,{color:"info",label:"Submit",type:"submit"}),h(B,{color:"secondary",label:"Cancel",onClick:e.handleReset},null,8,["onClick"])]),_:1})]),_:1},8,["onSubmit"])])}var Ke=j(Ee,[["render",Ne]]);const Xe=P({props:{employee:Object,assignment:Object},components:{UpdateSupervisor:Ke},setup(e){const l=ae(!1),{setAssignmentsByEmployee:n}=Y();return{props:e,supUpdated:c=>{l.value=!1,n({id:c[18],data:c})},editSup:l}}}),Ge=u("div",{class:"text-h6 q-pb-sm"},"Assign a Supervisor",-1),Je={class:"row text-body2"},Te={class:"col-12 col-md-6"},We=u("div",{class:"q-mb-xs"},"Current Location",-1),Ze={class:"q-pl-sm"},et={class:"col-12 col-md-6"},tt=u("div",{class:"q-mb-xs"},"Current Supervisor",-1),ot={class:"q-pl-sm"};function at(e,l,n,i,c,v){const a=R("update-supervisor");return f(),k("div",null,[e.assignment&&e.assignment[3]?(f(),q(le,{key:0,class:"text-dark"},{default:y(()=>[e.editSup?(f(),q(M,{key:0},{default:y(()=>[Ge,h(a,{record:e.assignment,onSupUpdated:e.supUpdated},null,8,["record","onSupUpdated"])]),_:1})):(f(),q(M,{key:1},{default:y(()=>[u("div",Je,[u("div",Te,[We,u("div",Ze,I(e.assignment[141]),1)]),u("div",et,[tt,u("div",ot,I(e.assignment[140]===""?"N/A":e.assignment[140]),1)])])]),_:1}))]),_:1})):w("",!0)])}var lt=j(Xe,[["render",at]]),nt=te({name:"QRating",props:O(D(D({},$e),_e),{modelValue:{type:Number,required:!0},max:{type:[String,Number],default:5},icon:[String,Array],iconHalf:[String,Array],iconSelected:[String,Array],iconAriaLabel:[String,Array],color:[String,Array],colorHalf:[String,Array],colorSelected:[String,Array],noReset:Boolean,noDimming:Boolean,readonly:Boolean,disable:Boolean}),emits:["update:modelValue"],setup(e,{slots:l,emit:n}){const{proxy:{$q:i}}=ee(),c=Se(e),v=Ae(e),a=Ce(v),r=ae(0);let b={};const S=d(()=>e.readonly!==!0&&e.disable!==!0),V=d(()=>`q-rating row inline items-center q-rating--${S.value===!0?"":"non-"}editable`+(e.noDimming===!0?" q-rating--no-dimming":"")+(e.disable===!0?" disabled":"")+(e.color!==void 0&&Array.isArray(e.color)===!1?` text-${e.color}`:"")),m=d(()=>{const s=Array.isArray(e.icon)===!0?e.icon.length:0,t=Array.isArray(e.iconSelected)===!0?e.iconSelected.length:0,_=Array.isArray(e.iconHalf)===!0?e.iconHalf.length:0,C=Array.isArray(e.color)===!0?e.color.length:0,L=Array.isArray(e.colorSelected)===!0?e.colorSelected.length:0,o=Array.isArray(e.colorHalf)===!0?e.colorHalf.length:0;return{iconLen:s,icon:s>0?e.icon[s-1]:e.icon,selIconLen:t,selIcon:t>0?e.iconSelected[t-1]:e.iconSelected,halfIconLen:_,halfIcon:_>0?e.iconHalf[t-1]:e.iconHalf,colorLen:C,color:C>0?e.color[C-1]:e.color,selColorLen:L,selColor:L>0?e.colorSelected[L-1]:e.colorSelected,halfColorLen:o,halfColor:o>0?e.colorHalf[o-1]:e.colorHalf}}),p=d(()=>{if(typeof e.iconAriaLabel=="string"){const s=e.iconAriaLabel.length>0?`${e.iconAriaLabel} `:"";return t=>`${s}${t}`}if(Array.isArray(e.iconAriaLabel)===!0){const s=e.iconAriaLabel.length;if(s>0)return t=>e.iconAriaLabel[Math.min(t,s)-1]}return(s,t)=>`${t} ${s}`}),g=d(()=>{const s=[],t=m.value,_=Math.ceil(e.modelValue),C=S.value===!0?0:null,L=e.iconHalf===void 0||_===e.modelValue?-1:_;for(let o=1;o<=e.max;o++){const x=r.value===0&&e.modelValue>=o||r.value>0&&r.value>=o,Q=L===o&&r.value<o,F=r.value>0&&(Q===!0?_:e.modelValue)>=o&&r.value<o,G=Q===!0?o<=t.halfColorLen?e.colorHalf[o-1]:t.halfColor:t.selColor!==void 0&&x===!0?o<=t.selColorLen?e.colorSelected[o-1]:t.selColor:o<=t.colorLen?e.color[o-1]:t.color,re=(Q===!0?o<=t.halfIconLen?e.iconHalf[o-1]:t.halfIcon:t.selIcon!==void 0&&(x===!0||F===!0)?o<=t.selIconLen?e.iconSelected[o-1]:t.selIcon:o<=t.iconLen?e.icon[o-1]:t.icon)||i.iconSet.rating.icon;s.push({name:(Q===!0?o<=t.halfIconLen?e.iconHalf[o-1]:t.halfIcon:t.selIcon!==void 0&&(x===!0||F===!0)?o<=t.selIconLen?e.iconSelected[o-1]:t.selIcon:o<=t.iconLen?e.icon[o-1]:t.icon)||i.iconSet.rating.icon,attrs:{tabindex:C,role:"radio","aria-checked":e.modelValue===o?"true":"false","aria-label":p.value(o,re)},iconClass:"q-rating__icon"+(x===!0||Q===!0?" q-rating__icon--active":"")+(F===!0?" q-rating__icon--exselected":"")+(r.value===o?" q-rating__icon--hovered":"")+(G!==void 0?` text-${G}`:"")})}return s}),$=d(()=>{const s={role:"radiogroup"};return e.disable===!0&&(s["aria-disabled"]="true"),e.readonly===!0&&(s["aria-readonly"]="true"),s});function A(s){if(S.value===!0){const t=Le(parseInt(s,10),1,parseInt(e.max,10)),_=e.noReset!==!0&&e.modelValue===t?0:t;_!==e.modelValue&&n("update:modelValue",_),r.value=0}}function K(s){S.value===!0&&(r.value=s)}function se(s,t){switch(s.keyCode){case 13:case 32:return A(t),U(s);case 37:case 40:return b[`rt${t-1}`]&&b[`rt${t-1}`].$el.focus(),U(s);case 39:case 38:return b[`rt${t+1}`]&&b[`rt${t+1}`].$el.focus(),U(s)}}function X(){r.value=0}return ke(()=>{b={}}),()=>{const s=[];return g.value.forEach(({iconClass:t,name:_,attrs:C},L)=>{const o=L+1;s.push(H("div",O(D({key:o,ref:x=>{b[`rt${o}`]=x},class:"q-rating__icon-container flex flex-center"},C),{onClick(){A(o)},onMouseover(){K(o)},onMouseout:X,onFocus(){K(o)},onBlur:X,onKeyup(x){se(x,o)}}),qe(l[`tip-${o}`],[H(xe,{class:t,name:_})])))}),e.name!==void 0&&e.disable!==!0&&a(s,"push"),H("div",D({class:V.value,style:c.value},$.value),s)}}});const st=P({props:{employee:Object},components:{},setup(e){const{getReleases:l,setReleases:n}=Y(),i=d(()=>l(e.employee[581])),c=d(()=>{let a;return i.value&&i.value[3]?a=[{label:"Reason",value:i.value[32]},{label:"Last Day On Site",value:E(i.value[36].$d).format("MM/DD/YYYY")},{label:"CAAP Rating",value:i.value[59][0][37],type:"rating"},{label:"Submitted By",value:`${i.value[38][35]} ${i.value[38][37]}`},{label:"Submitted On",value:E(i.value[1].$d).tz(E.tz.guess()).format("MM/DD/YYYY hh:mm a")},{label:"Comments",value:i.value[60],type:"comments"}]:a=[],a});return(async()=>{if(!i.value&&e.employee[581]){const{data:a}=await N.fetchFromHiringApp({fields:[ne({type:"releases",query:"",id:e.employee[581]})]});console.log(a),n({id:a[3],data:a})}})(),{releaseDetails:c,release:i}}}),rt={class:"row items-center"},it=u("div",{class:"col-12 col-md-8"},[u("div",{class:"text-h6 text-weight-bold"},"Pending Release Details")],-1),ct={key:0,class:"col-12 col-md-4"},ut={class:"row"},dt={class:"col-12 col-md-4"},mt={class:"text-body2"},ft={class:"col-12 col-md-8"},vt={key:1,class:"text-body2 text-weight-light"},yt={class:"text-body1 text-weight-bold q-mb-xs"},gt={class:"text-body2 text-italic text-primary q-pl-md"};function ht(e,l,n,i,c,v){return f(),k("div",null,[h(le,{class:"text-dark"},{default:y(()=>[h(M,{class:"q-pb-sm"},{default:y(()=>[u("div",rt,[it,e.release?(f(),k("div",ct,[h(oe,{align:"left"},{default:y(()=>[h(B,{size:"md",flat:"",dense:"",round:"",icon:"visibility",color:"info",to:{name:"view-release",params:{id:e.release[3]}}},null,8,["to"])]),_:1})])):w("",!0)])]),_:1}),(f(!0),k(W,null,Ie(e.releaseDetails,a=>(f(),k(W,{key:a},[a.type!=="comments"?(f(),q(M,{key:0,class:"q-py-sm"},{default:y(()=>[u("div",ut,[u("div",dt,[u("div",mt,I(a.label),1)]),u("div",ft,[a.type==="rating"?(f(),q(nt,{key:0,modelValue:a.value,"onUpdate:modelValue":r=>a.value=r,max:"5",size:"sm",color:"accent",icon:"star_border","icon-selected":"star","icon-half":"star_half","no-dimming":"",readonly:""},null,8,["modelValue","onUpdate:modelValue"])):(f(),k("div",vt,I(a.value),1))])])]),_:2},1024)):a.value!==""?(f(),q(M,{key:1},{default:y(()=>[u("div",yt,I(a.label),1),u("div",gt,I(a.value),1)]),_:2},1024)):w("",!0)],64))),128))]),_:1})])}var bt=j(st,[["render",ht]]);const pt=P({components:{LocationAndManager:lt,EmployeeJobDetails:Fe,PendingReleaseDetails:bt},setup(){const e=we(),{getEmployee:l,getAssignmentsByEmployee:n,setAssignmentsByEmployee:i}=Y(),c=d(()=>l(e.params.id)),v=d(()=>c.value?n(c.value[3]):null),a=async()=>{if(!v.value&&c.value[577]){const{data:r}=await N.fetchFromHiringApp({fields:[ne({type:"assignments",query:"",id:c.value[577]})]});console.log(r),i({id:c.value[3],data:r})}};return Ve(c,(r,b)=>{r&&a()}),{employee:c,assignment:v}}}),$t={class:"q-px-sm q-py-md"},_t={class:"row"},St={class:"col-12 col-md-6 q-px-xs"},At={key:1},kt={key:0};function qt(e,l,n,i,c,v){const a=R("location-and-manager"),r=R("employee-job-details"),b=R("pending-release-details");return f(),q(De,{style:{"max-width":"100vw"}},{default:y(()=>[u("div",$t,[u("div",_t,[u("div",St,[e.employee&&e.employee[408]==="Active"?(f(),q(a,{key:0,employee:e.employee,assignment:e.assignment},null,8,["employee","assignment"])):w("",!0),e.employee&&e.assignment?(f(),k("div",At,[e.assignment[21]==="In Process"?(f(),q(r,{key:0,class:"q-mt-md",assignment:e.assignment,employee:e.employee},null,8,["assignment","employee"])):w("",!0)])):w("",!0)]),u("div",{class:Qe(["col-12 col-md-6 q-px-xs",(e.employee&&e.employee[581],"")])},[e.employee&&e.employee[581]?(f(),k("div",kt,[h(b,{employee:e.employee},null,8,["employee"])])):w("",!0)],2)])]),h(Ue,{position:"bottom-right",offset:[18,18]},{default:y(()=>[h(B,{fab:"",icon:"close",color:"accent",onClick:l[0]||(l[0]=S=>e.$router.push({name:"employees"}))})]),_:1})]),_:1})}var Jt=j(pt,[["render",qt]]);export{Jt as default};
