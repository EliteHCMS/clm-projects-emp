import{Q as F}from"./QSpace.bdccd3c8.js";import{bX as te,c as p,h as g,bY as ae,dp as oe,c2 as ie,r as v,d1 as ue,dq as de,w as R,o as ce,bQ as H,bW as C,g as fe,cQ as me,bV as be,aT as ve,A as M,B as N,d as a,br as l,cE as pe,D as _,G as W,a8 as x,ac as $,cH as ge,cF as we,ax as T,bR as G,bP as j}from"./index.4017ca31.js";import{Q as X}from"./QTooltip.1e7f358f.js";import{Q as J}from"./QTd.a5677bd1.js";import{Q as K}from"./QSelect.f649ca34.js";import{Q as he}from"./QList.5e1c5b15.js";import{Q as _e}from"./QMenu.f2054918.js";import{u as ye}from"./use-quasar.5edd4060.js";import{e as Be}from"./export-file.dc78ba05.js";import{u as Se,I as qe,b as xe,q as Z}from"./quickbase.4804bb81.js";import{dayjs as Ce}from"./dayjs.01a1f0cd.js";import{_ as Qe}from"./hiringTabs.fe0b7ac9.js";import{_ as ke}from"./officeSelector.67dda656.js";import{_ as De}from"./aTable.d62af6a4.js";import{u as ee}from"./useQuerySaver.d29ff9ee.js";import"./api.a5c07642.js";import{l as Pe}from"./socketListener.12a9dfa2.js";import"./position-engine.9b406c07.js";import"./selection.238bfdbe.js";import"./QChip.4797ac30.js";import"./rtl.b51694b1.js";import"./_commonjsHelpers.a26ce4be.js";import"./index.04bc0a32.js";import"./localForage.8295c071.js";import"./i18n.c0a86e49.js";import"./QBadge.ce8a835b.js";import"./QRouteTab.8feae228.js";import"./QTabs.e985372c.js";import"./QResizeObserver.1fc8b5d0.js";import"./QTable.cf3c1214.js";import"./QMarkupTable.73ed5d05.js";import"./use-fullscreen.61aac10e.js";var Ve=te({name:"QBtnGroup",props:{unelevated:Boolean,outline:Boolean,flat:Boolean,rounded:Boolean,square:Boolean,push:Boolean,stretch:Boolean,glossy:Boolean,spread:Boolean},setup(e,{slots:i}){const u=p(()=>{const c=["unelevated","outline","flat","rounded","square","push","stretch","glossy"].filter(f=>e[f]===!0).map(f=>`q-btn-group--${f}`).join(" ");return`q-btn-group row no-wrap${c.length>0?" "+c:""}`+(e.spread===!0?" q-btn-group--spread":" inline")});return()=>g("div",{class:u.value},ae(i.default))}});const Ae=Object.keys(oe),Ie=e=>Ae.reduce((i,u)=>{const c=e[u];return c!==void 0&&(i[u]=c),i},{});var $e=te({name:"QBtnDropdown",props:{...oe,...ie,modelValue:Boolean,split:Boolean,dropdownIcon:String,contentClass:[Array,String,Object],contentStyle:[Array,String,Object],cover:Boolean,persistent:Boolean,noRouteDismiss:Boolean,autoClose:Boolean,menuAnchor:{type:String,default:"bottom end"},menuSelf:{type:String,default:"top end"},menuOffset:Array,disableMainBtn:Boolean,disableDropdown:Boolean,noIconAnimation:Boolean,toggleAriaLabel:String},emits:["update:modelValue","click","beforeShow","show","beforeHide","hide"],setup(e,{slots:i,emit:u}){const{proxy:c}=fe(),f=v(e.modelValue),d=v(null),Q=ue(),k=p(()=>{const t={"aria-expanded":f.value===!0?"true":"false","aria-haspopup":"true","aria-controls":Q,"aria-label":e.toggleAriaLabel||c.$q.lang.label[f.value===!0?"collapse":"expand"](e.label)};return(e.disable===!0||e.split===!1&&e.disableMainBtn===!0||e.disableDropdown===!0)&&(t["aria-disabled"]="true"),t}),L=p(()=>"q-btn-dropdown__arrow"+(f.value===!0&&e.noIconAnimation===!1?" rotate-180":"")+(e.split===!1?" q-btn-dropdown__arrow-container":"")),y=p(()=>de(e)),w=p(()=>Ie(e));R(()=>e.modelValue,t=>{d.value!==null&&d.value[t?"show":"hide"]()}),R(()=>e.split,q);function b(t){f.value=!0,u("beforeShow",t)}function D(t){u("show",t),u("update:modelValue",!0)}function m(t){f.value=!1,u("beforeHide",t)}function B(t){u("hide",t),u("update:modelValue",!1)}function P(t){u("click",t)}function S(t){me(t),q(),u("click",t)}function V(t){d.value!==null&&d.value.toggle(t)}function A(t){d.value!==null&&d.value.show(t)}function q(t){d.value!==null&&d.value.hide(t)}return Object.assign(c,{show:A,hide:q,toggle:V}),ce(()=>{e.modelValue===!0&&A()}),()=>{const t=[g(H,{class:L.value,name:e.dropdownIcon||c.$q.iconSet.arrow.dropdown})];return e.disableDropdown!==!0&&t.push(g(_e,{ref:d,id:Q,class:e.contentClass,style:e.contentStyle,cover:e.cover,fit:!0,persistent:e.persistent,noRouteDismiss:e.noRouteDismiss,autoClose:e.autoClose,anchor:e.menuAnchor,self:e.menuSelf,offset:e.menuOffset,separateClosePopup:!0,transitionShow:e.transitionShow,transitionHide:e.transitionHide,transitionDuration:e.transitionDuration,onBeforeShow:b,onShow:D,onBeforeHide:m,onHide:B},i.default)),e.split===!1?g(C,{class:"q-btn-dropdown q-btn-dropdown--simple",...w.value,...k.value,disable:e.disable===!0||e.disableMainBtn===!0,noWrap:!0,round:!1,onClick:P},{default:()=>ae(i.label,[]).concat(t),loading:i.loading}):g(Ve,{class:"q-btn-dropdown q-btn-dropdown--split no-wrap q-btn-item",rounded:e.rounded,square:e.square,...y.value,glossy:e.glossy,stretch:e.stretch},()=>[g(C,{class:"q-btn-dropdown--current",...w.value,disable:e.disable===!0||e.disableMainBtn===!0,noWrap:!0,round:!1,onClick:S},{default:i.label,loading:i.loading}),g(C,{class:"q-btn-dropdown__arrow-container q-anchor--skip",...k.value,...y.value,disable:e.disable===!0||e.disableDropdown===!0,rounded:e.rounded,color:e.color,textColor:e.textColor,dense:e.dense,size:e.size,padding:e.padding,ripple:e.ripple},()=>t)])}}});const Te={class:"q-pa-md"},je={class:"row items-center"},He={class:"col-12 col-md-5 q-px-sm"},Le={class:"col-12 col-md-3 q-px-sm"},Oe={class:"col-12 col-md-5 q-px-sm"},Me={key:0},Ne={key:1},_t={__name:"index",setup(e){const i=ye(),{notificationService:u}=Pe,{userOffices:c,getUser:f}=Se(),d=qe(),{openWindow:Q}=xe(),{fetchProfiles:k,fetchAllProfiles:L,setProfiles:y}=d,{getProfiles:w,getSelectedOffice:b,getLoadingState:D}=be(d),m=v(b.value?b.value[8]:null),B=v("Profiles"),P=v("profiles"),S=v(""),V=v({sortBy:"1",descending:!1,rowsPerPage:150}),A=async o=>{const{data:n}=await Z.fetchFromHiringApp({fields:[ee({type:"profiles",useQuery:{id:o}})]});return{id:o,data:n}},q=async o=>{if(o||w.value().length===0)if(m.value){const{data:n}=await Z.fetchFromHiringApp({fields:[ee({type:"profiles",useQuery:{id:m.value}})]});console.log(n),y({selectedId:m.value,data:n})}else{const n=[];c().forEach(h=>{const re=A(h[8]);n.push(re)});const Y=(await Promise.allSettled(n)).map(h=>h.value);console.log(Y),Y.forEach(h=>{y({selectedId:h.id,data:h.data})})}else return w.value(m.value)},t=o=>{m.value?k({selectedId:m.value,refresh:o}):L({can:"read",refresh:o})};t(),R(b,()=>{m.value=b.value?b.value[8]:null,t()});const le=v(new Date),ne=setInterval(()=>{le.value=new Date},1e3);ve(()=>{clearInterval(ne)});const se=p(()=>["index","submissionTime","name","phoneNumber","craft","latestScore","employmentStatus","action",...b.value?[]:["office"]]),O=p(()=>[{name:"index",align:"left",label:"#",sortable:!1},{name:"submissionTime",align:"left",label:"Time",field:"78",sortable:!1},{name:"name",align:"left",label:"Name",field:"24",sortable:!1},{name:"phoneNumber",align:"center",label:"Phone Number",field:"25",sortable:!1},{name:"craft",align:"center",label:"Craft",field:"52",sortable:!1},{name:"latestScore",align:"center",label:"Latest Score",field:"155",sortable:!1},{name:"employmentStatus",align:"center",label:"Employment Status",field:"56",sortable:!1},{name:"office",align:"center",label:"Office",field:"191",sortable:!1},{name:"action",align:"center",label:"",sortable:!1}]),I=p(()=>w.value(m.value).filter(o=>!0).sort((o,n)=>V.value.descending?o[1].isBefore(n[1]):o[1].isAfter(n[1]))),E=(o,n,s)=>{let r=n!==void 0?n(o,s):o;return r=r==null?"":String(r),r=r.split('"').join('""'),`"${r}"`},U=o=>{console.log(o),Q(null,{url:`https://elitehcms.quickbase.com/db/bpzpy6n3x?a=dbpage&pageID=2&ee=${o[3]}`,name:"View Profile"})},z=()=>{const o=[O.value.map(s=>E(s.label))].concat(I.value.map(s=>O.value.map(r=>E(typeof r.field=="function"?r.field(s):s[r.field===void 0?r.name:r.field],r.format,s)).join(","))).join(`\r
`);Be(`${B.value} ${Ce().format("MM.DD.YYYY")}.csv`,o,"text/csv")!==!0&&i.notify({message:"Browser denied file download...",color:"negative",icon:"warning"})};return u.on("created",({officeId:o,title:n})=>{n==="profilesUpdated"&&o&&t(!0)}),(o,n)=>(M(),N("div",Te,[a(Qe),a(ge,{flat:"",class:"q-pt-none"},{default:l(()=>[a(pe,null,{default:l(()=>[_("div",je,[_("div",He,[_("div",{class:W(["text-dark",x(i).screen.lt.md?"text-body1":"text-h5"])},$(B.value),3)]),a(F),_("div",Le,[a(ke,{styleSelection:!0})])])]),_:1})]),_:1}),a(De,{rows:I.value,columns:O.value,pagination:V.value,filter:S.value,title:B.value,separator:"vertical","row-key":"3",loading:x(D)(P.value),"visible-columns":se.value,downloadButton:!0,onDownload:z},{top:l(()=>[_("div",Oe,[a(we,{dense:x(i).screen.lt.md,modelValue:S.value,"onUpdate:modelValue":n[0]||(n[0]=s=>S.value=s),label:"Search...",clearable:""},{prepend:l(()=>[a(H,{name:"search"})]),_:1},8,["dense","modelValue"])]),a(F),_("div",{class:W(["text-dark text-caption text-italic",x(i).screen.lt.md?"offset-xs-5":""])},"(Total: "+$(I.value.length)+")",3),a(C,{flat:"",round:"",color:"primary",icon:"download",disable:I.value.length<1,onClick:z},{default:l(()=>[a(X,{class:"bg-accent text-black shadow-4",offset:[10,10]},{default:l(()=>[T(" Download ")]),_:1})]),_:1},8,["disable"]),a(C,{flat:"",round:"",color:"primary",icon:"refresh",onClick:n[1]||(n[1]=s=>q(!0)),loading:x(D)(P.value)},{default:l(()=>[a(X,{class:"bg-accent text-black shadow-4",offset:[10,10]},{default:l(()=>[T(" Refresh ")]),_:1})]),_:1},8,["loading"])]),"body-cell-submissionTime":l(s=>[a(J,{props:s},{default:l(()=>[o.$dayjs(s.value).isValid()?(M(),N("div",Me,$(s.value.format("L LT")),1)):(M(),N("div",Ne,$(s.row[1].format("L LT")),1))]),_:2},1032,["props"])]),"body-cell-action":l(s=>[a(J,{props:s},{default:l(()=>[a($e,{split:"",color:"primary",label:"View Profile","menu-anchor":"bottom right",onClick:r=>U(s.row),size:".75rem"},{default:l(()=>[a(he,{class:"text-primary",separator:"",bordered:""},{default:l(()=>[a(G,{clickable:"",onClick:r=>U(s.row)},{default:l(()=>[a(j,{avatar:""},{default:l(()=>[a(H,{name:"person"})]),_:1}),a(j,null,{default:l(()=>[a(K,null,{default:l(()=>[T("CEM View Profile")]),_:1})]),_:1})]),_:2},1032,["onClick"]),a(G,{clickable:"",to:{name:"ee-hiring",params:{id:s.row[3]}}},{default:l(()=>[a(j,{avatar:""},{default:l(()=>[a(H,{name:"badge"})]),_:1}),a(j,null,{default:l(()=>[a(K,null,{default:l(()=>[T("Full Employee")]),_:1})]),_:1})]),_:2},1032,["to"])]),_:2},1024)]),_:2},1032,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","columns","pagination","filter","title","loading","visible-columns"])]))}};export{_t as default};
