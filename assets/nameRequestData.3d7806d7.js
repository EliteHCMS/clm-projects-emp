import{Q as h}from"./QTd.d2ccd994.js";import{l as D,r as E,w as T,_ as Q,A as m,B as f,d as l,br as r,ax as g,bW as p,ar as w,c as A,y as z,b5 as R,D as _,bQ as B,ac as V}from"./index.d4eae66d.js";import{Q as I}from"./QTable.12045531.js";import{u as S}from"./use-quasar.bcab4131.js";import{dayjs as N}from"./dayjs.623dcd01.js";import{Q as L}from"./QSpinnerGears.d4624378.js";import{Q as $}from"./QTooltip.642cbb8f.js";import{q as k}from"./app.613d4acb.js";import{u as C}from"./useQuerySaver.d29ff9ee.js";import{workday as G}from"./workday.11468253.js";import{a as P,s as X}from"./syncEmployeeWithWorkday.826834d5.js";import{u as Y}from"./dataStore.1c488d7d.js";const F=D({emits:["viewEmployee"],props:{data:Object,type:String,query:String},setup(t){const s=S(),{getEmployee:c,setEmployees:u}=Y(),a=E(null),d=E(!0);async function i(){if(t.data[39]&&t.data[39]!==""){if(c(t.data[39]))a.value=c([t.data[39]]);else{const{data:n}=await k.fetchFromHiringApp({fields:[C({type:t.type,query:`{'3'.EX.'${t.data[39]}'}`})]});a.value=n[0],u({id:a.value[3],data:a.value})}d.value=!1}else{const{data:n}=await k.fetchFromHiringApp({fields:[C({type:t.type,query:t.query})]});d.value=!1,n.length>0&&(n.length===1?a.value=n[0]:a.value=n.find(e=>e[24].toLowerCase().includes(t.data.firstName)||e[24].toLowerCase().includes(t.data.lastName)?e:null)),a.value&&(k.upsertRecordsXML({to:"bsg4yb4wa",data:[{3:{value:t.data[3]},39:{value:a.value[3]}}],fieldsToReturn:[3]}),u({id:a.value[3],data:a.value}))}}T(a,async n=>{if(n[408]==="Active"&&n[378]&&n[378]!==""&&!n[207]){const e={workerId:n[378]},{data:q}=await G.getWorker(e);let y,b=null;if(q.length>0?y=q[0]:y=null,y){const v=await P({workday:y,clm:a.value});v.employmentData?b=v.employmentData.workerStatus.active:v.sync.employmentData?b=v.sync.employmentData.workerStatus.active:b=!1}y&&!b&&(a.value=await X({workday:y,clm:a.value}))}});const o=()=>{s.notify({type:"negative",message:"This feature is not ready yet."})};return i(),{record:a,loading:d,viewEmployee:o}}}),H={key:0},M={key:1},W={key:0},j={key:1},J={key:2},O={key:3};function K(t,s,c,u,a,d){return m(),f("div",null,[t.loading?(m(),f("div",H,[l(L,{size:"2em",color:"info"})])):(m(),f("div",M,[t.record&&(t.record[408]===""||t.record[408]==="Terminated")&&t.record[421]?(m(),f("div",W,[l(p,{class:"table-button",size:"xs",color:"positive",label:"Available",onClick:s[0]||(s[0]=i=>t.$emit("viewEmployee",t.record))},{default:r(()=>[l($,{anchor:"center left",self:"center end",class:"bg-positive"},{default:r(()=>[g("Click to view this employee.")]),_:1})]),_:1})])):w("",!0),t.record&&t.record[408]==="Terminated"&&!t.record[421]?(m(),f("div",j,[l(p,{class:"table-button",size:"xs",color:"negative",label:"Not Eligible",onClick:s[1]||(s[1]=i=>t.$emit("viewEmployee",t.record))},{default:r(()=>[l($,{anchor:"center left",self:"center end",class:"bg-negative"},{default:r(()=>[g("Click to view this employee.")]),_:1})]),_:1})])):w("",!0),t.record&&t.record[408]==="Active"?(m(),f("div",J,[l(p,{class:"table-button",size:"xs",color:"accent",label:"Active Employee",onClick:s[2]||(s[2]=i=>t.$emit("viewEmployee",t.record))},{default:r(()=>[l($,{anchor:"center left",self:"center end",class:"bg-accent"},{default:r(()=>[g("Click to view this employee.")]),_:1})]),_:1})])):w("",!0),t.record?w("",!0):(m(),f("div",O,[l(p,{class:"table-button",disable:"",size:"xs",color:"info",label:"Nothing Found"},{default:r(()=>[l($,{anchor:"center left",self:"center end",class:"bg-info"},{default:r(()=>[g("No employee to view.")]),_:1})]),_:1})]))]))])}var U=Q(F,[["render",K],["__scopeId","data-v-2d950db8"]]);const Z=D({emits:["refreshData","viewEmployee"],props:{requests:Array,status:String,loading:Boolean},components:{GetEmployee:U},setup(t,{emit:s}){const c=S(),{capitalize:u}=z,a=A(()=>c.screen.gt.sm?[{name:0,label:"",align:"left",field:""},{name:1,label:"Request ID",align:"left",field:e=>e[18],format:e=>`${e}`,sortable:!1,required:!0},{name:2,label:"Created",align:"left",field:e=>e[1],format:e=>`${o(e)}`,sortable:!0},{name:3,label:"Name",align:"left",field:e=>d(e),format:e=>`${e}`,sortable:!0},{name:4,label:"Phone",align:"left",field:e=>e[8],format:e=>`${e}`,sortable:!1,required:!0},{name:7,label:"Job",align:"left",field:e=>e[24],format:e=>`${e}`},{name:5,label:"Status",align:"left",field:e=>i(e),format:e=>`${e}`},{name:6,label:"",align:"center",field:""}]:[{name:0,label:"",align:"left",field:""},{name:1,label:"Request ID",align:"left",field:e=>e[18],format:e=>`${e}`,sortable:!1,required:!0},{name:2,label:"Created",align:"left",field:e=>e[1],format:e=>`${o(e)}`,sortable:!0},{name:3,label:"Name",align:"left",field:e=>d(e),format:e=>`${e}`,sortable:!0},{name:4,label:"Phone",align:"left",field:e=>e[8],format:e=>`${e}`,sortable:!1,required:!0},{name:7,label:"Job",align:"left",field:e=>e[24],format:e=>`${e}`},{name:5,label:"Status",align:"left",field:e=>i(e),format:e=>`${e}`},{name:6,label:"",align:"center",field:""}]);function d(e){return`${u(e[6].toLowerCase())} ${u(e[7].toLowerCase())}`}function i(e){return e.employee[0]===void 0?e[10]:e.employee[0][408]==="Terminated"&&!e.employee[0][421]?"Not Eligible":e.employee[0][552]===""?e[10]:e.employee[0][552]}function o(e){if(e.$d)return N(e.$d).fromNow();if(e.date)return N(e.date,"MM-DD-YYYY").fromNow()}return{columns:a,props:t,viewEmployee:e=>{s("viewEmployee",e)}}}}),x={class:"full-width row flex-center text-primary q-gutter-sm q-py-md"};function ee(t,s,c,u,a,d){const i=R("get-employee");return m(),f("div",null,[l(I,{columns:t.columns,rows:t.requests,"row-key":o=>o[3],class:"q-pa-sm",pagination:{rowsPerPage:10},"table-header-class":"bg-dark text-white","no-data-label":"There are no named requests",dense:"",loading:t.loading},{"header-cell-0":r(()=>[l(h,{"auto-width":""})]),"body-cell-0":r(o=>[l(h,{class:"text-center","auto-width":""},{default:r(()=>[l(i,{data:o.row,onViewEmployee:t.viewEmployee,type:"employee",query:`{'27'.EX.'${o.row[29]}'}AND{'551'.EX.'${o.row[16]}'}`},null,8,["data","onViewEmployee","query"])]),_:2},1024)]),"body-cell-6":r(o=>[l(h,{class:"text-center","auto-width":""},{default:r(()=>[l(p,{class:"q-pa-none q-ma-none",flat:"",color:"primary",round:"",dense:"",onClick:n=>t.$emit("removeName",o.row),icon:"delete_forever"},null,8,["onClick"])]),_:2},1024)]),"no-data":r(({message:o})=>[_("div",x,[l(B,{size:"2em",name:"fa-solid fa-person-circle-exclamation"}),_("span",null,V(o),1)])]),"top-right":r(()=>[l(p,{color:"secondary",flat:"","icon-right":"refresh",label:"Refresh",onClick:s[0]||(s[0]=o=>t.$emit("refreshData"))})]),_:1},8,["columns","rows","row-key","loading"])])}var ce=Q(Z,[["render",ee]]);export{ce as N};
