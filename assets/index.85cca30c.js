import{Q as W}from"./QSpace.15c1fb5a.js";import{bX as te,c as p,h as g,bY as ae,du as oe,c2 as ie,r as v,d8 as ue,dv as de,w as R,o as ce,bQ as L,bW as x,g as fe,cw as me,bV as be,aT as ve,A as M,B as N,d as a,br as l,cT as pe,D as _,G as F,a8 as C,ac as $,cS as ge,cU as we,ax as T,bR as G,bP as j}from"./index.a51a9ba1.js";import{Q as X}from"./QTooltip.334c8c40.js";import{Q as J}from"./QTd.72160b60.js";import{Q as K}from"./QSelect.a6ef019d.js";import{Q as he}from"./QList.5aed4ffe.js";import{Q as _e}from"./QMenu.90a16634.js";import{u as Se}from"./use-quasar.8b995f55.js";import{e as ye}from"./export-file.dc78ba05.js";import{u as Be,c as qe,b as Ce,q as Z}from"./app.b4a21019.js";import{dayjs as xe}from"./dayjs.1511c796.js";import{_ as Qe}from"./hiringTabs.9e41fa03.js";import{_ as ke}from"./officeSelector.dd1fc719.js";import{_ as De}from"./aTable.024ca58c.js";import{u as ee}from"./useQuerySaver.d29ff9ee.js";import"./api.d8a38fed.js";import{l as Pe}from"./socketListener.9366ba19.js";import"./position-engine.f0083cc9.js";import"./selection.9da62c6e.js";import"./QChip.fb49d412.js";import"./rtl.b51694b1.js";import"./_commonjsHelpers.a26ce4be.js";import"./localForage.ba8ccf49.js";import"./index.04bc0a32.js";import"./i18n.e1fd093e.js";import"./QBadge.1775feb4.js";import"./QRouteTab.85e4e7b3.js";import"./QTabs.e1536cf5.js";import"./QResizeObserver.27558595.js";import"./QTable.e1da6cc4.js";import"./QMarkupTable.a298530c.js";import"./use-fullscreen.551537c7.js";var Ve=te({name:"QBtnGroup",props:{unelevated:Boolean,outline:Boolean,flat:Boolean,rounded:Boolean,square:Boolean,push:Boolean,stretch:Boolean,glossy:Boolean,spread:Boolean},setup(e,{slots:i}){const u=p(()=>{const c=["unelevated","outline","flat","rounded","square","push","stretch","glossy"].filter(f=>e[f]===!0).map(f=>`q-btn-group--${f}`).join(" ");return`q-btn-group row no-wrap${c.length!==0?" "+c:""}`+(e.spread===!0?" q-btn-group--spread":" inline")});return()=>g("div",{class:u.value},ae(i.default))}});const Ae=Object.keys(oe),Ie=e=>Ae.reduce((i,u)=>{const c=e[u];return c!==void 0&&(i[u]=c),i},{});var $e=te({name:"QBtnDropdown",props:{...oe,...ie,modelValue:Boolean,split:Boolean,dropdownIcon:String,contentClass:[Array,String,Object],contentStyle:[Array,String,Object],cover:Boolean,persistent:Boolean,noRouteDismiss:Boolean,autoClose:Boolean,menuAnchor:{type:String,default:"bottom end"},menuSelf:{type:String,default:"top end"},menuOffset:Array,disableMainBtn:Boolean,disableDropdown:Boolean,noIconAnimation:Boolean,toggleAriaLabel:String},emits:["update:modelValue","click","beforeShow","show","beforeHide","hide"],setup(e,{slots:i,emit:u}){const{proxy:c}=fe(),f=v(e.modelValue),d=v(null),Q=ue(),k=p(()=>{const t={"aria-expanded":f.value===!0?"true":"false","aria-haspopup":"true","aria-controls":Q,"aria-label":e.toggleAriaLabel||c.$q.lang.label[f.value===!0?"collapse":"expand"](e.label)};return(e.disable===!0||e.split===!1&&e.disableMainBtn===!0||e.disableDropdown===!0)&&(t["aria-disabled"]="true"),t}),H=p(()=>"q-btn-dropdown__arrow"+(f.value===!0&&e.noIconAnimation===!1?" rotate-180":"")+(e.split===!1?" q-btn-dropdown__arrow-container":"")),S=p(()=>de(e)),w=p(()=>Ie(e));R(()=>e.modelValue,t=>{d.value!==null&&d.value[t?"show":"hide"]()}),R(()=>e.split,q);function b(t){f.value=!0,u("beforeShow",t)}function D(t){u("show",t),u("update:modelValue",!0)}function m(t){f.value=!1,u("beforeHide",t)}function y(t){u("hide",t),u("update:modelValue",!1)}function P(t){u("click",t)}function B(t){me(t),q(),u("click",t)}function V(t){d.value!==null&&d.value.toggle(t)}function A(t){d.value!==null&&d.value.show(t)}function q(t){d.value!==null&&d.value.hide(t)}return Object.assign(c,{show:A,hide:q,toggle:V}),ce(()=>{e.modelValue===!0&&A()}),()=>{const t=[g(L,{class:H.value,name:e.dropdownIcon||c.$q.iconSet.arrow.dropdown})];return e.disableDropdown!==!0&&t.push(g(_e,{ref:d,id:Q,class:e.contentClass,style:e.contentStyle,cover:e.cover,fit:!0,persistent:e.persistent,noRouteDismiss:e.noRouteDismiss,autoClose:e.autoClose,anchor:e.menuAnchor,self:e.menuSelf,offset:e.menuOffset,separateClosePopup:!0,transitionShow:e.transitionShow,transitionHide:e.transitionHide,transitionDuration:e.transitionDuration,onBeforeShow:b,onShow:D,onBeforeHide:m,onHide:y},i.default)),e.split===!1?g(x,{class:"q-btn-dropdown q-btn-dropdown--simple",...w.value,...k.value,disable:e.disable===!0||e.disableMainBtn===!0,noWrap:!0,round:!1,onClick:P},{default:()=>ae(i.label,[]).concat(t),loading:i.loading}):g(Ve,{class:"q-btn-dropdown q-btn-dropdown--split no-wrap q-btn-item",rounded:e.rounded,square:e.square,...S.value,glossy:e.glossy,stretch:e.stretch},()=>[g(x,{class:"q-btn-dropdown--current",...w.value,disable:e.disable===!0||e.disableMainBtn===!0,noWrap:!0,round:!1,onClick:B},{default:i.label,loading:i.loading}),g(x,{class:"q-btn-dropdown__arrow-container q-anchor--skip",...k.value,...S.value,disable:e.disable===!0||e.disableDropdown===!0,rounded:e.rounded,color:e.color,textColor:e.textColor,dense:e.dense,size:e.size,padding:e.padding,ripple:e.ripple},()=>t)])}}});const Te={class:"q-pa-md"},je={class:"row items-center"},Le={class:"col-12 col-md-5 q-px-sm"},He={class:"col-12 col-md-3 q-px-sm"},Oe={class:"col-12 col-md-5 q-px-sm"},Me={key:0},Ne={key:1},_t={__name:"index",setup(e){const i=Se(),{notificationService:u}=Pe,{userOffices:c,getUser:f}=Be(),d=qe(),{openWindow:Q}=Ce(),{fetchProfiles:k,fetchAllProfiles:H,setProfiles:S}=d,{getProfiles:w,getSelectedOffice:b,getLoadingState:D}=be(d),m=v(b.value?b.value[8]:null),y=v("Profiles"),P=v("profiles"),B=v(""),V=v({sortBy:"1",descending:!1,rowsPerPage:150}),A=async o=>{const{data:n}=await Z.fetchFromHiringApp({fields:[ee({type:"profiles",useQuery:{id:o}})]});return{id:o,data:n}},q=async o=>{if(o||w.value().length===0)if(m.value){const{data:n}=await Z.fetchFromHiringApp({fields:[ee({type:"profiles",useQuery:{id:m.value}})]});console.log(n),S({selectedId:m.value,data:n})}else{const n=[];c().forEach(h=>{const re=A(h[8]);n.push(re)});const z=(await Promise.allSettled(n)).map(h=>h.value);console.log(z),z.forEach(h=>{S({selectedId:h.id,data:h.data})})}else return w.value(m.value)},t=o=>{m.value?k({selectedId:m.value,refresh:o}):H({can:"read",refresh:o})};t(),R(b,()=>{m.value=b.value?b.value[8]:null,t()});const le=v(new Date),ne=setInterval(()=>{le.value=new Date},1e3);ve(()=>{clearInterval(ne)});const se=p(()=>["index","submissionTime","name","phoneNumber","craft","latestScore","employmentStatus","action",...b.value?[]:["office"]]),O=p(()=>[{name:"index",align:"left",label:"#",sortable:!1},{name:"submissionTime",align:"left",label:"Time",field:"78",sortable:!1},{name:"name",align:"left",label:"Name",field:"24",sortable:!1},{name:"phoneNumber",align:"center",label:"Phone Number",field:"25",sortable:!1},{name:"craft",align:"center",label:"Craft",field:"52",sortable:!1},{name:"latestScore",align:"center",label:"Latest Score",field:"155",sortable:!1},{name:"employmentStatus",align:"center",label:"Employment Status",field:"56",sortable:!1},{name:"office",align:"center",label:"Office",field:"191",sortable:!1},{name:"action",align:"center",label:"",sortable:!1}]),I=p(()=>w.value(m.value).filter(o=>!0).sort((o,n)=>V.value.descending?o[1].isBefore(n[1]):o[1].isAfter(n[1]))),U=(o,n,s)=>{let r=n!==void 0?n(o,s):o;return r=r==null?"":String(r),r=r.split('"').join('""'),`"${r}"`},E=o=>{Q(null,{url:`https://elitehcms.quickbase.com/db/bs7qsu6wh?a=dbpage&pageID=6&ee=${o[3]}`,name:"View Profile"})},Y=()=>{const o=[O.value.map(s=>U(s.label))].concat(I.value.map(s=>O.value.map(r=>U(typeof r.field=="function"?r.field(s):s[r.field===void 0?r.name:r.field],r.format,s)).join(","))).join(`\r
`);ye(`${y.value} ${xe().format("MM.DD.YYYY")}.csv`,o,"text/csv")!==!0&&i.notify({message:"Browser denied file download...",color:"negative",icon:"warning"})};return u.on("created",({officeId:o,title:n})=>{n==="profilesUpdated"&&o&&t(!0)}),(o,n)=>(M(),N("div",Te,[a(Qe),a(ge,{flat:"",class:"q-pt-none"},{default:l(()=>[a(pe,null,{default:l(()=>[_("div",je,[_("div",Le,[_("div",{class:F(["text-dark",C(i).screen.lt.md?"text-body1":"text-h5"])},$(y.value),3)]),a(W),_("div",He,[a(ke,{styleSelection:!0})])])]),_:1})]),_:1}),a(De,{rows:I.value,columns:O.value,pagination:V.value,filter:B.value,title:y.value,separator:"vertical","row-key":"3",loading:C(D)(P.value),"visible-columns":se.value,downloadButton:!0,onDownload:Y},{top:l(()=>[_("div",Oe,[a(we,{dense:C(i).screen.lt.md,modelValue:B.value,"onUpdate:modelValue":n[0]||(n[0]=s=>B.value=s),label:"Search...",clearable:""},{prepend:l(()=>[a(L,{name:"search"})]),_:1},8,["dense","modelValue"])]),a(W),_("div",{class:F(["text-dark text-caption text-italic",C(i).screen.lt.md?"offset-xs-5":""])},"(Total: "+$(I.value.length)+")",3),a(x,{flat:"",round:"",color:"primary",icon:"download",disable:I.value.length<1,onClick:Y},{default:l(()=>[a(X,{class:"bg-accent text-black shadow-4",offset:[10,10]},{default:l(()=>[T(" Download ")]),_:1})]),_:1},8,["disable"]),a(x,{flat:"",round:"",color:"primary",icon:"refresh",onClick:n[1]||(n[1]=s=>q(!0)),loading:C(D)(P.value)},{default:l(()=>[a(X,{class:"bg-accent text-black shadow-4",offset:[10,10]},{default:l(()=>[T(" Refresh ")]),_:1})]),_:1},8,["loading"])]),"body-cell-submissionTime":l(s=>[a(J,{props:s},{default:l(()=>[o.$dayjs(s.value).isValid()?(M(),N("div",Me,$(s.value.format("L LT")),1)):(M(),N("div",Ne,$(s.row[1].format("L LT")),1))]),_:2},1032,["props"])]),"body-cell-action":l(s=>[a(J,{props:s},{default:l(()=>[a($e,{split:"",color:"primary",label:"View Profile","menu-anchor":"bottom right",onClick:r=>E(s.row),size:".75rem"},{default:l(()=>[a(he,{class:"text-primary",separator:"",bordered:""},{default:l(()=>[a(G,{clickable:"",onClick:r=>E(s.row)},{default:l(()=>[a(j,{avatar:""},{default:l(()=>[a(L,{name:"person"})]),_:1}),a(j,null,{default:l(()=>[a(K,null,{default:l(()=>[T("CEM View Profile")]),_:1})]),_:1})]),_:2},1032,["onClick"]),a(G,{clickable:"",to:{name:"ee-hiring",params:{id:s.row[3]}}},{default:l(()=>[a(j,{avatar:""},{default:l(()=>[a(L,{name:"badge"})]),_:1}),a(j,null,{default:l(()=>[a(K,null,{default:l(()=>[T("Full Employee")]),_:1})]),_:1})]),_:2},1032,["to"])]),_:2},1024)]),_:2},1032,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","columns","pagination","filter","title","loading","visible-columns"])]))}};export{_t as default};
