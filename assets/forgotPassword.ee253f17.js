import{Q as J}from"./QImg.64a2acc7.js";import{_ as O,c4 as Z,r as g,c as P,w as $,aY as ee,z as u,am as k,bh as l,a6 as s,A as b,d as a,an as i,C as q,c2 as h,aa as v,bE as ae,bD as te,cx as I,b as C,bX as S,ar as se,c6 as z,D as le,cy as re,at as E,c3 as oe}from"./index.8f32f12d.js";import{Q as ne}from"./QForm.0aebbfc2.js";import{Q as ue}from"./QPage.66c1fb9d.js";import{u as ie}from"./use-quasar.a5692936.js";import{c as V,u as M}from"./array.967068df.js";import{u as me}from"./i18n.4811e7d4.js";import{c as de,q as pe}from"./quickbase.8936bef7.js";import{p as ce}from"./VueTelInput.aaa44e80.js";import{_ as ve}from"./languageSelector.defe5a17.js";import{c as fe}from"./carousel.d0c57eca.js";import"./_commonjsHelpers.dfee5925.js";import"./dayjs.22253e14.js";import"./localForage.1af4f1a9.js";import"./index.7dbe61ef.js";import"./api.513a61f9.js";import"./QSelect.129af288.js";import"./QChip.d6e68241.js";import"./QMenu.e618646e.js";import"./position-engine.d72c2bb6.js";import"./selection.758fed1b.js";import"./rtl.65b79c69.js";import"./use-panel.cd5af8ab.js";import"./touch.d8ab472d.js";import"./use-fullscreen.eedfb7ee.js";const ge={key:0,class:"col-md-7 col-lg-8 col-lx-8"},be={class:"col-xs-12 col-sm-12 col-md-5 col-lg-4 col-lx-4 row justify-center items-center"},he={key:0,class:"text-dark"},ye={key:1,class:"text-dark"},xe={key:0,class:"row q-col-gutter-xs"},_e={class:"text-grey-6",tabindex:"4"},we={class:"text-grey-6",tabindex:"5"},Ne={class:"row justify-center"},$e={__name:"forgotPassword",setup(ke){const R=ie(),U=Z(),{t:y}=me(),{currentUserType:j}=de(),m=g(!1),d=g(!1),B=g(10),r=g("username"),o=g("phoneNumber"),f=g(null),F=P(()=>m.value||o.value==="phoneNumber"?V().email(`${y("validEmailIsRequired")}`).nullable():V().email(`${y("validEmailIsRequired")}`).required()),K=P(()=>{if(d.value||o.value==="email")return V().nullable();{const e=new RegExp("^[0-9]{"+B.value+"}","g");return V().matches(e,{excludeEmptyString:!0,message:`${y("validPhoneIsRequired")}`}).required()}}),{value:x,errorMessage:A,meta:H}=M("firstName"),{value:_,errorMessage:D,meta:W}=M("lastName"),{errorMessage:Q,value:p}=M("email",F),{errorMessage:w,value:c}=M("phone",K);j==="QuickBase User"&&U.push("/"),$(Q,e=>{e||p.value===""?d.value=!1:d.value=!0}),$(p,e=>{(!e||e==="")&&(d.value=!1)}),$(w,e=>{e||c.value===""?m.value=!1:m.value=!0}),$(c,e=>{(!e||e==="")&&(m.value=!1)});const X=e=>{f.value=e},Y=e=>{B.value=e},L=P(()=>!(m.value||d.value)),T=async()=>{const e={userType:j,firstName:x.value,lastName:_.value,email:d.value?p.value:null,phoneNumber:m.value?`+${f.value?f.value.dialCode:"1"}${c.value}`:null},{data:t}=await pe.resetPassword(e);if(t.length===0)R.notify({position:"top-right",type:"negative",message:`${y("noUserFoundWithInformation")}`});else{const N=t[0][76];U.push({name:"code-confirmation",query:{...f.value&&m.value&&{p:`${f.value?f.value.dialCode:"1"}${c.value}`},...d.value&&{e:`${p.value}`},rid:N[3],ac:!0,send:!0}})}},G=e=>{r.value==="username"&&!L.value?T():e.preventDefault()};return(e,t)=>{const N=ee("router-link");return u(),k(ue,{class:"window-height window-width row"},{default:l(()=>[s(R).screen.lt.md?i("",!0):(u(),b("div",ge,[a(fe)])),q("div",be,[a(oe,{class:"auth-card",flat:""},{default:l(()=>[a(h,{style:{"padding-left":"30px","padding-right":"30px"}},{default:l(()=>[a(J,{src:"https://cdn.jsdelivr.net/gh/EliteHCMS/assets@latest/public/logo.svg",fit:"scale-down",class:"auth-logo full-width"})]),_:1}),a(h,{class:"text-center auth-description"},{default:l(()=>[o.value==="email"&&r.value==="username"?(u(),b("p",he,v(e.$t("enterEmailSendCode")),1)):i("",!0),o.value==="phoneNumber"&&r.value==="username"?(u(),b("p",ye,v(e.$t("enterPhoneSendCode")),1)):i("",!0)]),_:1}),a(h,null,{default:l(()=>[a(ne,{class:"q-px-sm q-pt-sm",onSubmit:t[7]||(t[7]=ae(()=>{},["prevent"])),onKeyup:te(G,["enter"])},{default:l(()=>[r.value==="username"?(u(),b("div",xe,[a(I,{class:"col-xs-12 col-sm-6 q-pb-lg",clearable:"",outlined:"",modelValue:s(x),"onUpdate:modelValue":t[0]||(t[0]=n=>C(x)?x.value=n:null),type:"text",autocomplete:"given-name",label:e.$t("firstName"),tabindex:"1",name:"firstName",error:!!(s(A)&&s(H).validated),"error-message":s(A)},{prepend:l(()=>[a(S,{name:"person"})]),_:1},8,["modelValue","label","error","error-message"]),a(I,{class:"col-xs-12 col-sm-6",clearable:"",outlined:"",modelValue:s(_),"onUpdate:modelValue":t[1]||(t[1]=n=>C(_)?_.value=n:null),type:"text",autocomplete:"family-name",label:e.$t("lastName"),tabindex:"2",name:"lastName",error:!!(s(D)&&s(W).validated),"error-message":s(D)},{prepend:l(()=>[a(S,{name:"person_outline"})]),_:1},8,["modelValue","label","error","error-message"])])):i("",!0),o.value==="email"&&r.value==="username"?(u(),k(I,{key:1,style:{"padding-bottom":"0px"},clearable:"",outlined:"",modelValue:s(p),"onUpdate:modelValue":t[3]||(t[3]=n=>C(p)?p.value=n:null),type:"email",label:e.$t("email"),tabindex:"3",error:!!s(Q),"error-message":s(Q),readonly:r.value!=="username"},se({prepend:l(()=>[a(S,{name:"email"})]),_:2},[r.value!=="username"?{name:"append",fn:l(()=>[a(z,{round:"",dense:"",flat:"",icon:"edit",onClick:t[2]||(t[2]=n=>{r.value="username"})})])}:void 0]),1032,["modelValue","label","error","error-message","readonly"])):i("",!0),o.value==="phoneNumber"&&r.value==="username"?(u(),k(ce,{key:2,outlined:"",modelValue:s(c),"onUpdate:modelValue":t[4]||(t[4]=n=>C(c)?c.value=n:null),label:e.$t("phoneNumber"),tabindex:"3",onMaxLengthChanged:Y,style:le(s(w)?"padding-bottom: 20px;":"padding-bottom: 0px;"),error:!!s(w),"error-message":s(w),onCountryChanged:X},null,8,["modelValue","label","style","error","error-message"])):i("",!0),a(h,{class:"text-right q-pa-none"},{default:l(()=>[o.value==="email"?(u(),b("a",{key:0,onClick:t[5]||(t[5]=n=>o.value="phoneNumber"),class:"text-grey-6",href:"javascript:void(0);",tabindex:"4"},v(e.$t("usePhoneNumber")),1)):i("",!0),o.value==="phoneNumber"?(u(),b("a",{key:1,onClick:t[6]||(t[6]=n=>o.value="email"),class:"text-grey-6",href:"javascript:void(0);",tabindex:"4"},v(e.$t("useEmail")),1)):i("",!0)]),_:1})]),_:1},8,["onKeyup"])]),_:1}),a(re,{class:"q-px-lg"},{default:l(()=>[r.value==="username"?(u(),k(z,{key:0,unelevated:"",size:"lg",color:"primary",class:"full-width text-white",label:e.$t("resetPassword"),tabindex:"3",disabled:s(L),onClick:T},null,8,["label","disabled"])):i("",!0)]),_:1}),a(h,{class:"text-center q-pa-sm"},{default:l(()=>[q("p",_e,[a(N,{to:"/login",class:"text-grey-6"},{default:l(()=>[E(v(e.$t("returnToLogin")),1)]),_:1})]),q("p",we,[E(v(e.$t("needAnAccountQuestion"))+" ",1),a(N,{to:"/register",class:"text-grey-6"},{default:l(()=>[E(v(e.$t("register")),1)]),_:1})])]),_:1}),a(h,{class:"q-pl-lg q-pa-sm"},{default:l(()=>[q("div",Ne,[a(ve,{dense:"",borderless:""})])]),_:1})]),_:1})])]),_:1})}}};var Je=O($e,[["__scopeId","data-v-a4a59948"]]);export{Je as default};
