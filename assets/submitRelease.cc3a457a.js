import{u as p,q as l}from"./app.65ef9746.js";import{dayjs as f}from"./dayjs.a1ba429d.js";import{u as T}from"./dataStore.7b401b80.js";import{u as L}from"./dataStore.03c8fc46.js";import{k as M}from"./index.90b022bc.js";const P=async({employee:e,assignment:t,effectiveNow:c,values:a,attachments:n,ratings:o,supervisor:s})=>{const{userData:i,getUserType:y}=p(),u=i;u.access&&delete u.access,u.permissions&&delete u.permissions;const R=[{12:{value:a.recommendation},25:{value:e[3]},28:{value:t[3]},30:{value:a.selection[10]},35:{value:t[142]},36:{value:a.effective},38:{value:JSON.stringify(u)},39:{value:y!=="QuickBase User"},60:{value:o.comments?o.comments:""},72:{value:a.equipment.value}}];if(c){const{ee:m,assign:r}=await S({assignment:t,supervisor:s}),{data:v}=await l.upsertRecordsXML({to:"bp3ga39ut",data:R,fieldsToReturn:[37],formatObject:37},{action:"create",type:"release"}),{release:d}=await O({release:v[0][37][3],employee:v[0][37][25],ratings:o,user:u,supervisor:s});if(n.length>0){const{docs:g}=await j({release:d,attachments:n,user:u});return d[70]=g.map(w=>w[12]),{release:d,employee:m,assignment:r,attachments:g}}else return{release:d,employee:m,assignment:r,attachments:[]}}else{const{data:m}=await l.upsertRecordsXML({to:"bp3ga39ut",data:R,fieldsToReturn:[37],formatObject:37},{action:"create",type:"release"});s&&X({assignment:t,supervisor:s});const{release:r}=await O({release:m[0][37][3],employee:m[0][37][25],ratings:o,user:u,supervisor:s});if(n.length>0){const{docs:v}=await j({release:r,attachments:n,user:u});return r[70]=v.map(d=>d[12]),{release:r,employee:e,assignment:t,attachments:v}}else return{release:r,employee:e,assignment:t,attachments:[]}}},O=async({release:e,employee:t,ratings:c,user:a,supervisor:n})=>{const o={6:{value:c.attendance},8:{value:c.attitude},10:{value:c.capability},12:{value:c.promotable},14:{value:c.comments?c.comments:""},16:{value:t},34:{value:e},36:{value:JSON.stringify(a)}};n&&Object.assign(o,{42:{value:n[18]}});const{data:s}=await l.upsertRecordsXML({to:"bqzkbcxup",data:[o],fieldsToReturn:[35],formatObject:35});return{release:s[0][35]}},j=async({release:e,attachments:t,user:c})=>{const a=[];t.forEach(o=>{Object.assign(o,{8:{value:JSON.stringify(c)},9:{value:e[3]},10:{value:e[25]}}),a.push(o)});const{data:n}=await l.upsertRecordsXML({to:"bsstsai5d",data:a,fieldsToReturn:[12],formatObject:12});return{docs:n}},S=async({assignment:e,supervisor:t,id:c})=>{const{removeData:a}=T(),{removeFromRoster:n}=L(),o={3:{value:c||e[3]},21:{value:"Complete"},22:{value:f()},165:{value:"Inactive"}};t&&Object.assign(o,{133:{value:t[3]}});const{data:s}=await l.upsertRecordsXML({to:"bp3gazpqj",data:[o],fieldsToReturn:[110],formatObject:110});return n({id:s[0][110][74],data:s[0]}),a({type:"assignments",key:s[0][110][74],item:s[0][110],storageKey:M.storageAssignments}),{ee:await b({3:{value:s[0][110][18]},79:{value:19}}),assign:s[0][110]}},b=async e=>{const{data:t}=await l.upsertRecordsXML({to:"bp3gb7ng2",data:[e],fieldsToReturn:[549],formatObject:549});return t[0][549]},X=async({assignment:e,supervisor:t})=>{l.upsertRecordsXML({to:"bp3gazpqj",data:[{3:{value:e[3]},133:{value:t[3]}}],fieldsToReturn:[110],formatObject:110})},z=async({release:e,disp:t})=>{const{userData:c}=p(),a=c;a.access&&delete a.access,a.permissions&&delete a.permissions;const n={3:{value:e[3]},42:{value:t.value==="Terminate"?"Reviewed":"Complete"},43:{value:t.value},73:{value:t.value==="Terminate"?"Pending":"Cancelled"},75:{value:JSON.stringify(a)},77:{value:f()}},o=t.value==="Terminate"?19:15,s=await b({3:{value:e[25]},79:{value:o},16:{value:e[35]}}),{data:i}=await l.upsertRecordsXML({to:"bp3ga39ut",data:[n],fieldsToReturn:[37],formatObject:37},{action:"update",type:"release"});return{release:i[0][37],employee:s}},C=async({release:e,fid:t,entryMoment:c,workdayData:a})=>{const{userData:n}=p(),o=t||37,s=n;s.access&&delete s.access,s.permissions&&delete s.permissions;const i=[{3:{value:e[3]},42:{value:"Complete"},73:{value:"Processed"},76:{value:JSON.stringify(s)},78:{value:f(c)||f()},106:{value:a?JSON.stringify(a):""}}];b({3:{value:e[25]},79:{value:""},122:{value:""}});const{data:y}=await l.upsertRecordsXML({to:"bp3ga39ut",data:i,fieldsToReturn:[o],formatObject:o},{action:"update",type:"release"});return{data:y[0][o]}},k=async({release:e,disp:t})=>{const{userData:c}=p(),a=c;a.access&&delete a.access,a.permissions&&delete a.permissions;const n={3:{value:e[3]},42:{value:"Rescinded"},43:{value:"Rescinded"},73:{value:"Not Processed"},75:{value:JSON.stringify(a)},77:{value:f()}};console.log(e);const o={3:{value:e.assignment[3]},21:{value:"In Process"},22:{value:""},165:{value:"Active"},112:{value:!1}};await l.upsertRecordsXML({to:"bp3gazpqj",data:[o],fieldsToReturn:[110],formatObject:110});const s=await b({3:{value:e[25]},79:{value:7},16:{value:e[35]}}),{data:i}=await l.upsertRecordsXML({to:"bp3ga39ut",data:[n],fieldsToReturn:[37],formatObject:37},{action:"update",type:"release"});return{release:i[0][37],employee:s}};export{S as a,z as f,k as r,P as s,C as t};
