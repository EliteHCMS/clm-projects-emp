import{Q as G}from"./QPage.93e19ded.js";import{l as C,r as B,c as m,_ as S,aZ as q,A as s,an as d,bi as u,B as c,D as i,G as A,ab as h,bO as R,ao as Y,H as Z,cw as w,bM as M,d as $,F as I,aY as V,cz as j,cy as K,bk as X,bJ as ee,bH as H,au as te,bI as F,cZ as le,aa as O,aB as z,bL as ae,y as se}from"./index.50a0cfd4.js";import{q as T}from"./quickbase.6e17af23.js";import{u as N}from"./dataStore.dea99bb7.js";import{Q as oe}from"./QInnerLoading.0bb94f29.js";import{dayjs as b}from"./dayjs.e4b3ebad.js";import{u as x}from"./useQuerySaver.ae1b8d62.js";import{E as ie}from"./form-edit-card-section.985c0459.js";import{Q as ne}from"./QRating.4aa66c0a.js";import{Q as re}from"./QList.dce0b541.js";import{d as ue,f as ce}from"./helpers.49ac7e4f.js";import{u as de}from"./index.b2d71d99.js";import{d as me}from"./decode.593c6ccc.js";import"./_commonjsHelpers.a26ce4be.js";import"./index.7dbe61ef.js";import"./localForage.33df9ee0.js";import"./api.6b6c9955.js";import"./i18n.605c18b9.js";import"./QSelect.6392c385.js";import"./QChip.be7dc79b.js";import"./QItemLabel.5e7dbcf4.js";import"./QMenu.f8d1591e.js";import"./position-engine.b7ac0753.js";import"./selection.179cebce.js";import"./rtl.d0f7624c.js";import"./QForm.d099fcde.js";import"./vee-validate.esm.f9625051.js";import"./array.aeb2de70.js";const pe=C({emits:[],props:{item:Object},components:{EditDetailsForm:ie},setup(e,{emit:r}){const n=B(!1),p=m(()=>{const{permission:o}=e.item.editable&&e.item.config?e.item.config:{action:null,subject:null};return o});return{edit:n,permission:p}}}),ve={key:0,class:"row"},fe={class:"col-12 col-md-4"},ye={class:"col-12 col-md-8"};function be(e,r,n,p,o,v){const t=q("edit-details-form");return s(),d(w,Z(e.$attrs,{class:e.$attrs.class||"q-pa-sm"}),{default:u(()=>[e.edit?(s(),d(t,{key:1,type:e.item.label,config:e.item.config,onCancelEdit:r[1]||(r[1]=l=>e.edit=!1)},null,8,["type","config"])):(s(),c("div",ve,[i("div",fe,[i("div",null,[i("span",{class:A(["text-info",e.$q.screen.gt.lg?"text-body2":"text-caption"])},h(e.item.label),3)])]),i("div",ye,[i("div",null,[i("span",{class:A(["text-weight-light",e.$q.screen.gt.lg?"text-body2":"text-caption"])},h(e.item.value===""?"N/A":e.item.value),3),e.item.editable&&e.$can(e.permission.action,e.permission.subject)?(s(),d(R,{key:0,color:"accent",flat:"",dense:"",round:"",icon:"edit",size:"sm",onClick:r[0]||(r[0]=l=>e.edit=!0)})):Y("",!0)])])]))]),_:1},16,["class"])}var J=S(pe,[["render",be]]);const $e=C({components:{CardSectionEditable:J},props:{employee:Object},setup(e){const r=M(),n=B(!0),{getWorkdayData:p,updateViewedEmployees:o,getEmployee:v,getAssignmentsByEmployee:t,setAssignmentsByEmployee:l}=N(),f=m(()=>r.params.id||e.employee[3]),g=m(()=>v(f.value)),a=m(()=>g.value?g.value.currentAssignment?g.value.currentAssignment:t(f.value)?t(f.value):null:null),y=m(()=>{const D=p(f.value);if(D){const{employmentData:W}=D,{positionData:P,workerStatus:Q}=W,{jobProfile:L}=P;return[{label:"Position",value:`${P.positionId} ${P.positionTitle}`},{label:"Job Profile",value:`${L.jobProfileId} - ${L.jobProfileName}`},{label:"Hire Date",value:b(Q.hireDate).format("MM/DD/YYYY")},{label:"Original Hire Date",value:b(Q.originalHireDate).format("MM/DD/YYYY")},{label:"Years Since Last Hire",value:b().diff(Q.hireDate,"year",!0).toFixed(2)}]}else return[]}),_=D=>D[145].$d?b(D[145].$d).format("MM/DD/YYYY"):b(D[1].$d).format("MM/DD/YYYY"),k=D=>D[145].$d?b().diff(D[145].$d,"day"):b().diff(D[1].$d,"day"),E=m(()=>a.value&&g.value[79]===7?[{label:"Project",value:a.value[146]},{label:"Current Location",value:a.value[141]},{label:"Job Title",value:a.value[20]},{label:"Current Supervisor",value:a.value[140]===""?"N/A":a.value[140]},{label:"Arrival Date",value:_(a.value)},{label:"Days on Site",value:`${k(a.value)}`}]:[]),U=m(()=>E.value.concat(y.value));return(async()=>{if(!a.value&&g.value&&g.value[577]){const{data:D}=await T.fetchFromHiringApp({fields:[x({type:"rawAssignments",query:"",id:g.value[577]})]});o({id:g.value[3],dataset:"currentAssignment",data:D}),l({id:g.value[3],data:D}),n.value=!1}else n.value=!1})(),{loading:n,details:U}}}),ge=i("div",{class:"text-h6 text-weight-bold"},"Job Details",-1),_e=i("div",{class:"text-body1 text-primary text-italic"},"Employee has a pending release.",-1);function he(e,r,n,p,o,v){const t=q("card-section-editable");return s(),c("div",null,[$(j,null,{default:u(()=>[$(w,{class:"q-pb-sm"},{default:u(()=>[ge]),_:1}),e.employee[581]?(s(),d(w,{key:0,class:"q-py-sm"},{default:u(()=>[_e]),_:1})):Y("",!0),(s(!0),c(I,null,V(e.details,l=>(s(),c(I,{key:l},[e.loading?Y("",!0):(s(),d(t,{key:0,item:l},null,8,["item"]))],64))),128)),e.loading?(s(),d(w,{key:1,style:{height:"200px"}},{default:u(()=>[$(oe,{showing:"",color:"primary",label:"Loading Details"})]),_:1})):Y("",!0)]),_:1})])}var De=S($e,[["render",he]]);const ke=C({props:{employee:Object},components:{},setup(e){const{getReleases:r,setReleases:n}=N(),p=l=>l[86].$d?b(l[86].$d).format("MM/DD/YYYY"):b(l[62].$d).format("MM/DD/YYYY"),o=m(()=>r(e.employee[581])),v=m(()=>{let l;return o.value&&o.value[3]?l=[{label:"Project",value:o.value[83]},{label:"Location",value:o.value[84]},{label:"Job Title",value:o.value[82]},{label:"Reason",value:o.value[32]},{label:"Arrival Date",value:p(o.value)},{label:"Last Hire Date",value:b(e.employee[397].$d).format("MM/DD/YYYY")},{label:"Last Day On Site",value:b(o.value[36].$d).format("MM/DD/YYYY")},{label:"Returned Equipment",value:o.value[72]?"Yes":"No"},{label:"Pay Deduct Needed",value:!o.value[72]&&b.duration(b(o.value[36].$d).diff(b(e.employee[397].$d))).asDays()<30?"Yes":"No"},{label:"CAAP Rating",value:o.value[59]&&o.value[59].length>0?o.value[59][0][37]:0,type:"rating"},{label:"Submitted By",value:`${o.value[38][35]} ${o.value[38][37]}`},{label:"Submitted On",value:b(o.value[1].$d).tz(b.tz.guess()).format("MM/DD/YYYY hh:mm a")},{label:"Comments",value:o.value[60],type:"comments"}]:l=[],l});return(async()=>{if(!o.value&&e.employee[581]){const{data:l}=await T.fetchFromHiringApp({fields:[x({type:"releases",query:"",id:e.employee[581]})]},{action:"read",type:"release"});n({id:l[3],data:l})}})(),{releaseDetails:v,release:o,downloadFile:ue}}}),we={class:"row items-center"},Ye=i("div",{class:"col-12 col-md-7"},[i("div",{class:"text-h6 text-weight-bold"},"Pending Release Details")],-1),Ie={key:0,class:"col-12 col-md-5"},qe={class:"row"},Ae={class:"col-12 col-md-5"},Ce={class:"text-body2"},Se={class:"col-12 col-md-7"},Ve={key:0},Ee={key:1,class:"text-body2 text-weight-light"},Ne={key:1,class:"text-body2 text-weight-light"},Me={class:"text-body1 text-weight-bold q-mb-xs"},je={class:"text-body2 text-italic text-primary q-pl-md"},Pe=i("div",{class:"text-body1 text-weight-bold q-mb-xs"},"Supporting Docs",-1);function Qe(e,r,n,p,o,v){return s(),c("div",null,[$(j,{class:"text-dark"},{default:u(()=>[$(w,{class:"q-pb-sm"},{default:u(()=>[i("div",we,[Ye,e.release?(s(),c("div",Ie,[$(K,{align:"right"},{default:u(()=>[$(R,{size:"md",flat:"",dense:"",label:"View Release",color:"info",to:{name:"view-ee-release",params:{id:e.release[25],release:e.release[3]}}},null,8,["to"])]),_:1})])):Y("",!0)])]),_:1}),(s(!0),c(I,null,V(e.releaseDetails,t=>(s(),c(I,{key:t},[t.type!=="comments"?(s(),d(w,{key:0,class:"q-py-sm"},{default:u(()=>[i("div",qe,[i("div",Ae,[i("div",Ce,h(t.label),1)]),i("div",Se,[t.type==="rating"?(s(),c("div",Ve,[t.value>0?(s(),d(ne,{key:0,modelValue:t.value,"onUpdate:modelValue":l=>t.value=l,max:"5",size:"sm",color:"accent",icon:"star_border","icon-selected":"star","icon-half":"star_half","no-dimming":"",readonly:""},null,8,["modelValue","onUpdate:modelValue"])):(s(),c("div",Ee,"Not Available"))])):(s(),c("div",Ne,h(t.value),1))])])]),_:2},1024)):t.value!==""?(s(),d(w,{key:1},{default:u(()=>[i("div",Me,h(t.label),1),i("div",je,h(t.value),1)]),_:2},1024)):Y("",!0)],64))),128)),e.release&&e.release[70].length>0?(s(),d(w,{key:0},{default:u(()=>[Pe,$(re,null,{default:u(()=>[(s(!0),c(I,null,V(e.release[70],(t,l)=>X((s(),d(ee,{key:l,clickable:"",class:"text-body2",onClick:f=>e.downloadFile({tableId:"bsstsai5d",recordId:t[3],fieldId:6,versionNumber:1,name:t[7]})},{default:u(()=>[$(H,null,{default:u(()=>[te(h(l+1)+". "+h(t[7]),1)]),_:2},1024),$(H,{avatar:""},{default:u(()=>[$(F,{color:"info",name:"file_download"})]),_:1})]),_:2},1032,["onClick"])),[[le]])),128))]),_:1})]),_:1})):Y("",!0)]),_:1})])}var Be=S(ke,[["render",Qe]]);const Le=C({emits:[],props:{item:Object},components:{},setup(e,{emit:r}){const n=B(!1),{can:p}=de(),o=m(()=>{if(e.item.config){const{permission:t}=e.item.config;return t?p(t.action,t.subject):!0}else return!0});return{visible:n,hasPermission:o,toggleVisibility:()=>{n.value?n.value=!1:(n.value=!0,setTimeout(()=>{n.value=!1},5e3))}}}}),He={key:0},Re={key:1};function Fe(e,r,n,p,o,v){return s(),c("div",null,[e.item.protected?(s(),c("div",He,[e.visible?(s(),c("span",{key:0,class:A(["text-weight-light",e.$q.screen.gt.lg?"text-body2":"text-caption"])},h(e.item.value===""?"N/A":e.item.value),3)):(s(),c("span",{key:1,class:A(["text-weight-light",e.$q.screen.gt.lg?"text-body2":"text-caption"])},h(e.item.hiddenValue===""?"N/A":e.item.hiddenValue),3)),e.hasPermission?(s(),d(F,{key:2,class:"cursor-pointer q-ml-sm",color:"accent",name:e.visible?"visibility_off":"visibility",size:"sm",onClick:e.toggleVisibility},null,8,["name","onClick"])):Y("",!0)])):(s(),c("div",Re,[i("span",{class:A(["text-weight-light",e.$q.screen.gt.lg?"text-body2":"text-caption"])},h(e.item.value===""?"N/A":e.item.value),3)]))])}var Oe=S(Le,[["render",Fe]]);const ze=C({props:{employee:Object},components:{CardSectionValue:Oe},setup(e){const r=M(),{getWorkdayData:n,getEmployee:p}=N(),o=({id:a,idType:y})=>y.includes("J&amp;E")?`${a.slice(1,4)} / ${a.slice(-5)}`:a,v=a=>{const y=a.slice(0,3),_=a.slice(3,5),k=a.slice(-4);return`${y}-${_}-${k}`},t=m(()=>r.params.id||e.employee[3]),l=m(()=>p(t.value));m(()=>{const a=n(t.value);if(a){const{personalData:y}=a,{nationalIDData:_}=y.identificationData?y.identificationData:{nationalIDData:null};if(_){const k=_;return{label:k.idType,value:v(k.id),protected:!0,allowView:!0,hiddenValue:`***-**-${k.id.slice(-4)}`,hideIfBlank:!0,config:{permission:{action:"read",subject:"protectedInformation"}}}}else return null}else return null});const f=m(()=>{let a;return l.value?a=[{label:"Workday ID",value:l.value[378],hideIfBlank:!0},{label:"USA-SSN",value:l.value[109].length===9?v(l.value[109]):"",protected:!0,allowView:!0,hiddenValue:`***-**-${l.value[109].slice(-4)}`,hideIfBlank:!0,config:{permission:{action:"read",subject:"protectedInformation"}}},{label:"CAN-SIN",value:l.value[567]&&l.value[567].length===9?v(l.value[567]):"",protected:!0,allowView:!0,hiddenValue:`***-**-${l.value[567].slice(-4)}`,hideIfBlank:!0,config:{permission:{action:"read",subject:"protectedInformation"}}}]:a=[],a}),g=m(()=>{const a=n(t.value);if(a){const{personalData:y}=a;if(y){const{customIds:_}=y.identificationData?y.identificationData:{customIds:[]};return _}else return[]}else return[]});return{standardIds:f,customIds:g,decodeHTML:me,processCustomID:o}}}),Te=i("div",{class:"text-h6 text-weight-bold"},"IDs",-1),xe={class:"row"},Je={class:"col-12 col-md-4"},Ue={class:"col-12 col-md-8"},We={class:"row"},Ge={class:"col-12 col-md-4"},Ze={class:"col-12 col-md-8"};function Ke(e,r,n,p,o,v){const t=q("card-section-value");return s(),d(j,O(z(e.$attrs)),{default:u(()=>[$(w,{class:"q-pb-sm"},{default:u(()=>[Te]),_:1}),(s(!0),c(I,null,V(e.standardIds,(l,f)=>(s(),c(I,{key:f},[!l.hideIfBlank||l.value!==""?(s(),d(w,{key:0,class:"q-py-sm"},{default:u(()=>[i("div",xe,[i("div",Je,[i("div",{class:A(["text-info",e.$q.screen.gt.lg?"text-body2":"text-caption"])},h(l.label),3)]),i("div",Ue,[$(t,{item:l},null,8,["item"])])])]),_:2},1024)):Y("",!0)],64))),128)),(s(!0),c(I,null,V(e.customIds,(l,f)=>(s(),d(w,{key:f,class:"q-py-sm"},{default:u(()=>[i("div",We,[i("div",Ge,[i("div",{class:A(["text-info",e.$q.screen.gt.lg?"text-body2":"text-caption"])},h(e.decodeHTML(l.idType)),3)]),i("div",Ze,[i("div",{class:A(["text-weight-light",e.$q.screen.gt.lg?"text-body2":"text-caption"])},h(e.processCustomID(l)),3)])])]),_:2},1024))),128))]),_:1},16)}var Xe=S(ze,[["render",Ke]]);const et=C({components:{CardSectionEditable:J},props:{employee:Object},setup(e){ae();const r=M(),{capitalize:n}=se,{updateViewedEmployees:p,getEmployee:o}=N(),v=m(()=>r.params.id||e.employee[3]),t=m(()=>o(v.value)),l=a=>{const y=a.split(" ");let _="";return y.forEach((k,E)=>{_+=E>0?` ${n(k.toLowerCase())}`:n(k.toLowerCase())}),_},f=a=>{const y=a[20]||"",_=a[21]&&a[21]!==""?` ${a[21]}`:"",k=a[22]&&a[22]!==""?` ${a[22]}`:"",E=a[23]&&a[23]!==""?` ${a[23]}`:"";return`${y}${_}${k}${E}`};return{details:m(()=>{let a;return t.value?a=[{label:"Full Name",value:ce(f(t.value))},{label:"Phone",value:t.value[25]},{label:"Email",value:t.value[26]},{label:"Address",value:l(t.value[40])},{label:"Primary Craft",value:t.value[52]},{label:"Hiring Status",value:t.value[80]},{label:"Employment Status",value:t.value[408]}]:a=[],a})}}}),tt=i("div",{class:"text-h6 text-weight-bold"},"Employee Information",-1);function lt(e,r,n,p,o,v){const t=q("card-section-editable");return s(),d(j,O(z(e.$attrs)),{default:u(()=>[$(w,{class:"q-pa-sm"},{default:u(()=>[tt]),_:1}),(s(!0),c(I,null,V(e.details,(l,f)=>(s(),d(t,{key:f,item:l},null,8,["item"]))),128))]),_:1},16)}var at=S(et,[["render",lt]]);const st=C({components:{EmployeeJobDetails:De,PendingReleaseDetails:Be,EmployeeIdentificationCard:Xe,FullEmployeeCard:at},setup(){const e=M(),{getEmployee:r}=N();return{employee:m(()=>r(e.params.id))}}}),ot={class:"q-pa-sm"},it={key:0,class:"row"},nt={class:"col-12 col-md-6 q-px-sm"},rt={class:"col-12 col-md-6 q-px-sm"};function ut(e,r,n,p,o,v){const t=q("full-employee-card"),l=q("employee-identification-card"),f=q("employee-job-details"),g=q("pending-release-details");return s(),d(G,{style:{"max-width":"100vw"}},{default:u(()=>[i("div",ot,[e.employee?(s(),c("div",it,[i("div",nt,[$(t,{employee:e.employee},null,8,["employee"]),$(l,{class:"q-mt-md",employee:e.employee},null,8,["employee"])]),i("div",rt,[e.employee[408]==="Active"&&!e.employee[581]?(s(),d(f,{key:0,employee:e.employee},null,8,["employee"])):Y("",!0),e.employee[408]==="Active"&&e.employee[581]?(s(),d(g,{key:1,employee:e.employee},null,8,["employee"])):Y("",!0)])])):Y("",!0)])]),_:1})}var Lt=S(st,[["render",ut]]);export{Lt as default};
