import{Q as G}from"./QPage.987dae48.js";import{l as S,r as M,c as b,_ as N,A as l,B as d,d as c,bi as u,D as i,ab as D,bO as E,ao as Y,cx as Z,bF as K,aZ as A,an as $,G as V,cw as C,bM as O,F as I,aY as Q,cz as F,cy as X,bk as x,bJ as ee,bH as H,au as te,bI as T,cZ as le,bL as oe,y as se}from"./index.0dddbf49.js";import{q as z}from"./quickbase.c1f7b402.js";import{u as L}from"./dataStore.aa435c1a.js";import{Q as ae}from"./QInnerLoading.220f2c4b.js";import{dayjs as _}from"./dayjs.b650d6a4.js";import{u as J}from"./useQuerySaver.bb1ebf35.js";import{Q as ne}from"./QSelect.af0bdc06.js";import{Q as ie}from"./QForm.ce9e615b.js";import{a as re,u as ue}from"./vee-validate.esm.6ae05c84.js";import{a as de}from"./array.2a69a999.js";import{Q as ce}from"./QRating.9e63dda6.js";import{Q as me}from"./QList.c6e274bc.js";import{d as pe,f as fe}from"./helpers.414648bb.js";import{u as ve}from"./index.d8bc6e7d.js";import{d as ye}from"./decode.593c6ccc.js";import"./_commonjsHelpers.a26ce4be.js";import"./index.7dbe61ef.js";import"./localForage.5c039857.js";import"./i18n.1d81d753.js";import"./api.5ba01119.js";import"./QChip.40f77c99.js";import"./QItemLabel.8751cc33.js";import"./QMenu.bcbd89cc.js";import"./position-engine.67a5d571.js";import"./selection.1ecd6506.js";import"./rtl.cf9bbe47.js";const be=S({emits:["closeEdit"],components:{},props:{config:Object},setup(e,{emit:a}){const n=M(null),m=M(null),o=M(!1),g=async()=>{const{type:v,initialValue:q}=e.config;if(v==="options"){const{getter:j}=e.config;m.value=await j(),n.value=m.value,r.value=q(n.value)}else r.value=q},t=b(()=>de({entry:e.config.formRules})),{meta:s,errors:y,handleSubmit:k}=re({validationSchema:t}),{value:r}=ue("entry"),p=(v,q)=>{const{filter:j}=e.config;v===""&&q(()=>{n.value=m.value}),q(()=>{const w=v.toLowerCase();n.value=j(m.value,w)})},f=v=>{o.value=!1,m.value.push(v),n.value.push(v),r.value=v},h=k(async v=>{const{setter:q}=e.config;await q(v.entry),a("closeEdit")});return g(),{rawOptions:m,options:n,entry:r,formErrors:y,formMeta:s,submit:h,filterOptions:p,addNew:o,newOptionAdded:f}}}),$e={key:0,class:"q-pr-xl"},ge={class:"text-caption"},he={key:0,class:"text-center bg-info"},_e={key:0,class:"text-center bg-info"},De={key:1,class:"q-pr-xl"},ke={class:"text-caption"};function we(e,a,n,m,o,g){return l(),d("div",null,[c(ie,{onSubmit:K(e.submit,["prevent"])},{default:u(()=>[e.config.type==="options"?(l(),d("div",$e,[c(ne,{class:"q-mb-sm",dense:"",label:`Select a ${e.config.fieldLabel}`,"transition-show":"flip-up","transition-hide":"flip-down",modelValue:e.entry,"onUpdate:modelValue":a[3]||(a[3]=t=>e.entry=t),options:e.options,"option-label":e.config.optionLabel,"display-value":`${e.entry?e.entry[e.config.displayValue]:""}`,"bottom-slots":"",error:!!e.formErrors.entry,"stack-label":"","use-input":"","input-debounce":"0",onFilter:e.filterOptions,clearable:"",loading:!e.rawOptions,disable:!e.rawOptions},{error:u(()=>[i("div",ge,D(e.formErrors.entry),1)]),after:u(()=>[c(E,{type:"submit",color:"info",icon:"done",dense:"",onClick:e.submit},null,8,["onClick"]),c(E,{color:"dark",icon:"close",dense:"",onClick:a[0]||(a[0]=t=>e.$emit("closeEdit"))})]),"after-options":u(()=>[e.config.allowNew&&e.options&&e.options.length>0?(l(),d("div",he,[c(E,{flat:"",color:"white",label:`Add a New ${e.config.fieldLabel}`,onClick:a[1]||(a[1]=t=>e.addNew=!0)},null,8,["label"])])):Y("",!0)]),"no-option":u(()=>[e.config.allowNew?(l(),d("div",_e,[c(E,{flat:"",color:"white",label:`Add a New ${e.config.fieldLabel}`,onClick:a[2]||(a[2]=t=>e.addNew=!0)},null,8,["label"])])):Y("",!0)]),_:1},8,["label","modelValue","options","option-label","display-value","error","onFilter","loading","disable"])])):Y("",!0),e.config.type==="input"?(l(),d("div",De,[c(Z,{class:"q-mb-sm",dense:"",label:e.config.fieldLabel,modelValue:e.entry,"onUpdate:modelValue":a[5]||(a[5]=t=>e.entry=t),"bottom-slots":"",error:!!e.formErrors.entry,"stack-label":""},{error:u(()=>[i("div",ke,D(e.formErrors.entry),1)]),after:u(()=>[c(E,{type:"submit",color:"info",icon:"done",dense:"",onClick:e.submit},null,8,["onClick"]),c(E,{color:"dark",icon:"close",dense:"",onClick:a[4]||(a[4]=t=>e.$emit("closeEdit"))})]),_:1},8,["label","modelValue","error"])])):Y("",!0)]),_:1},8,["onSubmit"])])}var Ye=N(be,[["render",we]]);const Ce=S({emits:[],props:{item:Object},components:{EditDetailsForm:Ye},setup(e,{emit:a}){const n=M(!1),m=b(()=>{const{permission:o}=e.item.editable&&e.item.config?e.item.config:{action:null,subject:null};return o});return{edit:n,permission:m}}}),qe={key:0,class:"row"},Ie={class:"col-12 col-md-4"},Ee={class:"col-12 col-md-8"};function Ae(e,a,n,m,o,g){const t=A("edit-details-form");return l(),$(C,{class:"q-py-sm"},{default:u(()=>[e.edit?(l(),$(t,{key:1,type:e.item.label,config:e.item.config,onCancelEdit:a[1]||(a[1]=s=>e.edit=!1)},null,8,["type","config"])):(l(),d("div",qe,[i("div",Ie,[i("div",null,[i("span",{class:V(["text-info",e.$q.screen.gt.lg?"text-body2":"text-caption"])},D(e.item.label),3)])]),i("div",Ee,[i("div",null,[i("span",{class:V(["text-weight-light",e.$q.screen.gt.lg?"text-body2":"text-caption"])},D(e.item.value===""?"N/A":e.item.value),3),e.item.editable&&e.$can(e.permission.action,e.permission.subject)?(l(),$(E,{key:0,color:"accent",flat:"",dense:"",round:"",icon:"edit",size:"sm",onClick:a[0]||(a[0]=s=>e.edit=!0)})):Y("",!0)])])]))]),_:1})}var U=N(Ce,[["render",Ae]]);const Ve=S({components:{CardSectionEditable:U},props:{employee:Object},setup(e){const a=O(),n=M(!0),{getWorkdayData:m,updateViewedEmployees:o,getEmployee:g,getAssignmentsByEmployee:t,setAssignmentsByEmployee:s}=L(),y=b(()=>a.params.id||e.employee[3]),k=b(()=>g(y.value)),r=b(()=>k.value?k.value.currentAssignment?k.value.currentAssignment:t(y.value)?t(y.value):null:null),p=b(()=>{const w=m(y.value);if(w){const{employmentData:W}=w,{positionData:P,workerStatus:R}=W,{jobProfile:B}=P;return[{label:"Position",value:`${P.positionId} ${P.positionTitle}`},{label:"Job Profile",value:`${B.jobProfileId} - ${B.jobProfileName}`},{label:"Hire Date",value:_(R.hireDate).format("MM/DD/YYYY")},{label:"Original Hire Date",value:_(R.originalHireDate).format("MM/DD/YYYY")},{label:"Years Since Last Hire",value:_().diff(R.hireDate,"year",!0).toFixed(2)}]}else return[]}),f=w=>w[145].$d?_(w[145].$d).format("MM/DD/YYYY"):_(w[1].$d).format("MM/DD/YYYY"),h=w=>w[145].$d?_().diff(w[145].$d,"day"):_().diff(w[1].$d,"day"),v=b(()=>r.value?[{label:"Project",value:r.value[146]},{label:"Current Location",value:r.value[141]},{label:"Job Title",value:r.value[20]},{label:"Current Supervisor",value:r.value[140]===""?"N/A":r.value[140]},{label:"Arrival Date",value:f(r.value)},{label:"Days on Site",value:`${h(r.value)}`}]:[]),q=b(()=>v.value.concat(p.value));return(async()=>{if(!r.value&&k.value&&k.value[577]){const{data:w}=await z.fetchFromHiringApp({fields:[J({type:"rawAssignments",query:"",id:k.value[577]})]});o({id:k.value[3],dataset:"currentAssignment",data:w}),s({id:k.value[3],data:w}),n.value=!1}else n.value=!1})(),{loading:n,details:q}}}),Se=i("div",{class:"text-h6 text-weight-bold"},"Job Details",-1),Ne=i("div",{class:"text-body1 text-primary text-italic"},"Employee has a pending release.",-1);function Me(e,a,n,m,o,g){const t=A("card-section-editable");return l(),d("div",null,[c(F,null,{default:u(()=>[c(C,{class:"q-pb-sm"},{default:u(()=>[Se]),_:1}),e.employee[581]?(l(),$(C,{key:0,class:"q-py-sm"},{default:u(()=>[Ne]),_:1})):Y("",!0),(l(!0),d(I,null,Q(e.details,s=>(l(),d(I,{key:s},[e.loading?Y("",!0):(l(),$(t,{key:0,item:s},null,8,["item"]))],64))),128)),e.loading?(l(),$(C,{key:1,style:{height:"200px"}},{default:u(()=>[c(ae,{showing:"",color:"primary",label:"Loading Details"})]),_:1})):Y("",!0)]),_:1})])}var Qe=N(Ve,[["render",Me]]);const Le=S({props:{employee:Object},components:{},setup(e){const{getReleases:a,setReleases:n}=L(),m=s=>s[86].$d?_(s[86].$d).format("MM/DD/YYYY"):_(s[62].$d).format("MM/DD/YYYY"),o=b(()=>a(e.employee[581])),g=b(()=>{let s;return o.value&&o.value[3]?s=[{label:"Project",value:o.value[83]},{label:"Location",value:o.value[84]},{label:"Job Title",value:o.value[82]},{label:"Reason",value:o.value[32]},{label:"Arrival Date",value:m(o.value)},{label:"Last Hire Date",value:_(e.employee[397].$d).format("MM/DD/YYYY")},{label:"Last Day On Site",value:_(o.value[36].$d).format("MM/DD/YYYY")},{label:"Returned Equipment",value:o.value[72]?"Yes":"No"},{label:"Pay Deduct Needed",value:!o.value[72]&&_.duration(_(o.value[36].$d).diff(_(e.employee[397].$d))).asDays()<30?"Yes":"No"},{label:"CAAP Rating",value:o.value[59]&&o.value[59].length>0?o.value[59][0][37]:0,type:"rating"},{label:"Submitted By",value:`${o.value[38][35]} ${o.value[38][37]}`},{label:"Submitted On",value:_(o.value[1].$d).tz(_.tz.guess()).format("MM/DD/YYYY hh:mm a")},{label:"Comments",value:o.value[60],type:"comments"}]:s=[],s});return(async()=>{if(!o.value&&e.employee[581]){const{data:s}=await z.fetchFromHiringApp({fields:[J({type:"releases",query:"",id:e.employee[581]})]},{action:"read",type:"release"});n({id:s[3],data:s})}})(),{releaseDetails:g,release:o,downloadFile:pe}}}),je={class:"row items-center"},Oe=i("div",{class:"col-12 col-md-7"},[i("div",{class:"text-h6 text-weight-bold"},"Pending Release Details")],-1),Fe={key:0,class:"col-12 col-md-5"},Pe={class:"row"},Re={class:"col-12 col-md-5"},Be={class:"text-body2"},He={class:"col-12 col-md-7"},Te={key:0},ze={key:1,class:"text-body2 text-weight-light"},Je={key:1,class:"text-body2 text-weight-light"},Ue={class:"text-body1 text-weight-bold q-mb-xs"},We={class:"text-body2 text-italic text-primary q-pl-md"},Ge=i("div",{class:"text-body1 text-weight-bold q-mb-xs"},"Supporting Docs",-1);function Ze(e,a,n,m,o,g){return l(),d("div",null,[c(F,{class:"text-dark"},{default:u(()=>[c(C,{class:"q-pb-sm"},{default:u(()=>[i("div",je,[Oe,e.release?(l(),d("div",Fe,[c(X,{align:"right"},{default:u(()=>[c(E,{size:"md",flat:"",dense:"",label:"View Release",color:"info",to:{name:"view-ee-release",params:{id:e.release[25],release:e.release[3]}}},null,8,["to"])]),_:1})])):Y("",!0)])]),_:1}),(l(!0),d(I,null,Q(e.releaseDetails,t=>(l(),d(I,{key:t},[t.type!=="comments"?(l(),$(C,{key:0,class:"q-py-sm"},{default:u(()=>[i("div",Pe,[i("div",Re,[i("div",Be,D(t.label),1)]),i("div",He,[t.type==="rating"?(l(),d("div",Te,[t.value>0?(l(),$(ce,{key:0,modelValue:t.value,"onUpdate:modelValue":s=>t.value=s,max:"5",size:"sm",color:"accent",icon:"star_border","icon-selected":"star","icon-half":"star_half","no-dimming":"",readonly:""},null,8,["modelValue","onUpdate:modelValue"])):(l(),d("div",ze,"Not Available"))])):(l(),d("div",Je,D(t.value),1))])])]),_:2},1024)):t.value!==""?(l(),$(C,{key:1},{default:u(()=>[i("div",Ue,D(t.label),1),i("div",We,D(t.value),1)]),_:2},1024)):Y("",!0)],64))),128)),e.release&&e.release[70].length>0?(l(),$(C,{key:0},{default:u(()=>[Ge,c(me,null,{default:u(()=>[(l(!0),d(I,null,Q(e.release[70],(t,s)=>x((l(),$(ee,{key:s,clickable:"",class:"text-body2",onClick:y=>e.downloadFile({tableId:"bsstsai5d",recordId:t[3],fieldId:6,versionNumber:1,name:t[7]})},{default:u(()=>[c(H,null,{default:u(()=>[te(D(s+1)+". "+D(t[7]),1)]),_:2},1024),c(H,{avatar:""},{default:u(()=>[c(T,{color:"info",name:"file_download"})]),_:1})]),_:2},1032,["onClick"])),[[le]])),128))]),_:1})]),_:1})):Y("",!0)]),_:1})])}var Ke=N(Le,[["render",Ze]]);const Xe=S({emits:[],props:{item:Object},components:{},setup(e,{emit:a}){const n=M(!1),{can:m}=ve(),o=b(()=>{if(e.item.config){const{permission:t}=e.item.config;return t?m(t.action,t.subject):!0}else return!0});return{visible:n,hasPermission:o,toggleVisibility:()=>{n.value?n.value=!1:(n.value=!0,setTimeout(()=>{n.value=!1},5e3))}}}}),xe={key:0},et={key:1};function tt(e,a,n,m,o,g){return l(),d("div",null,[e.item.protected?(l(),d("div",xe,[e.visible?(l(),d("span",{key:0,class:V(["text-weight-light",e.$q.screen.gt.lg?"text-body2":"text-caption"])},D(e.item.value===""?"N/A":e.item.value),3)):(l(),d("span",{key:1,class:V(["text-weight-light",e.$q.screen.gt.lg?"text-body2":"text-caption"])},D(e.item.hiddenValue===""?"N/A":e.item.hiddenValue),3)),e.hasPermission?(l(),$(T,{key:2,class:"cursor-pointer q-ml-sm",color:"accent",name:e.visible?"visibility_off":"visibility",size:"sm",onClick:e.toggleVisibility},null,8,["name","onClick"])):Y("",!0)])):(l(),d("div",et,[i("span",{class:V(["text-weight-light",e.$q.screen.gt.lg?"text-body2":"text-caption"])},D(e.item.value===""?"N/A":e.item.value),3)]))])}var lt=N(Xe,[["render",tt]]);const ot=S({props:{employee:Object},components:{CardSectionValue:lt},setup(e){const a=O(),{getWorkdayData:n,getEmployee:m}=L(),o=({id:p,idType:f})=>f.includes("J&amp;E")?`${p.slice(1,4)} / ${p.slice(-5)}`:p,g=p=>{const f=p.slice(0,3),h=p.slice(3,5),v=p.slice(-4);return`${f}-${h}-${v}`},t=b(()=>a.params.id||e.employee[3]),s=b(()=>m(t.value)),y=b(()=>{const p=n(t.value);if(p){const{personalData:f}=p,{nationalIDData:h}=f.identificationData?f.identificationData:{nationalIDData:null};if(h){const v=h;return{label:v.idType,value:g(v.id),protected:!0,allowView:!0,hiddenValue:`***-**-${v.id.slice(-4)}`,hideIfBlank:!0,config:{permission:{action:"read",subject:"protectedInformation"}}}}else return null}else return null}),k=b(()=>{let p;if(s.value){const f={label:"Workday ID",value:s.value[378],hideIfBlank:!0};p=y.value?[f,y.value]:[f]}else p=[];return p}),r=b(()=>{const p=n(t.value);if(p){const{personalData:f}=p;if(f){const{customIds:h}=f.identificationData?f.identificationData:{customIds:[]};return h}else return[]}else return[]});return{standardIds:k,customIds:r,decodeHTML:ye,processCustomID:o}}}),st=i("div",{class:"text-h6 text-weight-bold"},"IDs",-1),at={class:"row"},nt={class:"col-12 col-md-4"},it={class:"col-12 col-md-8"},rt={class:"row"},ut={class:"col-12 col-md-4"},dt={class:"col-12 col-md-8"};function ct(e,a,n,m,o,g){const t=A("card-section-value");return l(),d("div",null,[c(F,null,{default:u(()=>[c(C,{class:"q-pb-sm"},{default:u(()=>[st]),_:1}),(l(!0),d(I,null,Q(e.standardIds,(s,y)=>(l(),d(I,{key:y},[!s.hideIfBlank||s.value!==""?(l(),$(C,{key:0,class:"q-py-sm"},{default:u(()=>[i("div",at,[i("div",nt,[i("div",{class:V(["text-info",e.$q.screen.gt.lg?"text-body2":"text-caption"])},D(s.label),3)]),i("div",it,[c(t,{item:s},null,8,["item"])])])]),_:2},1024)):Y("",!0)],64))),128)),(l(!0),d(I,null,Q(e.customIds,(s,y)=>(l(),$(C,{key:y,class:"q-py-sm"},{default:u(()=>[i("div",rt,[i("div",ut,[i("div",{class:V(["text-info",e.$q.screen.gt.lg?"text-body2":"text-caption"])},D(e.decodeHTML(s.idType)),3)]),i("div",dt,[i("div",{class:V(["text-weight-light",e.$q.screen.gt.lg?"text-body2":"text-caption"])},D(e.processCustomID(s)),3)])])]),_:2},1024))),128))]),_:1})])}var mt=N(ot,[["render",ct]]);const pt=S({components:{CardSectionEditable:U},props:{employee:Object},setup(e){oe();const a=O(),{capitalize:n}=se,{updateViewedEmployees:m,getEmployee:o}=L(),g=b(()=>a.params.id||e.employee[3]),t=b(()=>o(g.value)),s=r=>{const p=r.split(" ");let f="";return p.forEach((h,v)=>{f+=v>0?` ${n(h.toLowerCase())}`:n(h.toLowerCase())}),f},y=r=>{const p=r[20]||"",f=r[21]&&r[21]!==""?` ${r[21]}`:"",h=r[22]&&r[22]!==""?` ${r[22]}`:"",v=r[23]&&r[23]!==""?` ${r[23]}`:"";return`${p}${f}${h}${v}`};return{details:b(()=>{let r;return t.value?r=[{label:"Full Name",value:fe(y(t.value))},{label:"Phone",value:t.value[25]},{label:"Email",value:t.value[26]},{label:"Address",value:s(t.value[40])},{label:"Primary Craft",value:t.value[52]},{label:"Hiring Status",value:t.value[80]},{label:"Employment Status",value:t.value[408]}]:r=[],r})}}}),ft=i("div",{class:"text-h6 text-weight-bold"},"Employee Information",-1);function vt(e,a,n,m,o,g){const t=A("card-section-editable");return l(),$(F,null,{default:u(()=>[c(C,{class:"q-pb-sm"},{default:u(()=>[ft]),_:1}),(l(!0),d(I,null,Q(e.details,(s,y)=>(l(),$(t,{key:y,item:s},null,8,["item"]))),128))]),_:1})}var yt=N(pt,[["render",vt]]);const bt=S({components:{EmployeeJobDetails:Qe,PendingReleaseDetails:Ke,EmployeeIdentificationCard:mt,FullEmployeeCard:yt},setup(){const e=O(),{getEmployee:a}=L();return{employee:b(()=>a(e.params.id))}}}),$t={class:"q-pa-sm"},gt={key:0,class:"row"},ht={class:"col-12 col-md-6 q-px-sm"},_t={class:"col-12 col-md-6 q-px-sm"};function Dt(e,a,n,m,o,g){const t=A("full-employee-card"),s=A("employee-identification-card"),y=A("employee-job-details"),k=A("pending-release-details");return l(),$(G,{style:{"max-width":"100vw"}},{default:u(()=>[i("div",$t,[e.employee?(l(),d("div",gt,[i("div",ht,[c(t,{employee:e.employee},null,8,["employee"]),c(s,{class:"q-mt-md",employee:e.employee},null,8,["employee"])]),i("div",_t,[e.employee[408]==="Active"&&!e.employee[581]?(l(),$(y,{key:0,employee:e.employee},null,8,["employee"])):(l(),$(k,{key:1,employee:e.employee},null,8,["employee"]))])])):Y("",!0)])]),_:1})}var Zt=N(bt,[["render",Dt]]);export{Zt as default};
