var fe=Object.defineProperty,me=Object.defineProperties;var be=Object.getOwnPropertyDescriptors;var G=Object.getOwnPropertySymbols;var ve=Object.prototype.hasOwnProperty,pe=Object.prototype.propertyIsEnumerable;var J=(e,a,n)=>a in e?fe(e,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[a]=n,v=(e,a)=>{for(var n in a||(a={}))ve.call(a,n)&&J(e,n,a[n]);if(G)for(var n of G(a))pe.call(a,n)&&J(e,n,a[n]);return e},B=(e,a)=>me(e,be(a));import{Q as K}from"./QSpace.a9679a9a.js";import{bP as le,c as w,h,bQ as se,dg as re,bW as ge,r as g,cV as we,dh as he,w as U,o as _e,bI as O,bO as k,g as ye,cI as Be,bN as Se,aL as qe,A as R,B as z,d as o,bi as s,cw as xe,D as S,G as X,a7 as b,ab as T,cz as Ce,cx as Qe,au as j,bJ as Z,bH as H}from"./index.226bbe9e.js";import{Q as ee}from"./QTooltip.d9dcbf65.js";import{Q as te}from"./QTd.d82945b5.js";import{Q as ae}from"./QItemLabel.d7e00488.js";import{Q as ke}from"./QList.1943e8e4.js";import{Q as De}from"./QMenu.0ed2d0c1.js";import{u as Ie}from"./use-quasar.e37fb258.js";import{e as Pe}from"./export-file.eb604dd4.js";import{u as Ve,I as Ae,b as $e,q as oe}from"./quickbase.aae604ff.js";import{dayjs as Le}from"./dayjs.61ba8b06.js";import{_ as Te}from"./hiringTabs.0e5ae044.js";import{_ as je,a as He}from"./aTable.e58b3463.js";import{u as ne}from"./useQuerySaver.ae1b8d62.js";import"./api.1ce17484.js";import{l as Oe}from"./socketListener.7754fc0e.js";import"./position-engine.283f53ba.js";import"./selection.e3cea41b.js";import"./_commonjsHelpers.a26ce4be.js";import"./index.7dbe61ef.js";import"./localForage.2f4a21a3.js";import"./i18n.df17a73c.js";import"./QBadge.a989c5dd.js";import"./QRouteTab.af1d5984.js";import"./QTabs.80f66e4e.js";import"./QResizeObserver.a399e20c.js";import"./rtl.cf9bbe47.js";import"./QSelect.5f4edeef.js";import"./QChip.5521b37c.js";import"./QTable.ae80641c.js";import"./QMarkupTable.c37a3647.js";import"./use-fullscreen.199cb342.js";var Me=le({name:"QBtnGroup",props:{unelevated:Boolean,outline:Boolean,flat:Boolean,rounded:Boolean,square:Boolean,push:Boolean,stretch:Boolean,glossy:Boolean,spread:Boolean},setup(e,{slots:a}){const n=w(()=>{const c=["unelevated","outline","flat","rounded","square","push","stretch","glossy"].filter(f=>e[f]===!0).map(f=>`q-btn-group--${f}`).join(" ");return`q-btn-group row no-wrap${c.length>0?" "+c:""}`+(e.spread===!0?" q-btn-group--spread":" inline")});return()=>h("div",{class:n.value},se(a.default))}});const Ne=Object.keys(re),Re=e=>Ne.reduce((a,n)=>{const c=e[n];return c!==void 0&&(a[n]=c),a},{});var ze=le({name:"QBtnDropdown",props:B(v(v({},re),ge),{modelValue:Boolean,split:Boolean,dropdownIcon:String,contentClass:[Array,String,Object],contentStyle:[Array,String,Object],cover:Boolean,persistent:Boolean,noRouteDismiss:Boolean,autoClose:Boolean,menuAnchor:{type:String,default:"bottom end"},menuSelf:{type:String,default:"top end"},menuOffset:Array,disableMainBtn:Boolean,disableDropdown:Boolean,noIconAnimation:Boolean,toggleAriaLabel:String}),emits:["update:modelValue","click","beforeShow","show","beforeHide","hide"],setup(e,{slots:a,emit:n}){const{proxy:c}=ye(),f=g(e.modelValue),d=g(null),D=we(),I=w(()=>{const t={"aria-expanded":f.value===!0?"true":"false","aria-haspopup":"true","aria-controls":D,"aria-label":e.toggleAriaLabel||c.$q.lang.label[f.value===!0?"collapse":"expand"](e.label)};return(e.disable===!0||e.split===!1&&e.disableMainBtn===!0||e.disableDropdown===!0)&&(t["aria-disabled"]="true"),t}),M=w(()=>"q-btn-dropdown__arrow"+(f.value===!0&&e.noIconAnimation===!1?" rotate-180":"")+(e.split===!1?" q-btn-dropdown__arrow-container":"")),q=w(()=>he(e)),_=w(()=>Re(e));U(()=>e.modelValue,t=>{d.value!==null&&d.value[t?"show":"hide"]()}),U(()=>e.split,Q);function p(t){f.value=!0,n("beforeShow",t)}function P(t){n("show",t),n("update:modelValue",!0)}function m(t){f.value=!1,n("beforeHide",t)}function x(t){n("hide",t),n("update:modelValue",!1)}function V(t){n("click",t)}function C(t){Be(t),Q(),n("click",t)}function A(t){d.value!==null&&d.value.toggle(t)}function $(t){d.value!==null&&d.value.show(t)}function Q(t){d.value!==null&&d.value.hide(t)}return Object.assign(c,{show:$,hide:Q,toggle:A}),_e(()=>{e.modelValue===!0&&$()}),()=>{const t=[h(O,{class:M.value,name:e.dropdownIcon||c.$q.iconSet.arrow.dropdown})];return e.disableDropdown!==!0&&t.push(h(De,{ref:d,id:D,class:e.contentClass,style:e.contentStyle,cover:e.cover,fit:!0,persistent:e.persistent,noRouteDismiss:e.noRouteDismiss,autoClose:e.autoClose,anchor:e.menuAnchor,self:e.menuSelf,offset:e.menuOffset,separateClosePopup:!0,transitionShow:e.transitionShow,transitionHide:e.transitionHide,transitionDuration:e.transitionDuration,onBeforeShow:p,onShow:P,onBeforeHide:m,onHide:x},a.default)),e.split===!1?h(k,B(v(v({class:"q-btn-dropdown q-btn-dropdown--simple"},_.value),I.value),{disable:e.disable===!0||e.disableMainBtn===!0,noWrap:!0,round:!1,onClick:V}),{default:()=>se(a.label,[]).concat(t),loading:a.loading}):h(Me,B(v({class:"q-btn-dropdown q-btn-dropdown--split no-wrap q-btn-item",rounded:e.rounded,square:e.square},q.value),{glossy:e.glossy,stretch:e.stretch}),()=>[h(k,B(v({class:"q-btn-dropdown--current"},_.value),{disable:e.disable===!0||e.disableMainBtn===!0,noWrap:!0,round:!1,onClick:C}),{default:a.label,loading:a.loading}),h(k,B(v(v({class:"q-btn-dropdown__arrow-container q-anchor--skip"},I.value),q.value),{disable:e.disable===!0||e.disableDropdown===!0,rounded:e.rounded,color:e.color,textColor:e.textColor,dense:e.dense,size:e.size,padding:e.padding,ripple:e.ripple}),()=>t)])}}});const Ue={class:"q-pa-md"},Ee={class:"row items-center"},We={class:"col-12 col-md-5 q-px-sm"},Ye={class:"col-12 col-md-3 q-px-sm"},Fe={class:"col-12 col-md-5 q-px-sm"},Ge={key:0},Je={key:1},It={__name:"index",setup(e){const a=Ie(),{notificationService:n}=Oe,{userOffices:c,getUser:f}=Ve(),d=Ae(),{openWindow:D}=$e(),{fetchProfiles:I,fetchAllProfiles:M,setProfiles:q}=d,{getProfiles:_,getSelectedOffice:p,getLoadingState:P}=Se(d),m=g(p.value?p.value[8]:null),x=g("Profiles"),V=g("profiles"),C=g(""),A=g({sortBy:"1",descending:!1,rowsPerPage:150}),$=async l=>{const{data:r}=await oe.fetchFromHiringApp({fields:[ne({type:"profiles",useQuery:{id:l}})]});return{id:l,data:r}},Q=async l=>{if(l||_.value().length===0)if(m.value){const{data:r}=await oe.fetchFromHiringApp({fields:[ne({type:"profiles",useQuery:{id:m.value}})]});console.log(r),q({selectedId:m.value,data:r})}else{const r=[];c().forEach(y=>{const ce=$(y[8]);r.push(ce)});const F=(await Promise.allSettled(r)).map(y=>y.value);console.log(F),F.forEach(y=>{q({selectedId:y.id,data:y.data})})}else return _.value(m.value)},t=l=>{m.value?I({selectedId:m.value,refresh:l}):M({can:"read",refresh:l})};t(),U(p,()=>{m.value=p.value?p.value[8]:null,t()});const ie=g(new Date),ue=setInterval(()=>{ie.value=new Date},1e3);qe(()=>{clearInterval(ue)});const de=w(()=>["index","submissionTime","name","phoneNumber","craft","latestScore","employmentStatus","action",...p.value?[]:["office"]]),N=w(()=>[{name:"index",align:"left",label:"#",sortable:!1},{name:"submissionTime",align:"left",label:"Time",field:"78",sortable:!1},{name:"name",align:"left",label:"Name",field:"24",sortable:!1},{name:"phoneNumber",align:"center",label:"Phone Number",field:"25",sortable:!1},{name:"craft",align:"center",label:"Craft",field:"52",sortable:!1},{name:"latestScore",align:"center",label:"Latest Score",field:"155",sortable:!1},{name:"employmentStatus",align:"center",label:"Employment Status",field:"56",sortable:!1},{name:"office",align:"center",label:"Office",field:"191",sortable:!1},{name:"action",align:"center",label:"",sortable:!1}]),L=w(()=>_.value(m.value).filter(l=>!0).sort((l,r)=>A.value.descending?l[1].isBefore(r[1]):l[1].isAfter(r[1]))),E=(l,r,i)=>{let u=r!==void 0?r(l,i):l;return u=u==null?"":String(u),u=u.split('"').join('""'),`"${u}"`},W=l=>{console.log(l),D(null,{url:`https://elitehcms.quickbase.com/db/bpzpy6n3x?a=dbpage&pageID=2&ee=${l[3]}`,name:"View Profile"})},Y=()=>{const l=[N.value.map(i=>E(i.label))].concat(L.value.map(i=>N.value.map(u=>E(typeof u.field=="function"?u.field(i):i[u.field===void 0?u.name:u.field],u.format,i)).join(","))).join(`\r
`);Pe(`${x.value} ${Le().format("MM.DD.YYYY")}.csv`,l,"text/csv")!==!0&&a.notify({message:"Browser denied file download...",color:"negative",icon:"warning"})};return n.on("created",({officeId:l,title:r})=>{r==="profilesUpdated"&&l&&t(!0)}),(l,r)=>(R(),z("div",Ue,[o(Te),o(Ce,{flat:"",class:"q-pt-none"},{default:s(()=>[o(xe,null,{default:s(()=>[S("div",Ee,[S("div",We,[S("div",{class:X(["text-dark",b(a).screen.lt.md?"text-body1":"text-h5"])},T(x.value),3)]),o(K),S("div",Ye,[o(je,{styleSelection:!0})])])]),_:1})]),_:1}),o(He,{rows:b(L),columns:b(N),pagination:A.value,filter:C.value,title:x.value,separator:"vertical","row-key":"3",loading:b(P)(V.value),"visible-columns":b(de),downloadButton:!0,onDownload:Y},{top:s(()=>[S("div",Fe,[o(Qe,{dense:b(a).screen.lt.md,modelValue:C.value,"onUpdate:modelValue":r[0]||(r[0]=i=>C.value=i),label:"Search...",clearable:""},{prepend:s(()=>[o(O,{name:"search"})]),_:1},8,["dense","modelValue"])]),o(K),S("div",{class:X(["text-dark text-caption text-italic",b(a).screen.lt.md?"offset-xs-5":""])},"(Total: "+T(b(L).length)+")",3),o(k,{flat:"",round:"",color:"primary",icon:"download",disable:b(L).length<1,onClick:Y},{default:s(()=>[o(ee,{class:"bg-accent text-black shadow-4",offset:[10,10]},{default:s(()=>[j(" Download ")]),_:1})]),_:1},8,["disable"]),o(k,{flat:"",round:"",color:"primary",icon:"refresh",onClick:r[1]||(r[1]=i=>Q(!0)),loading:b(P)(V.value)},{default:s(()=>[o(ee,{class:"bg-accent text-black shadow-4",offset:[10,10]},{default:s(()=>[j(" Refresh ")]),_:1})]),_:1},8,["loading"])]),"body-cell-submissionTime":s(i=>[o(te,{props:i},{default:s(()=>[l.$dayjs(i.value).isValid()?(R(),z("div",Ge,T(i.value.format("L LT")),1)):(R(),z("div",Je,T(i.row[1].format("L LT")),1))]),_:2},1032,["props"])]),"body-cell-action":s(i=>[o(te,{props:i},{default:s(()=>[o(ze,{split:"",color:"primary",label:"View Profile","menu-anchor":"bottom right",onClick:u=>W(i.row),size:".75rem"},{default:s(()=>[o(ke,{class:"text-primary",separator:"",bordered:""},{default:s(()=>[o(Z,{clickable:"",onClick:u=>W(i.row)},{default:s(()=>[o(H,{avatar:""},{default:s(()=>[o(O,{name:"person"})]),_:1}),o(H,null,{default:s(()=>[o(ae,null,{default:s(()=>[j("CLM View Profile")]),_:1})]),_:1})]),_:2},1032,["onClick"]),o(Z,{clickable:"",to:{name:"ee-hiring",params:{id:i.row[3]}}},{default:s(()=>[o(H,{avatar:""},{default:s(()=>[o(O,{name:"badge"})]),_:1}),o(H,null,{default:s(()=>[o(ae,null,{default:s(()=>[j("Full Employee")]),_:1})]),_:1})]),_:2},1032,["to"])]),_:2},1024)]),_:2},1032,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","columns","pagination","filter","title","loading","visible-columns"])]))}};export{It as default};
