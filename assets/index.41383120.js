import{Q as ze}from"./QPage.eed23df8.js";import{u as ge}from"./use-quasar.900ac942.js";import{u as D,q as I,c as He}from"./app.c06ae7e4.js";import{q as Ce,k as V,l as se,r as H,_ as J,A as b,aq as R,av as ve,br as c,d as i,bW as y,D as l,ac as w,H as qe,b5 as L,cS as Y,cT as k,cU as ee,B,ar as X,cV as G,bO as de,bQ as Pe,c as C,w as ue,bU as Ne,bT as Ie,bV as De,F as be,b4 as Se,G as $e,bS as Ye,y as We}from"./index.2bf5f3d5.js";import{localforage as O}from"./localForage.fc877897.js";import{dayjs as v}from"./dayjs.67bcdf99.js";import{Q as fe}from"./QForm.8b79410e.js";import{a as Je,Q as re}from"./QStep.b7800273.js";import{a as te,b as Ge}from"./useQuerySaver.d29ff9ee.js";import{u as Ze}from"./dataStore.ccd157ed.js";import{a as pe,u as j}from"./vee-validate.esm.365d338d.js";import{a as A,b as Ke,c as ie,e as je}from"./array.59f93f43.js";import{Q as ce}from"./QTooltip.6e254bc4.js";import{a as ne}from"./QSelect.35e2e745.js";import{P as xe,f as et,n as tt}from"./pay-rate-v2.b9b8d672.js";import{Q as ke}from"./QTd.4d74c04b.js";import{Q as Ve}from"./QTable.158fedee.js";import{_ as st}from"./projectSelector.53ecbe48.js";import"./_commonjsHelpers.a26ce4be.js";import"./api.c01eef32.js";import"./index.04bc0a32.js";import"./i18n.43e58d72.js";import"./use-panel.c6f17dc8.js";import"./touch.3df10340.js";import"./selection.d9f9c811.js";import"./QSlideTransition.0928f9b3.js";import"./position-engine.ed83372a.js";import"./QChip.4a8cc4f1.js";import"./QMenu.f5054ee4.js";import"./rtl.b51694b1.js";import"./QList.1e2f5ca3.js";import"./QMarkupTable.2acd56f7.js";import"./use-fullscreen.217361b2.js";const oe=Ce("newRequestDataStore",{state:()=>({selectedProject:null,humanizedData:{},humanizedClassificationData:[],dbData:{},dbClassificationData:[],jobNumbers:{},siteContacts:{},meetingLocations:{},perDiemSpecs:{},projectCrafts:{},projectCraftClassifications:{},requestedTimeStamps:{},v3EditData:{request:null,classifications:[],names:[]},v3Data:{request:null,project:null,general:null,classifications:[],names:[],matches:null,edit:!1},v3Options:{projects:[],jobNumbers:[],contacts:[],locations:[],perDiem:[],crafts:[],jobs:[],restrictions:[{value:"Name Request Only",description:"The hiring center will only hire the names you provide.",warning:"If you DO NOT provide enough names or if the people you request do not show up, the hiring center WILL NOT assist with filling this request."},{value:"Open",description:"The hiring center will fill positions by recruiting and selecting the most qualified candidates available.",warning:"You will NOT be able to add names to this type of request."},{value:"Mixed",description:"The hiring center will hire all of the names that you provide and fill remaining positions by recruiting and selecting the most qualified candidates available."}],reasons:[{value:"Backfill",label:"Backfill - (An employee was terminated)",description:"This request is to fill positions that are open because of an employee leaving the job site."},{value:"Increase in Manpower",label:"Increase in Manpower - (We need more employees on site)",description:"This request is to fill positions that are new because of an increased need in manpower. This may be due to a change in the scope of an existing contract, an additional contract awarded, etc."}]}}),getters:{getStoredData:e=>({type:t,key:s})=>!t||!s?[]:!e.requestedTimeStamps[s]||!e.requestedTimeStamps[s][t]||e.requestedTimeStamps[s][t].isBefore(v().subtract(10,"minute"))?[]:e[t][s],getHumanizedData:e=>e.humanizedData,getDbData:e=>e.dbData,getHumanizedClassificationData:e=>e.humanizedClassificationData,getDbClassificationData:e=>e.dbClassificationData,getRequestedTimeStamps(e){return e.requestedTimeStamps},getV3Data:e=>e.v3Data,getV3Options:e=>e.v3Options,getV3EditData:e=>e.v3EditData},actions:{setselectedProject(e){this.selectedProject=e},setTimeStamp({name:e,timeStamp:t,Id:s},o){if(this.requestedTimeStamps[s]?this.requestedTimeStamps[s][e]=t:this.requestedTimeStamps[s]={[e]:t},o){const r=JSON.parse(JSON.stringify(this.requestedTimeStamps));O.setItem(`${V.storageProcessTimeStamps}`,r)}},setNewRequestData({humanized:e,database:t}){for(const[s,o]of Object.entries(e))Object.assign(this.humanizedData,{[s]:o});for(const[s,o]of Object.entries(t))Object.assign(this.dbData,{[s]:o})},setNewRequestClassificationData({humanized:e,database:t}){this.humanizedClassificationData=e,this.dbClassificationData=t},setStorageData({type:e,key:t,data:s,timestamp:o}){this.setTimeStamp({name:e,Id:t,timeStamp:o}),this[e][t]=s},setTimeStampState(e){this.requestedTimeStamps=e},async removeData({type:e,key:t,item:s,storageKey:o}){const r=this[e][t].findIndex(f=>f[3]===s[3]);r>-1&&this[e][t].splice(r,1);const n=this[e][t];O.removeItem(`${V[o]}_${t}`),O.getItem(`${V[o]}_${t}`)||O.setItem(`${V[o]}_${t}`,n)},setV3Data({prop:e,data:t,push:s}){s?this.v3Data[e].push(t):this.v3Data[e]=t},setV3EditData({prop:e,data:t,push:s}){s?this.v3EditData[e].push(t):this.v3EditData[e]=t},setV3Options({prop:e,data:t}){this.v3Options[e]=t},resetV3Data(){this.v3Data={project:null,general:null,classifications:[],names:[],matches:null},this.v3Options={projects:[],jobNumbers:[],contacts:[],locations:[],perDiem:[],crafts:[],jobs:[],restrictions:[{value:"Name Request Only",description:"The hiring center will only hire the names you provide.",warning:"If you DO NOT provide enough names or if the people you request do not show up, the hiring center WILL NOT assist with filling this request."},{value:"Open",description:"The hiring center will fill positions by recruiting and selecting the most qualified candidates available.",warning:"You will NOT be able to add names to this type of request."},{value:"Mixed",description:"The hiring center will hire all of the names that you provide and fill remaining positions by recruiting and selecting the most qualified candidates available."}],reasons:[{value:"Backfill",label:"Backfill - (An employee was terminated)",description:"This request is to fill positions that are open because of an employee leaving the job site."},{value:"Increase in Manpower",label:"Increase in Manpower - (We need more employees on site)",description:"This request is to fill positions that are new because of an increased need in manpower. This may be due to a change in the scope of an existing contract, an additional contract awarded, etc."}]}}}}),Oe=Ce("dataStore2",{state:()=>({selectedOffice:null,selfCheckIns:{},profiles:{},scheduledInterviews:{},inProcessInterviews:{},inProcess:{},pending:{},deployments:{},projects:{},openRequest:{},pendingRequest:{},closedRequest:{},openClassifications:{},pendingClassifications:{},closedClassifications:{},nameRequest:{},pendingProjects:{},requestedTimeStamps:{}}),getters:{getSelfCheckIns:e=>t=>{if(t)return e.selfCheckIns[t]?e.selfCheckIns[t]:[];{let s=[];return Object.keys(e.selfCheckIns).forEach(o=>{s=s.concat(e.selfCheckIns[o])}),s}},getProfiles:e=>t=>{if(t)return e.profiles[t]?e.profiles[t]:[];{let s=[];return Object.keys(e.profiles).forEach(o=>{s=s.concat(e.profiles[o])}),s}},getScheduledInterviews:e=>t=>{if(t)return e.scheduledInterviews[t]?e.scheduledInterviews[t]:[];{let s=[];return Object.keys(e.scheduledInterviews).forEach(o=>{s=s.concat(e.scheduledInterviews[o])}),s}},getInProcessInterviews:e=>t=>{if(t)return e.inProcessInterviews[t]?e.inProcessInterviews[t]:[];{let s=[];return Object.keys(e.inProcessInterviews).forEach(o=>{s=s.concat(e.inProcessInterviews[o])}),s}},getInProcess:e=>t=>{if(t)return e.inProcess[t]?e.inProcess[t]:[];{let s=[];return Object.keys(e.inProcess).forEach(o=>{s=s.concat(e.inProcess[o])}),s}},getPending:e=>t=>{if(t)return e.pending[t]?e.pending[t]:[];{let s=[];return Object.keys(e.pending).forEach(o=>{s=s.concat(e.pending[o])}),s}},getDeployments:e=>t=>{if(t)return e.deployments[t]?e.deployments[t]:[];{let s=[];return Object.keys(e.deployments).forEach(o=>{s=s.concat(e.deployments[o])}),s}},getProjects:e=>(t,s)=>{if(!s&&!t){let o=[];return Object.keys(e.projects).forEach(r=>{o=o.concat(e.projects[r])}),o}else if(!s&&t){const{userOffices:o}=D();let r=[];return o(t).forEach(n=>{r=r.concat(e.projects[n[8]])}),r}else if(s&&t){const{getOffice:o}=D(),r=o(s);return t==="read"&&r&&r[39]!==!0?[]:(t==="create"||t==="update")&&r&&r[40]!==!0?[]:t==="manage"&&r&&r[41]!==!0?[]:e.projects[s]?e.projects[s]:[]}else return e.projects[s]?e.projects[s]:[]},getPendingProjects:e=>t=>{if(t)return e.pendingProjects[t]?e.pendingProjects[t]:[];{let s=[];return Object.keys(e.pendingProjects).forEach(o=>{s=s.concat(e.pendingProjects[o])}),s}},getRequestedTimeStamps(e){return e.requestedTimeStamps},getSelectedOffice(e){return e.selectedOffice}},actions:{setSelectedOffice(e,t){this.selectedOffice=e},setTimeStamp({name:e,timeStamp:t,officeId:s},o){if(this.requestedTimeStamps[s]?this.requestedTimeStamps[s][e]=t:this.requestedTimeStamps[s]={[e]:t},o){const r=JSON.parse(JSON.stringify(this.requestedTimeStamps));O.setItem(`${V.storageProcessTimeStamps}`,r)}},setTimeStampState(e){this.requestedTimeStamps=e},async fetchSelfCheckIns(e){const t=this.getRequestedTimeStamps[e.officeId]||{};let s=!0;const o=[{9:{value:e.officeId},7:{value:"Self Check-Ins"}}];if(t.selfCheckIns&&(t.selfCheckIns.isBefore(v().subtract(1,"minute"))?s=!0:s=e.refresh?e.refresh:!1),s){this.setTimeStamp({officeId:e.officeId,name:"selfCheckIns",timeStamp:v()},!0);const{data:r}=await I.fetchFromRecruitingApp({fields:o});return this.setSelfCheckIns({officeId:e.officeId,data:r},!0),{data:r}}else return{data:[]}},async fetchAllSelfCheckIns(e){const{userOffices:t}=D(),s=[];return t(e?e.access:null).forEach(r=>{let n=this.fetchSelfCheckIns({...e,officeId:r[8]});s.push(n)}),await Promise.allSettled(s)},setSelfCheckIns({officeId:e,data:t},s){this.selfCheckIns[e]=t,s&&O.setItem(`${V.storageSelfCheckIns}_${e}`,t)},async fetchProfiles(e){const t=this.getRequestedTimeStamps[e.officeId]||{};let s=!0;const o=[{9:{value:e.officeId},7:{value:"Profiles"}}];if(t.profiles&&(t.profiles.isBefore(v().subtract(1,"minute"))?s=!0:s=e.refresh?e.refresh:!1),s){this.setTimeStamp({officeId:e.officeId,name:"profiles",timeStamp:v()},!0);const{data:r}=await I.fetchFromHiringApp({fields:o});return this.setProfiles({officeId:e.officeId,data:r},!0),{data:r}}else return{data:[]}},async fetchAllProfiles(e){const{userOffices:t}=D(),s=[];return t(e?e.access:null).forEach(r=>{let n=this.fetchProfiles({...e,officeId:r[8]});s.push(n)}),await Promise.allSettled(s)},setProfiles({officeId:e,data:t},s){this.profiles[e]=t,s&&O.setItem(`${V.storageProfiles}_${e}`,t)},async fetchScheduledInterviews(e){const t=this.getRequestedTimeStamps[e.officeId]||{};let s=!0;const o=[{9:{value:e.officeId},7:{value:"Scheduled Interviews"}}];if(t.scheduledInterviews&&(t.scheduledInterviews.isBefore(v().subtract(1,"minute"))?s=!0:s=e.refresh?e.refresh:!1),s){this.setTimeStamp({officeId:e.officeId,name:"scheduledInterviews",timeStamp:v()},!0);const{data:r}=await I.fetchFromHiringApp({fields:o});return this.setScheduledInterviews({officeId:e.officeId,data:r},!0),{data:r}}else return{data:[]}},async fetchAllScheduledInterviews(e){const{userOffices:t}=D(),s=[];return t(e?e.access:null).forEach(r=>{let n=this.fetchScheduledInterviews({...e,officeId:r[8]});s.push(n)}),await Promise.allSettled(s)},setScheduledInterviews({officeId:e,data:t},s){this.scheduledInterviews[e]=t,s&&O.setItem(`${V.storageScheduledInterviews}_${e}`,t)},async fetchInProcessInterviews(e){const t=this.getRequestedTimeStamps[e.officeId]||{};let s=!0;const o=[{9:{value:e.officeId},7:{value:"In Process Interviews"}}];if(t.inProcessInterviews&&(t.inProcessInterviews.isBefore(v().subtract(1,"minute"))?s=!0:s=e.refresh?e.refresh:!1),s){this.setTimeStamp({officeId:e.officeId,name:"inProcessInterviews",timeStamp:v()},!0);const{data:r}=await I.fetchFromHiringApp({fields:o});return this.setInProcessInterviews({officeId:e.officeId,data:r},!0),{data:r}}else return{data:[]}},async fetchAllInProcessInterviews(e){const{userOffices:t}=D(),s=[];return t(e?e.access:null).forEach(r=>{let n=this.fetchInProcessInterviews({...e,officeId:r[8]});s.push(n)}),await Promise.allSettled(s)},setInProcessInterviews({officeId:e,data:t},s){this.inProcessInterviews[e]=t,s&&O.setItem(`${V.storageInProcessInterviews}_${e}`,t)},async fetchInProcess(e){const t=this.getRequestedTimeStamps[e.officeId]||{};let s=!0;const o=[{9:{value:e.officeId},7:{value:"In Processes"}}];if(t.inProcess&&(t.inProcess.isBefore(v().subtract(1,"minute"))?s=!0:s=e.refresh?e.refresh:!1),s){this.setTimeStamp({officeId:e.officeId,name:"inProcess",timeStamp:v()},!0);const{data:r}=await I.fetchFromHiringApp({fields:o});return this.setInProcess({officeId:e.officeId,data:r},!0),{data:r}}else return{data:[]}},async fetchAllInProcess(e){const{userOffices:t}=D(),s=[];return t(e?e.access:null).forEach(r=>{let n=this.fetchInProcess({...e,officeId:r[8]});s.push(n)}),await Promise.allSettled(s)},setInProcess({officeId:e,data:t},s){this.inProcess[e]=t,s&&O.setItem(`${V.storageInProcess}_${e}`,t)},async fetchPending(e){const t=this.getRequestedTimeStamps[e.officeId]||{};let s=!0;const o=[{9:{value:e.officeId},7:{value:"Dispatches"}}];if(t.pending&&(t.pending.isBefore(v().subtract(1,"minute"))?s=!0:s=e.refresh?e.refresh:!1),s){this.setTimeStamp({officeId:e.officeId,name:"pending",timeStamp:v()},!0);const{data:r}=await I.fetchFromHiringApp({fields:o});return this.setPending({officeId:e.officeId,data:r},!0),{data:r}}else return{data:[]}},async fetchAllPending(e){const{userOffices:t}=D(),s=[];return t(e?e.access:null).forEach(r=>{let n=this.fetchPending({...e,officeId:r[8]});s.push(n)}),await Promise.allSettled(s)},setPending({officeId:e,data:t},s){this.pending[e]=t,s&&O.setItem(`${V.storagePending}_${e}`,t)},async fetchOpenRequest(e){const t=this.getRequestedTimeStamps[e.officeId]||{};let s=!0;const o=[{9:{value:e.officeId},7:{value:"Open Request"}}];if(t.openRequest&&(t.openRequest.isBefore(v().subtract(1,"minute"))?s=!0:s=e.refresh?e.refresh:!1),s){this.setTimeStamp({officeId:e.officeId,name:"openRequest",timeStamp:v()},!0);const{data:r}=await I.fetchFromProjectsApp({fields:o});return this.setOpenRequest({officeId:e.officeId,data:r},!0),{data:r}}else return{data:[]}},async fetchAllOpenRequest(e){const{userOffices:t}=D(),s=[];return t(e?e.access:null).forEach(r=>{let n=this.fetchOpenRequest({...e,officeId:r[8]});s.push(n)}),await Promise.allSettled(s)},setOpenRequest({officeId:e,data:t},s){this.openRequest[e]=t,s&&O.setItem(`${V.storageOpenRequest}_${e}`,t)},async fetchPendingRequest(e){const t=this.getRequestedTimeStamps[e.officeId]||{};let s=!0;const o=[{9:{value:e.officeId},7:{value:"Pending Request"}}];if(t.pendingRequest&&(t.pendingRequest.isBefore(v().subtract(1,"minute"))?s=!0:s=e.refresh?e.refresh:!1),s){this.setTimeStamp({officeId:e.officeId,name:"pendingRequest",timeStamp:v()},!0);const{data:r}=await I.fetchFromProjectsApp({fields:o});return this.setPendingRequest({officeId:e.officeId,data:r},!0),{data:r}}else return{data:[]}},async fetchAllPendingRequest(e){const{userOffices:t}=D(),s=[];return t(e?e.access:null).forEach(r=>{let n=this.fetchPendingRequest({...e,officeId:r[8]});s.push(n)}),await Promise.allSettled(s)},setPendingRequest({officeId:e,data:t},s){this.pendingRequest[e]=t,s&&O.setItem(`${V.storagePendingRequest}_${e}`,t)},async fetchProjects(e){const{getOffice:t}=D(),s=this.getRequestedTimeStamps[e.officeId]||{};let o=!0;if(e&&e.access){const n=t(e.officeId);if(e.access==="read"&&n&&n[39]!==!0)return{data:[]};if((e.access==="create"||e.access==="update")&&n&&n[40]!==!0)return{data:[]};if(e.access==="manage"&&n&&n[41]!==!0)return{data:[]}}const r=[{9:{value:e.officeId},7:{value:"Projects"}}];if(s.projects&&(s.projects.isBefore(v().subtract(1,"minute"))?o=!0:o=e.refresh?e.refresh:!1),o){this.setTimeStamp({officeId:e.officeId,name:"projects",timeStamp:v()},!0);const{data:n}=await I.fetchFromProjectsApp({fields:r});return this.setProjects({officeId:e.officeId,data:n},!0),{data:n}}else return{data:[]}},async fetchAllProjects(e){const{userOffices:t}=D(),s=[];return t(e?e.access:null).forEach(r=>{let n=this.fetchProjects({...e,officeId:r[8]});s.push(n)}),await Promise.allSettled(s)},setProjects({officeId:e,data:t},s){e&&t&&(this.projects[e]=t),s&&e&&O.setItem(`${V.storageProjects}_${e}`,t)},async fetchPendingProjects(e){const t=this.getRequestedTimeStamps[e.officeId]||{};let s=!0;const o=[{9:{value:e.officeId},7:{value:"Pending Projects"}}];if(t.pendingProjects&&(t.pendingProjects.isBefore(v().subtract(1,"minute"))?s=!0:s=e.refresh?e.refresh:!1),s){this.setTimeStamp({officeId:e.officeId,name:"pendingProjects",timeStamp:v()},!0);const{data:r}=await I.fetchFromProjectsApp({fields:o});return this.setPendingProjects({officeId:e.officeId,data:r},!0),{data:r}}else return{data:[]}},async fetchAllPendingProjects(e){const{userOffices:t}=D(),s=[];return t(e?e.access:null).forEach(r=>{let n=this.fetchPendingProjects({...e,officeId:r[8]});s.push(n)}),await Promise.allSettled(s)},setPendingProjects({officeId:e,data:t},s){this.pendingProjects[e]=t,s&&O.setItem(`${V.storagePendingProjects}_${e}`,t)}}}),ot=se({props:{fetcher:{type:Function,required:!0},getter:{type:Function,required:!0},setter:{type:Function,required:!0},filter:{type:Function,required:!0}},setup(e){const t=H([]),s=async()=>{const{fetcher:r,getter:n,setter:f}=e;if(!n()||n().length===0){const a=await r();f(a),t.value=n()}else t.value=n()},o=(r,n)=>{const{getter:f,filter:a}=e,u=f();if(r===""||!r){n(()=>{t.value=u});return}t.value=a(u,r)};return s(),{options:t,filterOptions:o}}}),at={class:"text-caption"},rt={class:"text-caption"};function it(e,t,s,o,r,n){return b(),R(ne,qe(e.$attrs,{"transition-show":"flip-up","transition-hide":"flip-down",options:e.options,"bottom-slots":"","use-input":"","input-debounce":"0",onFilter:e.filterOptions,loading:!e.options||e.options.length===0}),ve({error:c(()=>[l("div",at,w(e.$attrs.errorMessage),1)]),_:2},[e.$attrs.showTooltip?{name:"after",fn:c(()=>[i(y,{size:"xs",color:"accent",round:"",icon:"question_mark"},{default:c(()=>[i(ce,{anchor:"top middle",self:"center middle",class:"bg-primary text-white"},{default:c(()=>[l("div",null,[l("div",rt,w(e.$attrs.tooltipMessage),1)])]),_:1})]),_:1})]),key:"0"}:void 0]),1040,["options","onFilter","loading"])}var Te=J(ot,[["render",it]]);const nt=se({emits:["changeStep"],components:{aSelect:Te},setup(e,{emit:t}){const s=H(0),{getV3Data:o,setV3Data:r,getV3Options:n,setV3Options:f}=oe(),a=o.general?o.general:{},u=A({dateNeeded:Ke().required().nullable().label("Date Needed"),restriction:A().required().label("Request Type"),reason:A().required().label("Request Reason"),jobNumber:A().required().nullable().label("Job Number"),meetingLocation:A().required().nullable().label("Meeting Location"),siteContact:A().required().nullable().label("Site Contact"),perDiem:A().nullable().label("Per Diem"),notes:ie().nullable().label("Notes")}),{meta:d,errors:g,handleSubmit:h}=pe({validationSchema:u,initialValues:{restriction:a.restriction?a.restriction:n.restrictions[1],reason:a.reason?a.reason:n.reasons[0],dateNeeded:a.dateNeeded?a.dateNeeded:null,jobNumber:a.jobNumber?a.jobNumber:null,meetingLocation:a.meetingLocation?a.meetingLocation:null,siteContact:a.siteContact?a.siteContact:null,perDiem:a.perDiem?a.perDiem:null,notes:a.notes?a.notes:null}}),{value:_}=j("dateNeeded"),{value:S}=j("restriction"),{value:q}=j("reason"),{value:E}=j("jobNumber"),{value:F}=j("meetingLocation"),{value:z}=j("siteContact"),{value:Z}=j("perDiem"),{value:m}=j("notes"),$=h(p=>{console.log(p),p.notes=p.notes?p.notes.replace(/(\r\n|\n|\r)/gm," "):null,r({prop:"general",data:p}),t("changeStep",2)});return{step:s,changeStep:p=>{},submit:$,meta:d,errors:g,dateNeeded:_,jobNumber:E,restriction:S,reason:q,siteContact:z,meetingLocation:F,perDiem:Z,notes:m,getV3Options:n,setV3Options:f,getV3Data:o,jobNumberFetcher:async()=>{const{data:p}=await I.fetchFromProjectsApp({fields:[te({type:"jobNumbers",query:`{'6'.EX.'${o.project[3]}'}AND{'29'.EX.'Active'}`})]});return p.sort((U,W)=>U[11]>W[11]?-1:1)},meetingLocationsFetcher:async()=>{const{data:p}=await I.fetchFromStructureApp({fields:[Ge({type:"meetingLocations",query:`{'15'.EX.'${o.project[8]}'}AND{'14'.EX.'Active'}`})]});return p.sort((U,W)=>U[6]>W[6]?-1:1)},siteContactsFetcher:async()=>{const{data:p}=await I.fetchFromProjectsApp({fields:[te({type:"siteContacts",query:`{'7'.EX.'${o.project[3]}'}AND{'6'.EX.'Active'}`})]});return p.sort((U,W)=>U[17]>W[17]?-1:1)},perDiemFetcher:async()=>{const{data:p}=await I.fetchFromProjectsApp({fields:[te({type:"perDiemSpecs",query:`{'12'.EX.'${o.project[3]}'}AND{'38'.EX.'Active'}`})]});return p.sort((U,W)=>U[20]>W[20]?-1:1)}}}}),lt=l("div",{class:"text-body2 text-italic text-weight-bold text-dark"},"Please provide the following general information about this request.",-1),ct={class:"row"},ut={class:"col-12 col-md-4 q-pr-md"},dt={class:"text-caption"},ft=l("div",null,[l("div",{class:"text-caption"}," This is the day that these employees should arrive to begin work. "),l("div",{class:"text-caption"}," Expect a minimum of 3-5 days for processing of any drug screens or background checks. ")],-1),pt={class:"text-caption"},mt={class:"text-caption"},ht={class:"text-caption"},bt={class:"text-caption"},gt={key:0,class:"text-caption text-dark text-italic text-weight-bold"},vt={class:"col-12 col-md-4 q-pr-sm"},qt={class:"col-12 col-md-4 q-pr-sm"};function yt(e,t,s,o,r,n){const f=L("a-select");return b(),R(fe,{onSubmit:de(e.submit,["prevent"])},{default:c(()=>[i(Y,{flat:""},{default:c(()=>[i(k,{class:"q-pt-none q-px-none"},{default:c(()=>[lt]),_:1}),i(k,{class:"q-px-none q-pb-none"},{default:c(()=>[l("div",ct,[l("div",ut,[i(ee,{class:"q-mb-md",autofocus:"",outlined:"",clearable:"",type:"date",dense:"",label:"Date Needed",modelValue:e.dateNeeded,"onUpdate:modelValue":t[0]||(t[0]=a=>e.dateNeeded=a),error:!!e.errors.dateNeeded,"bottom-slots":"","stack-label":""},{error:c(()=>[l("div",dt,w(e.errors.dateNeeded),1)]),before:c(()=>[i(y,{size:"xs",color:"accent",round:"",icon:"question_mark"},{default:c(()=>[i(ce,{anchor:"top middle",self:"center middle",class:"bg-primary text-white"},{default:c(()=>[ft]),_:1})]),_:1})]),_:1},8,["modelValue","error"]),i(ne,{class:"q-mb-md",dense:"",clearable:"",outlined:"","transition-show":"flip-up","transition-hide":"flip-down",label:"Request Reason",modelValue:e.reason,"onUpdate:modelValue":t[1]||(t[1]=a=>e.reason=a),options:e.getV3Options.reasons,"option-label":"label",error:!!e.errors.reason,"bottom-slots":""},{error:c(()=>[l("div",pt,w(e.errors.reason),1)]),before:c(()=>[i(y,{size:"xs",color:"accent",round:"",icon:"question_mark"},{default:c(()=>[i(ce,{anchor:"top middle",self:"center middle",class:"bg-primary text-white"},{default:c(()=>[l("div",null,[l("div",mt,w(e.reason?e.reason.description:""),1)])]),_:1})]),_:1})]),_:1},8,["modelValue","options","error"]),i(ne,{class:"q-mb-md",dense:"",clearable:"",outlined:"","transition-show":"flip-up","transition-hide":"flip-down",label:"Request Type",modelValue:e.restriction,"onUpdate:modelValue":t[2]||(t[2]=a=>e.restriction=a),options:e.getV3Options.restrictions,"option-label":"value",error:!!e.errors.restriction,"bottom-slots":""},{error:c(()=>[l("div",ht,w(e.errors.restriction),1)]),before:c(()=>[i(y,{size:"xs",color:"accent",round:"",icon:"question_mark"},{default:c(()=>[i(ce,{anchor:"top middle",self:"center middle",class:"bg-primary text-white"},{default:c(()=>[l("div",null,[l("div",bt,w(e.restriction?e.restriction.description:""),1)])]),_:1})]),_:1})]),hint:c(()=>[e.restriction?(b(),B("div",gt,w(e.restriction.warning||""),1)):X("",!0)]),_:1},8,["modelValue","options","error"])]),l("div",vt,[i(f,{dense:"",class:"q-mb-md",clearable:"",outlined:"",label:"Job Number",modelValue:e.jobNumber,"onUpdate:modelValue":t[3]||(t[3]=a=>e.jobNumber=a),"option-label":a=>a[11],"display-value":e.jobNumber?`${e.jobNumber[11]}`:"",error:!!e.errors.jobNumber,"error-message":e.errors.jobNumber,fetcher:e.jobNumberFetcher,getter:()=>e.getV3Options.jobNumbers,setter:a=>{e.setV3Options({prop:"jobNumbers",data:a})},filter:(a,u)=>a.filter(d=>d[17].toLowerCase().indexOf(u.toLowerCase())>-1),"bottom-slots":"",showTooltip:!0,tooltipMessage:"This is the job number that hiring costs should be charged to."},null,8,["modelValue","option-label","display-value","error","error-message","fetcher","getter","setter","filter"]),i(f,{dense:"",class:"q-mb-md",clearable:"",outlined:"",label:"Site Contact",modelValue:e.siteContact,"onUpdate:modelValue":t[4]||(t[4]=a=>e.siteContact=a),"option-label":a=>a[17],"display-value":e.siteContact?`${e.siteContact[17]}`:"",error:!!e.errors.siteContact,"error-message":e.errors.siteContact,fetcher:e.siteContactsFetcher,getter:()=>e.getV3Options.siteContacts,setter:a=>{e.setV3Options({prop:"siteContacts",data:a})},filter:(a,u)=>a.filter(d=>d[17].toLowerCase().indexOf(u.toLowerCase())>-1),"bottom-slots":"",showTooltip:!0,tooltipMessage:"This is the person that a new hire should contact when the arrive at the job site."},null,8,["modelValue","option-label","display-value","error","error-message","fetcher","getter","setter","filter"]),i(f,{dense:"",class:"q-mb-md",clearable:"",outlined:"",label:"Meeting Location",modelValue:e.meetingLocation,"onUpdate:modelValue":t[5]||(t[5]=a=>e.meetingLocation=a),"option-label":a=>a[6],"display-value":e.meetingLocation?`${e.meetingLocation[6]}`:"",error:!!e.errors.meetingLocation,"error-message":e.errors.meetingLocation,fetcher:e.meetingLocationsFetcher,getter:()=>e.getV3Options.meetingLocations,setter:a=>{e.setV3Options({prop:"meetingLocations",data:a})},filter:(a,u)=>a.filter(d=>d[6].toLowerCase().indexOf(u.toLowerCase())>-1),"bottom-slots":"",showTooltip:!0,tooltipMessage:"This is the location that the new hire should report to."},null,8,["modelValue","option-label","display-value","error","error-message","fetcher","getter","setter","filter"]),e.getV3Data.project[351]?(b(),R(f,{key:0,dense:"",class:"q-mb-md",clearable:"",outlined:"",label:"Per Diem (optional)",modelValue:e.perDiem,"onUpdate:modelValue":t[6]||(t[6]=a=>e.perDiem=a),"option-label":a=>a[20],"display-value":e.perDiem?`${e.perDiem[20]}`:"",error:!!e.errors.perDiem,"error-message":e.errors.perDiem,fetcher:e.perDiemFetcher,getter:()=>e.getV3Options.perDiem,setter:a=>{e.setV3Options({prop:"perDiem",data:a})},filter:(a,u)=>a.filter(d=>d[20].toLowerCase().indexOf(u.toLowerCase())>-1),"bottom-slots":"",showTooltip:!0,tooltipMessage:"If per diem is available, this is the specification for per diem for all classifications on this request. Add a separate request for any classifications that do not qualify for per diem."},null,8,["modelValue","option-label","display-value","error","error-message","fetcher","getter","setter","filter"])):X("",!0)]),l("div",qt,[i(ee,{outlined:"","input-style":"resize: none",maxlength:"2500",type:"textarea",modelValue:e.notes,"onUpdate:modelValue":t[7]||(t[7]=a=>e.notes=a),label:"Notes"},null,8,["modelValue"])])])]),_:1}),i(G,{align:"right"},{default:c(()=>[i(y,{color:"secondary",label:"Back",onClick:t[8]||(t[8]=a=>e.$emit("changeStep",0))}),i(y,{color:"info",label:"Continue",type:"submit",onClick:e.submit},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["onSubmit"])}var wt=J(nt,[["render",yt]]);const St={emits:["removeClassification"],props:{data:Array,matchTable:Boolean},setup(e,{emit:t}){return{columns:[{name:0,label:"Craft",align:"left",field:o=>o.craft[10],format:o=>`${o}`,sortable:!0},{name:1,label:"Classification",align:"left",field:o=>o.classification[18],format:o=>`${o}`,sortable:!0,required:!0},{name:2,label:"Pay Rate",align:"right",field:o=>o.rate,format:o=>`$ ${parseFloat(o).toFixed(2)}`},{name:3,label:"Quantity",align:"right",field:o=>o.qty,format:o=>`${parseFloat(o)}`},{name:4,label:"",align:"center",field:""}]}}},$t={class:"full-width row flex-center text-primary q-gutter-sm q-py-xs"};function jt(e,t,s,o,r,n){return b(),B("div",null,[i(Ve,qe(e.$attrs,{dense:"",title:e.$attrs.title?e.$attrs.title:"Saved Classifications","title-class":e.$attrs.titleClass?e.$attrs.titleClass:(e.$q.screen.gt.sm,"text-primary text-body1"),columns:o.columns,"row-key":f=>f.id,pagination:{rowsPerPage:10},"table-header-class":"bg-dark text-white","no-data-label":"You are required to add at least one classification!","hide-pagination":!0}),ve({"no-data":c(({message:f})=>[l("div",$t,[i(Pe,{size:"2em",name:"fa-solid fa-person-circle-exclamation"}),l("span",null,w(f),1)])]),_:2},[e.$attrs.hideRemove?void 0:{name:"body-cell-4",fn:c(f=>[i(ke,{class:"text-center","auto-width":""},{default:c(()=>[i(y,{flat:"",color:"accent",round:"",dense:"",onClick:a=>e.$emit("removeClassification",f.row),icon:"delete"},null,8,["onClick"])]),_:2},1024)]),key:"0"}]),1040,["title","title-class","columns","row-key"])])}var Re=J(St,[["render",jt]]);const Ct=se({emits:["changeStep"],props:{},components:{aSelect:Te,PayRateField:xe,ClassificationsTable:Re},setup(e,{emit:t}){const{getV3Data:s,setV3Data:o,getV3Options:r,setV3Options:n}=oe(),f=C(()=>s.general?s.general:{}),a=C(()=>s.matches?s.matches:null),u=C(()=>s.request?s.request:null),d=A({craft:A().required().nullable().label("Craft"),classification:A().required().nullable().label("Classification"),rate:je().required().nullable().label("Rate"),qty:je().required().nullable().label("Quantity")}),{errors:g,handleSubmit:h,resetForm:_,isSubmitting:S,setFieldError:q}=pe({validationSchema:d}),{value:E}=j("craft"),{value:F}=j("classification"),{value:z}=j("rate"),{value:Z}=j("qty"),m=h(async P=>{console.log(P),console.log(a.value);const Q=s.classifications.length+1;if(P.id=Q,a.value||u.value){const p=await et({job:P,matches:a.value?a.value:u.value});console.log(p),o({prop:"classifications",data:p,push:!0})}else o({prop:"classifications",data:P,push:!0});_()}),$=async()=>{if(s.project?s.project[3]:s.request?s.request[6]:null){const{data:Q}=await I.fetchFromProjectsApp({fields:[te({type:"projectCrafts",query:`{'7'.EX.'${s.project[3]}'}AND{'6'.EX.'Active'}`})]});return Q.sort((x,U)=>x[20]>U[20]?1:-1)}else return[]},M=C(()=>{const P=E.value&&E.value.classifications?E.value.classifications:[];return P.length>0?P.sort((Q,p)=>Q[32]>p[32]?-1:1):[]}),K=P=>{const Q=s.classifications.filter(p=>p.id!==P.id);o({prop:"classifications",data:Q,push:!1})};return ue(F,(P,Q)=>{P&&P.hasFixedRate?z.value=P.fixedRate:z.value&&(z.value=null)}),{submit:m,resetForm:_,errors:g,craft:E,classification:F,rate:z,qty:Z,getV3Data:s,getV3Options:r,setV3Options:n,craftsFetcher:$,classificationOptions:M,removeClassification:K,nextStep:()=>{f.value.restriction&&f.value.restriction.value!=="Open"?t("changeStep",3):u.value?u.value[282]!=="Open"?t("changeStep",1):t("changeStep",2):t("changeStep",4)},request:u}}}),Pt={class:"row justify-between"},Nt={class:"col-12 col-md-6 q-pr-md"},It=l("div",{class:"text-body2 text-italic text-weight-bold text-dark"}," Enter the following information about the classification and click Save. Repeat until all classifications you are requesting have been saved. Then click Continue. ",-1),Dt={class:"row q-mb-md"},kt={class:"col-6 q-pr-sm"},Vt={class:"col-6 q-pl-sm"},Ot={class:"text-caption"},Tt={class:"row"},Rt={class:"col-6 q-pr-sm"},At={class:"text-caption"},_t={class:"col-6 q-pl-sm"},Et={class:"col-12 col-md-6 q-pl-md"};function Ft(e,t,s,o,r,n){const f=L("a-select"),a=L("pay-rate-field"),u=L("classifications-table");return b(),B("div",null,[i(Y,{flat:""},{default:c(()=>[i(k,{class:"q-px-none q-pt-none"},{default:c(()=>[l("div",Pt,[l("div",Nt,[i(fe,{onSubmit:de(e.submit,["prevent"])},{default:c(()=>[i(Y,null,{default:c(()=>[i(k,null,{default:c(()=>[It,l("div",Dt,[l("div",kt,[i(f,{dense:"",class:"q-mt-md",clearable:"",label:"Select Craft",modelValue:e.craft,"onUpdate:modelValue":t[0]||(t[0]=d=>e.craft=d),"option-label":d=>d[10],"display-value":e.craft?`${e.craft[10]}`:"",error:!!e.errors.craft,"error-message":e.errors.craft,fetcher:e.craftsFetcher,getter:()=>e.getV3Options.crafts,setter:d=>{e.setV3Options({prop:"crafts",data:d})},filter:(d,g)=>d.filter(h=>h[10].toLowerCase().indexOf(g.toLowerCase())>-1),"bottom-slots":""},null,8,["modelValue","option-label","display-value","error","error-message","fetcher","getter","setter","filter"])]),l("div",Vt,[i(ne,{class:"q-mt-md",dense:"",clearable:"","transition-show":"flip-up","transition-hide":"flip-down",label:"Classification",modelValue:e.classification,"onUpdate:modelValue":t[1]||(t[1]=d=>e.classification=d),options:e.classificationOptions,"option-label":d=>d[18],"display-value":e.classification?`${e.classification[18]}`:"",error:!!e.errors.classification,"bottom-slots":"",disable:!e.craft},{error:c(()=>[l("div",Ot,w(e.errors.classification),1)]),_:1},8,["modelValue","options","option-label","display-value","error","disable"])])]),l("div",Tt,[l("div",Rt,[i(ee,{dense:"",type:"number",label:"Quantity",modelValue:e.qty,"onUpdate:modelValue":t[2]||(t[2]=d=>e.qty=d),modelModifiers:{number:!0},error:!!e.errors.qty,disable:!e.classification,"bottom-slots":""},{error:c(()=>[l("div",At,w(e.errors.qty),1)]),_:1},8,["modelValue","error","disable"])]),l("div",_t,[i(a,{class:"q-mb-md",type:"number",step:"any",dense:"",label:"Hourly Rate",modelValue:e.rate,"onUpdate:modelValue":t[3]||(t[3]=d=>e.rate=d),modelModifiers:{number:!0},prefix:"$",disable:!e.classification||e.classification.hasFixedRate&&!e.$can("manage","rates"),error:!!e.errors.rate,"error-message":e.errors.rate,"bottom-slots":""},null,8,["modelValue","disable","error","error-message"])])])]),_:1}),i(G,{align:"right"},{default:c(()=>[i(y,{dense:"",color:"accent",label:"Reset",onClick:e.resetForm},null,8,["onClick"]),i(y,{dense:"",color:"primary",label:"Save",type:"submit",onClick:e.submit},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),l("div",Et,[i(u,{rows:e.getV3Data.classifications,onRemoveClassification:e.removeClassification},null,8,["rows","onRemoveClassification"])])])]),_:1}),i(G,{class:"q-pb-none",align:"right"},{default:c(()=>[e.request?X("",!0):(b(),R(y,{key:0,color:"secondary",label:"Back",onClick:t[4]||(t[4]=d=>e.$emit("changeStep",1))})),i(y,{color:"info",label:"Continue",disable:e.getV3Data.classifications.length===0,onClick:e.nextStep},null,8,["disable","onClick"])]),_:1})]),_:1})])}var Lt=J(Ct,[["render",Ft]]);const Mt={emits:["removeName","viewEmployee"],props:{data:Array},components:{},setup(e,{emit:t}){const s=[{name:1,label:"Name",align:"left",field:n=>n.firstName,format:(n,f)=>`${n} ${f.lastName}`,sortable:!0},{name:2,label:"Phone",align:"left",field:n=>n.phoneNumber,format:n=>`${r(n)}`,sortable:!0,required:!0},{name:3,label:"Last 4",align:"left",field:n=>n.ssn,format:n=>`${n}`,sortable:!0},{name:4,label:"Classification",align:"left",field:n=>n.job.classification[18],format:n=>`${n}`,sortable:!0,required:!0},{name:6,label:"",align:"center",field:""}],o=n=>{t("viewEmployee",n)},r=n=>{const a=(""+n).replace(/\D/g,"").match(/^(\d{3})(\d{3})(\d{4})$/);return a?`(${a[1]}) ${a[2]}-${a[3]}`:null};return{props:e,columns:s,viewEmployee:o,formatPhone:r}}},Bt={class:"full-width row flex-center text-primary q-gutter-sm q-py-xs"};function Qt(e,t,s,o,r,n){return b(),B("div",null,[i(Ve,qe(e.$attrs,{dense:"",title:e.$attrs.title?e.$attrs.title:"People","title-class":e.$attrs.titleClass?e.$attrs.titleClass:(e.$q.screen.gt.sm,"text-primary text-body1"),columns:o.columns,rows:o.props.data,"row-key":f=>f.ssn,pagination:{rowsPerPage:10},"table-header-class":"bg-dark text-white","no-data-label":"No People Added","hide-pagination":!0}),ve({"no-data":c(({message:f})=>[l("div",Bt,[i(Pe,{size:"2em",name:"fa-solid fa-person-circle-exclamation"}),l("span",null,w(f),1)])]),_:2},[e.$attrs.hideRemove?void 0:{name:"body-cell-6",fn:c(f=>[i(ke,{class:"text-center","auto-width":""},{default:c(()=>[i(y,{flat:"",color:"accent",round:"",dense:"",onClick:a=>e.$emit("removeName",f.row),icon:"delete_forever"},null,8,["onClick"])]),_:2},1024)]),key:"0"}]),1040,["title","title-class","columns","rows","row-key"])])}var Ae=J(Mt,[["render",Qt]]);const Ut=se({emits:["changeStep"],props:{},components:{ClassificationsTable:Re,NamesTable:Ae},setup(e,{emit:t}){const s=ge(),o=Ne(),r=Ie(),{capitalize:n}=We,{getUserType:f}=D(),a=oe(),{getV3Data:u}=De(a),d=u.value.general?u.value.general:null,g=C(()=>u.value.matches?u.value.matches:null),h=C(()=>u.request?u.request:null),_=C(()=>u.value.classifications.filter($=>$.match)),S=C(()=>u.value.classifications.filter($=>!$.match)),q=m=>{const $=m.split(" ");let M="";return $.forEach((K,ae)=>{M+=ae>0?` ${n(K.toLowerCase())}`:n(K.toLowerCase())}),M},E=C(()=>g.value?h.value?[{label:"Request Number",value:h.value[3]},{label:"Date Submitted",value:v(h.value[1].$d).format("MM/DD/YYYY")},{label:"Hiring Center",value:h.value[103]},{label:"Current Status",value:h.value[14]}]:null:[{label:"Request Number",value:g.value[3]},{label:"Date Submitted",value:v(g.value[1].$d).format("MM/DD/YYYY")},{label:"Hiring Center",value:g.value[103]},{label:"Current Status",value:g.value[14]}]),F=C(()=>{let m;return d?m=[{label:"Project",value:u.value.project?u.value.project[43]:"N/A"},{label:"Date Needed",value:v(d.dateNeeded).format("MM/DD/YYYY")},{label:"Request Reason",value:d.reason.label},{label:"Request Type",value:d.restriction.value},{label:"Job Number",value:d.jobNumber[11]},{label:"Meeting Location",value:q(d.meetingLocation[6])},{label:"Meeting Location Address",value:d.meetingLocation[7]},{label:"Site Contact",value:q(d.siteContact[17])},{label:"Per Diem",value:d.perDiem?d.perDiem[20]:"N/A"},{label:"Notes",value:d.notes}]:m=[],m});return{getV3Data:u,details:F,matchDetails:E,changeStep:()=>{h.value?h.value[282]!=="Open"?t("changeStep",1):t("changeStep",0):d.restriction.value!=="Open"?t("changeStep",3):t("changeStep",2)},submitRequest:async()=>{const m=o.params.project?{name:"project-requests",params:{id:o.params.project}}:f==="Project User"?{name:"requests"}:null;s.loading.show({message:"Submitting Request Now"});try{const{data:$}=await tt({data:u.value});s.loading.hide(),s.notify({type:"positive",message:g.value?"Hire Request successfully updated":"Hire Request successfully added"}),m?r.replace({name:"hire-request",params:{id:$[3]}}):window.close(),a.$reset()}catch{s.loading.hide(),s.notify({type:"negative",message:"There was a problem add request"})}},match:g,classWithMatch:_,classNoMatch:S}}}),Xt=l("div",{class:"text-body2 text-italic text-weight-bold text-dark"}," Review the information below. If changes are needed, click Back. If all information is correct, click Submit to complete this request. ",-1),zt={class:"row"},Ht={class:"col-12 col-md-6 q-pr-md"},Yt=l("div",{class:"text-body1 text-primary text-weight-bold"},"General Information",-1),Wt={class:"row"},Jt={class:"col-12 col-md-4"},Gt={class:"text-weight-bold text-caption"},Zt={class:"col-12 col-md-8"},Kt={class:"text-dark text-caption"},xt={class:"col-12 col-md-6 q-pl-md"},es={key:1,class:"row justify-center"},ts={class:"col-12 col-md-10"},ss=l("div",{class:"text-primary text-h6 text-weight-bold"},"Matching Request Found",-1),os=l("div",{class:"text-body2 text-italic"}," The information that you entered on this request matches another request that you submitted recently. ",-1),as=l("div",{style:{"text-decoration":"underline"},class:"text-body2 text-accent text-italic"},"This request will be updated with the below classification and name changes, where applicable.",-1),rs={class:"row q-mb-md"},is={key:0,class:"col-12 col-md-3 q-pr-sm"},ns={class:"row q-mt-md"},ls={class:"col-12 col-md-6 q-pr-md"},cs={class:"col-12 col-md-6 q-pl-md"};function us(e,t,s,o,r,n){const f=L("classifications-table"),a=L("names-table");return b(),B("div",null,[e.match?(b(),B("div",es,[l("div",ts,[i(Y,null,{default:c(()=>[i(k,null,{default:c(()=>[ss,os,as]),_:1}),i(k,{class:"q-py-none"},{default:c(()=>[l("div",rs,[(b(!0),B(be,null,Se(e.matchDetails,(u,d)=>(b(),B(be,{key:d},[u.hide?X("",!0):(b(),B("div",is,[l("div",{class:$e(["text-weight-bold",e.$q.screen.gt.lg?"text-body2":"text-caption"])},w(u.label),3),l("div",{class:$e(["q-pl-sm text-weight-light",e.$q.screen.gt.lg?"text-body2":"text-caption"])},w(u.value),3)]))],64))),128))]),i(Ye),l("div",ns,[l("div",ls,[e.classWithMatch.length>0?(b(),R(f,{key:0,class:"q-mb-md",matchTable:!0,titleClass:"text-body1 text-accent",title:"Classifications to Update",hideRemove:!0,rows:e.classWithMatch},null,8,["rows"])):X("",!0),e.classNoMatch.length>0?(b(),R(f,{key:1,titleClass:"text-body1 text-dark",title:e.match?"Classifications to Add":"Classifications",hideRemove:!0,rows:e.classNoMatch},null,8,["title","rows"])):X("",!0)]),l("div",cs,[e.getV3Data.names.length>0?(b(),R(a,{key:0,titleClass:"text-body1 text-primary",title:"People to Add",hideRemove:!0,data:e.getV3Data.names},null,8,["data"])):X("",!0)])])]),_:1}),i(G,{align:"right"},{default:c(()=>[i(y,{color:"secondary",label:"Back",onClick:e.changeStep},null,8,["onClick"]),i(y,{color:"info",label:"Submit",onClick:e.submitRequest},null,8,["onClick"])]),_:1})]),_:1})])])):(b(),R(Y,{key:0,flat:""},{default:c(()=>[i(k,{class:"q-pt-none q-px-none"},{default:c(()=>[Xt]),_:1}),i(k,{class:"q-px-none q-pt-none"},{default:c(()=>[l("div",zt,[l("div",Ht,[i(Y,null,{default:c(()=>[i(k,{class:"q-pa-sm"},{default:c(()=>[Yt]),_:1}),(b(!0),B(be,null,Se(e.details,(u,d)=>(b(),R(k,{key:d,class:"q-pa-sm"},{default:c(()=>[l("div",Wt,[l("div",Jt,[l("div",null,[l("span",Gt,w(u.label),1)])]),l("div",Zt,[l("div",null,[l("span",Kt,w(u.value===""?"N/A":u.value),1)])])])]),_:2},1024))),128))]),_:1})]),l("div",xt,[e.classNoMatch.length>0?(b(),R(f,{key:0,class:"q-mb-md",titleClass:"text-body1 text-primary text-weight-bold",title:e.match?"Classifications to Add":"Classifications",hideRemove:!0,rows:e.classNoMatch},null,8,["title","rows"])):X("",!0),e.match&&e.classWithMatch.length>0?(b(),R(f,{key:1,matchTable:!0,class:"q-mb-md",titleClass:"text-body1 text-primary text-weight-bold",title:"Classifications to Update",hideRemove:!0,rows:e.classWithMatch},null,8,["rows"])):X("",!0),e.getV3Data.names.length>0?(b(),R(a,{key:2,class:"q-mb-md",titleClass:"text-body1 text-primary text-weight-bold",title:"People",hideRemove:!0,data:e.getV3Data.names},null,8,["data"])):X("",!0),i(G,{class:"q-pb-none q-pt-lg q-px-none",align:"right"},{default:c(()=>[i(y,{color:"secondary",label:"Back",onClick:e.changeStep},null,8,["onClick"]),i(y,{color:"info",label:"Submit",onClick:e.submitRequest},null,8,["onClick"])]),_:1})])])]),_:1})]),_:1}))])}var ds=J(Ut,[["render",us]]);const fs=se({emits:["changeStep"],props:{},components:{NamesTable:Ae},setup(e,{emit:t}){const s=H(10),{getV3Data:o,setV3Data:r,getV3Options:n,setV3Options:f}=oe();o.general&&o.general;const a=C(()=>{const m=new RegExp("^[0-9]{"+s.value+"}","g");return A({job:A().required("Classification is required"),firstName:ie().required().label("First Name"),lastName:ie().required().label("Last Name"),phoneNumber:ie().matches(m,{excludeEmptyString:!0,message:"Number Only!"}).required().label("Phone Number"),ssn:ie().matches(/^\d+$/,{excludeEmptyString:!0,message:"Numbers Only!"}).label("Last 4 of SSN")})}),{errors:u,handleSubmit:d,resetForm:g,isSubmitting:h}=pe({validationSchema:a,initialValues:{job:o.classifications.length===1?o.classifications[0]:null}}),{value:_}=j("job"),{value:S}=j("firstName"),{value:q}=j("lastName"),{value:E}=j("phoneNumber"),{value:F}=j("ssn");return{submit:d(m=>{console.log(m);const $=o.names.length+1;m.id=$,r({prop:"names",data:m,push:!0}),g()}),resetForm:g,errors:u,getV3Data:o,job:_,firstName:S,lastName:q,phoneNumber:E,ssn:F,removeName:m=>{const $=o.names.filter(M=>M.id!==m.id);r({prop:"names",data:$,push:!1})}}}}),ps={class:"row justify-between"},ms={class:"col-12 col-md-6 q-pr-md"},hs=l("div",{class:"text-body2 text-italic text-weight-bold text-dark"}," Enter the following information about the people and click Save. Repeat until all people you are requesting have been saved. Then click Continue. You may also skip adding names if you do not have them yet. ",-1),bs={class:"row q-mb-md"},gs={class:"col-6"},vs={class:"text-caption"},qs={class:"row"},ys={class:"col-6 q-pr-sm"},ws={class:"text-caption"},Ss={class:"col-6 q-pl-sm"},$s={class:"text-caption"},js={class:"row"},Cs={class:"col-6 q-pr-sm"},Ps={class:"text-caption"},Ns={class:"col-6 q-pl-sm"},Is={class:"text-caption"},Ds={class:"col-12 col-md-6 q-pl-md"};function ks(e,t,s,o,r,n){const f=L("names-table");return b(),B("div",null,[i(Y,{flat:""},{default:c(()=>[i(k,{class:"q-px-none q-pt-none"},{default:c(()=>[l("div",ps,[l("div",ms,[i(fe,{onSubmit:de(e.submit,["prevent"])},{default:c(()=>[i(Y,null,{default:c(()=>[i(k,null,{default:c(()=>[hs,l("div",bs,[l("div",gs,[i(ne,{class:"q-mt-md",dense:"",clearable:"","transition-show":"flip-up","transition-hide":"flip-down",label:"Classification",modelValue:e.job,"onUpdate:modelValue":t[0]||(t[0]=a=>e.job=a),options:e.getV3Data.classifications,"option-label":a=>a.classification[18],"display-value":e.job?`${e.job.classification[18]}`:"",error:!!e.errors.job,"bottom-slots":""},{error:c(()=>[l("div",vs,w(e.errors.job),1)]),_:1},8,["modelValue","options","option-label","display-value","error"])])]),l("div",qs,[l("div",ys,[i(ee,{dense:"",type:"text",label:"First Name",modelValue:e.firstName,"onUpdate:modelValue":t[1]||(t[1]=a=>e.firstName=a),error:!!e.errors.firstName,"bottom-slots":""},{error:c(()=>[l("div",ws,w(e.errors.firstName),1)]),_:1},8,["modelValue","error"])]),l("div",Ss,[i(ee,{dense:"",type:"text",label:"Last Name",modelValue:e.lastName,"onUpdate:modelValue":t[2]||(t[2]=a=>e.lastName=a),error:!!e.errors.lastName,"bottom-slots":""},{error:c(()=>[l("div",$s,w(e.errors.lastName),1)]),_:1},8,["modelValue","error"])])]),l("div",js,[l("div",Cs,[i(ee,{dense:"",type:"tel",label:"Phone Number",modelValue:e.phoneNumber,"onUpdate:modelValue":t[3]||(t[3]=a=>e.phoneNumber=a),error:!!e.errors.phoneNumber,"bottom-slots":""},{error:c(()=>[l("div",Ps,w(e.errors.phoneNumber),1)]),_:1},8,["modelValue","error"])]),l("div",Ns,[i(ee,{dense:"",maxlength:"4",label:"SSN Last 4 (Optional)",modelValue:e.ssn,"onUpdate:modelValue":t[4]||(t[4]=a=>e.ssn=a),error:!!e.errors.ssn,"bottom-slots":""},{error:c(()=>[l("div",Is,w(e.errors.ssn),1)]),_:1},8,["modelValue","error"])])])]),_:1}),i(G,{align:"right"},{default:c(()=>[i(y,{dense:"",color:"accent",label:"Reset",onClick:e.resetForm},null,8,["onClick"]),i(y,{dense:"",color:"primary",label:"Save",type:"submit",onClick:e.submit},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),l("div",Ds,[i(f,{data:e.getV3Data.names,onRemoveName:e.removeName},null,8,["data","onRemoveName"])])])]),_:1}),i(G,{class:"q-pb-none",align:"right"},{default:c(()=>[i(y,{color:"secondary",label:"Back",onClick:t[5]||(t[5]=a=>e.$emit("changeStep",2))}),i(y,{color:"info",label:e.getV3Data.names.length===0?"Skip Names":"Continue",onClick:t[6]||(t[6]=a=>e.$emit("changeStep",4))},null,8,["label"])]),_:1})]),_:1})])}var Vs=J(fs,[["render",ks]]);const Os=se({components:{GeneralStep:wt,ClassificationsStep:Lt,ReviewStep:ds,NamesStep:Vs,projectSelector:st},setup(){const e=ge(),t=Ne(),s=Ie(),o=H(0),r=H(null),n=H(null),f=H(null),a=H(null),u=He(),{getV3Data:d,setV3Data:g,setV3Options:h,getV3Options:_,resetV3Data:S}=oe(),{getSelectedProject:q}=De(u),{userData:E,getUserType:F,userOffices:z,userProjects:Z}=D(),{getProjects:m,fetchAllProjects:$}=Oe(),{getViewedProjects:M,setViewedProjects:K}=Ze(),ae=A({projectSelection:A().required().nullable().label("Project")}),{errors:P,handleSubmit:Q}=pe({validationSchema:ae}),{value:p}=j("projectSelection");q.value&&(p.value=q.value),ue(q,()=>{q.value?p.value=q.value:p.value=null});const x=Q(N=>{g({prop:"project",data:N.projectSelection}),le(1)}),U=()=>{e.dialog({title:"Confirm",message:"Are you sure you want to cancel this new request?",persistent:!0,cancel:!0}).onOk(()=>{S(),t.params.project?s.replace({name:"project-general",params:{id:t.params.project}}):s.replace({name:"requests"})})},W=C(()=>d),le=N=>{N===0?(S(),q.value&&(p.value=q.value)):N===2&&_e(),o.value=N},_e=async()=>{const{project:N}=d,{jobNumber:T,siteContact:Me,perDiem:ye,meetingLocation:Be,restriction:Qe}=d.general,{data:we}=await I.fetchFromProjectsApp({fields:[te({type:"requests",query:`({'1'.IR.'today'}OR{'1'.IR.'last 3 d'})AND{'282'.EX.'${Qe.value}'}AND{'180'.XEX.'Shared'}AND{'14'.XEX.'Closed'}AND{'14'.XEX.'Cancelled'}AND{'6'.EX.'${N[3]}'}AND{'31'.EX.'${Be[3]}'}AND{'9'.EX.'${T[3]}'}AND{'60'.EX.'${Me[3]}'}${ye?`AND{'65'.EX.'${ye[3]}'}`:""}`})]}),he=we.length>0?we.sort((Ue,Xe)=>Ue[1].$d>Xe[1].$d?-1:1):null;he&&(console.log(he[0]),g({prop:"matches",data:he[0]}))};C(()=>z());const me=C(()=>Z()),Ee=C(()=>{const N=[];return me.value.forEach(T=>{N.push(T.project)}),m().forEach(T=>{N.push(T)}),[...new Map(N.map(T=>[T[3],T])).values()]}),Fe=async()=>{F==="Project User"?me.value.length>0&&h({prop:"projects",data:me.value}):F==="QuickBase User"&&(m().length>0?_.projects.length!==m().length&&h({prop:"projects",data:m()}):(await $(),m().length>0&&_.projects.length!==m().length&&h({prop:"projects",data:m()})))},Le=async N=>{if(M(N))g({prop:"project",data:M(N)}),h({prop:"projects",data:[M(N)]}),p.value=M(N),le(1);else{e.loading.show();const{data:T}=await I.fetchFromProjectsApp({fields:[te({type:"projects",id:N})]});console.log(T),g({prop:"project",data:T}),h({prop:"projects",data:[T]}),K({id:t.params.project,data:T}),p.value=T,le(1),e.loading.hide()}};return t.params.project?Le(t.params.project):Fe(),{step:o,changeStep:le,general:r,classifications:n,names:f,match:a,data:W,allProjects:Ee,formErrors:P,projectSelection:p,submit:x,cancelNew:U,getV3Data:d}}}),Ts=l("div",{class:"text-h6 text-info"},"Add a New Hire Request",-1),Rs=l("div",{class:"text-body2 text-dark text-italic"},"Complete the steps below to submit a new hire request.",-1),As=l("div",{class:"text-body2 text-italic text-weight-bold text-dark"},"Please select the project that this request is for.",-1);function _s(e,t,s,o,r,n){const f=L("projectSelector"),a=L("general-step"),u=L("classifications-step"),d=L("names-step"),g=L("review-step");return b(),B("div",null,[i(Y,{flat:""},{default:c(()=>[i(k,{class:"q-py-sm"},{default:c(()=>[Ts,Rs]),_:1}),i(k,{class:"q-pa-none"},{default:c(()=>[i(Je,{flat:"",modelValue:e.step,"onUpdate:modelValue":t[0]||(t[0]=h=>e.step=h),color:"info","active-icon":"build","done-icon":"task_alt","active-color":"accent","done-color":"info",animated:""},{default:c(()=>[i(re,{name:0,title:e.getV3Data.project?e.getV3Data.project[20]:"Select Project",prefix:"1",done:e.step>0},{default:c(()=>[i(fe,{onSubmit:de(e.submit,["prevent"])},{default:c(()=>[i(Y,{flat:""},{default:c(()=>[i(k,{class:"q-pt-none q-px-none"},{default:c(()=>[As]),_:1}),i(k,{class:"q-pa-none"},{default:c(()=>[i(f,{can:"read",styleSelection:!0,error:!!e.formErrors.projectSelection,style:{"max-width":"500px"}},null,8,["error"])]),_:1}),i(G,{align:"right"},{default:c(()=>[i(y,{color:"secondary",label:"Cancel",onClick:e.cancelNew},null,8,["onClick"]),i(y,{color:"info",label:"Continue",type:"submit",onClick:e.submit},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1},8,["title","done"]),i(re,{name:1,title:"General Information",prefix:"2",done:e.step>1},{default:c(()=>[i(a,{onChangeStep:e.changeStep},null,8,["onChangeStep"])]),_:1},8,["done"]),i(re,{name:2,title:e.step===2?"Add Classifications":e.step>2?"Classifications Added":"Classifications",prefix:"3",done:e.step>2},{default:c(()=>[i(u,{onChangeStep:e.changeStep},null,8,["onChangeStep"])]),_:1},8,["title","done"]),e.data.general&&e.data.general.restriction.value!=="Open"?(b(),R(re,{key:0,name:3,title:e.step===3?"Add Names":"Names",prefix:e.data.general&&e.data.general.restriction.value!=="Open"?"4":"",done:e.step>3},{default:c(()=>[i(d,{onChangeStep:e.changeStep},null,8,["onChangeStep"])]),_:1},8,["title","prefix","done"])):X("",!0),i(re,{name:4,title:"Review",prefix:e.data.general&&e.data.general.restriction.value!=="Open"?"5":"4",done:e.step>4},{default:c(()=>[i(g,{onChangeStep:e.changeStep},null,8,["onChangeStep"])]),_:1},8,["prefix","done"])]),_:1},8,["modelValue"])]),_:1})]),_:1})])}var Es=J(Os,[["render",_s]]);const Fs={name:"New Request",components:{RequestFormStepper:Es},setup(){ge();const{userOffices:e,userProjects:t}=D(),{getProjects:s,fetchAllProjects:o}=Oe(),{setNewRequestData:r,getDbData:n,getHumanizedData:f,getHumanizedClassificationData:a}=oe(),u=H(0),d=H(!1);C(()=>e());const g=C(()=>t()),h=C(()=>{const S=[];return g.value.forEach(q=>{S.push(q.project)}),s().forEach(q=>{S.push(q)}),[...new Map(S.map(q=>[q[3],q])).values()]});function _(){(u.value>1||h.value.length>1)&&(u.value=u.value-1)}return ue(h,(S,q)=>{if(S.length===1){u.value=1;const E={6:{value:S[0][3]},92:{value:S[0][12]}},F={project:S[0]};r({humanized:F,database:E})}}),ue(u,()=>{console.log(f),console.log(a)}),{allProjects:h,step:u,goBack:_,getDbData:n,showCart:d}}},Ls={class:"q-pa-sm"};function Ms(e,t,s,o,r,n){const f=L("request-form-stepper");return b(),R(ze,{style:{"max-width":"100vw"}},{default:c(()=>[l("div",Ls,[i(f)])]),_:1})}var wo=J(Fs,[["render",Ms]]);export{wo as default};
