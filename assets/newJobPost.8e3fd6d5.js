import{a7 as H,bX as B,B as O,as as j,ax as W,b6 as X,bt as t,D as K,ad as Z,aJ as ee,aa as e,E as o,H as oe,ae as w,I as te,r as $,w as C,d as a,cV as se,bQ as ae,cW as D,at as le,b as J,cY as ie,bY as R}from"./index.960d5b34.js";import{a as g}from"./QSelect.ce23f885.js";import{Q as re}from"./QSpinnerGears.4fd5f8fe.js";import{Q as ne}from"./QForm.f3e65354.js";import{Q as de}from"./QPage.8d15663e.js";import{a as ce,u as Q}from"./vee-validate.esm.d4095220.js";import{a as h}from"./array.164cfe36.js";import{u as ue,c as I,b as pe}from"./app.bda2cd70.js";import{u as fe}from"./use-quasar.09536e80.js";import"./QChip.e4d2f168.js";import"./QMenu.dd57348b.js";import"./position-engine.40859e34.js";import"./selection.4cab378b.js";import"./rtl.b51694b1.js";import"./_commonjsHelpers.a26ce4be.js";import"./dayjs.501e8a8e.js";import"./localForage.84a30b23.js";import"./index.04bc0a32.js";import"./i18n.2abc02f2.js";const me={__name:"officeSelectorAlt",props:{can:{type:String,default:"read"},twilio:{type:Boolean,default:!1},styleSelection:{type:Boolean,default:!1}},setup(k){const x=k,{can:p,twilio:S,styleSelection:A}=H(x),F=ue(),y=I(),{userOffices:f}=B(F),{setSelectedOffice:v}=y,{getSelectedOffice:m}=B(y);m.value||(f.value(p.value).length>1&&f.value(p.value).forEach(l=>{l[15]===!0&&v(l,!0)}),m.value||v(f.value(p.value)[0],!0));const i=l=>{v(l,!0)};return(l,L)=>(O(),j(g,te({"model-value":e(m),options:e(f)(e(p),e(S))},l.$attrs,{"onUpdate:modelValue":i,label:e(m)?"Office":"Select Office","option-label":"11","option-value":"8",clearable:!1,dense:""}),W({_:2},[X(l.$slots,(q,V)=>({name:V,fn:t(r=>[K(l.$slots,V,Z(ee(r)))])})),e(A)?{name:"selected-item",fn:t(q=>[o("span",{class:oe(["text-primary",l.$q.screen.gt.sm?"text-h6":""])},w(q.opt[11]),3)]),key:"0"}:void 0]),1040,["model-value","options","label"]))}},be={class:"row justify-center q-pt-sm"},ve={class:"col-12 col-md-8"},_e=o("div",{class:"text-h5 text-dark"},"Post a New Job",-1),he=o("div",{class:"text-primary text-h6 q-mb-sm"},"Job Details",-1),we={class:"row"},ge={class:"col-12 q-pr-md"},Se={class:"row"},ye={class:"col-12 q-pr-md"},qe={class:"text-caption"},Ve={class:"row"},Ce={class:"col-12 q-pr-md"},Je={class:"text-caption"},Qe={class:"row"},xe={class:"col-12 q-pr-md"},Ae={class:"text-caption"},Fe={class:"row"},Pe={class:"col-12 q-pr-md"},Be={class:"text-caption"},Ke={__name:"newJobPost",setup(k){const x=fe(),{userType:p}=pe(),S=I(),{fetchCrafts:A,fetchLocations:F,fetchAllLocations:y,fetchJobs:f,fetchJobAliases:v}=S,{getCrafts:m,getSelectedOffice:i,getLocations:l,getJobs:L,getJobAliases:q}=B(S);$([]),$([]);const V=h({location:h().nullable().required().label("Location"),craft:h().nullable().required().label("Craft"),job:h().nullable().label("Job"),alias:h().nullable().required().label("Alias")}),{errors:r,handleSubmit:E,handleReset:T,isSubmitting:b}=ce({validationSchema:V}),{value:_}=Q("location"),{value:n,resetField:z}=Q("craft"),{value:d,resetField:M}=Q("job"),{value:P,resetField:Y}=Q("alias"),U=c=>{i.value?F({selectedId:i.value[8],refresh:c}):y({can:"read",refresh:c})};i.value&&U(!0),A({refresh:!1}),C(i,()=>{U(!0),T()}),C(_,()=>{z()}),C(n,()=>{M(),n.value&&f({selectedId:n.value.value})}),C(d,()=>{Y(),d.value&&v({selectedId:d.value.value})});const G=E(async c=>{try{const s=[{12:{value:i.value[8]},14:{value:c.job[3]},16:{value:c.craft[3]},18:{value:c.alias[3]},33:{value:c.location[3]},47:{value:"now"}}];console.log(s),N()}catch(s){console.log(s),x.notify({position:"top-right",type:"negative",message:"There was a problem submitting Job Post!"})}}),N=()=>{console.log(window.parent,window.opener),window.parent&&window.parent.postMessage("refreshData")};return(c,s)=>(O(),j(de,{style:{"max-width":"100vw","max-height":"100vh"}},{default:t(()=>[o("div",be,[o("div",ve,[a(se,{flat:""},{default:t(()=>[a(ne,{onSubmit:ae(e(G),["prevent"])},{default:t(()=>[a(D,{class:"q-pb-lg"},{default:t(()=>[_e]),_:1}),a(D,{class:"q-pl-lg q-pt-none"},{default:t(()=>[he,o("div",we,[o("div",ge,[e(p)==="QuickBase User"?(O(),j(me,{key:0,can:"read",styleSelection:!1,outlined:"",dense:"",class:"q-mb-md"})):le("",!0)])]),o("div",Se,[o("div",ye,[a(g,{dense:"",outlined:"",label:"Location","transition-show":"flip-up","transition-hide":"flip-down",modelValue:e(_),"onUpdate:modelValue":s[0]||(s[0]=u=>J(_)?_.value=u:null),options:e(l)(e(i)?e(i)[8]:null),"bottom-slots":"",error:!!e(r).location,disable:e(b)||!e(i)},{error:t(()=>[o("div",qe,w(e(r).location),1)]),_:1},8,["modelValue","options","error","disable"])])]),o("div",Ve,[o("div",Ce,[a(g,{dense:"",outlined:"",label:"Craft","transition-show":"flip-up","transition-hide":"flip-down",modelValue:e(n),"onUpdate:modelValue":s[1]||(s[1]=u=>J(n)?n.value=u:null),options:e(m),"bottom-slots":"",error:!!e(r).craft,disable:e(b)||!e(_)},{error:t(()=>[o("div",Je,w(e(r).craft),1)]),_:1},8,["modelValue","options","error","disable"])])]),o("div",Qe,[o("div",xe,[a(g,{dense:"",outlined:"",label:"Job","transition-show":"flip-up","transition-hide":"flip-down",modelValue:e(d),"onUpdate:modelValue":s[2]||(s[2]=u=>J(d)?d.value=u:null),options:e(L)(e(n)?e(n).value:null),"bottom-slots":"",error:!!e(r).job,disable:e(b)||!e(n)},{error:t(()=>[o("div",Ae,w(e(r).job),1)]),_:1},8,["modelValue","options","error","disable"])])]),o("div",Fe,[o("div",Pe,[a(g,{dense:"",outlined:"",label:"Alias","transition-show":"flip-up","transition-hide":"flip-down",modelValue:e(P),"onUpdate:modelValue":s[3]||(s[3]=u=>J(P)?P.value=u:null),options:e(q)(e(d)?e(d).value:null),"bottom-slots":"",error:!!e(r).alias,disable:e(b)||!e(d)},{error:t(()=>[o("div",Be,w(e(r).alias),1)]),_:1},8,["modelValue","options","error","disable"])])])]),_:1}),a(ie,{class:"q-pl-lg q-py-lg",align:"right"},{default:t(()=>[a(R,{loading:e(b),disable:e(b),color:"primary",label:"Save & Close",type:"submit"},{loading:t(()=>[a(re)]),_:1},8,["loading","disable"]),a(R,{class:"q-mr-lg",color:"secondary",label:"Cancel",onClick:N})]),_:1})]),_:1},8,["onSubmit"])]),_:1})])])]),_:1}))}};export{Ke as default};
