import{Q as V}from"./QPage.18854c58.js";import{u as Y,k as A,c1 as q,c4 as T,r as p,w as j,_ as w,z as l,A as h,C as n,aa as _,am as m,bh as o,d as s,c2 as d,d4 as B,cx as O,an as v,b$ as U,c6 as N,cy as E,c3 as D,c5 as M,aY as z}from"./index.be20b90c.js";import{q as C,c as F,e as H,u as $,f as I}from"./quickbase.e729000e.js";import{u as K}from"./use-quasar.27122bf0.js";import"./_commonjsHelpers.dfee5925.js";import"./dayjs.89050af1.js";import"./localForage.ee205151.js";import"./index.7dbe61ef.js";import"./i18n.01339855.js";import"./api.8ea9d2ce.js";const Q=Y("QRStore",{state:()=>({qr:{}}),getters:{getQR:e=>e.qr},actions:{async fetchQRData(e){const a=[{6:{value:"bskbpgnwb"},7:{value:"Table Record"},9:{value:e},14:{value:7}}],{data:t}=await C.fetchFromStructureApp({fields:a});t&&(this.qr=t)}}}),L=A({setup(){const e=K(),{setEvent:a}=F(),{getQR:t}=q(Q()),{employeeData:r}=H(),{getUser:i}=$(),b=$(),c=T(),y=p(!1),R=p(!1),f=p(""),k=p(""),S=async()=>{a(null),b.logout().then(()=>{c.replace({name:"login"})})};async function x(){const u={12:{value:r[3]},6:{value:t.value[17]},13:{value:t.value[16]},17:{value:t.value[14]},23:{value:t.value[3]},10:{value:`${i[35]} ${i[37]}`}};t.value[17]==="date"?Object.assign(u,{8:{value:f.value}}):t.value[17]==="checkbox"||t.value[20]?Object.assign(u,{9:{value:y.value}}):Object.assign(u,{7:{value:k.value}});try{const{data:g}=await C.upsertRecordsXML({to:"bsi3t4bcz",data:[u],fieldsToReturn:[11],formatObject:11});g&&(R.value=!0,setTimeout(function(){S()},5e3))}catch{e.notify({type:"negative",message:"There was a problem submitting"})}}return j(y,(u,g)=>{u?f.value=I.formatDate(Date.now(),"YYYY-MM-DD"):f.value=""}),{getQR:t,confirmation:y,submitted:R,submitAttendanceRecord:x,employeeData:r,completionDate:f,entryString:k}}}),P={class:"row justify-center q-mt-md"},W={class:"col-12 col-md-4 q-px-sm"},X={class:"text-primary text-h6 q-mb-md"},G={class:"text-white text-body1"},J={class:"text-dark text-body2"},Z={key:0,class:"q-pt-md"},ee=n("div",{class:"text-white text-body1"},"Congratulations",-1),te=n("div",{class:"text-dark text-body2"},"You have successfully submitted your attendance record for this training.",-1),ae=n("div",{class:"text-dark text-body2"},"You are done. You may close this screen.",-1),oe=n("div",{class:"text-primary text-body1"},"THANK YOU!",-1);function se(e,a,t,r,i,b){return l(),h("div",null,[n("div",P,[n("div",W,[n("div",X,"Welcome, "+_(e.employeeData[20])+"!",1),e.submitted?(l(),m(D,{key:1,class:"text-center"},{default:o(()=>[s(d,{class:"bg-info"},{default:o(()=>[ee]),_:1}),s(d,null,{default:o(()=>[te,ae]),_:1}),s(d,null,{default:o(()=>[oe]),_:1})]),_:1})):(l(),m(D,{key:0,class:"text-center"},{default:o(()=>[s(d,{class:"bg-info"},{default:o(()=>[n("div",G,_(e.getQR[19]),1)]),_:1}),s(d,null,{default:o(()=>[n("div",J,_(e.getQR[11]),1)]),_:1}),e.getQR[20]?(l(),m(d,{key:0},{default:o(()=>[n("div",null,[s(B,{modelValue:e.confirmation,"onUpdate:modelValue":a[0]||(a[0]=c=>e.confirmation=c),label:e.getQR[21]},null,8,["modelValue","label"])]),e.confirmation?(l(),h("div",Z,[s(O,{type:"date",modelValue:e.completionDate,"onUpdate:modelValue":a[1]||(a[1]=c=>e.completionDate=c),label:"Date Completed","stack-label":""},null,8,["modelValue"])])):v("",!0)]),_:1})):v("",!0),s(U),s(E,{align:"right"},{default:o(()=>[e.getQR[20]?(l(),m(N,{key:0,color:"primary",label:"Submit",disable:e.getQR[20]&&(!e.confirmation||e.completionDate===""),onClick:e.submitAttendanceRecord},null,8,["disable","onClick"])):v("",!0)]),_:1})]),_:1}))])])])}var ne=w(L,[["render",se]]);const le={components:{QrDataCard:ne},setup(){const e=M(),{fetchQRData:a}=Q(),{getQR:t}=q(Q());async function r(){const i=e.query.qr;await a(i),console.log(t.value)}return r(),{fetchQRData:a,getQR:t}}},re={key:0};function ce(e,a,t,r,i,b){const c=z("qr-data-card");return l(),m(V,{style:{"max-width":"100vw"}},{default:o(()=>[r.getQR[3]?(l(),h("div",re,[s(c)])):v("",!0)]),_:1})}var _e=w(le,[["render",ce]]);export{_e as default};
