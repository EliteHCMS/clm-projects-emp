import{Q as F,a as H,b as Q}from"./QTabPanels.08b8c604.js";import{Q as V}from"./QTabs.f5a4b527.js";import{Q as M}from"./QToolbar.7de023f9.js";import{Q as x}from"./QPage.e6a76550.js";import{u as B}from"./use-quasar.04742e8f.js";import{_ as T,l as _,r as L,bW as j,bV as I,c as C,b7 as O,B as b,as as v,bt as g,E as S,d as h,C as P,F as X,b6 as N,z}from"./index.1bdfb1af.js";import"./array.164cfe36.js";import{q as $}from"./app.b866ce7a.js";import{u as y}from"./useQuerySaver.d29ff9ee.js";import{dayjs as l}from"./dayjs.d9609b5e.js";import{u as U}from"./index.b8387053.js";import{u as G}from"./dataStore.045be7a8.js";import{H as W}from"./historyPanel.f38ecb7a.js";import"./use-panel.2270b0a0.js";import"./touch.3df10340.js";import"./selection.424f2d7d.js";import"./QResizeObserver.e82f054c.js";import"./rtl.b51694b1.js";import"./_commonjsHelpers.a26ce4be.js";import"./localForage.34b90606.js";import"./index.04bc0a32.js";import"./i18n.8bfbf2a5.js";import"./QRating.465ea2a1.js";import"./QInnerLoading.15a7e337.js";import"./QTable.0c4bdbf7.js";import"./QList.756f4e56.js";import"./QMarkupTable.cfd50ad9.js";import"./QSelect.bc92d132.js";import"./QChip.4ce28263.js";import"./QMenu.92ffa49f.js";import"./position-engine.f90a4f55.js";import"./use-fullscreen.def6ffc2.js";import"./QTr.381372db.js";import"./QTd.96769614.js";const J=_({components:{HistoryPanel:W},setup(){const m=L("offers");B();const f=j(),w=I(),{can:A}=U(),{capitalize:c}=z,{getEmployee:E,updateViewedEmployees:p}=G(),s=C(()=>E(f.params.id)),i=C(()=>f.params.id?f.params.id:null),D=({start:n,end:e,status:t})=>t==="In Process"?"TBD":t==="DNC"?"N/A":t==="Complete"&&n&&e?`${l(e).diff(l(n),"day",!0).toFixed(2)} days`:"N/A",R=n=>n[145].$d?n[145].$d:n[1].$d,k=n=>{if(!n||!n[0]||!n[0][44])return"N/A";{const e=n[0][44];return`${c(e[20].toLowerCase())} ${c(e[22].toLowerCase())}`}},q=C(()=>[{label:"Offers",key:"offers",columns:[{name:0,label:"Date",align:"left",field:e=>e[1].$d,format:e=>`${l(e).format("MM/DD/YYYY")}`,sortable:!0,required:!0},{name:1,label:"Hiring Center",align:"left",field:e=>e[44],format:e=>`${e}`,sortable:!0},{name:2,label:"Project",align:"left",field:e=>e[56],format:e=>`${e}`,sortable:!0},{name:3,label:"Classification",align:"left",field:e=>e[57],format:e=>`${e}`,sortable:!0},{name:4,label:"Rate",align:"left",field:e=>e[22],format:e=>`$ ${e.toFixed(2)}`,sortable:!0,hide:!A("read","rates")},{name:5,label:"Status",align:"left",field:e=>e[21],format:e=>`${e}`,sortable:!0}],getter:async()=>{const{data:e}=await $.fetchFromHiringApp({fields:[y({type:"offers",query:`{'25'.EX.'${i.value}'}AND{'21'.XEX.'Canceled'}AND{'29'.XEX.'In Process'}AND{'29'.XEX.'Canceled'}`})]});p({id:i.value,dataset:"history",nested:!0,subset:"offers",data:e})},showCompletion:!0,completionRateOverride:"Acceptance Rate",completionRate:e=>(e.filter(r=>r[21]==="Accepted").length/e.length*100).toFixed(2)},{label:"Processing",key:"inProcess",columns:[{name:0,label:"Date",align:"left",field:e=>e[1].$d,format:e=>`${l(e).format("MM/DD/YYYY")}`,sortable:!0,required:!0},{name:1,label:"Hiring Center",align:"left",field:e=>e[126],format:e=>`${e}`,sortable:!0},{name:2,label:"Project",align:"left",field:e=>e[109],format:e=>`${e}`,sortable:!0},{name:3,label:"Classification",align:"left",field:e=>e[106],format:e=>`${e}`,sortable:!0},{name:4,label:"Processing Time",align:"left",field:e=>e[237],format:(e,t)=>D({start:t[1].$d,end:e.$d,status:t[37]}),sortable:!1}],getter:async()=>{const{data:e}=await $.fetchFromHiringApp({fields:[y({type:"rawInProcesses",query:`{'16'.EX.'${i.value}'}AND{'37'.XEX.'Canceled'}`})]});p({id:i.value,dataset:"history",nested:!0,subset:"inProcess",data:e})},showCompletion:!0,completionRate:e=>(e.filter(r=>r[37]==="Complete").length/e.length*100).toFixed(2),showDuration:!0,averageDuration:e=>{const t=e.filter(o=>o[37]==="Complete");let a=0;t.forEach(o=>{const u=o[1].$d,d=o[237].$d;u&&d&&(a+=l(d).diff(l(u),"ms",!0))});const r=a/t.length;return l.duration(r).asDays()}},{label:"Deployments",key:"deployments",columns:[{name:0,label:"Date",align:"left",field:e=>e[1].$d,format:e=>`${l(e).format("MM/DD/YYYY")}`,sortable:!0,required:!0},{name:1,label:"Hiring Center",align:"left",field:e=>e[68],format:e=>`${e}`,sortable:!0},{name:2,label:"Project",align:"left",field:e=>e[148],format:e=>`${e}`,sortable:!0},{name:3,label:"Classification",align:"left",field:e=>e[45],format:e=>`${e}`,sortable:!0},{name:4,label:"Time to Arrival",align:"left",field:e=>e[22],format:(e,t)=>D({start:t[1].$d,end:e.$d,status:t[20]}),sortable:!1}],getter:async()=>{const{data:e}=await $.fetchFromHiringApp({fields:[y({type:"rawDeployments",query:`{'21'.EX.'${i.value}'}AND{'20'.XEX.'Canceled'}`})]});p({id:i.value,dataset:"history",nested:!0,subset:"deployments",data:e})},showCompletion:!0,completionRate:e=>(e.filter(r=>r[20]==="Complete").length/e.length*100).toFixed(2),showDuration:!0,averageDuration:e=>{const t=e.filter(o=>o[20]==="Complete");let a=0;t.forEach(o=>{const u=o[1].$d,d=o[22].$d;u&&d&&(a+=l(d).diff(l(u),"ms",!0))});const r=a/t.length;return l.duration(r).asDays()}},{label:"Assignments",key:"assignments",columns:[{name:0,label:"Date",align:"left",field:e=>e[1].$d,format:e=>`${l(e).format("MM/DD/YYYY")}`,sortable:!0,required:!0},{name:1,label:"Hiring Center",align:"left",field:e=>e[23],format:e=>`${e}`,sortable:!0},{name:2,label:"Project",align:"left",field:e=>e[94],format:e=>`${e}`,sortable:!0},{name:3,label:"Classification",align:"left",field:e=>e[20],format:e=>`${e}`,sortable:!0},{name:4,label:"Time On Site",align:"left",field:e=>e[22],format:(e,t)=>D({start:R(t),end:e.$d,status:t[21]}),sortable:!1}],getter:async()=>{const{data:e}=await $.fetchFromHiringApp({fields:[y({type:"rawAssignments",query:`{'18'.EX.'${i.value}'}AND{'21'.XEX.'Canceled'}`})]});p({id:i.value,dataset:"history",nested:!0,subset:"assignments",data:e})},showCompletion:!0,completionRate:e=>(e.filter(r=>r[21]==="Complete").length/e.length*100).toFixed(2),showDuration:!0,averageDuration:e=>{const t=e.filter(o=>o[21]==="Complete");let a=0;t.forEach(o=>{const u=R(o),d=o[22].$d;u&&d&&(a+=l(d).diff(l(u),"ms",!0))});const r=a/t.length;return l.duration(r).asDays()}},{label:"Releases",key:"releases",columns:[{name:0,label:"Date",align:"left",field:e=>e[36].$d,format:e=>`${l(e).format("MM/DD/YYYY")}`,sortable:!0,required:!0},{name:1,label:"Project",align:"left",field:e=>e[83],format:e=>`${e}`,sortable:!0},{name:2,label:"Classification",align:"left",field:e=>e[48],format:e=>`${e}`,sortable:!0},{name:3,label:"Rating",align:"left",field:e=>e[59],format:e=>e[0]&&e[0][37]?e[0][37]:"N/A",sortable:!1,showRating:!0},{name:4,label:"Disposition",align:"left",field:e=>e[43],format:e=>`${e}`,sortable:!0},{name:5,label:"Evaluated By",align:"left",field:e=>e[59],format:(e,t)=>e?`${k(e)}`:"N/A",sortable:!1},{name:6,label:"Reviewed By",align:"left",field:e=>e[75],format:(e,t)=>e?`${c(e[35].toLowerCase())} ${c(e[37].toLowerCase())}`:"N/A",sortable:!1},{name:7,label:"Processed By",align:"left",field:e=>e[76],format:(e,t)=>e?`${c(e[35].toLowerCase())} ${c(e[37].toLowerCase())}`:"N/A",sortable:!1}],getter:async()=>{const{data:e}=await $.fetchFromHiringApp({fields:[y({type:"releases",query:`{'25'.EX.'${i.value}'}`})]});p({id:i.value,dataset:"history",nested:!0,subset:"releases",data:e})},showCompletion:!0,completionRateOverride:"Reassignment Rate",completionRate:e=>(e.filter(r=>r[43]==="Reassign").length/e.length*100).toFixed(2),showRating:!0,averageRating:e=>e.filter(a=>a[59]&&a[59][0]&&a[59][0][37]).reduce((a,r)=>a+r[59][0][37],0),showView:!0,viewer:e=>{w.push({name:"view-ee-release",params:{id:e[25],release:e[3]}})}}]);return{tab:m,employee:s,categories:q}}}),K={class:"q-pa-sm"};function Z(m,f,w,A,c,E){const p=O("history-panel");return b(),v(x,{style:{"max-width":"100vw"}},{default:g(()=>[S("div",K,[h(M,{class:"bg-info text-white shadow-2 rounded-borders"},{default:g(()=>[h(V,{dense:"",modelValue:m.tab,"onUpdate:modelValue":f[0]||(f[0]=s=>m.tab=s),align:"left","indicator-color":"accent"},{default:g(()=>[(b(!0),P(X,null,N(m.categories,s=>(b(),v(F,{key:s.key,name:s.key,label:`${s.label}`},null,8,["name","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),h(H,{modelValue:m.tab,"onUpdate:modelValue":f[1]||(f[1]=s=>m.tab=s),animated:""},{default:g(()=>[(b(!0),P(X,null,N(m.categories,s=>(b(),v(Q,{key:s.key,name:s.key,class:"q-px-xs"},{default:g(()=>[h(p,{category:s},null,8,["category"])]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue"])])]),_:1})}var He=T(J,[["render",Z]]);export{He as default};
