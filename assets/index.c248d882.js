import{Q as D,b as N,a as G}from"./QTabPanels.48b3dd7b.js";import{Q as H}from"./QTabs.b83fc561.js";import{Q as W}from"./QSpace.172b0f0f.js";import{k as w,bL as K,c as g,_ as R,A as f,B as v,d as o,bi as n,F as z,aY as I,an as _,au as L,ab as A,bI as U,D as $,bO as X,r as y,bN as Q,aZ as b,cw as k,cz as T,bM as x,w as ee,y as te,ao as C}from"./index.1ac36dbf.js";import{Q as ae}from"./QToolbar.97ee8261.js";import{Q as oe}from"./QPage.ca7fb638.js";import{u as j}from"./use-quasar.62bc1ed8.js";import{u as P}from"./dataStore.ea8a125c.js";import{I as O,u as re,q as se}from"./quickbase.1048e8f9.js";import{Q as J,a as ne}from"./QTable.c5e4c2e7.js";import{Q as M}from"./QTr.665e76d4.js";import{Q as E}from"./QTd.bc1a5183.js";import{dayjs as F}from"./dayjs.1cc35b40.js";import{_ as V}from"./projectSelector.98421c2a.js";import{N as le}from"./nameRequestData.d0c8e667.js";import"./use-panel.c5ddf7b4.js";import"./touch.60582172.js";import"./selection.e5a652d5.js";import"./QResizeObserver.bb68d233.js";import"./rtl.cf9bbe47.js";import"./localForage.ade47897.js";import"./_commonjsHelpers.a26ce4be.js";import"./index.7dbe61ef.js";import"./i18n.184ac08d.js";import"./api.5efad581.js";import"./QList.f8c2aa0e.js";import"./QMarkupTable.cd381f84.js";import"./QSelect.e22078b5.js";import"./QChip.e79f60a1.js";import"./QItemLabel.1fd06108.js";import"./QMenu.2b924fdd.js";import"./position-engine.8e0075ac.js";import"./use-fullscreen.347b34e6.js";import"./NameRequestGetEmployee.983f7bfb.js";import"./QTooltip.0881e0c5.js";import"./dataStore.1029c0ed.js";import"./workday.4874f55b.js";import"./syncEmployeeWithWorkday.03d6f9ad.js";import"./workdayAPI.0c5a9e85.js";const ue=w({emits:["refreshData"],props:{requests:Array,status:String},setup(t,r){const i=j(),c=K(),d=g(()=>i.screen.gt.sm?[{name:1,label:"Created",align:"left",field:e=>e[1].$d,format:e=>`${F(e).fromNow()}`,sortable:!0},{name:2,label:"ID",align:"left",field:e=>e[3],format:e=>`${e}`,sortable:!0,required:!0},{name:3,label:"Type",align:"left",field:e=>e[282],format:e=>`${e===""?"Open":e}`,sortable:!0,required:!0},{name:4,label:"Office",align:"left",field:e=>e[103],format:e=>`${e}`,sortable:!0},{name:5,label:"Job #",align:"left",field:e=>e[27],format:e=>`${e}`,sortable:!0,required:!0},{name:6,label:"# Requested",align:"right",field:e=>u(e),format:e=>`${e}`},{name:7,label:"Offers",align:"right",field:e=>a(e),format:e=>`${e}`,sortable:!0,required:!0},{name:8,label:"Deployed",align:"right",field:e=>e[254],format:e=>`${e}`,sortable:!0,required:!0},{name:9,label:"Balance",align:"right",field:e=>s(e),format:e=>`${e}`,sortable:!0,required:!0}]:[{name:1,label:"Created",align:"left",field:e=>e[1].$d,format:e=>`${F(e).fromNow()}`,sortable:!0},{name:2,label:"ID",align:"left",field:e=>e[3],format:e=>`${e}`,sortable:!0,required:!0},{name:3,label:"Type",align:"left",field:e=>e[282],format:e=>`${e===""?"Open":e}`,sortable:!0,required:!0},{name:4,label:"Office",align:"left",field:e=>e[103],format:e=>`${e}`,sortable:!0},{name:5,label:"Job #",align:"left",field:e=>e[27],format:e=>`${e}`,sortable:!0,required:!0},{name:6,label:"# Requested",align:"right",field:e=>u(e),format:e=>`${e}`},{name:7,label:"Offers",align:"right",field:e=>a(e),format:e=>`${e}`,sortable:!0,required:!0},{name:8,label:"Deployed",align:"right",field:e=>e[254],format:e=>`${e}`,sortable:!0,required:!0},{name:9,label:"Balance",align:"right",field:e=>s(e),format:e=>`${e}`,sortable:!0,required:!0}]);function u(e){return e.classes.reduce((l,p)=>l+p[18],0)}function a(e){return e.offers.filter(l=>l[21]==="Accepted").length}function s(e){const l=u(e),p=a(e);return l-p}function m(e){console.log(e),c.push({name:"hire-request",params:{id:e[3]}})}return{columns:d,props:t,viewRequest:m}}}),ie={class:"full-width row flex-center text-primary q-gutter-sm q-py-md"};function de(t,r,i,c,d,u){return f(),v("div",null,[o(ne,{columns:t.columns,rows:t.props.requests,"row-key":a=>a[3],class:"q-pa-sm",pagination:{rowsPerPage:10},"table-header-class":"bg-dark text-white","no-data-label":`There are no ${t.props.status} requests`,dense:""},{header:n(a=>[o(M,{class:"bg-dark text-white",props:a},{default:n(()=>[o(J,{"auto-width":""}),(f(!0),v(z,null,I(a.cols,s=>(f(),_(J,{key:s.name,props:a},{default:n(()=>[L(A(s.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),body:n(a=>[o(M,{props:a},{default:n(()=>[o(E,{"auto-width":""},{default:n(()=>[o(U,{class:"cursor-pointer",size:t.$q.screen.gt.sm?"sm":"xs",color:"info",round:"",dense:"",onClick:s=>t.viewRequest(a.row),name:a.expand?"visibility_off":"visibility"},null,8,["size","onClick","name"])]),_:2},1024),(f(!0),v(z,null,I(a.cols,s=>(f(),_(E,{key:s.name,props:a},{default:n(()=>[L(A(s.value),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),"no-data":n(({message:a})=>[$("div",ie,[o(U,{size:"2em",name:"fa-solid fa-person-circle-exclamation"}),$("span",null,A(a),1)])]),"top-right":n(()=>[o(X,{color:"secondary",flat:"","icon-right":"refresh",label:"Refresh",onClick:r[0]||(r[0]=a=>t.$emit("refreshData"))})]),_:1},8,["columns","rows","row-key","no-data-label"])])}var B=R(ue,[["render",de]]);const ce=w({props:{},components:{RequestDataTable:B,projectSelector:V},setup(t){const r=j(),i=O(),c=y(null),{getSelectedProject:d}=Q(i),{getOpenRequest:u,fetchAllOpenRequest:a}=P(),s=g(()=>d.value?d.value[3]:null),m=g(()=>u(s.value).sort((l,p)=>l[1].$d<p[1].$d?1:-1));async function e(l){r.loading.show(),await a({refresh:l}),r.loading.hide()}return e(!1),{openRequests:m,projectFilter:c,loadData:e}}}),me={class:"row items-center"},pe={class:"col-12 col-md-4"};function fe(t,r,i,c,d,u){const a=b("projectSelector"),s=b("request-data-table");return f(),v("div",null,[o(T,{flat:""},{default:n(()=>[o(k,null,{default:n(()=>[$("div",me,[$("div",pe,[o(a,{dense:""})])])]),_:1})]),_:1}),o(s,{requests:t.openRequests,status:"Open",onRefreshData:r[0]||(r[0]=m=>t.loadData(!0))},null,8,["requests"])])}var be=R(ce,[["render",fe]]);const $e=w({props:{},components:{RequestDataTable:B,projectSelector:V},setup(t){const r=j(),i=x(),c=O(),d=y(null),{getSelectedProject:u}=Q(c),{getPendingRequest:a,fetchAllPendingRequest:s}=P(),m=g(()=>u.value?u.value[3]:null),e=g(()=>a(m.value).sort((p,S)=>p[1].$d<S[1].$d?1:-1));async function l(p){r.loading.show(),await s({refresh:p}),r.loading.hide()}return ee(()=>i.from,p=>{p.name==="new-request"&&(console.log("reloading"),s({refresh:!0}))}),l(!1),{pendingRequests:e,projectFilter:d,loadData:l}}}),qe={class:"row items-center"},ge={class:"col-12 col-md-4"};function _e(t,r,i,c,d,u){const a=b("projectSelector"),s=b("request-data-table");return f(),v("div",null,[o(T,{flat:""},{default:n(()=>[o(k,null,{default:n(()=>[$("div",qe,[$("div",ge,[o(a,{dense:""})])])]),_:1})]),_:1}),o(s,{requests:t.pendingRequests,status:"Pending",onRefreshData:r[0]||(r[0]=m=>t.loadData(!0))},null,8,["requests"])])}var ve=R($e,[["render",_e]]);const he=w({props:{},components:{RequestDataTable:B,projectSelector:V},setup(t){const r=j(),i=O(),c=y(null),{getSelectedProject:d}=Q(i),{getClosedRequest:u,fetchAllClosedRequest:a}=P(),s=g(()=>d.value?d.value[3]:null),m=g(()=>u(s.value).sort((l,p)=>l[1].$d<p[1].$d?1:-1));async function e(l){r.loading.show(),await a({refresh:l}),r.loading.hide()}return e(),{closedRequests:m,projectFilter:c,loadData:e}}}),we={class:"row items-center"},Re={class:"col-12 col-md-4"};function ye(t,r,i,c,d,u){const a=b("projectSelector"),s=b("request-data-table");return f(),v("div",null,[o(T,{flat:""},{default:n(()=>[o(k,null,{default:n(()=>[$("div",we,[$("div",Re,[o(a,{dense:""})])])]),_:1})]),_:1}),o(s,{requests:t.closedRequests,status:"Completed",onRefreshData:r[0]||(r[0]=m=>t.loadData(!0))},null,8,["requests"])])}var je=R(he,[["render",ye]]);const Se=w({props:{},components:{NameRequestDataTable:le,projectSelector:V},setup(t){const r=j(),i=O(),{capitalize:c}=te,d=y(null),{userData:u}=re(),{getSelectedProject:a}=Q(i),{getNameRequest:s,fetchAllNameRequest:m,removeData:e}=P(),l=g(()=>a.value?a.value[3]:null),p=g(()=>s(l.value).sort((q,h)=>q[1].$d<h[1].$d?1:-1));async function S(q){r.loading.show(),await m({refresh:q}),r.loading.hide()}function Y(q){return`${c(q[6].toLowerCase())} ${c(q[7].toLowerCase())}`}async function Z(q){r.dialog({title:"Confirm",message:`Are you sure you want to remove ${Y(q)} from request# ${q[18]}?`,cancel:!0,persistent:!0}).onOk(async()=>{try{const{data:h}=await se.upsertRecordsXML({to:"bsg4yb4wa",data:[{3:{value:q[3]},11:{value:!0},12:{value:F().tz("America/Chicago")},13:{value:`${u[35]} ${u[37]}`}}],fieldsToReturn:[15],formatObject:15});e({type:"nameRequest",key:h[0][15][38],item:h[0][15],storageKey:"storageNameRequest"})}catch(h){r.notify({type:"negative",message:"Cannot remove name request"}),console.log(h)}})}return S(),{nameRequests:p,projectFilter:d,removeName:Z,loadData:S}}}),De={class:"row items-center"},Ne={class:"col-12 col-md-4"};function Ce(t,r,i,c,d,u){const a=b("projectSelector"),s=b("name-request-data-table");return f(),v("div",null,[o(T,{flat:""},{default:n(()=>[o(k,null,{default:n(()=>[$("div",De,[$("div",Ne,[o(a,{dense:""})])])]),_:1})]),_:1}),o(s,{requests:t.nameRequests,status:"Named",onRemoveName:t.removeName,onRefreshData:r[0]||(r[0]=m=>t.loadData(!0))},null,8,["requests","onRemoveName"])])}var Qe=R(Se,[["render",Ce]]);const ke=w({name:"Requests",components:{OpenTab:be,PendingTab:ve,CompleteTab:je,NamesTab:Qe},setup(){const t=K(),r=y(0);function i(){t.push({name:"new-request"})}return{tab:r,addNewRequest:i}}}),Te={class:"q-pa-md"};function Pe(t,r,i,c,d,u){const a=b("open-tab"),s=b("pending-tab"),m=b("names-tab"),e=b("complete-tab");return f(),_(oe,{style:{"max-width":"100vw"}},{default:n(()=>[$("div",Te,[o(ae,{class:"bg-info text-white shadow-2 rounded-borders"},{default:n(()=>[o(H,{modelValue:t.tab,"onUpdate:modelValue":r[0]||(r[0]=l=>t.tab=l),"bg-color":"none","indicator-color":"accent",dense:t.$q.screen.lt.md},{default:n(()=>[o(D,{name:0,label:t.$q.screen.gt.xs?"Open Requests":"Open"},null,8,["label"]),t.$q.screen.gt.sm?(f(),_(D,{key:0,name:1,label:t.$q.screen.gt.xs?"Pending Requests":"Pending"},null,8,["label"])):C("",!0),t.$can("read","nameRequests")?(f(),_(D,{key:1,name:2,label:t.$q.screen.gt.xs?"Named Requests":"Named"},null,8,["label"])):C("",!0),t.$q.screen.gt.sm?(f(),_(D,{key:2,name:3,label:t.$q.screen.gt.xs?"Completed Requests":"Completed"},null,8,["label"])):C("",!0)]),_:1},8,["modelValue","dense"]),o(W),t.$q.screen.gt.sm?(f(),_(X,{key:0,dense:"",color:"accent",icon:"add",label:t.$q.screen.lt.md?"Add New":"Add New Request",onClick:t.addNewRequest},null,8,["label","onClick"])):C("",!0)]),_:1}),o(G,{modelValue:t.tab,"onUpdate:modelValue":r[1]||(r[1]=l=>t.tab=l),animated:""},{default:n(()=>[o(N,{name:0},{default:n(()=>[o(a)]),_:1}),o(N,{name:1},{default:n(()=>[o(s)]),_:1}),o(N,{name:2},{default:n(()=>[o(m)]),_:1}),o(N,{name:3},{default:n(()=>[o(e)]),_:1})]),_:1},8,["modelValue"])])]),_:1})}var _t=R(ke,[["render",Pe]]);export{_t as default};
