import{Q as F,a as H,b as Q}from"./QTabPanels.1c4122ec.js";import{Q as M}from"./QTabs.3143048e.js";import{Q as T}from"./QToolbar.9c7d465d.js";import{Q as V}from"./QPage.67abb418.js";import{u as x}from"./use-quasar.b628893e.js";import{_ as B,l as _,r as L,bU as j,bT as I,c as C,b5 as O,A as b,aq as v,br as g,D as S,d as h,B as P,F as X,b4 as N,y as U}from"./index.35263bc9.js";import"./array.59f93f43.js";import{q as $}from"./app.60ab06c9.js";import{u as y}from"./useQuerySaver.d29ff9ee.js";import{dayjs as l}from"./dayjs.515e6981.js";import{u as z}from"./index.81316b11.js";import{u as G}from"./dataStore.92e4db50.js";import{H as J}from"./historyPanel.ed4096c0.js";import"./use-panel.6d6d7233.js";import"./touch.3df10340.js";import"./selection.03356054.js";import"./QResizeObserver.7080aea8.js";import"./rtl.b51694b1.js";import"./_commonjsHelpers.a26ce4be.js";import"./localForage.07bccd5e.js";import"./api.b1e79703.js";import"./index.04bc0a32.js";import"./i18n.e68020fa.js";import"./QRating.4b134a9f.js";import"./QInnerLoading.682c8919.js";import"./QTable.18445b6b.js";import"./QList.9a0a68df.js";import"./QMarkupTable.6b2ffa72.js";import"./QSelect.f9a2629d.js";import"./QChip.3e700a72.js";import"./QMenu.b9d1a35f.js";import"./position-engine.5ee61549.js";import"./use-fullscreen.ebe2b650.js";import"./QTr.9478d68c.js";import"./QTd.9e0f420c.js";const K=_({components:{HistoryPanel:J},setup(){const m=L("offers");x();const f=j(),w=I(),{can:A}=z(),{capitalize:c}=U,{getEmployee:R,updateViewedEmployees:p}=G(),s=C(()=>R(f.params.id)),i=C(()=>f.params.id?f.params.id:null),D=({start:n,end:e,status:t})=>t==="In Process"?"TBD":t==="DNC"?"N/A":t==="Complete"&&n&&e?`${l(e).diff(l(n),"day",!0).toFixed(2)} days`:"N/A",Y=n=>n[145].$d?n[145].$d:n[1].$d,k=n=>{if(!n||!n[0]||!n[0][44])return"N/A";{const e=n[0][44];return`${c(e[20].toLowerCase())} ${c(e[22].toLowerCase())}`}},q=C(()=>[{label:"Offers",key:"offers",columns:[{name:0,label:"Date",align:"left",field:e=>e[1].$d,format:e=>`${l(e).format("MM/DD/YYYY")}`,sortable:!0,required:!0},{name:1,label:"Hiring Center",align:"left",field:e=>e[44],format:e=>`${e}`,sortable:!0},{name:2,label:"Project",align:"left",field:e=>e[56],format:e=>`${e}`,sortable:!0},{name:3,label:"Classification",align:"left",field:e=>e[57],format:e=>`${e}`,sortable:!0},{name:4,label:"Rate",align:"left",field:e=>e[22],format:e=>`$ ${e.toFixed(2)}`,sortable:!0,hide:!A("read","rates")},{name:5,label:"Status",align:"left",field:e=>e[21],format:e=>`${e}`,sortable:!0}],getter:async()=>{const{data:e}=await $.fetchFromHiringApp({fields:[y({type:"offers",query:`{'25'.EX.'${i.value}'}AND{'21'.XEX.'Canceled'}AND{'29'.XEX.'In Process'}AND{'29'.XEX.'Canceled'}`})]});p({id:i.value,dataset:"history",nested:!0,subset:"offers",data:e})},showCompletion:!0,completionRateOverride:"Acceptance Rate",completionRate:e=>(e.filter(r=>r[21]==="Accepted").length/e.length*100).toFixed(2)},{label:"Processing",key:"inProcess",columns:[{name:0,label:"Date",align:"left",field:e=>e[1].$d,format:e=>`${l(e).format("MM/DD/YYYY")}`,sortable:!0,required:!0},{name:1,label:"Hiring Center",align:"left",field:e=>e[126],format:e=>`${e}`,sortable:!0},{name:2,label:"Project",align:"left",field:e=>e[109],format:e=>`${e}`,sortable:!0},{name:3,label:"Classification",align:"left",field:e=>e[106],format:e=>`${e}`,sortable:!0},{name:4,label:"Processing Time",align:"left",field:e=>e[237],format:(e,t)=>D({start:t[1].$d,end:e.$d,status:t[37]}),sortable:!1}],getter:async()=>{const{data:e}=await $.fetchFromHiringApp({fields:[y({type:"rawInProcesses",query:`{'16'.EX.'${i.value}'}AND{'37'.XEX.'Canceled'}`})]});p({id:i.value,dataset:"history",nested:!0,subset:"inProcess",data:e})},showCompletion:!0,completionRate:e=>(e.filter(r=>r[37]==="Complete").length/e.length*100).toFixed(2),showDuration:!0,averageDuration:e=>{const t=e.filter(o=>o[37]==="Complete");let a=0;t.forEach(o=>{const u=o[1].$d,d=o[237].$d;u&&d&&(a+=l(d).diff(l(u),"ms",!0))});const r=a/t.length;return l.duration(r).asDays()}},{label:"Deployments",key:"deployments",columns:[{name:0,label:"Date",align:"left",field:e=>e[1].$d,format:e=>`${l(e).format("MM/DD/YYYY")}`,sortable:!0,required:!0},{name:1,label:"Hiring Center",align:"left",field:e=>e[68],format:e=>`${e}`,sortable:!0},{name:2,label:"Project",align:"left",field:e=>e[148],format:e=>`${e}`,sortable:!0},{name:3,label:"Classification",align:"left",field:e=>e[45],format:e=>`${e}`,sortable:!0},{name:4,label:"Time to Arrival",align:"left",field:e=>e[22],format:(e,t)=>D({start:t[1].$d,end:e.$d,status:t[20]}),sortable:!1}],getter:async()=>{const{data:e}=await $.fetchFromHiringApp({fields:[y({type:"rawDeployments",query:`{'21'.EX.'${i.value}'}AND{'20'.XEX.'Canceled'}`})]});p({id:i.value,dataset:"history",nested:!0,subset:"deployments",data:e})},showCompletion:!0,completionRate:e=>(e.filter(r=>r[20]==="Complete").length/e.length*100).toFixed(2),showDuration:!0,averageDuration:e=>{const t=e.filter(o=>o[20]==="Complete");let a=0;t.forEach(o=>{const u=o[1].$d,d=o[22].$d;u&&d&&(a+=l(d).diff(l(u),"ms",!0))});const r=a/t.length;return l.duration(r).asDays()}},{label:"Assignments",key:"assignments",columns:[{name:0,label:"Date",align:"left",field:e=>e[1].$d,format:e=>`${l(e).format("MM/DD/YYYY")}`,sortable:!0,required:!0},{name:1,label:"Hiring Center",align:"left",field:e=>e[23],format:e=>`${e}`,sortable:!0},{name:2,label:"Project",align:"left",field:e=>e[94],format:e=>`${e}`,sortable:!0},{name:3,label:"Classification",align:"left",field:e=>e[20],format:e=>`${e}`,sortable:!0},{name:4,label:"Time On Site",align:"left",field:e=>e[22],format:(e,t)=>D({start:Y(t),end:e.$d,status:t[21]}),sortable:!1}],getter:async()=>{const{data:e}=await $.fetchFromHiringApp({fields:[y({type:"rawAssignments",query:`{'18'.EX.'${i.value}'}AND{'21'.XEX.'Canceled'}`})]});p({id:i.value,dataset:"history",nested:!0,subset:"assignments",data:e})},showCompletion:!0,completionRate:e=>(e.filter(r=>r[21]==="Complete").length/e.length*100).toFixed(2),showDuration:!0,averageDuration:e=>{const t=e.filter(o=>o[21]==="Complete");let a=0;t.forEach(o=>{const u=Y(o),d=o[22].$d;u&&d&&(a+=l(d).diff(l(u),"ms",!0))});const r=a/t.length;return l.duration(r).asDays()}},{label:"Releases",key:"releases",columns:[{name:0,label:"Date",align:"left",field:e=>e[36].$d,format:e=>`${l(e).format("MM/DD/YYYY")}`,sortable:!0,required:!0},{name:1,label:"Project",align:"left",field:e=>e[83],format:e=>`${e}`,sortable:!0},{name:2,label:"Classification",align:"left",field:e=>e[48],format:e=>`${e}`,sortable:!0},{name:3,label:"Rating",align:"left",field:e=>e[59],format:e=>e[0]&&e[0][37]?e[0][37]:"N/A",sortable:!1,showRating:!0},{name:4,label:"Disposition",align:"left",field:e=>e[43],format:e=>`${e}`,sortable:!0},{name:5,label:"Evaluated By",align:"left",field:e=>e[59],format:(e,t)=>e?`${k(e)}`:"N/A",sortable:!1},{name:6,label:"Reviewed By",align:"left",field:e=>e[75],format:(e,t)=>e?`${c(e[35].toLowerCase())} ${c(e[37].toLowerCase())}`:"N/A",sortable:!1},{name:7,label:"Processed By",align:"left",field:e=>e[76],format:(e,t)=>e?`${c(e[35].toLowerCase())} ${c(e[37].toLowerCase())}`:"N/A",sortable:!1}],getter:async()=>{const{data:e}=await $.fetchFromHiringApp({fields:[y({type:"releases",query:`{'25'.EX.'${i.value}'}`})]});p({id:i.value,dataset:"history",nested:!0,subset:"releases",data:e})},showCompletion:!0,completionRateOverride:"Reassignment Rate",completionRate:e=>(e.filter(r=>r[43]==="Reassign").length/e.length*100).toFixed(2),showRating:!0,averageRating:e=>e.filter(a=>a[59]&&a[59][0]&&a[59][0][37]).reduce((a,r)=>a+r[59][0][37],0),showView:!0,viewer:e=>{w.push({name:"view-ee-release",params:{id:e[25],release:e[3]}})}}]);return{tab:m,employee:s,categories:q}}}),W={class:"q-pa-sm"};function Z(m,f,w,A,c,R){const p=O("history-panel");return b(),v(V,{style:{"max-width":"100vw"}},{default:g(()=>[S("div",W,[h(T,{class:"bg-info text-white shadow-2 rounded-borders"},{default:g(()=>[h(M,{dense:"",modelValue:m.tab,"onUpdate:modelValue":f[0]||(f[0]=s=>m.tab=s),align:"left","indicator-color":"accent"},{default:g(()=>[(b(!0),P(X,null,N(m.categories,s=>(b(),v(F,{key:s.key,name:s.key,label:`${s.label}`},null,8,["name","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),h(H,{modelValue:m.tab,"onUpdate:modelValue":f[1]||(f[1]=s=>m.tab=s),animated:""},{default:g(()=>[(b(!0),P(X,null,N(m.categories,s=>(b(),v(Q,{key:s.key,name:s.key,class:"q-px-xs"},{default:g(()=>[h(p,{category:s},null,8,["category"])]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue"])])]),_:1})}var Qe=B(K,[["render",Z]]);export{Qe as default};
