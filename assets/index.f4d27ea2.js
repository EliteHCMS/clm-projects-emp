import{Q as re,b as de,a as we}from"./QTabPanels.dc0dcd58.js";import{Q as $e}from"./QTabs.af5e4e56.js";import{Q as ye}from"./QPage.c832dd56.js";import{u as ie}from"./use-quasar.bf22106c.js";import{l as le,r as p,_ as se,A as f,an as P,bi as n,D as r,bL as ue,c as V,aZ as ne,B as _,d as s,cw as H,cz as J,ab as c,bO as ae,F as T,aY as E,bK as he,ao as ge,cx as ee,au as R,bI as I,y as be}from"./index.7f467912.js";import{Q as M}from"./QSelect.a345da3a.js";import{Q as N,a as me}from"./QTable.b8d71263.js";import{Q as W}from"./QTr.d57df62c.js";import{Q as U}from"./QTd.bb5e00f4.js";import{Q as pe}from"./QInnerLoading.3d097836.js";import{u as ce}from"./dataStore.6465eb17.js";import{dayjs as w}from"./dayjs.0f1a0bc9.js";import{u as fe,a as _e}from"./useQuerySaver.c5fe436e.js";import{q as oe,u as De}from"./quickbase.159c15f2.js";import"./workdayAPI.3922a68e.js";import"./workday.60a35b68.js";import"./dataStore.dccb8b76.js";import"./use-panel.f17f9ea6.js";import"./touch.60582172.js";import"./selection.8b006c7f.js";import"./QResizeObserver.d592ab8a.js";import"./rtl.cf9bbe47.js";import"./QChip.6a7808a8.js";import"./QItemLabel.6ffcf1f7.js";import"./QMenu.ee595e6f.js";import"./position-engine.7d860d3d.js";import"./QList.86507577.js";import"./QMarkupTable.ff93cfc4.js";import"./use-fullscreen.e9ab5bdb.js";import"./localForage.24410b96.js";import"./_commonjsHelpers.a26ce4be.js";import"./index.7dbe61ef.js";import"./i18n.5ecfa174.js";import"./api.54911380.js";const qe=async({array:a})=>{const i=[];return a.forEach(async C=>{const y=ke({release:C});i.push(y)}),(await Promise.allSettled(i)).map(C=>C.value)},ke=async({release:a})=>{const i=a[93],S=a[102]&&a[a[102]]?a[a[102]]:null,q=S?fe({status:i,id:S}):null;if(q){const{data:C}=await oe.fetchFromHiringApp({fields:[q]}),y=C;if(y){const e=y[1].$d>a[1].$d;return e?{release:await Se({release:a,disposition:"Reassign",ts:y[1].$d}),reassigned:e}:{release:a,reassigned:!1}}else return{release:a,reassigned:!1}}else return{release:a,reassigned:!1}},Se=async({release:a,disposition:i,ts:S})=>{De();const{data:q}=await oe.upsertRecordsXML({to:"bp3ga39ut",data:[{3:{value:a[3]},42:{value:"Complete"},43:{value:i},44:{value:a[44].$d||S},73:{value:"Cancelled"}}],fieldsToReturn:[80],formatObject:80});return q[0][80]},Ve=le({emits:[],props:{id:String,release:Object},setup(a){const i=p(null),S=p(!0);return{record:i,loading:S}}}),Fe=r("div",null,null,-1);function Re(a,i,S,q,C,y){return f(),P(U,{class:"text-left","auto-width":""},{default:n(()=>[Fe]),_:1})}var Ce=se(Ve,[["render",Re]]);const Ae=le({props:{},components:{GetWorkerCell:Ce},setup(a){const i=ie(),S=ue(),{capitalize:q}=be,C=p(""),y=p(null),e=p(null),o=p(null),g=p(null),$=p(null),k=p(null),A=p(null),x=p(null),z=p(null),X=p(!0),{setAdminData:G,getAdminData:te,setAdminItemData:Q}=ce(),F=[{name:1,label:"Name",align:"left",field:t=>t[49],format:t=>`${K(t)}`,sortable:!0},{name:2,label:"Disposition",align:"left",field:t=>t[43],format:t=>`${t}`,sortable:!0},{name:3,label:"Workday Status",align:"left",field:t=>t[87],format:t=>`${t}`,sortable:!0},{name:4,label:"Hiring Status",align:"left",field:t=>t[92],format:t=>`${t}`,sortable:!0},{name:5,label:"Submission Status",align:"left",field:t=>t[73],format:t=>`${t}`,sortable:!0}],Y=async()=>{i.loading.show(),await L(),i.loading.hide()},L=async()=>{const t=j.value.filter(D=>D[87]==="Active"&&D[95]&&D[42]!=="Complete");(await qe({array:t})).filter(D=>D.reassigned).forEach(D=>{Q({dataset:"releases",id:D[3],data:D})})},j=V(()=>te({dataset:"releases"})||[]),b=V(()=>{const t=j.value;let m;if(e.value?m=t.filter(v=>v[87]===e.value):m=t,o.value&&(m=m.filter(v=>v[43]===o.value.value)),y.value&&(m=m.filter(v=>v[73]===y.value)),g.value&&(m=m.filter(v=>v[92]===g.value)),$.value){const v=$.value==="Yes";m=m.filter(D=>D[95]===v)}return k.value&&(m=m.filter(v=>v[84]===k.value)),A.value&&(m=m.filter(v=>v[84]!==A.value)),x.value&&(m=m.filter(v=>w(v[1].$d)>=w(x.value))),z.value&&(m=m.filter(v=>w(v[1].$d)<=w(z.value))),m}),B=async t=>{if(t||b.value.length===0){X.value=!0;const{data:m}=await oe.fetchFromHiringApp({fields:[fe({type:"releases",query:"{'104'.EX.true}AND{'74'.EX.false}AND{'1'.OAF.'12-12-2022'}"})]}),v=m&&m.length>0?[...new Map(m.map(D=>[{e:D[25],o:D[105]},D])).values()].sort((D,ve)=>D[1].$d>ve[1].$d?-1:1):[];G({dataset:"releases",data:v}),X.value=!1}else X.value=!1},K=t=>{const m=t.split(" ");let v="";return m.forEach((D,ve)=>{v+=ve>0?` ${q(D.toLowerCase())}`:q(D.toLowerCase())}),v},Z=t=>{S.push({name:"view-release",params:{release:t[3]}})},l=V(()=>[...new Map(j.value.map(t=>[t[92],t[92]])).values()].filter(t=>t!=="")),u=V(()=>[...new Map(j.value.map(t=>[t[84],t[84]])).values()].filter(t=>t!=="")),h=V(()=>j.value.length>0?[{label:"Termed but Not Processed",value:b.value.filter(t=>t[73]!=="Processed"&&t[87]==="Terminated").length,denominator:b.value.length},{label:"Decision to Reassign",value:b.value.filter(t=>t[43]==="Reassign").length,denominator:b.value.filter(t=>t[43]!=="").length},{label:"Decision to Terminate",value:b.value.filter(t=>t[43]==="Terminate").length,denominator:b.value.filter(t=>t[43]!=="").length},{label:"Waiting on Reassignment",value:b.value.filter(t=>t[43]==="Reassign"&&t[42]!=="Complete"&&t[87]==="Active").length,denominator:b.value.filter(t=>t[43]==="Reassign").length},{label:"Waiting on Termination",value:b.value.filter(t=>t[43]==="Terminate"&&t[73]!=="Processed"&&t[87]==="Active").length,denominator:b.value.filter(t=>t[43]==="Terminate").length}]:[]),O=V(()=>j.value.length>0?[{label:"Complete",value:b.value.filter(t=>t[42]==="Complete").length,denominator:b.value.length,separate:!0},{label:"Decision Made",value:b.value.filter(t=>t[43]!==""&&t[42]!=="Complete").length,denominator:b.value.filter(t=>t[42]!=="Complete").length},{label:"Waiting on Decision",value:b.value.filter(t=>t[42]!=="Complete"&&t[43]==="").length,denominator:b.value.filter(t=>t[42]!=="Complete").length,separate:!0},{label:"Reassigned",value:b.value.filter(t=>t[43]==="Reassign"&&t[42]==="Complete").length,denominator:b.value.filter(t=>t[42]==="Complete").length},{label:"Terminated",value:b.value.filter(t=>t[43]==="Terminate"&&t[42]==="Complete").length,denominator:b.value.filter(t=>t[42]==="Complete").length}]:[]),d=V(()=>b.value.length>0?[{label:"Employment Status",updateFunction:t=>{e.value=t},model:e.value,type:"select",options:["Active","Terminated"]},{label:"Hiring Status",updateFunction:t=>{g.value=t},model:g.value,type:"select",options:l.value},{label:"Submission Status",updateFunction:t=>{y.value=t},model:y.value,type:"select",options:["Processed","Pending","Cancelled","Submitted","Rescinded"]},{label:"Disposition",updateFunction:t=>{o.value=t},model:o.value,type:"select",options:[{value:"Reassign",label:"Reassign"},{value:"Terminate",label:"Terminate"},{value:"",label:"None"}]},{label:"Possible Reassignment",updateFunction:t=>{$.value=t},model:$.value,type:"select",options:["Yes","No"]},{label:"Project",updateFunction:t=>{k.value=t},model:k.value,type:"select",options:u.value},{label:"Remove Project",updateFunction:t=>{A.value=t},model:A.value,type:"select",options:u.value},{label:"Start Date",updateFunction:t=>{x.value=t},model:x.value,type:"date",options:null},{label:"End Date",updateFunction:t=>{z.value=t},model:z.value,type:"date",options:null}]:[]);return B(),{search:C,columns:F,rows:b,loadData:B,loading:X,checkForUpdates:Y,viewRelease:Z,stats:O,hiddenStats:h,filters:d}}}),xe={class:"row items-start"},Pe={class:"col-4 q-pr-xs"},Te={class:"row"},Ne={class:"col-8"},Ue=r("div",{class:"text-body1"},"Departures Summary",-1),je={class:"text-caption text-italic"},Oe={class:"col-4 text-right"},Qe={class:"text-caption"},Ye={class:"text-primary q-mr-sm"},Ee={key:0,class:"text-dark"},Me={key:1,class:"text-dark"},ze={class:"col-8 q-px-xs"},Xe={class:"row items-center"},He={class:"full-width row flex-center text-primary q-gutter-sm q-py-md"};function Le(a,i,S,q,C,y){const e=ne("get-worker-cell");return f(),_("div",null,[s(J,{flat:""},{default:n(()=>[s(H,{class:"q-px-none q-pt-none"},{default:n(()=>[r("div",xe,[r("div",Pe,[s(J,null,{default:n(()=>[s(H,{class:"q-pa-sm bg-dark text-white"},{default:n(()=>[r("div",Te,[r("div",Ne,[Ue,r("div",je,"Total: "+c(a.rows.length)+" Departures",1)]),r("div",Oe,[s(ae,{round:"",dense:"",size:"md",color:"white",flat:"",icon:"refresh",onClick:i[0]||(i[0]=o=>a.loadData(!0))})])])]),_:1}),(f(!0),_(T,null,E(a.stats,(o,g)=>(f(),_(T,{key:g},[s(H,{class:"q-py-xs q-pr-xs q-pl-sm"},{default:n(()=>[r("div",Qe,[r("span",Ye,c(o.label)+": ",1),o.value>0?(f(),_("span",Ee,c(o.value)+" / "+c(o.denominator)+" ("+c((o.value/o.denominator*100).toFixed(2))+"%) ",1)):(f(),_("span",Me,"None"))])]),_:2},1024),o.separate?(f(),P(he,{key:0})):ge("",!0)],64))),128))]),_:1})]),r("div",ze,[r("div",Xe,[(f(!0),_(T,null,E(a.filters,(o,g)=>(f(),_("div",{key:g,class:"col-12 col-md-4 q-px-xs q-pb-sm"},[o.type==="select"?(f(),P(M,{key:0,dense:"",label:o.label,"transition-show":"flip-up","transition-hide":"flip-down",modelValue:o.model,"onUpdate:modelValue":[$=>o.model=$,$=>o.updateFunction($)],options:o.options,clearable:""},null,8,["label","modelValue","onUpdate:modelValue","options"])):(f(),P(ee,{key:1,dense:"",modelValue:o.model,"onUpdate:modelValue":[$=>o.model=$,$=>o.updateFunction($)],label:o.label},null,8,["modelValue","onUpdate:modelValue","label"]))]))),128))])])])]),_:1})]),_:1}),r("div",null,[s(me,{columns:a.columns,rows:a.rows,"row-key":o=>o[3],class:"q-pa-sm",pagination:{rowsPerPage:100},"table-header-class":"bg-dark text-white","no-data-label":"There are no recent departures",dense:"",loading:a.loading},{header:n(o=>[s(W,{class:"bg-dark text-white",props:o},{default:n(()=>[s(N,{"auto-width":""}),s(N,{"auto-width":""},{default:n(()=>[R("Date")]),_:1}),(f(!0),_(T,null,E(o.cols,g=>(f(),P(N,{key:g.name,props:o},{default:n(()=>[R(c(g.label),1)]),_:2},1032,["props"]))),128)),s(N,{"auto-width":""})]),_:2},1032,["props"])]),body:n(o=>[s(W,{props:o},{default:n(()=>[s(U,{"auto-width":""},{default:n(()=>[s(I,{class:"cursor-pointer",size:a.$q.screen.gt.sm?"sm":"xs",color:"info",round:"",dense:"",onClick:g=>a.viewRelease(o.row),name:o.expand?"visibility_off":"visibility"},null,8,["size","onClick","name"])]),_:2},1024),s(U,{"auto-width":""},{default:n(()=>[R(c(a.$dayjs(o.row[1].$d).format("MM/DD/YYYY")||""),1)]),_:2},1024),(f(!0),_(T,null,E(o.cols,g=>(f(),P(U,{key:g.name,props:o},{default:n(()=>[R(c(g.value),1)]),_:2},1032,["props"]))),128)),s(e,{id:o.row[50],release:o.row},null,8,["id","release"])]),_:2},1032,["props"])]),"no-data":n(({message:o})=>[r("div",He,[s(I,{size:"2em",name:"fa-solid fa-person-circle-exclamation"}),r("span",null,c(o),1)])]),loading:n(()=>[s(pe,{showing:"",color:"primary"})]),_:1},8,["columns","rows","row-key","loading"])])])}var Be=se(Ae,[["render",Le]]);const Ie=le({props:{},components:{},setup(a){const i=ie(),S=ue(),{capitalize:q}=be,C=p(""),y=p(null),e=p(null),o=p(null),g=p(null),$=p(null),k=p(!0),A=p(null),x=p(null),z=[{name:1,label:"Name",align:"left",field:d=>d[75],format:d=>`${b(d)}`,sortable:!0},{name:2,label:"Status",align:"left",field:d=>d[21],format:d=>`${d}`,sortable:!0},{name:3,label:"Workday Status",align:"left",field:d=>d[102],format:d=>`${d}`,sortable:!0},{name:4,label:"Project",align:"left",field:d=>d[141],format:d=>`${d}`,sortable:!0}],X=[{value:"Reassign",label:"Reassign"},{value:"Terminate",label:"Terminate"},{value:"",label:"None"}],{setAdminData:G,getAdminData:te,setAdminItemData:Q}=ce(),F=V(()=>{const d=Y.value;let t;if(e.value?t=d.filter(m=>m[102]===e.value):t=d,g.value&&(t=t.filter(m=>m[146]===g.value)),o.value&&(t=t.filter(m=>m[146]!==o.value)),$.value){const m=$.value==="Yes";t=t.filter(v=>v[148]===m)}return A.value&&(t=t.filter(m=>l(m).isSameOrAfter(w(A.value)))),x.value&&(t=t.filter(m=>l(m).isSameOrBefore(w(x.value)))),t}),Y=V(()=>te({dataset:"assignments"})||[]),L=V(()=>F.value.filter(d=>d[148])||[]),j=async d=>{if(d||F.value.length===0){k.value=!0;const{data:t}=await oe.fetchFromHiringApp({fields:[fe({type:"rawAssignments",query:"{'147'.EX.true}AND{'21'.XEX.'Canceled'}AND{'1'.OAF.'06-30-2022'}"})]}),m=t&&t.length>0?[...new Map(t.map(v=>[v[85],v])).values()].sort((v,D)=>v[1].$d>D[1].$d?-1:1):[];G({dataset:"assignments",data:m}),k.value=!1}else k.value=!1},b=d=>{const t=d.split(" ");let m="";return t.forEach((v,D)=>{m+=D>0?` ${q(v.toLowerCase())}`:q(v.toLowerCase())}),m},B=async()=>{i.loading.show(),i.loading.hide()};function K(d){S.push({name:"view-release",params:{release:d[3]}})}const Z=V(()=>[...new Map(Y.value.map(d=>[d[146],d[146]])).values()].filter(d=>d!==""));j();const l=d=>d[145]&&d[145].$d?w(d[145].$d):w(d[1].$d),u=d=>l(d).isSameOrAfter(w(A.value))&&l(d).isSameOrBefore(w(x.value)),h=d=>!d[149]||!d[149].$d||w(d[149].$d).isAfter(w()),O=V(()=>Y.value.length>0?[{label:"Retained No Filter",value:Y.value.filter(d=>u(d)&&h(d)).length,denominator:Y.value.filter(d=>u(d)).length,separate:!0},{label:"Retained With Filter",value:F.value.filter(d=>u(d)&&h(d)).length,denominator:F.value.filter(d=>u(d)).length,separate:!0}]:[]);return{search:C,columns:z,rows:F,loadData:j,loading:k,statusFilter:e,checkForUpdates:B,viewRelease:K,dispositionFilter:o,dispositions:X,submissionStatus:y,hiringStatusFilter:g,hiringStatusOptions:Z,possibleReassignment:$,startDate:A,endDate:x,bySite:L,stats:O,getArrivalDate:l}}}),We={class:"row items-start"},Ge={class:"col-4 q-pr-xs"},Ke={class:"row"},Ze={class:"col-8"},Je=r("div",{class:"text-body1"},"Assignments Summary",-1),et={class:"text-caption text-italic"},tt={class:"col-4 text-right"},at={class:"text-caption"},lt={class:"text-primary q-mr-sm"},st={class:"text-dark"},ot={class:"col-8 q-px-xs"},nt={class:"row items-center"},it={class:"col-12 col-md-2 q-px-sm"},rt={class:"col-12 col-md-2 q-px-sm"},dt={class:"col-12 col-md-2 q-px-sm"},ut={class:"col-12 col-md-2 q-px-sm"},mt={class:"col-12 col-md-2 q-px-sm"},pt={class:"full-width row flex-center text-primary q-gutter-sm q-py-md"},ct={class:"text-dark text-caption text-italic"},ft={class:"text-dark text-caption text-italic"};function vt(a,i,S,q,C,y){return f(),_("div",null,[s(J,{flat:""},{default:n(()=>[s(H,null,{default:n(()=>[r("div",We,[r("div",Ge,[s(J,null,{default:n(()=>[s(H,{class:"q-pa-sm bg-dark text-white"},{default:n(()=>[r("div",Ke,[r("div",Ze,[Je,r("div",et,"Total: "+c(a.rows.length)+" Departures",1)]),r("div",tt,[s(ae,{round:"",dense:"",size:"md",color:"white",flat:"",icon:"refresh",onClick:i[0]||(i[0]=e=>a.loadData(!0))})])])]),_:1}),(f(!0),_(T,null,E(a.stats,(e,o)=>(f(),_(T,{key:o},[s(H,{class:"q-py-xs q-pr-xs q-pl-sm"},{default:n(()=>[r("div",at,[r("span",lt,c(e.label)+": ",1),r("span",st,c(e.value)+" / "+c(e.denominator)+" ("+c((e.value/e.denominator*100).toFixed(2))+"%) ",1)])]),_:2},1024),e.separate?(f(),P(he,{key:0})):ge("",!0)],64))),128))]),_:1})]),r("div",ot,[r("div",nt,[r("div",it,[s(M,{dense:"",label:"Project","transition-show":"flip-up","transition-hide":"flip-down",modelValue:a.hiringStatusFilter,"onUpdate:modelValue":i[1]||(i[1]=e=>a.hiringStatusFilter=e),options:a.hiringStatusOptions,clearable:""},null,8,["modelValue","options"])]),r("div",rt,[s(M,{dense:"",label:"Remove Project","transition-show":"flip-up","transition-hide":"flip-down",modelValue:a.dispositionFilter,"onUpdate:modelValue":i[2]||(i[2]=e=>a.dispositionFilter=e),options:a.hiringStatusOptions,clearable:""},null,8,["modelValue","options"])]),r("div",dt,[s(M,{dense:"",label:"Created by Project App","transition-show":"flip-up","transition-hide":"flip-down",modelValue:a.possibleReassignment,"onUpdate:modelValue":i[3]||(i[3]=e=>a.possibleReassignment=e),options:["Yes","No"],clearable:""},null,8,["modelValue"])]),r("div",ut,[s(ee,{"stack-label":"",dense:"",type:"date",modelValue:a.startDate,"onUpdate:modelValue":i[4]||(i[4]=e=>a.startDate=e),label:"Start Date"},null,8,["modelValue"])]),r("div",mt,[s(ee,{"stack-label":"",dense:"",type:"date",modelValue:a.endDate,"onUpdate:modelValue":i[5]||(i[5]=e=>a.endDate=e),label:"End Date"},null,8,["modelValue"])])])])])]),_:1})]),_:1}),r("div",null,[s(me,{title:"Assignments","title-class":"text-h5 text-primary",columns:a.columns,rows:a.rows,"row-key":e=>e[3],class:"q-pa-sm",pagination:{rowsPerPage:100},"table-header-class":"bg-dark text-white","no-data-label":"There are no recent departures",dense:"",loading:a.loading},{header:n(e=>[s(W,{class:"bg-dark text-white",props:e},{default:n(()=>[s(N,{"auto-width":""}),s(N,{"auto-width":""},{default:n(()=>[R("Date")]),_:1}),(f(!0),_(T,null,E(e.cols,o=>(f(),P(N,{key:o.name,props:e},{default:n(()=>[R(c(o.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),body:n(e=>[s(W,{props:e},{default:n(()=>[s(U,{"auto-width":""},{default:n(()=>[s(I,{class:"cursor-pointer",size:a.$q.screen.gt.sm?"sm":"xs",color:"info",round:"",dense:"",onClick:o=>a.viewRelease(e.row),name:e.expand?"visibility_off":"visibility"},null,8,["size","onClick","name"])]),_:2},1024),s(U,{"auto-width":""},{default:n(()=>[R(c(a.getArrivalDate(e.row).format("MM/DD/YYYY")||""),1)]),_:2},1024),(f(!0),_(T,null,E(e.cols,o=>(f(),P(U,{key:o.name,props:e},{default:n(()=>[R(c(o.value),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),"no-data":n(({message:e})=>[r("div",pt,[s(I,{size:"2em",name:"fa-solid fa-person-circle-exclamation"}),r("span",null,c(e),1)])]),"top-right":n(()=>[r("div",ct,"(Total: "+c(a.rows.length)+" assignments)",1),s(ae,{color:"secondary",flat:"","icon-right":"refresh",label:"Refresh",onClick:i[6]||(i[6]=e=>a.loadData(!0))})]),"top-left":n(()=>[r("div",ft,"Created by Ratio (Site/HC): "+c(a.bySite.length)+" / "+c(a.rows.length)+" ("+c((a.bySite.length/a.rows.length*100).toFixed(2))+"%)",1)]),loading:n(()=>[s(pe,{showing:"",color:"primary"})]),_:1},8,["columns","rows","row-key","loading"])])])}var ht=se(Ie,[["render",vt]]);const gt=le({props:{},components:{},setup(a){const i=ie(),S=ue(),{capitalize:q}=be,C=p(""),y=p(null),e=p(null),o=p(null),g=p(null),$=p(null),k=p(!0),A=p(null),x=p(null),z=[{name:1,label:"Name",align:"left",field:l=>l[31],format:l=>`${b(l)}`,sortable:!0},{name:2,label:"Status",align:"left",field:l=>l[20],format:l=>`${l}`,sortable:!0},{name:3,label:"Hiring Center",align:"left",field:l=>l[68],format:l=>`${l}`,sortable:!0},{name:4,label:"Project",align:"left",field:l=>l[190],format:l=>`${l}`,sortable:!0}],X=[{value:"Reassign",label:"Reassign"},{value:"Terminate",label:"Terminate"},{value:"",label:"None"}],{setAdminData:G,getAdminData:te,setAdminItemData:Q}=ce(),F=V(()=>{const l=Y.value;let u;return e.value?u=l.filter(h=>h[20]===e.value):u=l,g.value&&(u=u.filter(h=>h[190]===g.value)),o.value&&(u=u.filter(h=>h[190]!==o.value)),A.value&&(u=u.filter(h=>w(h[1].$d)>=w(A.value))),x.value&&(u=u.filter(h=>w(h[1].$d)<=w(x.value))),u}),Y=V(()=>te({dataset:"deployments"})||[]),L=V(()=>F.value),j=async l=>{if(l||F.value.length===0){k.value=!0;const{data:u}=await oe.fetchFromHiringApp({fields:[fe({type:"rawDeployments",query:"{'220'.EX.true}AND{'20'.XEX.'Canceled'}AND{'1'.OAF.'06-01-2022'}"})]}),h=u&&u.length>0?[...new Map(u.map(O=>[{e:O[21],o:O[72]},O])).values()].sort((O,d)=>O[1].$d>d[1].$d?-1:1):[];G({dataset:"deployments",data:h}),k.value=!1}else k.value=!1},b=l=>{const u=l.split(" ");let h="";return u.forEach((O,d)=>{h+=d>0?` ${q(O.toLowerCase())}`:q(O.toLowerCase())}),h},B=async()=>{i.loading.show(),i.loading.hide()};function K(l){S.push({name:"view-release",params:{release:l[3]}})}const Z=V(()=>[...new Map(Y.value.map(l=>[l[190],l[190]])).values()].filter(l=>l!==""));return j(),{search:C,columns:z,rows:F,loadData:j,loading:k,statusFilter:e,checkForUpdates:B,viewRelease:K,dispositionFilter:o,dispositions:X,submissionStatus:y,hiringStatusFilter:g,hiringStatusOptions:Z,possibleReassignment:$,startDate:A,endDate:x,bySite:L}}}),bt={class:"row items-center"},wt={class:"col-12 col-md-2 q-px-sm"},$t={class:"col-12 col-md-2 q-px-sm"},yt={class:"col-12 col-md-2 q-px-sm"},_t={class:"col-12 col-md-2 q-px-sm"},Dt={class:"col-12 col-md-2 q-px-sm"},qt={class:"col-12 col-md-2 q-px-sm"},kt={class:"full-width row flex-center text-primary q-gutter-sm q-py-md"},St={class:"text-dark text-caption text-italic"};function Vt(a,i,S,q,C,y){return f(),_("div",null,[s(J,{flat:""},{default:n(()=>[s(H,null,{default:n(()=>[r("div",bt,[r("div",wt,[s(M,{dense:"",label:"Status","transition-show":"flip-up","transition-hide":"flip-down",modelValue:a.statusFilter,"onUpdate:modelValue":i[0]||(i[0]=e=>a.statusFilter=e),options:["In Process","Complete","DNC"],clearable:""},null,8,["modelValue"])]),r("div",$t,[s(M,{dense:"",label:"Project","transition-show":"flip-up","transition-hide":"flip-down",modelValue:a.hiringStatusFilter,"onUpdate:modelValue":i[1]||(i[1]=e=>a.hiringStatusFilter=e),options:a.hiringStatusOptions,clearable:""},null,8,["modelValue","options"])]),r("div",yt,[s(M,{dense:"",label:"Remove Project","transition-show":"flip-up","transition-hide":"flip-down",modelValue:a.dispositionFilter,"onUpdate:modelValue":i[2]||(i[2]=e=>a.dispositionFilter=e),options:a.hiringStatusOptions,clearable:""},null,8,["modelValue","options"])]),r("div",_t,[s(M,{dense:"",label:"Created by Project App","transition-show":"flip-up","transition-hide":"flip-down",modelValue:a.possibleReassignment,"onUpdate:modelValue":i[3]||(i[3]=e=>a.possibleReassignment=e),options:["Yes","No"],clearable:""},null,8,["modelValue"])]),r("div",Dt,[s(ee,{"stack-label":"",dense:"",type:"date",modelValue:a.startDate,"onUpdate:modelValue":i[4]||(i[4]=e=>a.startDate=e),label:"Start Date"},null,8,["modelValue"])]),r("div",qt,[s(ee,{"stack-label":"",dense:"",type:"date",modelValue:a.endDate,"onUpdate:modelValue":i[5]||(i[5]=e=>a.endDate=e),label:"End Date"},null,8,["modelValue"])])])]),_:1})]),_:1}),r("div",null,[s(me,{title:"Assignments","title-class":"text-h5 text-primary",columns:a.columns,rows:a.rows,"row-key":e=>e[3],class:"q-pa-sm",pagination:{rowsPerPage:100},"table-header-class":"bg-dark text-white","no-data-label":"There are no recent departures",dense:"",loading:a.loading},{header:n(e=>[s(W,{class:"bg-dark text-white",props:e},{default:n(()=>[s(N,{"auto-width":""}),s(N,{"auto-width":""},{default:n(()=>[R("Date")]),_:1}),(f(!0),_(T,null,E(e.cols,o=>(f(),P(N,{key:o.name,props:e},{default:n(()=>[R(c(o.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),body:n(e=>[s(W,{props:e},{default:n(()=>[s(U,{"auto-width":""},{default:n(()=>[s(I,{class:"cursor-pointer",size:a.$q.screen.gt.sm?"sm":"xs",color:"info",round:"",dense:"",onClick:o=>a.viewRelease(e.row),name:e.expand?"visibility_off":"visibility"},null,8,["size","onClick","name"])]),_:2},1024),s(U,{"auto-width":""},{default:n(()=>[R(c(a.$dayjs(e.row[1].$d).format("MM/DD/YYYY")||""),1)]),_:2},1024),(f(!0),_(T,null,E(e.cols,o=>(f(),P(U,{key:o.name,props:e},{default:n(()=>[R(c(o.value),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),"no-data":n(({message:e})=>[r("div",kt,[s(I,{size:"2em",name:"fa-solid fa-person-circle-exclamation"}),r("span",null,c(e),1)])]),"top-right":n(()=>[r("div",St,"(Total: "+c(a.rows.length)+" deployments)",1),s(ae,{color:"secondary",flat:"","icon-right":"refresh",label:"Refresh",onClick:i[6]||(i[6]=e=>a.loadData(!0))})]),"top-left":n(()=>[]),loading:n(()=>[s(pe,{showing:"",color:"primary"})]),_:1},8,["columns","rows","row-key","loading"])])])}var Ft=se(gt,[["render",Vt]]);const Rt=le({props:{},components:{},setup(a){const i=ie(),S=ue(),q=p(""),C=p(null),y=p(null),e=p(null),o=p(null),g=p(null),$=p(!0),k=p(null),A=p(null),x=[{name:1,label:"Number",align:"left",field:l=>l[3],format:l=>`${l}`,sortable:!0},{name:2,label:"Status",align:"left",field:l=>l[14],format:l=>`${l}`,sortable:!0},{name:3,label:"Hiring Center",align:"left",field:l=>l[103],format:l=>`${l}`,sortable:!0},{name:4,label:"Project",align:"left",field:l=>l[28],format:l=>`${l}`,sortable:!0}],z=[{value:"Reassign",label:"Reassign"},{value:"Terminate",label:"Terminate"},{value:"",label:"None"}],{setAdminData:X,getAdminData:G,setAdminItemData:te}=ce(),Q=V(()=>{const l=F.value;let u;if(y.value?u=l.filter(h=>h[14]===y.value):u=l,o.value&&(u=u.filter(h=>h[28]===o.value)),e.value&&(u=u.filter(h=>h[28]!==e.value)),g.value){const h=g.value==="Yes";u=u.filter(O=>O[281]===h)}return k.value&&(u=u.filter(h=>w(h[1].$d).isSameOrAfter(w(k.value)))),A.value&&(u=u.filter(h=>w(h[1].$d).isSameOrBefore(w(A.value)))),u}),F=V(()=>G({dataset:"requests"})||[]),Y=V(()=>Q.value.filter(l=>l[148])),L=async l=>{if(l||Q.value.length===0){$.value=!0;const{data:u}=await oe.fetchFromProjectsApp({fields:[_e({type:"requests",query:"{'288'.EX.true}AND{'14'.XEX.'Cancelled'}AND{'14'.XEX.''}AND{'1'.OAF.'07-12-2022'}"})]});X({dataset:"requests",data:u||[]}),$.value=!1}else $.value=!1},j=async()=>{i.loading.show(),i.loading.hide()};function b(l){S.push({name:"view-release",params:{release:l[3]}})}const B=V(()=>[...new Map(F.value.map(l=>[l[28],l[28]])).values()].filter(l=>l!==""));L();const K=l=>l[145].$d?w(l[145].$d):w(l[1].$d),Z=V(()=>F.value.length>0?[{label:"Submitted by Portal",value:F.value.filter(l=>l[281]).length,denominator:F.value.length,separate:!0},{label:"Filtered Submitted by Portal",value:Q.value.filter(l=>l[281]).length,denominator:Q.value.length,separate:!0},{label:"Unfiltered Total Needed",value:F.value.reduce((l,u)=>l+u[115],0),separate:!0},{label:"Filtered Total Needed",value:Q.value.reduce((l,u)=>l+u[115],0),separate:!0},{label:"Time to Open Unfiltered",value:(F.value.filter(l=>l[82].$d!==null&&l[82].$d!==void 0&&l[14]!=="Pending").reduce((l,u)=>l+w(u[82].$d).diff(w(u[1].$d),"hour",!0),0)/F.value.filter(l=>l[82].$d!==null&&l[82].$d!==void 0&&l[14]!=="Pending").length).toFixed(2)+" hours",separate:!0},{label:"Time to Open Filtered",value:(Q.value.filter(l=>l[82].$d!==null&&l[82].$d!==void 0&&l[14]!=="Pending").reduce((l,u)=>l+w(u[82].$d).diff(w(u[1].$d),"hour",!0),0)/Q.value.filter(l=>l[82].$d!==null&&l[82].$d!==void 0&&l[14]!=="Pending").length).toFixed(2)+" hours",separate:!0}]:[]);return{search:q,columns:x,rows:Q,loadData:L,loading:$,statusFilter:y,checkForUpdates:j,viewRelease:b,dispositionFilter:e,dispositions:z,submissionStatus:C,hiringStatusFilter:o,hiringStatusOptions:B,possibleReassignment:g,startDate:k,endDate:A,bySite:Y,stats:Z,getArrivalDate:K}}}),Ct={class:"row items-start"},At={class:"col-4 q-pr-xs"},xt={class:"row"},Pt={class:"col-8"},Tt=r("div",{class:"text-body1"},"Requests Summary",-1),Nt={class:"text-caption text-italic"},Ut={class:"col-4 text-right"},jt={class:"text-caption"},Ot={class:"text-primary q-mr-sm"},Qt={key:0,class:"text-dark"},Yt={key:1,class:"text-dark"},Et={class:"col-8 q-px-xs"},Mt={class:"row items-center"},zt={class:"col-12 col-md-2 q-px-sm"},Xt={class:"col-12 col-md-2 q-px-sm"},Ht={class:"col-12 col-md-2 q-px-sm"},Lt={class:"col-12 col-md-2 q-px-sm"},Bt={class:"col-12 col-md-2 q-px-sm"},It={class:"col-12 col-md-2 q-px-sm"},Wt={class:"full-width row flex-center text-primary q-gutter-sm q-py-md"},Gt={class:"text-dark text-caption text-italic"},Kt=r("div",{class:"text-dark text-caption text-italic"},"Created by Ratio (Site/HC):",-1);function Zt(a,i,S,q,C,y){return f(),_("div",null,[s(J,{flat:""},{default:n(()=>[s(H,null,{default:n(()=>[r("div",Ct,[r("div",At,[s(J,null,{default:n(()=>[s(H,{class:"q-pa-sm bg-dark text-white"},{default:n(()=>[r("div",xt,[r("div",Pt,[Tt,r("div",Nt,"Total: "+c(a.rows.length)+" Requests",1)]),r("div",Ut,[s(ae,{round:"",dense:"",size:"md",color:"white",flat:"",icon:"refresh",onClick:i[0]||(i[0]=e=>a.loadData(!0))})])])]),_:1}),(f(!0),_(T,null,E(a.stats,(e,o)=>(f(),_(T,{key:o},[s(H,{class:"q-py-xs q-pr-xs q-pl-sm"},{default:n(()=>[r("div",jt,[r("span",Ot,c(e.label)+": ",1),e.denominator?(f(),_("span",Qt,c(e.value)+" / "+c(e.denominator)+" ("+c((e.value/e.denominator*100).toFixed(2))+"%) ",1)):(f(),_("span",Yt,c(e.value),1))])]),_:2},1024),e.separate?(f(),P(he,{key:0})):ge("",!0)],64))),128))]),_:1})]),r("div",Et,[r("div",Mt,[r("div",zt,[s(M,{dense:"",label:"Status","transition-show":"flip-up","transition-hide":"flip-down",modelValue:a.statusFilter,"onUpdate:modelValue":i[1]||(i[1]=e=>a.statusFilter=e),options:["Open","Closed","Pending"],clearable:""},null,8,["modelValue"])]),r("div",Xt,[s(M,{dense:"",label:"Project","transition-show":"flip-up","transition-hide":"flip-down",modelValue:a.hiringStatusFilter,"onUpdate:modelValue":i[2]||(i[2]=e=>a.hiringStatusFilter=e),options:a.hiringStatusOptions,clearable:""},null,8,["modelValue","options"])]),r("div",Ht,[s(M,{dense:"",label:"Remove Project","transition-show":"flip-up","transition-hide":"flip-down",modelValue:a.dispositionFilter,"onUpdate:modelValue":i[3]||(i[3]=e=>a.dispositionFilter=e),options:a.hiringStatusOptions,clearable:""},null,8,["modelValue","options"])]),r("div",Lt,[s(M,{dense:"",label:"Created by Project App","transition-show":"flip-up","transition-hide":"flip-down",modelValue:a.possibleReassignment,"onUpdate:modelValue":i[4]||(i[4]=e=>a.possibleReassignment=e),options:["Yes","No"],clearable:""},null,8,["modelValue"])]),r("div",Bt,[s(ee,{"stack-label":"",dense:"",type:"date",modelValue:a.startDate,"onUpdate:modelValue":i[5]||(i[5]=e=>a.startDate=e),label:"Start Date"},null,8,["modelValue"])]),r("div",It,[s(ee,{"stack-label":"",dense:"",type:"date",modelValue:a.endDate,"onUpdate:modelValue":i[6]||(i[6]=e=>a.endDate=e),label:"End Date"},null,8,["modelValue"])])])])])]),_:1})]),_:1}),r("div",null,[s(me,{title:"Requests","title-class":"text-h5 text-primary",columns:a.columns,rows:a.rows,"row-key":e=>e[3],class:"q-pa-sm",pagination:{rowsPerPage:100},"table-header-class":"bg-dark text-white","no-data-label":"There are no requests",dense:"",loading:a.loading},{header:n(e=>[s(W,{class:"bg-dark text-white",props:e},{default:n(()=>[s(N,{"auto-width":""}),s(N,{"auto-width":""},{default:n(()=>[R("Date")]),_:1}),s(N,{"auto-width":""},{default:n(()=>[R("Opened")]),_:1}),s(N,{"auto-width":""},{default:n(()=>[R("Duration")]),_:1}),(f(!0),_(T,null,E(e.cols,o=>(f(),P(N,{key:o.name,props:e},{default:n(()=>[R(c(o.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),body:n(e=>[s(W,{props:e},{default:n(()=>[s(U,{"auto-width":""},{default:n(()=>[s(I,{class:"cursor-pointer",size:a.$q.screen.gt.sm?"sm":"xs",color:"info",round:"",dense:"",onClick:o=>a.viewRelease(e.row),name:e.expand?"visibility_off":"visibility"},null,8,["size","onClick","name"])]),_:2},1024),s(U,{"auto-width":""},{default:n(()=>[R(c(a.$dayjs(e.row[1].$d).format("MM/DD/YYYY hh:mm:ss")||""),1)]),_:2},1024),s(U,{"auto-width":""},{default:n(()=>[R(c(e.row[82].$d?a.$dayjs(e.row[82].$d).format("MM/DD/YYYY hh:mm:ss"):""),1)]),_:2},1024),s(U,{"auto-width":""},{default:n(()=>[R(c(e.row[82].$d?a.$dayjs(e.row[82].$d).diff(a.$dayjs(e.row[1].$d),"hour",!0).toFixed(2):""),1)]),_:2},1024),(f(!0),_(T,null,E(e.cols,o=>(f(),P(U,{key:o.name,props:e},{default:n(()=>[R(c(o.value),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),"no-data":n(({message:e})=>[r("div",Wt,[s(I,{size:"2em",name:"fa-solid fa-person-circle-exclamation"}),r("span",null,c(e),1)])]),"top-right":n(()=>[r("div",Gt,"(Total: "+c(a.rows.length)+" requests)",1),s(ae,{color:"secondary",flat:"","icon-right":"refresh",label:"Refresh",onClick:i[7]||(i[7]=e=>a.loadData(!0))})]),"top-left":n(()=>[Kt]),loading:n(()=>[s(pe,{showing:"",color:"primary"})]),_:1},8,["columns","rows","row-key","loading"])])])}var Jt=se(Rt,[["render",Zt]]);const ea=le({name:"Admin",components:{ReleasesPanel:Be,AssignmentsPanel:ht,DeploymentsPanel:Ft,RequestPanel:Jt},setup(){const a=p(0);return ie(),{tab:a}}}),ta={class:"q-pa-sm"};function aa(a,i,S,q,C,y){const e=ne("releases-panel"),o=ne("assignments-panel"),g=ne("deployments-panel"),$=ne("request-panel");return f(),P(ye,{style:{"max-width":"100vw"}},{default:n(()=>[r("div",ta,[s($e,{class:"q-py-xs q-px-sm bg-info text-white shadow-2 rounded-borders",align:"left",modelValue:a.tab,"onUpdate:modelValue":i[0]||(i[0]=k=>a.tab=k),dense:"","indicator-color":"accent","outside-arrows":"","mobile-arrows":"","inline-label":""},{default:n(()=>[s(re,{name:0,label:"Departures"}),s(re,{name:1,label:"Assignments"}),s(re,{name:2,label:"Deployments"}),s(re,{name:3,label:"Requests"})]),_:1},8,["modelValue"]),s(we,{modelValue:a.tab,"onUpdate:modelValue":i[1]||(i[1]=k=>a.tab=k),animated:"",class:"q-px-none"},{default:n(()=>[s(de,{class:"q-px-xs",name:0},{default:n(()=>[s(e)]),_:1}),s(de,{class:"q-px-xs",name:1},{default:n(()=>[s(o)]),_:1}),s(de,{class:"q-px-xs",name:2},{default:n(()=>[s(g)]),_:1}),s(de,{class:"q-px-xs",name:3},{default:n(()=>[s($)]),_:1})]),_:1},8,["modelValue"])])]),_:1})}var ja=se(ea,[["render",aa]]);export{ja as default};
