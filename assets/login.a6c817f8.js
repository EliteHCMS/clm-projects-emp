import{Q as re}from"./QImg.fad7b93b.js";import{_ as ne,c5 as ie,c4 as de,r as i,c as Q,w as y,aY as U,z as u,am as p,bh as t,A as L,d as l,an as c,C as q,c2 as w,aa as P,bE as ue,bD as ce,cx as X,ar as me,c6 as I,bX as z,D as pe,cy as ge,at as j,c3 as ve,aH as D}from"./index.061ea6bc.js";import{Q as fe}from"./QForm.4d8d9761.js";import{Q as he}from"./QPage.0aa73bf0.js";import{u as ye}from"./use-quasar.6ea742fe.js";import{c as M,u as K}from"./array.2111f2ac.js";import{p as we}from"./VueTelInput.1f88b2a3.js";import{_ as be}from"./languageSelector.3e6376ae.js";import{c as _e}from"./carousel.469e38d7.js";import{c as xe,q as G}from"./quickbase.b92f3042.js";import{u as ke}from"./i18n.0de7a792.js";import"./_commonjsHelpers.dfee5925.js";import"./QSelect.262adbc5.js";import"./QChip.69c1fd52.js";import"./QMenu.83a60a3d.js";import"./position-engine.dfad590e.js";import"./selection.4585179d.js";import"./rtl.65b79c69.js";import"./use-panel.ebc106e4.js";import"./touch.d8ab472d.js";import"./use-fullscreen.3b991254.js";import"./dayjs.34e2bfa8.js";import"./localForage.c8aefc07.js";import"./index.7dbe61ef.js";import"./api.1800cf8a.js";const Ce={name:"Login",components:{phoneNumberInput:we,carousel:_e,languageSelector:be},setup(){const o=ye(),n=ie(),b=de(),{locale:e,t:_}=ke(),{currentUserType:x,currentPageType:V}=xe(),s=i(!1),r=i(!1),k=i(10),d=i(!1),C=i(null),T=i(!1),J=i("first"),v=i("username"),F=i(null),A=i(null),S=i(!1),E=i(!1);n.query.redirect&&(A.value=n.query.redirect,b.replace({query:{}}));const W=Q(()=>s.value?M().email(`${_("validEmailIsRequired")}`).nullable():M().email(`${_("validEmailIsRequired")}`).nullable()),$=Q(()=>{if(r.value)return M().nullable();{const a=new RegExp("^[0-9]{"+k.value+"}","g");return M().matches(a,{excludeEmptyString:!0,message:`${_("validPhoneIsRequired")}`}).nullable()}}),ee=Q(()=>M().required().matches(/^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d@$!%*#?&]{8,}$/,{excludeEmptyString:!0,message:`${_("passwordRules")}`}).nullable()),{errorMessage:R,value:f}=K("email",W),{errorMessage:B,value:g}=K("phone",$),{errorMessage:H,value:h}=K("password",ee),ae=i(!0);y(R,a=>{a||f.value===""?r.value=!1:r.value=!0}),y(f,a=>{!a||a===""?r.value=!1:/^\w+([.-]?\w+)*@\w+([.-]?\w+)*(\.\w{2,3})+$/.test(a)&&!R.value&&(r.value=!0)}),y(B,a=>{a||g.value===""?s.value=!1:s.value=!0}),y(g,a=>{!a||a===""?s.value=!1:a.length===k.value&&!B.value&&(s.value=!0)}),y(H,a=>{a||h.value===""?d.value=!1:d.value=!0}),y(h,a=>{T.value=!1,(!a||a==="")&&(d.value=!1)});const oe=a=>{k.value=a},O=Q(()=>!(s.value||r.value)),le=a=>{C.value=a},te=()=>{v.value="username",h.value=null,D(()=>{document.querySelector("#email").focus()})},se=()=>{v.value="username",h.value=null,D(()=>{document.querySelector("#phoneNumber").focus()})},Y=async()=>{E.value=!0;const a={userType:x};s.value?a.phoneNumber=`+${C.value?C.value.dialCode:"1"}${g.value}`:r.value&&(a.email=f.value);try{const m=await G.checkIfUserExist(a);E.value=!1,m?(v.value="password",D(()=>{document.querySelector("#password").focus()})):x==="Candidate"?b.push({name:"register",params:{...s.value&&{phoneTemp:g.value},...r.value&&{emailTemp:a.email}}}):o.dialog({title:"Alert",message:s.value?"That phone number does not exist. Try again.":"That email does not exist. Try again."}).onOk(()=>{g.value="",s.value=!1,f.value="",r.value=!1})}catch(m){E.value=!1,console.log(m)}},Z=async()=>{S.value=!0,clearTimeout(F.value);const a={password:h.value,userType:x};s.value?a.phoneNumber=`+${C.value?C.value.dialCode:"1"}${g.value}`:r.value&&(a.email=f.value);try{const m=await G.login(a);S.value=!1,m&&(A.value?b.push(A.value):b.push({path:"/"}))}catch(m){S.value=!1,F.value=setTimeout(function(){T.value=!1},7e3);const{response:N}=m;N&&N.data.errtext&&N.data.errdetail?o.notify({type:"negative",message:N.data.errdetail,timeout:7e3,position:o.screen.lt.md?"top":"top-right"}):(console.log(m),o.notify({type:"negative",message:"An error occurred, please try again later",timeout:7e3,position:o.screen.lt.md?"top":"top-right"}))}};return{email:f,phone:g,password:h,isPwd:ae,validPhone:s,validEmail:r,step:v,validPassword:d,invalidLogin:T,continueProgress:E,loginProgress:S,passwordMessage:H,phoneMessage:B,emailMessage:R,userNameInvalid:O,updatePhoneMaxLength:oe,continueAction:Y,editUserNameEmail:te,editUserNamePhoneNumber:se,slide:J,login:Z,updateCountry:le,onSubmit:a=>{v.value==="username"&&!O.value?Y():v.value==="password"&&!(!d.value||T.value)?Z():a.preventDefault()},locale:e,currentUserType:x,currentPageType:V}}},qe={key:0,class:"col-md-7 col-lg-8 col-lx-8"},Pe={class:"col-xs-12 col-sm-12 col-md-5 col-lg-4 col-lx-4 row justify-center items-center"},Me={class:"text-dark"},Te={key:1,class:"divider"},Se={class:"divider-text"},Ee={key:0,class:"text-grey-6",tabindex:"4"},Ne={class:"row justify-center"},Qe={class:"row justify-center"};function Ue(o,n,b,e,_,x){const V=U("carousel"),s=U("phone-number-input"),r=U("router-link"),k=U("languageSelector");return u(),p(he,{class:"window-height window-width row"},{default:t(()=>[o.$q.screen.lt.md?c("",!0):(u(),L("div",qe,[l(V)])),q("div",Pe,[l(ve,{class:"auth-card",flat:""},{default:t(()=>[l(w,{style:{"padding-left":"30px","padding-right":"30px"}},{default:t(()=>[l(re,{src:"https://cdn.jsdelivr.net/gh/EliteHCMS/assets@latest/public/logo.svg",fit:"scale-down",class:"auth-logo full-width"})]),_:1}),l(w,{class:"text-center auth-description"},{default:t(()=>[q("p",Me,P(o.$t("pleaseSignInToYourAccount")),1)]),_:1}),l(w,null,{default:t(()=>[l(fe,{class:"q-px-sm q-pt-sm",onSubmit:n[4]||(n[4]=ue(()=>{},["prevent"])),onKeyup:ce(e.onSubmit,["enter"])},{default:t(()=>[!e.validEmail&&!e.validPhone||e.validEmail?(u(),p(X,{key:0,for:"email",style:{"padding-bottom":"0px"},autocomplete:"username",clearable:"",outlined:"",modelValue:e.email,"onUpdate:modelValue":n[0]||(n[0]=d=>e.email=d),type:"email",label:o.$t("email"),tabindex:"1",error:!!e.emailMessage,"error-message":e.emailMessage,readonly:e.step!=="username"},me({prepend:t(()=>[l(z,{name:"email"})]),_:2},[e.step!=="username"?{name:"append",fn:t(()=>[l(I,{round:"",dense:"",flat:"",icon:"edit",onClick:e.editUserNameEmail},null,8,["onClick"])])}:void 0]),1032,["modelValue","label","error","error-message","readonly"])):c("",!0),!e.validEmail&&!e.validPhone&&e.currentUserType!=="QuickBase User"?(u(),L("div",Te,[q("div",Se,P(o.$t("or")),1)])):c("",!0),(!e.validEmail&&!e.validPhone||e.validPhone)&&e.currentUserType!=="QuickBase User"?(u(),p(s,{key:2,outlined:"",for:"phoneNumber",modelValue:e.phone,"onUpdate:modelValue":n[1]||(n[1]=d=>e.phone=d),label:o.$t("phoneNumber"),tabindex:"1",autocomplete:"username",onMaxLengthChanged:e.updatePhoneMaxLength,style:pe(e.phoneMessage?"padding-bottom: 20px;":"padding-bottom: 0px;"),error:!!e.phoneMessage,"error-message":e.phoneMessage,readonly:e.step!=="username",editIcon:e.step!=="username",onEditClicked:e.editUserNamePhoneNumber,onCountryChanged:e.updateCountry},null,8,["modelValue","label","onMaxLengthChanged","style","error","error-message","readonly","editIcon","onEditClicked","onCountryChanged"])):c("",!0),e.step==="password"?(u(),p(X,{key:3,for:"password",class:"q-mt-lg",outlined:"",modelValue:e.password,"onUpdate:modelValue":n[3]||(n[3]=d=>e.password=d),type:e.isPwd?"password":"text",label:o.$t("password"),autocomplete:"current-password",tabindex:"2",error:!!e.passwordMessage,"error-message":e.passwordMessage},{append:t(()=>[l(z,{name:e.isPwd?"visibility_off":"visibility",class:"cursor-pointer",onClick:n[2]||(n[2]=d=>e.isPwd=!e.isPwd)},null,8,["name"])]),prepend:t(()=>[l(z,{name:"lock"})]),_:1},8,["modelValue","type","label","error","error-message"])):c("",!0)]),_:1},8,["onKeyup"])]),_:1}),l(ge,{class:"q-px-lg"},{default:t(()=>[e.step==="username"?(u(),p(I,{key:0,loading:e.continueProgress,unelevated:"",size:"lg",color:"primary",class:"full-width text-white",label:o.$t("continue"),tabindex:"3",disabled:e.userNameInvalid,onClick:e.continueAction},null,8,["loading","label","disabled","onClick"])):c("",!0),e.step==="password"?(u(),p(I,{key:1,loading:e.loginProgress,unelevated:"",size:"lg",color:"primary",class:"full-width text-white",label:o.$t("login"),tabindex:"3",disabled:!e.validPassword||e.invalidLogin,onClick:e.login},null,8,["loading","label","disabled","onClick"])):c("",!0)]),_:1}),l(w,{class:"text-center q-pa-sm"},{default:t(()=>[e.currentUserType==="Candidate"?(u(),L("p",Ee,[j(P(o.$t("needAnAccountQuestion"))+" ",1),l(r,{to:"/register",class:"text-grey-6"},{default:t(()=>[j(P(o.$t("register")),1)]),_:1})])):c("",!0),e.currentUserType!=="QuickBase User"?(u(),p(r,{key:1,to:"/forgot-password",class:"text-grey-6"},{default:t(()=>[j(P(o.$t("forgotPasswordQuestion")),1)]),_:1})):c("",!0)]),_:1}),l(w,{class:"q-pl-lg q-pa-sm"},{default:t(()=>[q("div",Ne,[l(k,{dense:"",borderless:""})])]),_:1}),e.currentPageType==="Candidate Kiosk"?(u(),p(w,{key:0,class:"q-pl-lg q-pa-sm"},{default:t(()=>[q("div",Qe,[l(I,{label:"Bookmarks",color:"primary",size:"md",class:"text-white q-mt-xl",to:{name:"bookmarks"}})])]),_:1})):c("",!0)]),_:1})])]),_:1})}var ra=ne(Ce,[["render",Ue],["__scopeId","data-v-7ec56d53"]]);export{ra as default};
