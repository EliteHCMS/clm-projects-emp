import{a as E,Q as G}from"./QTable.12045531.js";import{Q as I}from"./QTr.fb3ac2d2.js";import{Q as w}from"./QTd.d2ccd994.js";import{l as K,bT as Z,r as c,c as k,_,y as ee,b5 as te,A as m,B as h,d as u,av as le,br as d,F as Q,b4 as q,aq as p,cU as y,ar as oe,ax as R,ac as A,bQ as Y,D as X,bW as O}from"./index.d4eae66d.js";import{a as ae}from"./QSelect.031fcf1a.js";import{Q as re}from"./QInnerLoading.252eeb0c.js";import{u as se}from"./use-quasar.bcab4131.js";import{e as ne}from"./export-file.dc78ba05.js";import{dayjs as j}from"./dayjs.623dcd01.js";import{u as ie}from"./index.36c6fd7e.js";import{A as ue}from"./arrivalDate.40cfcc65.js";import{q as P}from"./app.613d4acb.js";import{u as T}from"./useQuerySaver.d29ff9ee.js";const me=K({components:{ArrivalDate:ue},emits:["refreshData"],props:{rows:Array,title:String},setup(t,a){const b=se(),v=Z(),{can:F}=ie(),{capitalize:g}=ee,L=c(!1),r=c(null),s=c(null),n=c(null),D=c(null),V=c(null),C=c(null),$=c(null),N=c(null),U=k(()=>[{name:1,label:"Name",align:"left",field:e=>e.employee[22],format:(e,o)=>`${B(o.employee)}`,sortable:!0,sortOrder:"ad"},{name:7,label:"Phone #",align:"left",field:e=>e.employee[25],format:e=>`${e}`,sortable:!1},{name:2,label:"Workday ID",align:"left",field:e=>e.employee[378],format:e=>`${e}`,sortable:!0,sortOrder:"ad"},{name:3,label:"Payroll ID",align:"left",field:e=>e.employee[213],format:e=>e===""?"not available":e,sortable:!0},{name:4,label:"Classification",align:"left",field:e=>e[20],format:e=>`${!e||e===""?"Not Assigned":e}`,sortable:!0},{name:116,label:"Rate",align:"left",field:e=>e[116],format:e=>`${e===""||!e||e===0?"N/A":`$${Number(e).toFixed(2)}`}`,sortable:!0},{name:5,label:"Job #",align:"left",field:e=>e[105],format:e=>`${e===""||!e?"Not Assigned":e}`,sortable:!0}]),x=k(()=>b.screen.gt.sm?[1,7,2,3,4,F("read","rates")?116:[],5]:[1,7,2,3,4,F("read","rates")?116:[],5]),z=k(()=>[...new Set(t.rows.map(e=>e[105]===""||!e[105]?"Not Assigned":e[105]))]),S=k(()=>{let e=t.rows;if(r.value&&r.value.trim().length>0){const o=r.value.trim().toLowerCase();e=e.filter(l=>l.employee&&B(l.employee).toLowerCase().includes(o))}if(s.value&&s.value.trim().length>0){const o=s.value.trim().toLowerCase();e=e.filter(l=>l.employee&&l.employee[25]&&l.employee[25].toLowerCase().includes(o))}if(n.value&&n.value.trim().length>0){const o=n.value.trim().toLowerCase();e=e.filter(l=>l.employee&&l.employee[378]&&l.employee[378].toLowerCase().includes(o))}if(D.value&&D.value.trim().length>0){const o=D.value.trim().toLowerCase();e=e.filter(l=>l.employee&&(l.employee[213]===""?"not available".includes(o):l.employee[213]&&l.employee[213].toLowerCase().includes(o)))}if(V.value&&V.value.trim().length>0){const o=V.value.trim().toLowerCase();e=e.filter(l=>!l[20]||l[20]===""?"Not Assigned".toLowerCase().includes(o):l[20]&&l[20].toLowerCase().includes(o))}if(C.value&&C.value.trim().length>0){const o=C.value.trim().toLowerCase();e=e.filter(l=>l[116]===""||!l[116]||l[116]===0?"N/A".toLowerCase().includes(o):l[116]&&"$".concat(Number(l[116]).toFixed(2).toString()).toLowerCase().includes(o))}if($.value&&$.value.trim().length>0){const o=$.value.trim().toLowerCase();e=e.filter(l=>l[105]===""||!l[105]?"Not Assigned".toLowerCase().includes(o):l[105]&&l[105].toLowerCase().includes(o))}if(N.value&&N.value.trim().length>0){const o=j(N.value.trim()).format("MM/DD/YYYY");e=e.filter(l=>J(l)===o)}return e}),B=e=>{const o=e[20]!==""?g(e[20].toLowerCase().trim()):"",l=e[22]!==""?g(e[22].toLowerCase().trim()):"",i=e[21]!==""?` ${g(e[21].toLowerCase().trim())}`:"",f=e[23]!==""?` ${g(e[23])}`:"";return`${l}${f}, ${o}${i}`};function H(e){v.push({name:"ee-summary",params:{id:e[18]}})}function M(e,o,l){let i=o!==void 0?o(e,l):e;return i=i==null?"":String(i),i=i.split('"').join('""'),`"${i}"`}function W(){const e=U.value.filter(i=>!!x.value.includes(i.name)),o=[e.map(i=>M(i.label))].concat(S.value.map(i=>e.map(f=>M(typeof f.field=="function"?f.field(i):i[f.field===void 0?f.name:f.field],f.format,i)).join(","))).join(`\r
`);ne(`${j().format("MM.DD.YYYY")} Employees-Export.csv`,o,"text/csv")!==!0&&b.notify({message:"Browser denied file download...",color:"negative",icon:"warning"})}const J=e=>{const o=e[145]&&e[145].$d?e[145].$d:e[1].$d;return j(o).format("MM/DD/YYYY")};return{columns:U,visibleColumns:x,props:t,exportAllEmployees:W,viewEmployee:H,showFilter:L,nameFilter:r,phoneNumberFilter:s,workdayIDFilter:n,payrollIDFilter:D,classificationFilter:V,rateFilter:C,jobNumberFilter:$,arrivalDateFilter:N,jobNumbers:z,filteredRows:S}}}),de={class:"full-width row flex-center text-primary q-gutter-sm q-py-md"},pe={class:"text-dark text-caption text-italic"};function ce(t,a,b,v,F,g){const L=te("arrival-date");return m(),h("div",null,[u(G,{title:t.title,"title-class":"text-h5 text-primary",columns:t.columns,"visible-columns":t.visibleColumns,rows:t.filteredRows,"row-key":r=>r[3],class:"q-pa-sm",pagination:{rowsPerPage:25},"table-header-class":"bg-dark text-white","no-data-label":"There are no employees in the roster",dense:""},le({header:d(r=>[u(I,{class:"bg-dark text-white",props:r},{default:d(()=>[u(E,{"auto-width":""}),(m(!0),h(Q,null,q(r.cols,s=>(m(),p(E,{key:s.name,props:r},{default:d(()=>[R(A(s.label),1)]),_:2},1032,["props"]))),128)),u(E,{class:"text-left","auto-width":""},{default:d(()=>[R("Arrival Date")]),_:1})]),_:2},1032,["props"])]),body:d(r=>[u(I,{props:r},{default:d(()=>[u(w,{"auto-width":""},{default:d(()=>[u(Y,{class:"cursor-pointer",size:t.$q.screen.gt.sm?"sm":"xs",color:"info",round:"",dense:"",onClick:s=>t.viewEmployee(r.row),name:r.expand?"visibility_off":"visibility"},null,8,["size","onClick","name"])]),_:2},1024),(m(!0),h(Q,null,q(r.cols,s=>(m(),p(w,{key:s.name,props:r},{default:d(()=>[R(A(s.value),1)]),_:2},1032,["props"]))),128)),(m(),p(L,{class:"text-left",rowType:"assignment",row:r.row,key:r.row[3]},null,8,["row"]))]),_:2},1032,["props"])]),"no-data":d(({message:r})=>[X("div",de,[u(Y,{size:"2em",name:"fa-solid fa-person-circle-exclamation"}),X("span",null,A(r),1)])]),"top-right":d(()=>[X("div",pe,"(Total: "+A(t.filteredRows.length)+" employees)",1),u(Y,{class:"q-pl-md",size:"xs",color:t.showFilter?"info":"grey-7",name:"fa-solid fa-filter",onClick:a[8]||(a[8]=r=>t.showFilter=!t.showFilter)},null,8,["color"]),u(O,{color:"secondary",flat:"","icon-right":"refresh",label:"Refresh",onClick:a[9]||(a[9]=r=>t.$emit("refreshData"))}),u(O,{dense:t.$q.screen.lt.md,class:"q-ml-sm",color:"primary",label:"Download",onClick:t.exportAllEmployees,disable:t.filteredRows.length<1},null,8,["dense","onClick","disable"])]),loading:d(()=>[u(re,{showing:"",color:"primary"})]),_:2},[t.showFilter?{name:"top-row",fn:d(r=>[u(I,{props:r},{default:d(()=>[u(w,{"auto-width":""}),(m(!0),h(Q,null,q(r.cols,s=>(m(),p(w,{key:s.name},{default:d(()=>[s.name===1?(m(),p(y,{key:0,outlined:"",dense:"","bg-color":"grey-2",clearable:"","input-class":"text-caption",modelValue:t.nameFilter,"onUpdate:modelValue":a[0]||(a[0]=n=>t.nameFilter=n)},null,8,["modelValue"])):s.name===7?(m(),p(y,{key:1,outlined:"",dense:"","bg-color":"grey-2",clearable:"","input-class":"text-caption",modelValue:t.phoneNumberFilter,"onUpdate:modelValue":a[1]||(a[1]=n=>t.phoneNumberFilter=n)},null,8,["modelValue"])):s.name===2?(m(),p(y,{key:2,outlined:"",dense:"","bg-color":"grey-2",clearable:"","input-class":"text-caption",modelValue:t.workdayIDFilter,"onUpdate:modelValue":a[2]||(a[2]=n=>t.workdayIDFilter=n)},null,8,["modelValue"])):s.name===3?(m(),p(y,{key:3,outlined:"",dense:"","bg-color":"grey-2",clearable:"","input-class":"text-caption",modelValue:t.payrollIDFilter,"onUpdate:modelValue":a[3]||(a[3]=n=>t.payrollIDFilter=n)},null,8,["modelValue"])):s.name===4?(m(),p(y,{key:4,outlined:"",dense:"","bg-color":"grey-2",clearable:"","input-class":"text-caption",modelValue:t.classificationFilter,"onUpdate:modelValue":a[4]||(a[4]=n=>t.classificationFilter=n)},null,8,["modelValue"])):s.name===116?(m(),p(y,{key:5,outlined:"",dense:"","bg-color":"grey-2",clearable:"","input-class":"text-caption",modelValue:t.rateFilter,"onUpdate:modelValue":a[5]||(a[5]=n=>t.rateFilter=n)},null,8,["modelValue"])):s.name===5?(m(),p(ae,{key:6,outlined:"",dense:"","bg-color":"grey-2",clearable:"",class:"text-caption","popup-content-class":"text-caption",options:t.jobNumbers,"options-dense":"",modelValue:t.jobNumberFilter,"onUpdate:modelValue":a[6]||(a[6]=n=>t.jobNumberFilter=n)},null,8,["options","modelValue"])):oe("",!0)]),_:2},1024))),128)),u(w,{"auto-width":""},{default:d(()=>[u(y,{outlined:"",dense:"","bg-color":"grey-2","input-class":"text-caption",clearable:"",type:"date",modelValue:t.arrivalDateFilter,"onUpdate:modelValue":a[7]||(a[7]=s=>t.arrivalDateFilter=s)},null,8,["modelValue"])]),_:1})]),_:2},1032,["props"])]),key:"0"}:void 0]),1032,["title","columns","visible-columns","rows","row-key"])])}var Ee=_(me,[["render",ce],["__scopeId","data-v-3920a04a"]]);const Ie=async t=>{const a=await fe(t),b=await ye(t),v=await be(t);return a.concat(b.concat(v))},fe=async t=>{const{data:a}=await P.fetchFromHiringApp({fields:[T({type:"inProcesses",query:`{'108'.EX.'${t}'}AND{'37'.EX.'In Process'}AND{'38'.EX.'4'}`})]});return a},ye=async t=>{const{data:a}=await P.fetchFromHiringApp({fields:[T({type:"dispatches",query:`{'157'.EX.'${t}'}AND{'24'.EX.'5'}AND{'17'.EX.'In Process'}`})]});return a},be=async t=>{const{data:a}=await P.fetchFromHiringApp({fields:[T({type:"deployments",query:`{'134'.EX.'${t}'}ANDAND({'33'.OAF.'today'}OR{'33'.IR.'last 10 d'})AND({'20'.EX.'In Process'}OR{'20'.EX.'Complete'})AND{'128'.EX.'Yes'}AND({'27'.EX.'6'}OR{'27'.EX.'7'})`})]});return a};export{Ee as R,Ie as g};
