import{Q as G,a as ue,b as H}from"./QTabPanels.5f7ee656.js";import{Q as me}from"./QTabs.7d9f9adb.js";import{Q as pe}from"./QToolbar.cde6ee4d.js";import{Q as be}from"./QPage.b37a2af4.js";import{bU as J,bW as K,r as c,w as k,o as Z,B as F,C as ee,d as s,bs as d,cV as ae,E as u,cW as j,cU as le,bR as Q,a9 as M,ad as Y,bX as z,z as te,ar as ve}from"./index.2e7fe8e8.js";import{Q as B}from"./QTd.f89fda48.js";import{Q as oe}from"./QInnerLoading.3b857ded.js";import{Q as se}from"./QTable.0863689b.js";import{u as ne}from"./use-quasar.40d4c05b.js";import{e as re}from"./export-file.dc78ba05.js";import{dayjs as y}from"./dayjs.d259e186.js";import{c as ie,u as de,i as fe}from"./app.1914f476.js";import{_ as ce}from"./projectSelector.2a86b958.js";import"./use-panel.3430e8b4.js";import"./touch.3df10340.js";import"./selection.87b1e79a.js";import"./QResizeObserver.29993df0.js";import"./rtl.b51694b1.js";import"./QList.ca4b78d4.js";import"./QMarkupTable.883d653c.js";import"./QSelect.63d8c041.js";import"./QChip.1e62c9f1.js";import"./QMenu.aa89615f.js";import"./position-engine.fae1bc72.js";import"./use-fullscreen.a6d76165.js";import"./_commonjsHelpers.a26ce4be.js";import"./localForage.efbf8f90.js";import"./api.15b844fb.js";import"./index.04bc0a32.js";import"./i18n.2ffb039e.js";const ge={class:"row items-center"},ye={class:"col-12 col-md-3 q-px-sm"},$e={class:"col-12 col-md-3 q-px-sm"},we={class:"col-12 col-md-3 q-px-sm"},De=u("div",{class:"col-12 col-md-3 q-px-sm"},null,-1),he={class:"full-width row flex-center text-primary q-gutter-sm q-py-md"},_e={class:"text-dark text-caption text-italic"},xe={__name:"redeployment",setup(X){const _=J(),x=ne(),N=ie();de();const{getSelectedProject:m,getSelectedOffice:b}=K(N),{capitalize:C}=te,T=c(b.value?b.value[8]:null),O=c(m.value?m.value[3]:null),R=c(),$=c([]),w=c(""),v=c(""),D=c(!1),i=c({sortBy:"effectiveDate",descending:!0,page:1,rowsPerPage:25,rowsNumber:0});k(b,()=>{T.value=b.value?b.value[8]:null}),k(m,()=>{O.value=m.value?m.value[3]:null}),k(v,()=>{V()});const I=c([{name:"action",label:"",align:"left",field:"action",sortable:!1},{name:"fullName",label:"Name",align:"left",field:"fullName",format:e=>`${q(e)}`,sortable:!1,sortOrder:"ad"},{name:"phoneNumber",label:"Phone #",align:"left",field:"phoneNumber",sortable:!1},{name:"workdayId",label:"Workday ID",align:"left",field:"workdayId",format:e=>`${e}`,sortable:!1,sortOrder:"ad"},{name:"payrollId",label:"Payroll ID",align:"left",field:"payrollId",format:e=>e===""?"not available":e,sortable:!1},{name:"classification",label:"Classification",align:"left",field:"classification",format:e=>`${!e||e===""?"Not Assigned":e}`,sortable:!1},{name:"reason",label:"Term Reason",align:"left",field:"reason",format:e=>`${e}`,sortable:!1},{name:"effectiveDate",label:"Release Date",align:"left",field:"effectiveDate",format:e=>`${y(e).format("MM/DD/YYYY")}`,sortable:!0},{name:"releaseDateCreated",label:"Date Submitted",align:"left",field:"releaseDateCreated",format:e=>`${y(e).format("MM/DD/YYYY")}`,sortable:!0}]),P=c([{name:"action",label:"",align:"left",field:"action",sortable:!1},{name:"fullName",label:"Name",align:"left",field:"fullName",format:e=>`${q(e)}`,sortable:!1,sortOrder:"ad"},{name:"phoneNumber",label:"Phone #",align:"left",field:"phoneNumber",sortable:!1},{name:"workdayId",label:"Workday ID",align:"left",field:"workdayId",format:e=>`${e}`,sortable:!1,sortOrder:"ad"},{name:"payrollId",label:"Payroll ID",align:"left",field:"payrollId",format:e=>e===""?"not available":e,sortable:!1},{name:"classification",label:"Classification",align:"left",field:"classification",format:e=>`${!e||e===""?"Not Assigned":e}`,sortable:!1},{name:"reason",label:"Term Reason",align:"left",field:"reason",format:e=>`${e}`,sortable:!1},{name:"effectiveDate",label:"Release Date",align:"left",field:"effectiveDate",format:e=>`${y(e).format("MM/DD/YYYY")}`,sortable:!0},{name:"releaseDateCreated",label:"Date Submitted",align:"left",field:"releaseDateCreated",format:e=>`${y(e).format("MM/DD/YYYY")}`,sortable:!0}]),q=e=>{const t=e.split(" ");let a="";return t.forEach((l,f)=>{a+=f>0?` ${C(l.toLowerCase())}`:C(l.toLowerCase())}),a},S=({page:e,pageSize:t,descending:a,filter:l,sortBy:f})=>{try{let r="";const g=l&&l!=="";g&&(r=l.trim());const n={$or:[{fullName:{$containsi:`${r}`}},{classification:{$containsi:`${r}`}},{jobNumber:{$containsi:`${r}`}},{workdayId:{$containsi:`${r}`}},{phoneNumber:{$containsi:`${r}`}},{payrollId:{$containsi:`${r}`}}]},o={$and:[...g?[n]:[],{status:{$in:["Pending","Reviewed"]}},{primaryReason:{$eq:"Involuntary"}},{workdayStatus:{$eq:"Active"}},{reason:{$in:["Lack of Work / End of Contract/Project","RIF/Elimination of Position","Project Cancelled Before Employee Started"]}},...v.value?[{effectiveDate:{$eq:v.value}}]:[]]};return fe.getReleases({pagination:{page:e,pageSize:t},sort:`${f||"releaseDateCreated"}:${a?"desc":"asc"}`,filters:o}).then(p=>{const{data:W,meta:L}=p;return D.value=!1,{data:W,meta:L}})}catch(r){console.log(r),D.value=!1}},U=async e=>{const{page:t,rowsPerPage:a,sortBy:l,descending:f}=e.pagination,r=e.filter,g=a===0?i.value.rowsNumber:a;D.value=!0;const n=await S({page:t,sortBy:l,descending:f,pageSize:g,filter:r});if(D.value=!1,n){const{data:o,meta:p}=n;$.value.splice(0,$.value.length,...o),i.value.page=p.pagination.page,i.value.sortBy=l,i.value.descending=f,i.value.rowsPerPage=p.pagination.pageSize,i.value.rowsPerPage=p.pagination.pageSize,i.value.rowsNumber=p.pagination.total}};Z(()=>{R.value.requestServerInteraction()});const V=()=>{R.value.requestServerInteraction()};function h(e,t,a){let l=t!==void 0?t(e,a):e;return l=l==null?"":String(l),l=l.split('"').join('""'),`"${l}"`}const A=async()=>{const{page:e,rowsNumber:t,sortBy:a,descending:l}=i.value,f=await S({page:e,sortBy:a,descending:l,pageSize:t,filter:w.value});let r=[I.value.map(n=>h(n.label))].concat($.value.map(n=>I.value.map(o=>h(typeof o.field=="function"?o.field(n):n[o.field===void 0?o.name:o.field],o.format,n)).join(","))).join(`\r
`);f&&f.data&&(r=[P.value.map(n=>h(n.label))].concat(f.data.map(n=>P.value.map(o=>h(typeof o.field=="function"?o.field(n):n[o.field===void 0?o.name:o.field],o.format,n)).join(","))).join(`\r
`)),re(`${y().format("MM.DD.YYYY")} Releases-Export.csv`,r,"text/csv")!==!0&&x.notify({message:"Browser denied file download...",color:"negative",icon:"warning"})};function E(e){_.push({name:"view-release",params:{release:e.id}})}return(e,t)=>(F(),ee("div",null,[s(le,{flat:""},{default:d(()=>[s(ae,null,{default:d(()=>[u("div",ge,[u("div",ye,[s(ce,{debounce:"300",dense:""})]),u("div",$e,[s(j,{dense:"",debounce:"300",modelValue:w.value,"onUpdate:modelValue":t[0]||(t[0]=a=>w.value=a),label:"Search"},null,8,["modelValue"])]),u("div",we,[s(j,{dense:"",debounce:"300",modelValue:v.value,"onUpdate:modelValue":t[1]||(t[1]=a=>v.value=a),label:"Release Date",type:"date","stack-label":""},null,8,["modelValue"])]),De])]),_:1})]),_:1}),u("div",null,[s(se,{title:"Available for Redeployment","title-class":"text-h5 text-primary",ref_key:"tableRef",ref:R,columns:I.value,rows:$.value,"row-key":a=>a[3],class:"q-pa-sm",pagination:i.value,"onUpdate:pagination":t[2]||(t[2]=a=>i.value=a),"table-header-class":"bg-dark text-white","no-data-label":"There are no releases",dense:"","binary-state-sort":"",filter:w.value,onRequest:U},{"body-cell-action":d(a=>[s(B,{props:a},{default:d(()=>[s(Q,{class:"cursor-pointer",size:M(x).screen.gt.sm?"sm":"xs",color:"info",round:"",dense:"",onClick:l=>E(a.row),name:a.expand?"visibility_off":"visibility"},null,8,["size","onClick","name"])]),_:2},1032,["props"])]),"body-cell-phoneNumber":d(a=>[s(B,{props:a},{default:d(()=>[u("span",null,Y(a.row.syncObject[56]),1)]),_:2},1032,["props"])]),"no-data":d(({message:a})=>[u("div",he,[s(Q,{size:"2em",name:"fa-solid fa-person-circle-exclamation"}),u("span",null,Y(a),1)])]),"top-right":d(()=>[u("div",_e,"(Total: "+Y(i.value.rowsNumber)+" releases)",1),s(z,{color:"secondary",flat:"","icon-right":"refresh",label:"Refresh",onClick:V}),s(z,{dense:M(x).screen.lt.md,class:"q-ml-sm",color:"primary",label:"Download",onClick:A,disable:i.value.rowsNumber<1},null,8,["dense","disable"])]),loading:d(()=>[s(oe,{showing:"",color:"primary"})]),_:1},8,["columns","rows","row-key","pagination","filter"])])]))}},Ne={class:"row items-center"},Re={class:"col-12 col-md-3 q-px-sm"},Ie={class:"col-12 col-md-3 q-px-sm"},ke={class:"col-12 col-md-3 q-px-sm"},Ye=u("div",{class:"col-12 col-md-3 q-px-sm"},null,-1),Ce={class:"full-width row flex-center text-primary q-gutter-sm q-py-md"},Pe={class:"text-dark text-caption text-italic"},qe={__name:"releases",setup(X){const _=J(),x=ne(),N=ie();de();const{getSelectedProject:m,getSelectedOffice:b}=K(N),{capitalize:C}=te,T=c(b.value?b.value[8]:null),O=c(m.value?m.value[3]:null),R=c(),$=c([]),w=c(""),v=c(""),D=c(!1),i=c({sortBy:"effectiveDate",descending:!0,page:1,rowsPerPage:25,rowsNumber:0});k(b,()=>{T.value=b.value?b.value[8]:null}),k(m,()=>{O.value=m.value?m.value[3]:null}),k(v,()=>{V()});const I=c([{name:"action",label:"",align:"left",field:"action",sortable:!1},{name:"fullName",label:"Name",align:"left",field:"fullName",format:e=>`${q(e)}`,sortable:!1,sortOrder:"ad"},{name:"phoneNumber",label:"Phone #",align:"left",field:"phoneNumber",sortable:!1},{name:"workdayId",label:"Workday ID",align:"left",field:"workdayId",format:e=>`${e}`,sortable:!1,sortOrder:"ad"},{name:"payrollId",label:"Payroll ID",align:"left",field:"payrollId",format:e=>e===""?"not available":e,sortable:!1},{name:"classification",label:"Classification",align:"left",field:"classification",format:e=>`${!e||e===""?"Not Assigned":e}`,sortable:!1},{name:"reason",label:"Term Reason",align:"left",field:"reason",format:e=>`${e}`,sortable:!1},{name:"effectiveDate",label:"Release Date",align:"left",field:"effectiveDate",format:e=>`${y(e).format("MM/DD/YYYY")}`,sortable:!0},{name:"releaseDateCreated",label:"Date Submitted",align:"left",field:"releaseDateCreated",format:e=>`${y(e).format("MM/DD/YYYY")}`,sortable:!0}]),P=c([{name:"action",label:"",align:"left",field:"action",sortable:!1},{name:"fullName",label:"Name",align:"left",field:"fullName",format:e=>`${q(e)}`,sortable:!1,sortOrder:"ad"},{name:"phoneNumber",label:"Phone #",align:"left",field:"phoneNumber",sortable:!1},{name:"workdayId",label:"Workday ID",align:"left",field:"workdayId",format:e=>`${e}`,sortable:!1,sortOrder:"ad"},{name:"payrollId",label:"Payroll ID",align:"left",field:"payrollId",format:e=>e===""?"not available":e,sortable:!1},{name:"classification",label:"Classification",align:"left",field:"classification",format:e=>`${!e||e===""?"Not Assigned":e}`,sortable:!1},{name:"reason",label:"Term Reason",align:"left",field:"reason",format:e=>`${e}`,sortable:!1},{name:"effectiveDate",label:"Release Date",align:"left",field:"effectiveDate",format:e=>`${y(e).format("MM/DD/YYYY")}`,sortable:!0},{name:"releaseDateCreated",label:"Date Submitted",align:"left",field:"releaseDateCreated",format:e=>`${y(e).format("MM/DD/YYYY")}`,sortable:!0}]),q=e=>{const t=e.split(" ");let a="";return t.forEach((l,f)=>{a+=f>0?` ${C(l.toLowerCase())}`:C(l.toLowerCase())}),a},S=({page:e,pageSize:t,descending:a,filter:l,sortBy:f})=>{try{let r="";const g=l&&l!=="";g&&(r=l.trim());const n={$or:[{fullName:{$containsi:`${r}`}},{classification:{$containsi:`${r}`}},{jobNumber:{$containsi:`${r}`}},{workdayId:{$containsi:`${r}`}},{phoneNumber:{$containsi:`${r}`}},{payrollId:{$containsi:`${r}`}}]},o={$and:[...g?[n]:[],{status:{$in:["Pending","Reviewed"]}},{primaryReason:{$eq:"Involuntary"}},...v.value?[{effectiveDate:{$eq:v.value}}]:[]]};return fe.getReleases({pagination:{page:e,pageSize:t},sort:`${f||"releaseDateCreated"}:${a?"desc":"asc"}`,filters:o}).then(p=>{const{data:W,meta:L}=p;return D.value=!1,{data:W,meta:L}})}catch(r){console.log(r),D.value=!1}},U=async e=>{const{page:t,rowsPerPage:a,sortBy:l,descending:f}=e.pagination,r=e.filter,g=a===0?i.value.rowsNumber:a;D.value=!0;const n=await S({page:t,sortBy:l,descending:f,pageSize:g,filter:r});if(D.value=!1,n){const{data:o,meta:p}=n;$.value.splice(0,$.value.length,...o),i.value.page=p.pagination.page,i.value.sortBy=l,i.value.descending=f,i.value.rowsPerPage=p.pagination.pageSize,i.value.rowsPerPage=p.pagination.pageSize,i.value.rowsNumber=p.pagination.total}};Z(()=>{R.value.requestServerInteraction()});const V=()=>{R.value.requestServerInteraction()};function h(e,t,a){let l=t!==void 0?t(e,a):e;return l=l==null?"":String(l),l=l.split('"').join('""'),`"${l}"`}const A=async()=>{const{page:e,rowsNumber:t,sortBy:a,descending:l}=i.value,f=await S({page:e,sortBy:a,descending:l,pageSize:t,filter:w.value});let r=[I.value.map(n=>h(n.label))].concat($.value.map(n=>I.value.map(o=>h(typeof o.field=="function"?o.field(n):n[o.field===void 0?o.name:o.field],o.format,n)).join(","))).join(`\r
`);f&&f.data&&(r=[P.value.map(n=>h(n.label))].concat(f.data.map(n=>P.value.map(o=>h(typeof o.field=="function"?o.field(n):n[o.field===void 0?o.name:o.field],o.format,n)).join(","))).join(`\r
`)),re(`${y().format("MM.DD.YYYY")} Releases-Export.csv`,r,"text/csv")!==!0&&x.notify({message:"Browser denied file download...",color:"negative",icon:"warning"})};function E(e){_.push({name:"view-release",params:{release:e.id}})}return(e,t)=>(F(),ee("div",null,[s(le,{flat:""},{default:d(()=>[s(ae,null,{default:d(()=>[u("div",Ne,[u("div",Re,[s(ce,{debounce:"300",dense:""})]),u("div",Ie,[s(j,{dense:"",debounce:"300",modelValue:w.value,"onUpdate:modelValue":t[0]||(t[0]=a=>w.value=a),label:"Search"},null,8,["modelValue"])]),u("div",ke,[s(j,{dense:"",debounce:"300",modelValue:v.value,"onUpdate:modelValue":t[1]||(t[1]=a=>v.value=a),label:"Release Date",type:"date","stack-label":""},null,8,["modelValue"])]),Ye])]),_:1})]),_:1}),u("div",null,[s(se,{title:"Releases","title-class":"text-h5 text-primary",ref_key:"tableRef",ref:R,columns:I.value,rows:$.value,"row-key":a=>a[3],class:"q-pa-sm",pagination:i.value,"onUpdate:pagination":t[2]||(t[2]=a=>i.value=a),"table-header-class":"bg-dark text-white","no-data-label":"There are no releases",dense:"","binary-state-sort":"",filter:w.value,onRequest:U},{"body-cell-action":d(a=>[s(B,{props:a},{default:d(()=>[s(Q,{class:"cursor-pointer",size:M(x).screen.gt.sm?"sm":"xs",color:"info",round:"",dense:"",onClick:l=>E(a.row),name:a.expand?"visibility_off":"visibility"},null,8,["size","onClick","name"])]),_:2},1032,["props"])]),"body-cell-phoneNumber":d(a=>[s(B,{props:a},{default:d(()=>[u("span",null,Y(a.row.syncObject[56]),1)]),_:2},1032,["props"])]),"no-data":d(({message:a})=>[u("div",Ce,[s(Q,{size:"2em",name:"fa-solid fa-person-circle-exclamation"}),u("span",null,Y(a),1)])]),"top-right":d(()=>[u("div",Pe,"(Total: "+Y(i.value.rowsNumber)+" releases)",1),s(z,{color:"secondary",flat:"","icon-right":"refresh",label:"Refresh",onClick:V}),s(z,{dense:M(x).screen.lt.md,class:"q-ml-sm",color:"primary",label:"Download",onClick:A,disable:i.value.rowsNumber<1},null,8,["dense","disable"])]),loading:d(()=>[s(oe,{showing:"",color:"primary"})]),_:1},8,["columns","rows","row-key","pagination","filter"])])]))}},Se={class:"q-pa-md"},fa={__name:"index",setup(X){const _=c(0);return(x,N)=>(F(),ve(be,{style:{"max-width":"100vw"}},{default:d(()=>[u("div",Se,[s(pe,{class:"bg-info text-white shadow-2 rounded-borders"},{default:d(()=>[s(me,{modelValue:_.value,"onUpdate:modelValue":N[0]||(N[0]=m=>_.value=m),"bg-color":"none","indicator-color":"accent",align:"justify",dense:""},{default:d(()=>[s(G,{name:0,label:"Available for Redeployment"}),s(G,{name:1,label:"Releases"})]),_:1},8,["modelValue"])]),_:1}),s(ue,{modelValue:_.value,"onUpdate:modelValue":N[1]||(N[1]=m=>_.value=m),animated:""},{default:d(()=>[s(H,{name:0},{default:d(()=>[s(xe)]),_:1}),s(H,{name:1},{default:d(()=>[s(qe)]),_:1})]),_:1},8,["modelValue"])])]),_:1}))}};export{fa as default};
