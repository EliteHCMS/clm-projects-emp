import{Q as G,a as ue,b as H}from"./QTabPanels.7f2b2f83.js";import{Q as me}from"./QTabs.3a560d12.js";import{Q as pe}from"./QToolbar.6b905ef4.js";import{Q as be}from"./QPage.8d15663e.js";import{bV as J,bX as K,r as c,w as Y,o as Z,B as F,C as ee,d as s,bt as d,cW as ae,E as u,cX as j,cV as le,bS as Q,aa as M,ae as k,bY as z,z as te,as as ve}from"./index.960d5b34.js";import{Q as B}from"./QTd.e3f90e32.js";import{Q as oe}from"./QInnerLoading.13b17dc0.js";import{Q as se}from"./QTable.2cc075de.js";import{u as ne}from"./use-quasar.09536e80.js";import{e as re}from"./export-file.dc78ba05.js";import{dayjs as y}from"./dayjs.501e8a8e.js";import{c as ie,u as de,i as fe}from"./app.bda2cd70.js";import{_ as ce}from"./projectSelector.32d51d56.js";import"./use-panel.98705a6b.js";import"./touch.3df10340.js";import"./selection.4cab378b.js";import"./QResizeObserver.b1215cec.js";import"./rtl.b51694b1.js";import"./QList.c2993b6b.js";import"./QMarkupTable.17a90ccc.js";import"./QSelect.ce23f885.js";import"./QChip.e4d2f168.js";import"./QMenu.dd57348b.js";import"./position-engine.40859e34.js";import"./use-fullscreen.7e074d8e.js";import"./_commonjsHelpers.a26ce4be.js";import"./localForage.84a30b23.js";import"./index.04bc0a32.js";import"./i18n.2abc02f2.js";const ge={class:"row items-center"},ye={class:"col-12 col-md-3 q-px-sm"},$e={class:"col-12 col-md-3 q-px-sm"},we={class:"col-12 col-md-3 q-px-sm"},De=u("div",{class:"col-12 col-md-3 q-px-sm"},null,-1),he={class:"full-width row flex-center text-primary q-gutter-sm q-py-md"},_e={class:"text-dark text-caption text-italic"},xe={__name:"redeployment",setup(X){const _=J(),x=ne(),N=ie();de();const{getSelectedProject:m,getSelectedOffice:b}=K(N),{capitalize:C}=te,T=c(b.value?b.value[8]:null),O=c(m.value?m.value[3]:null),I=c(),$=c([]),w=c(""),v=c(""),D=c(!1),i=c({sortBy:"effectiveDate",descending:!0,page:1,rowsPerPage:25,rowsNumber:0});Y(b,()=>{T.value=b.value?b.value[8]:null}),Y(m,()=>{O.value=m.value?m.value[3]:null}),Y(v,()=>{V()});const R=c([{name:"action",label:"",align:"left",field:"action",sortable:!1},{name:"fullName",label:"Name",align:"left",field:"fullName",format:e=>`${S(e)}`,sortable:!1,sortOrder:"ad"},{name:"phoneNumber",label:"Phone #",align:"left",field:"phoneNumber",sortable:!1},{name:"workdayId",label:"Workday ID",align:"left",field:"workdayId",format:e=>`${e}`,sortable:!1,sortOrder:"ad"},{name:"payrollId",label:"Payroll ID",align:"left",field:"payrollId",format:e=>e===""?"not available":e,sortable:!1},{name:"classification",label:"Classification",align:"left",field:"classification",format:e=>`${!e||e===""?"Not Assigned":e}`,sortable:!1},{name:"reason",label:"Term Reason",align:"left",field:"reason",format:e=>`${e}`,sortable:!1},{name:"effectiveDate",label:"Release Date",align:"left",field:"effectiveDate",format:e=>`${y(e).format("MM/DD/YYYY")}`,sortable:!0},{name:"releaseDateCreated",label:"Date Submitted",align:"left",field:"releaseDateCreated",format:e=>`${y(e).format("MM/DD/YYYY")}`,sortable:!0}]),P=c([{name:"action",label:"",align:"left",field:"action",sortable:!1},{name:"fullName",label:"Name",align:"left",field:"fullName",format:e=>`${S(e)}`,sortable:!1,sortOrder:"ad"},{name:"phoneNumber",label:"Phone #",align:"left",field:"phoneNumber",sortable:!1},{name:"workdayId",label:"Workday ID",align:"left",field:"workdayId",format:e=>`${e}`,sortable:!1,sortOrder:"ad"},{name:"payrollId",label:"Payroll ID",align:"left",field:"payrollId",format:e=>e===""?"not available":e,sortable:!1},{name:"classification",label:"Classification",align:"left",field:"classification",format:e=>`${!e||e===""?"Not Assigned":e}`,sortable:!1},{name:"reason",label:"Term Reason",align:"left",field:"reason",format:e=>`${e}`,sortable:!1},{name:"effectiveDate",label:"Release Date",align:"left",field:"effectiveDate",format:e=>`${y(e).format("MM/DD/YYYY")}`,sortable:!0},{name:"releaseDateCreated",label:"Date Submitted",align:"left",field:"releaseDateCreated",format:e=>`${y(e).format("MM/DD/YYYY")}`,sortable:!0}]),S=e=>{const t=e.split(" ");let a="";return t.forEach((l,f)=>{a+=f>0?` ${C(l.toLowerCase())}`:C(l.toLowerCase())}),a},q=({page:e,pageSize:t,descending:a,filter:l,sortBy:f})=>{try{let r="";const g=l&&l!=="";g&&(r=l.trim());const n={$or:[{fullName:{$containsi:`${r}`}},{classification:{$containsi:`${r}`}},{jobNumber:{$containsi:`${r}`}},{workdayId:{$containsi:`${r}`}},{phoneNumber:{$containsi:`${r}`}},{payrollId:{$containsi:`${r}`}}]},o={$and:[...g?[n]:[],{status:{$in:["Pending","Reviewed"]}},{primaryReason:{$eq:"Involuntary"}},{workdayStatus:{$eq:"Active"}},{reason:{$in:["Lack of Work / End of Contract/Project","RIF/Elimination of Position","Project Cancelled Before Employee Started"]}},...v.value?[{effectiveDate:{$eq:v.value}}]:[]]};return fe.getReleases({pagination:{page:e,pageSize:t},sort:`${f||"releaseDateCreated"}:${a?"desc":"asc"}`,filters:o}).then(p=>{const{data:L,meta:W}=p;return D.value=!1,{data:L,meta:W}})}catch(r){console.log(r),D.value=!1}},A=async e=>{const{page:t,rowsPerPage:a,sortBy:l,descending:f}=e.pagination,r=e.filter,g=a===0?i.value.rowsNumber:a;D.value=!0;const n=await q({page:t,sortBy:l,descending:f,pageSize:g,filter:r});if(D.value=!1,n){const{data:o,meta:p}=n;$.value.splice(0,$.value.length,...o),i.value.page=p.pagination.page,i.value.sortBy=l,i.value.descending=f,i.value.rowsPerPage=p.pagination.pageSize,i.value.rowsPerPage=p.pagination.pageSize,i.value.rowsNumber=p.pagination.total}};Z(()=>{I.value.requestServerInteraction()});const V=()=>{I.value.requestServerInteraction()};function h(e,t,a){let l=t!==void 0?t(e,a):e;return l=l==null?"":String(l),l=l.split('"').join('""'),`"${l}"`}const E=async()=>{const{page:e,rowsNumber:t,sortBy:a,descending:l}=i.value,f=await q({page:e,sortBy:a,descending:l,pageSize:t,filter:w.value});let r=[R.value.map(n=>h(n.label))].concat($.value.map(n=>R.value.map(o=>h(typeof o.field=="function"?o.field(n):n[o.field===void 0?o.name:o.field],o.format,n)).join(","))).join(`\r
`);f&&f.data&&(r=[P.value.map(n=>h(n.label))].concat(f.data.map(n=>P.value.map(o=>h(typeof o.field=="function"?o.field(n):n[o.field===void 0?o.name:o.field],o.format,n)).join(","))).join(`\r
`)),re(`${y().format("MM.DD.YYYY")} Releases-Export.csv`,r,"text/csv")!==!0&&x.notify({message:"Browser denied file download...",color:"negative",icon:"warning"})};function U(e){_.push({name:"view-release",params:{release:e.id}})}return(e,t)=>(F(),ee("div",null,[s(le,{flat:""},{default:d(()=>[s(ae,null,{default:d(()=>[u("div",ge,[u("div",ye,[s(ce,{debounce:"300",dense:""})]),u("div",$e,[s(j,{dense:"",debounce:"300",modelValue:w.value,"onUpdate:modelValue":t[0]||(t[0]=a=>w.value=a),label:"Search"},null,8,["modelValue"])]),u("div",we,[s(j,{dense:"",debounce:"300",modelValue:v.value,"onUpdate:modelValue":t[1]||(t[1]=a=>v.value=a),label:"Release Date",type:"date","stack-label":""},null,8,["modelValue"])]),De])]),_:1})]),_:1}),u("div",null,[s(se,{title:"Available for Redeployment","title-class":"text-h5 text-primary",ref_key:"tableRef",ref:I,columns:R.value,rows:$.value,"row-key":a=>a[3],class:"q-pa-sm",pagination:i.value,"onUpdate:pagination":t[2]||(t[2]=a=>i.value=a),"table-header-class":"bg-dark text-white","no-data-label":"There are no releases",dense:"","binary-state-sort":"",filter:w.value,onRequest:A},{"body-cell-action":d(a=>[s(B,{props:a},{default:d(()=>[s(Q,{class:"cursor-pointer",size:M(x).screen.gt.sm?"sm":"xs",color:"info",round:"",dense:"",onClick:l=>U(a.row),name:a.expand?"visibility_off":"visibility"},null,8,["size","onClick","name"])]),_:2},1032,["props"])]),"body-cell-phoneNumber":d(a=>[s(B,{props:a},{default:d(()=>[u("span",null,k(a.row.syncObject[56]),1)]),_:2},1032,["props"])]),"no-data":d(({message:a})=>[u("div",he,[s(Q,{size:"2em",name:"fa-solid fa-person-circle-exclamation"}),u("span",null,k(a),1)])]),"top-right":d(()=>[u("div",_e,"(Total: "+k(i.value.rowsNumber)+" releases)",1),s(z,{color:"secondary",flat:"","icon-right":"refresh",label:"Refresh",onClick:V}),s(z,{dense:M(x).screen.lt.md,class:"q-ml-sm",color:"primary",label:"Download",onClick:E,disable:i.value.rowsNumber<1},null,8,["dense","disable"])]),loading:d(()=>[s(oe,{showing:"",color:"primary"})]),_:1},8,["columns","rows","row-key","pagination","filter"])])]))}},Ne={class:"row items-center"},Ie={class:"col-12 col-md-3 q-px-sm"},Re={class:"col-12 col-md-3 q-px-sm"},Ye={class:"col-12 col-md-3 q-px-sm"},ke=u("div",{class:"col-12 col-md-3 q-px-sm"},null,-1),Ce={class:"full-width row flex-center text-primary q-gutter-sm q-py-md"},Pe={class:"text-dark text-caption text-italic"},Se={__name:"releases",setup(X){const _=J(),x=ne(),N=ie();de();const{getSelectedProject:m,getSelectedOffice:b}=K(N),{capitalize:C}=te,T=c(b.value?b.value[8]:null),O=c(m.value?m.value[3]:null),I=c(),$=c([]),w=c(""),v=c(""),D=c(!1),i=c({sortBy:"effectiveDate",descending:!0,page:1,rowsPerPage:25,rowsNumber:0});Y(b,()=>{T.value=b.value?b.value[8]:null}),Y(m,()=>{O.value=m.value?m.value[3]:null}),Y(v,()=>{V()});const R=c([{name:"action",label:"",align:"left",field:"action",sortable:!1},{name:"fullName",label:"Name",align:"left",field:"fullName",format:e=>`${S(e)}`,sortable:!1,sortOrder:"ad"},{name:"phoneNumber",label:"Phone #",align:"left",field:"phoneNumber",sortable:!1},{name:"workdayId",label:"Workday ID",align:"left",field:"workdayId",format:e=>`${e}`,sortable:!1,sortOrder:"ad"},{name:"payrollId",label:"Payroll ID",align:"left",field:"payrollId",format:e=>e===""?"not available":e,sortable:!1},{name:"classification",label:"Classification",align:"left",field:"classification",format:e=>`${!e||e===""?"Not Assigned":e}`,sortable:!1},{name:"reason",label:"Term Reason",align:"left",field:"reason",format:e=>`${e}`,sortable:!1},{name:"effectiveDate",label:"Release Date",align:"left",field:"effectiveDate",format:e=>`${y(e).format("MM/DD/YYYY")}`,sortable:!0},{name:"releaseDateCreated",label:"Date Submitted",align:"left",field:"releaseDateCreated",format:e=>`${y(e).format("MM/DD/YYYY")}`,sortable:!0}]),P=c([{name:"action",label:"",align:"left",field:"action",sortable:!1},{name:"fullName",label:"Name",align:"left",field:"fullName",format:e=>`${S(e)}`,sortable:!1,sortOrder:"ad"},{name:"phoneNumber",label:"Phone #",align:"left",field:"phoneNumber",sortable:!1},{name:"workdayId",label:"Workday ID",align:"left",field:"workdayId",format:e=>`${e}`,sortable:!1,sortOrder:"ad"},{name:"payrollId",label:"Payroll ID",align:"left",field:"payrollId",format:e=>e===""?"not available":e,sortable:!1},{name:"classification",label:"Classification",align:"left",field:"classification",format:e=>`${!e||e===""?"Not Assigned":e}`,sortable:!1},{name:"reason",label:"Term Reason",align:"left",field:"reason",format:e=>`${e}`,sortable:!1},{name:"effectiveDate",label:"Release Date",align:"left",field:"effectiveDate",format:e=>`${y(e).format("MM/DD/YYYY")}`,sortable:!0},{name:"releaseDateCreated",label:"Date Submitted",align:"left",field:"releaseDateCreated",format:e=>`${y(e).format("MM/DD/YYYY")}`,sortable:!0}]),S=e=>{const t=e.split(" ");let a="";return t.forEach((l,f)=>{a+=f>0?` ${C(l.toLowerCase())}`:C(l.toLowerCase())}),a},q=({page:e,pageSize:t,descending:a,filter:l,sortBy:f})=>{try{let r="";const g=l&&l!=="";g&&(r=l.trim());const n={$or:[{fullName:{$containsi:`${r}`}},{classification:{$containsi:`${r}`}},{jobNumber:{$containsi:`${r}`}},{workdayId:{$containsi:`${r}`}},{phoneNumber:{$containsi:`${r}`}},{payrollId:{$containsi:`${r}`}}]},o={$and:[...g?[n]:[],...v.value?[{effectiveDate:{$eq:v.value}}]:[]]};return fe.getReleases({pagination:{page:e,pageSize:t},sort:`${f||"releaseDateCreated"}:${a?"desc":"asc"}`,filters:o}).then(p=>{const{data:L,meta:W}=p;return D.value=!1,{data:L,meta:W}})}catch(r){console.log(r),D.value=!1}},A=async e=>{const{page:t,rowsPerPage:a,sortBy:l,descending:f}=e.pagination,r=e.filter,g=a===0?i.value.rowsNumber:a;D.value=!0;const n=await q({page:t,sortBy:l,descending:f,pageSize:g,filter:r});if(D.value=!1,n){const{data:o,meta:p}=n;$.value.splice(0,$.value.length,...o),i.value.page=p.pagination.page,i.value.sortBy=l,i.value.descending=f,i.value.rowsPerPage=p.pagination.pageSize,i.value.rowsPerPage=p.pagination.pageSize,i.value.rowsNumber=p.pagination.total}};Z(()=>{I.value.requestServerInteraction()});const V=()=>{I.value.requestServerInteraction()};function h(e,t,a){let l=t!==void 0?t(e,a):e;return l=l==null?"":String(l),l=l.split('"').join('""'),`"${l}"`}const E=async()=>{const{page:e,rowsNumber:t,sortBy:a,descending:l}=i.value,f=await q({page:e,sortBy:a,descending:l,pageSize:t,filter:w.value});let r=[R.value.map(n=>h(n.label))].concat($.value.map(n=>R.value.map(o=>h(typeof o.field=="function"?o.field(n):n[o.field===void 0?o.name:o.field],o.format,n)).join(","))).join(`\r
`);f&&f.data&&(r=[P.value.map(n=>h(n.label))].concat(f.data.map(n=>P.value.map(o=>h(typeof o.field=="function"?o.field(n):n[o.field===void 0?o.name:o.field],o.format,n)).join(","))).join(`\r
`)),re(`${y().format("MM.DD.YYYY")} Releases-Export.csv`,r,"text/csv")!==!0&&x.notify({message:"Browser denied file download...",color:"negative",icon:"warning"})};function U(e){_.push({name:"view-release",params:{release:e.id}})}return(e,t)=>(F(),ee("div",null,[s(le,{flat:""},{default:d(()=>[s(ae,null,{default:d(()=>[u("div",Ne,[u("div",Ie,[s(ce,{debounce:"300",dense:""})]),u("div",Re,[s(j,{dense:"",debounce:"300",modelValue:w.value,"onUpdate:modelValue":t[0]||(t[0]=a=>w.value=a),label:"Search"},null,8,["modelValue"])]),u("div",Ye,[s(j,{dense:"",debounce:"300",modelValue:v.value,"onUpdate:modelValue":t[1]||(t[1]=a=>v.value=a),label:"Release Date",type:"date","stack-label":""},null,8,["modelValue"])]),ke])]),_:1})]),_:1}),u("div",null,[s(se,{title:"Releases","title-class":"text-h5 text-primary",ref_key:"tableRef",ref:I,columns:R.value,rows:$.value,"row-key":a=>a[3],class:"q-pa-sm",pagination:i.value,"onUpdate:pagination":t[2]||(t[2]=a=>i.value=a),"table-header-class":"bg-dark text-white","no-data-label":"There are no releases",dense:"","binary-state-sort":"",filter:w.value,onRequest:A},{"body-cell-action":d(a=>[s(B,{props:a},{default:d(()=>[s(Q,{class:"cursor-pointer",size:M(x).screen.gt.sm?"sm":"xs",color:"info",round:"",dense:"",onClick:l=>U(a.row),name:a.expand?"visibility_off":"visibility"},null,8,["size","onClick","name"])]),_:2},1032,["props"])]),"body-cell-phoneNumber":d(a=>[s(B,{props:a},{default:d(()=>[u("span",null,k(a.row.syncObject[56]),1)]),_:2},1032,["props"])]),"no-data":d(({message:a})=>[u("div",Ce,[s(Q,{size:"2em",name:"fa-solid fa-person-circle-exclamation"}),u("span",null,k(a),1)])]),"top-right":d(()=>[u("div",Pe,"(Total: "+k(i.value.rowsNumber)+" releases)",1),s(z,{color:"secondary",flat:"","icon-right":"refresh",label:"Refresh",onClick:V}),s(z,{dense:M(x).screen.lt.md,class:"q-ml-sm",color:"primary",label:"Download",onClick:E,disable:i.value.rowsNumber<1},null,8,["dense","disable"])]),loading:d(()=>[s(oe,{showing:"",color:"primary"})]),_:1},8,["columns","rows","row-key","pagination","filter"])])]))}},qe={class:"q-pa-md"},da={__name:"index",setup(X){const _=c(0);return(x,N)=>(F(),ve(be,{style:{"max-width":"100vw"}},{default:d(()=>[u("div",qe,[s(pe,{class:"bg-info text-white shadow-2 rounded-borders"},{default:d(()=>[s(me,{modelValue:_.value,"onUpdate:modelValue":N[0]||(N[0]=m=>_.value=m),"bg-color":"none","indicator-color":"accent",align:"justify",dense:""},{default:d(()=>[s(G,{name:0,label:"Available for Redeployment"}),s(G,{name:1,label:"Releases"})]),_:1},8,["modelValue"])]),_:1}),s(ue,{modelValue:_.value,"onUpdate:modelValue":N[1]||(N[1]=m=>_.value=m),animated:""},{default:d(()=>[s(H,{name:0},{default:d(()=>[s(xe)]),_:1}),s(H,{name:1},{default:d(()=>[s(Se)]),_:1})]),_:1},8,["modelValue"])])]),_:1}))}};export{da as default};
