import{Q as O}from"./QImg.528a6e4c.js";import{_ as Y,c3 as Z,r as g,c as P,w as $,aX as ee,y as u,al as k,bg as l,a5 as s,z as b,d as a,am as i,B as q,c1 as h,a9 as v,bD as ae,bC as te,cA as I,b as C,bW as S,aq as se,c5 as z,C as le,cB as re,as as E,c2 as oe}from"./index.b3e75908.js";import{Q as ne}from"./QForm.4299a774.js";import{Q as ue}from"./QPage.de043d3b.js";import{u as ie}from"./use-quasar.0709ee11.js";import{c as V,u as M}from"./array.67354d4e.js";import{u as me}from"./i18n.6357316e.js";import{c as de,q as pe}from"./quickbase.002c2695.js";import{p as ce}from"./VueTelInput.61fbc7eb.js";import{_ as ve}from"./languageSelector.47ae2e17.js";import{c as fe}from"./carousel.4ea49972.js";import"./_commonjsHelpers.dfee5925.js";import"./dayjs.d2fb0443.js";import"./localForage.69471374.js";import"./index.7dbe61ef.js";import"./api.4d9372cc.js";import"./QSelect.f41b057f.js";import"./QMenu.c7af2595.js";import"./position-engine.dc1fa88b.js";import"./selection.f696f409.js";import"./rtl.65b79c69.js";import"./use-panel.acfa707c.js";import"./touch.d8ab472d.js";import"./use-fullscreen.7a786134.js";const ge={key:0,class:"col-md-7 col-lg-8 col-lx-8"},be={class:"col-xs-12 col-sm-12 col-md-5 col-lg-4 col-lx-4 row justify-center items-center"},he={key:0,class:"text-dark"},ye={key:1,class:"text-dark"},xe={key:0,class:"row q-col-gutter-xs"},_e={class:"text-grey-6",tabindex:"4"},we={class:"text-grey-6",tabindex:"5"},Ne={class:"row justify-center"},$e={__name:"forgotPassword",setup(ke){const B=ie(),R=Z(),{t:y}=me(),{currentUserType:U}=de(),m=g(!1),d=g(!1),j=g(10),r=g("username"),o=g("phoneNumber"),f=g(null),F=P(()=>m.value||o.value==="phoneNumber"?V().email(`${y("validEmailIsRequired")}`).nullable():V().email(`${y("validEmailIsRequired")}`).required()),K=P(()=>{if(d.value||o.value==="email")return V().nullable();{const e=new RegExp("^[0-9]{"+j.value+"}","g");return V().matches(e,{excludeEmptyString:!0,message:`${y("validPhoneIsRequired")}`}).required()}}),{value:x,errorMessage:A,meta:W}=M("firstName"),{value:_,errorMessage:L,meta:H}=M("lastName"),{errorMessage:Q,value:p}=M("email",F),{errorMessage:w,value:c}=M("phone",K);U==="QuickBase User"&&R.push("/"),$(Q,e=>{e||p.value===""?d.value=!1:d.value=!0}),$(p,e=>{(!e||e==="")&&(d.value=!1)}),$(w,e=>{e||c.value===""?m.value=!1:m.value=!0}),$(c,e=>{(!e||e==="")&&(m.value=!1)});const X=e=>{f.value=e},G=e=>{j.value=e},T=P(()=>!(m.value||d.value)),D=async()=>{const e={userType:U,firstName:x.value,lastName:_.value,email:d.value?p.value:null,phoneNumber:m.value?`+${f.value?f.value.dialCode:"1"}${c.value}`:null},{data:t}=await pe.resetPassword(e);if(t.length===0)B.notify({position:"top-right",type:"negative",message:`${y("noUserFoundWithInformation")}`});else{const N=t[0][76];R.push({name:"code-confirmation",query:{...f.value&&m.value&&{p:`${f.value?f.value.dialCode:"1"}${c.value}`},...d.value&&{e:`${p.value}`},rid:N[3],ac:!0,send:!0}})}},J=e=>{r.value==="username"&&!T.value?D():e.preventDefault()};return(e,t)=>{const N=ee("router-link");return u(),k(ue,{class:"window-height window-width row"},{default:l(()=>[s(B).screen.lt.md?i("",!0):(u(),b("div",ge,[a(fe)])),q("div",be,[a(oe,{class:"auth-card",flat:""},{default:l(()=>[a(h,{style:{"padding-left":"30px","padding-right":"30px"}},{default:l(()=>[a(O,{src:"https://cdn.jsdelivr.net/gh/EliteHCMS/assets@latest/public/logo.svg",fit:"scale-down",class:"auth-logo full-width"})]),_:1}),a(h,{class:"text-center auth-description"},{default:l(()=>[o.value==="email"&&r.value==="username"?(u(),b("p",he,v(e.$t("enterEmailSendCode")),1)):i("",!0),o.value==="phoneNumber"&&r.value==="username"?(u(),b("p",ye,v(e.$t("enterPhoneSendCode")),1)):i("",!0)]),_:1}),a(h,null,{default:l(()=>[a(ne,{class:"q-px-sm q-pt-sm",onSubmit:t[7]||(t[7]=ae(()=>{},["prevent"])),onKeyup:te(J,["enter"])},{default:l(()=>[r.value==="username"?(u(),b("div",xe,[a(I,{class:"col-xs-12 col-sm-6 q-pb-lg",clearable:"",outlined:"",modelValue:s(x),"onUpdate:modelValue":t[0]||(t[0]=n=>C(x)?x.value=n:null),type:"text",autocomplete:"given-name",label:e.$t("firstName"),tabindex:"1",name:"firstName",error:!!(s(A)&&s(W).validated),"error-message":s(A)},{prepend:l(()=>[a(S,{name:"person"})]),_:1},8,["modelValue","label","error","error-message"]),a(I,{class:"col-xs-12 col-sm-6",clearable:"",outlined:"",modelValue:s(_),"onUpdate:modelValue":t[1]||(t[1]=n=>C(_)?_.value=n:null),type:"text",autocomplete:"family-name",label:e.$t("lastName"),tabindex:"2",name:"lastName",error:!!(s(L)&&s(H).validated),"error-message":s(L)},{prepend:l(()=>[a(S,{name:"person_outline"})]),_:1},8,["modelValue","label","error","error-message"])])):i("",!0),o.value==="email"&&r.value==="username"?(u(),k(I,{key:1,style:{"padding-bottom":"0px"},clearable:"",outlined:"",modelValue:s(p),"onUpdate:modelValue":t[3]||(t[3]=n=>C(p)?p.value=n:null),type:"email",label:e.$t("email"),tabindex:"3",error:!!s(Q),"error-message":s(Q),readonly:r.value!=="username"},se({prepend:l(()=>[a(S,{name:"email"})]),_:2},[r.value!=="username"?{name:"append",fn:l(()=>[a(z,{round:"",dense:"",flat:"",icon:"edit",onClick:t[2]||(t[2]=n=>{r.value="username"})})])}:void 0]),1032,["modelValue","label","error","error-message","readonly"])):i("",!0),o.value==="phoneNumber"&&r.value==="username"?(u(),k(ce,{key:2,outlined:"",modelValue:s(c),"onUpdate:modelValue":t[4]||(t[4]=n=>C(c)?c.value=n:null),label:e.$t("phoneNumber"),tabindex:"3",onMaxLengthChanged:G,style:le(s(w)?"padding-bottom: 20px;":"padding-bottom: 0px;"),error:!!s(w),"error-message":s(w),onCountryChanged:X},null,8,["modelValue","label","style","error","error-message"])):i("",!0),a(h,{class:"text-right q-pa-none"},{default:l(()=>[o.value==="email"?(u(),b("a",{key:0,onClick:t[5]||(t[5]=n=>o.value="phoneNumber"),class:"text-grey-6",href:"javascript:void(0);",tabindex:"4"},v(e.$t("usePhoneNumber")),1)):i("",!0),o.value==="phoneNumber"?(u(),b("a",{key:1,onClick:t[6]||(t[6]=n=>o.value="email"),class:"text-grey-6",href:"javascript:void(0);",tabindex:"4"},v(e.$t("useEmail")),1)):i("",!0)]),_:1})]),_:1},8,["onKeyup"])]),_:1}),a(re,{class:"q-px-lg"},{default:l(()=>[r.value==="username"?(u(),k(z,{key:0,unelevated:"",size:"lg",color:"primary",class:"full-width text-white",label:e.$t("resetPassword"),tabindex:"3",disabled:s(T),onClick:D},null,8,["label","disabled"])):i("",!0)]),_:1}),a(h,{class:"text-center q-pa-sm"},{default:l(()=>[q("p",_e,[a(N,{to:"/login",class:"text-grey-6"},{default:l(()=>[E(v(e.$t("returnToLogin")),1)]),_:1})]),q("p",we,[E(v(e.$t("needAnAccountQuestion"))+" ",1),a(N,{to:"/register",class:"text-grey-6"},{default:l(()=>[E(v(e.$t("register")),1)]),_:1})])]),_:1}),a(h,{class:"q-pl-lg q-pa-sm"},{default:l(()=>[q("div",Ne,[a(ve,{dense:"",borderless:""})])]),_:1})]),_:1})])]),_:1})}}};var Je=Y($e,[["__scopeId","data-v-59610dc8"]]);export{Je as default};
