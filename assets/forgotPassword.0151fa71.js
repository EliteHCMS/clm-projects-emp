import{Q as X}from"./QImg.377710c3.js";import{_ as Y,bT as Z,r as g,c as P,w as $,b5 as ee,A as u,aq as k,br as s,a8 as l,B as b,d as a,ar as i,D as q,cE as ae,cF as y,ac as v,bO as te,bN as se,cG as E,b as C,bQ as I,av as le,bW as L,E as re,cH as oe,ax as S}from"./index.e8fb2253.js";import{Q as ne}from"./QForm.bc1b5926.js";import{Q as ue}from"./QPage.d147e8f9.js";import{u as ie}from"./use-quasar.0aa2fc3d.js";import{u as Q}from"./vee-validate.esm.f9a9192e.js";import{u as me}from"./i18n.2814a62c.js";import{b as de,q as pe}from"./app.00bf1e10.js";import{p as ce}from"./VueTelInput.e2906d76.js";import{_ as ve}from"./languageSelector.ac25040f.js";import{c as V}from"./array.6a8b7cfb.js";import{c as fe}from"./carousel.1dc054b5.js";import"./_commonjsHelpers.a26ce4be.js";import"./dayjs.d1250a8a.js";import"./localForage.8666a90b.js";import"./api.e92e8aaa.js";import"./index.04bc0a32.js";import"./QSelect.c4b0a406.js";import"./QChip.178232ad.js";import"./QMenu.b4300bfa.js";import"./position-engine.d748a9db.js";import"./selection.1f477e95.js";import"./rtl.b51694b1.js";import"./use-panel.0e4ac6ef.js";import"./touch.70a9dd44.js";import"./use-fullscreen.b1caa6d3.js";const ge={key:0,class:"col-md-7 col-lg-8 col-lx-8"},be={class:"col-xs-12 col-sm-12 col-md-5 col-lg-4 col-lx-4 row justify-center items-center"},ye={key:0,class:"text-dark"},he={key:1,class:"text-dark"},xe={key:0,class:"row q-col-gutter-xs"},_e={class:"text-grey-6",tabindex:"4"},Ne={class:"text-grey-6",tabindex:"5"},we={class:"row justify-center"},$e={__name:"forgotPassword",setup(ke){const R=ie(),B=Z(),{t:h}=me(),{currentUserType:U}=de(),m=g(!1),d=g(!1),j=g(10),r=g("username"),o=g("phoneNumber"),f=g(null),K=P(()=>m.value||o.value==="phoneNumber"?V().email(`${h("validEmailIsRequired")}`).nullable():V().email(`${h("validEmailIsRequired")}`).required()),z=P(()=>{if(d.value||o.value==="email")return V().nullable();{const e=new RegExp("^[0-9]{"+j.value+"}","g");return V().matches(e,{excludeEmptyString:!0,message:`${h("validPhoneIsRequired")}`}).required()}}),{value:x,errorMessage:T,meta:H}=Q("firstName"),{value:_,errorMessage:A,meta:W}=Q("lastName"),{errorMessage:M,value:p}=Q("email",K),{errorMessage:N,value:c}=Q("phone",z);U==="QuickBase User"&&B.push("/"),$(M,e=>{e||p.value===""?d.value=!1:d.value=!0}),$(p,e=>{(!e||e==="")&&(d.value=!1)}),$(N,e=>{e||c.value===""?m.value=!1:m.value=!0}),$(c,e=>{(!e||e==="")&&(m.value=!1)});const G=e=>{f.value=e},O=e=>{j.value=e},D=P(()=>!(m.value||d.value)),F=async()=>{const e={userType:U,firstName:x.value,lastName:_.value,email:d.value?p.value:null,phoneNumber:m.value?`+${f.value?f.value.dialCode:"1"}${c.value}`:null},{data:t}=await pe.resetPassword(e);if(t.length===0)R.notify({position:"top-right",type:"negative",message:`${h("noUserFoundWithInformation")}`});else{const w=t[0][76];B.push({name:"code-confirmation",query:{...f.value&&m.value&&{p:`${f.value?f.value.dialCode:"1"}${c.value}`},...d.value&&{e:`${p.value}`},rid:w[3],ac:!0,send:!0}})}},J=e=>{r.value==="username"&&!D.value?F():e.preventDefault()};return(e,t)=>{const w=ee("router-link");return u(),k(ue,{class:"window-height window-width row"},{default:s(()=>[l(R).screen.lt.md?i("",!0):(u(),b("div",ge,[a(fe)])),q("div",be,[a(ae,{class:"auth-card",flat:""},{default:s(()=>[a(y,{style:{"padding-left":"30px","padding-right":"30px"}},{default:s(()=>[a(X,{src:"https://cdn.jsdelivr.net/gh/EliteHCMS/assets@latest/public/logo.svg",fit:"scale-down",class:"auth-logo full-width"})]),_:1}),a(y,{class:"text-center auth-description"},{default:s(()=>[o.value==="email"&&r.value==="username"?(u(),b("p",ye,v(e.$t("enterEmailSendCode")),1)):i("",!0),o.value==="phoneNumber"&&r.value==="username"?(u(),b("p",he,v(e.$t("enterPhoneSendCode")),1)):i("",!0)]),_:1}),a(y,null,{default:s(()=>[a(ne,{class:"q-px-sm q-pt-sm",onSubmit:t[7]||(t[7]=te(()=>{},["prevent"])),onKeyup:se(J,["enter"])},{default:s(()=>[r.value==="username"?(u(),b("div",xe,[a(E,{class:"col-xs-12 col-sm-6 q-pb-lg",clearable:"",outlined:"",modelValue:l(x),"onUpdate:modelValue":t[0]||(t[0]=n=>C(x)?x.value=n:null),type:"text",autocomplete:"given-name",label:e.$t("firstName"),tabindex:"1",name:"firstName",error:!!(l(T)&&l(H).validated),"error-message":l(T)},{prepend:s(()=>[a(I,{name:"person"})]),_:1},8,["modelValue","label","error","error-message"]),a(E,{class:"col-xs-12 col-sm-6",clearable:"",outlined:"",modelValue:l(_),"onUpdate:modelValue":t[1]||(t[1]=n=>C(_)?_.value=n:null),type:"text",autocomplete:"family-name",label:e.$t("lastName"),tabindex:"2",name:"lastName",error:!!(l(A)&&l(W).validated),"error-message":l(A)},{prepend:s(()=>[a(I,{name:"person_outline"})]),_:1},8,["modelValue","label","error","error-message"])])):i("",!0),o.value==="email"&&r.value==="username"?(u(),k(E,{key:1,style:{"padding-bottom":"0px"},clearable:"",outlined:"",modelValue:l(p),"onUpdate:modelValue":t[3]||(t[3]=n=>C(p)?p.value=n:null),type:"email",label:e.$t("email"),tabindex:"3",error:!!l(M),"error-message":l(M),readonly:r.value!=="username"},le({prepend:s(()=>[a(I,{name:"email"})]),_:2},[r.value!=="username"?{name:"append",fn:s(()=>[a(L,{round:"",dense:"",flat:"",icon:"edit",onClick:t[2]||(t[2]=n=>{r.value="username"})})]),key:"0"}:void 0]),1032,["modelValue","label","error","error-message","readonly"])):i("",!0),o.value==="phoneNumber"&&r.value==="username"?(u(),k(ce,{key:2,outlined:"",modelValue:l(c),"onUpdate:modelValue":t[4]||(t[4]=n=>C(c)?c.value=n:null),label:e.$t("phoneNumber"),tabindex:"3",onMaxLengthChanged:O,style:re(l(N)?"padding-bottom: 20px;":"padding-bottom: 0px;"),error:!!l(N),"error-message":l(N),onCountryChanged:G},null,8,["modelValue","label","style","error","error-message"])):i("",!0),a(y,{class:"text-right q-pa-none"},{default:s(()=>[o.value==="email"?(u(),b("a",{key:0,onClick:t[5]||(t[5]=n=>o.value="phoneNumber"),class:"text-grey-6",href:"javascript:void(0);",tabindex:"4"},v(e.$t("usePhoneNumber")),1)):i("",!0),o.value==="phoneNumber"?(u(),b("a",{key:1,onClick:t[6]||(t[6]=n=>o.value="email"),class:"text-grey-6",href:"javascript:void(0);",tabindex:"4"},v(e.$t("useEmail")),1)):i("",!0)]),_:1})]),_:1},8,["onKeyup"])]),_:1}),a(oe,{class:"q-px-lg"},{default:s(()=>[r.value==="username"?(u(),k(L,{key:0,unelevated:"",size:"lg",color:"primary",class:"full-width text-white",label:e.$t("resetPassword"),tabindex:"3",disabled:D.value,onClick:F},null,8,["label","disabled"])):i("",!0)]),_:1}),a(y,{class:"text-center q-pa-sm"},{default:s(()=>[q("p",_e,[a(w,{to:"/login",class:"text-grey-6"},{default:s(()=>[S(v(e.$t("returnToLogin")),1)]),_:1})]),q("p",Ne,[S(v(e.$t("needAnAccountQuestion"))+" ",1),a(w,{to:"/register",class:"text-grey-6"},{default:s(()=>[S(v(e.$t("register")),1)]),_:1})])]),_:1}),a(y,{class:"q-pl-lg q-pa-sm"},{default:s(()=>[q("div",we,[a(ve,{dense:"",borderless:""})])]),_:1})]),_:1})])]),_:1})}}};var Ye=Y($e,[["__scopeId","data-v-a4a59948"]]);export{Ye as default};
